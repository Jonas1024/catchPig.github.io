System.register("chunks:///_virtual/AnimBaseUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Main.ts"],(function(e){var n,t,o,s,c,i,r,u,a;return{setters:[function(e){n=e.inheritsLoose,t=e.createForOfIteratorHelperLoose,o=e.createClass},function(e){s=e.cclegacy},function(e){c=e.ccclass,i=e.MoveCC,r=e.LoadDir,u=e._scene,a=e.BaseUI}],execute:function(){var h;s._RF.push({},"d08e2Mdh95MpbUSeEdlbQ0i","AnimBaseUI",void 0);e("AnimBaseUI",c("AnimBaseUI")(h=function(e){function s(){for(var n,t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return(n=e.call.apply(e,[this].concat(o))||this).enterMoveccs=[],n.exitMoveccs=[],n}n(s,e);var c=s.prototype;return c.onCreate=function(){for(var e,n=this.getComponentsInChildren(i),o=t(n);!(e=o()).done;){var s=e.value;"enter"==s.tag?this.enterMoveccs.push(s):this.exitMoveccs.push(s)}},c.onOpen=function(){for(var e,n=t(this.exitMoveccs);!(e=n()).done;){e.value.resetPos()}},c.onClose=function(){},c.playAnim=function(e,n){var o=e?this.enterMoveccs:this.exitMoveccs;if(0!=o.length)for(var s,c=new r(o.length,n||function(){}),i=t(o);!(s=i()).done;){s.value.startMove(c.subCount())}else n&&n()},c.playAnimByResetPos=function(e){for(var n,o=e?this.enterMoveccs:this.exitMoveccs,s=t(o);!(n=s()).done;){n.value.resetPos()}},c.onTouchStart=function(e){this.scene&&this.scene.touchStart(e)},c.onTouchEnd=function(e){this.scene&&this.scene.touchEnd(e)},c.onTouchCancel=function(e){this.scene&&this.scene.touchEnd(e)},c.onTouchMove=function(e){this.scene&&this.scene.touchMove(e)},c.onMouseWheel=function(e){this.scene&&this.scene.mouseWheel(e)},o(s,[{key:"scene",get:function(){return u.getCurrent()}}]),s}(a))||h);s._RF.pop()}}}));

System.register("chunks:///_virtual/apeng.js",["./cjs-loader.mjs"],(function(t,e){var i;return{setters:[function(t){i=t.default}],execute:function(){function n(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function o(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,r(t,e)}function r(t,e){return(r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function a(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */a=function(){return e};var t,e={},i=Object.prototype,n=i.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",l=r.asyncIterator||"@@asyncIterator",u=r.toStringTag||"@@toStringTag";function h(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,i){return t[e]=i}}function c(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new x(n||[]);return o(a,"_invoke",{value:I(t,i,s)}),a}function p(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var d="suspendedStart",f="executing",y="completed",g={};function m(){}function v(){}function C(){}var _={};h(_,s,(function(){return this}));var S=Object.getPrototypeOf,E=S&&S(S(B([])));E&&E!==i&&n.call(E,s)&&(_=E);var b=C.prototype=m.prototype=Object.create(_);function T(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function i(o,r,a,s){var l=p(t[o],t,r);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,a,s)}),(function(t){i("throw",t,a,s)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return i("throw",t,a,s)}))}s(l.arg)}var r;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){i(t,n,e,o)}))}return r=r?r.then(o,o):o()}})}function I(e,i,n){var o=d;return function(r,a){if(o===f)throw new Error("Generator is already running");if(o===y){if("throw"===r)throw a;return{value:t,done:!0}}for(n.method=r,n.arg=a;;){var s=n.delegate;if(s){var l=P(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var u=p(e,i,n);if("normal"===u.type){if(o=n.done?y:"suspendedYield",u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function P(e,i){var n=i.method,o=e.iterator[n];if(o===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,P(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var r=p(o,e.iterator,i.arg);if("throw"===r.type)return i.method="throw",i.arg=r.arg,i.delegate=null,g;var a=r.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function B(e){if(e||""===e){var i=e[s];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,r=function i(){for(;++o<e.length;)if(n.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return r.next=r}}throw new TypeError(typeof e+" is not iterable")}return v.prototype=C,o(b,"constructor",{value:C,configurable:!0}),o(C,"constructor",{value:v,configurable:!0}),v.displayName=h(C,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},T(w.prototype),h(w.prototype,l,(function(){return this})),e.AsyncIterator=w,e.async=function(t,i,n,o,r){void 0===r&&(r=Promise);var a=new w(c(t,i,n,o),r);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},T(b),h(b,u,"Generator"),h(b,s,(function(){return this})),h(b,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function o(n,o){return s.type="throw",s.arg=e,i.next=n,o&&(i.method="next",i.arg=t),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),M(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var o=n.arg;M(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,r=void 0,"symbol"==typeof(r=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"))?r:String(r)),n)}var o,r}function l(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function u(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return(i=i.call(t)).next.bind(i);if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return h(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}t("default",void 0);var c=t("__cjsMetaURL",e.meta.url);i.define(c,(function(e,i,r,s,h){window.apeng={versionCode:4};var c=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,r){function a(t){try{l(n.next(t))}catch(t){r(t)}}function s(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))},p=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};!function(t){t.KeyCode=_cc_.KeyCode,t.CCFloat=_cc_.CCFloat,t.math=_cc_.math,t.ViewGroup=_cc_.ViewGroup,t.CCInteger=_cc_.CCInteger,t.native=_cc_.native,t.sys=_cc_.sys,t.input=_cc_.input,t.assetManager=_cc_.assetManager,t.AudioSource=_cc_.AudioSource,t.director=_cc_.director,t.Size=_cc_.Size,t.view=_cc_.view,t.Vec2=_cc_.Vec2,t.Director=_cc_.Director,t.Canvas=_cc_.Canvas,t.sp=_cc_.sp,t.js=_cc_.js,t.game=_cc_.game,t.Game=_cc_.Game,t.TextAsset=_cc_.TextAsset,t.Color=_cc_.Color,t.Vec3=_cc_.Vec3,t.ccenum=_cc_.ccenum,t.Graphics=_cc_.Graphics,t.Animation=_cc_.Animation,t.Node=_cc_.Node,t.Widget=_cc_.Widget,t.BlockInputEvents=_cc_.BlockInputEvents,t.Camera=_cc_.Camera,t.Collider2D=_cc_.Collider2D,t.Component=_cc_.Component,t.dragonBones=_cc_.dragonBones,t.EditBox=_cc_.EditBox,t.EventKeyboard=_cc_.EventKeyboard,t.EventMouse=_cc_.EventMouse,t.EventTouch=_cc_.EventTouch,t.Input=_cc_.Input,t.isValid=_cc_.isValid,t.Label=_cc_.Label,t.Layout=_cc_.Layout,t.Mask=_cc_.Mask,t.MeshRenderer=_cc_.MeshRenderer,t.MotionStreak=_cc_.MotionStreak,t.PageView=_cc_.PageView,t.RigidBody2D=_cc_.RigidBody2D,t.Scene=_cc_.Scene,t.ScrollBar=_cc_.ScrollBar,t.ScrollView=_cc_.ScrollView,t.Sprite=_cc_.Sprite,t.UIOpacity=_cc_.UIOpacity,t.UIRenderer=_cc_.UIRenderer,t.UITransform=_cc_.UITransform,t.warn=_cc_.warn,t.lerp=_cc_.lerp,t.instantiate=_cc_.instantiate,t.CCObject=_cc_.CCObject,t.Asset=_cc_.Asset,t.Prefab=_cc_.Prefab,t.SpriteFrame=_cc_.SpriteFrame,t.Material=_cc_.Material,t._decorator=_cc_._decorator,t.EventHandler=_cc_.EventHandler,t.Quat=_cc_.Quat,t.Mat4=_cc_.Mat4,t.RenderTexture=_cc_.RenderTexture,t.Tween=_cc_.Tween,t.TweenSystem=_cc_.TweenSystem,t.AudioClip=_cc_.AudioClip,t.Layers=_cc_.Layers,t.macro=_cc_.macro,t.SubContextView=_cc_.SubContextView,t.ParticleSystem2D=_cc_.ParticleSystem2D}(apeng||(apeng={})),function(t,e){var i,n,o,r,a;(i=t.EInitCoreState||(t.EInitCoreState={}))[i.init=0]="init",i[i.private=1]="private",i[i.config=2]="config",i[i.openIndex=3]="openIndex",i[i.openScene=4]="openScene",(n=t.EModuleType||(t.EModuleType={}))[n.none=2]="none",n[n.platform=3]="platform",n[n.language=4]="language",n[n.timer=5]="timer",n[n.resouces=6]="resouces",n[n.ui=7]="ui",n[n.audio=8]="audio",n[n.scene=9]="scene",n[n.login=10]="login",n[n.main=11]="main",n[n.privacy=12]="privacy",n[n.gm=13]="gm",n[n.guide=14]="guide",n[n.prop=15]="prop",n[n.rank=16]="rank",(o=t.EPlatformLogicType||(t.EPlatformLogicType={}))[o.banner=100]="banner",o[o.blockOnce=101]="blockOnce",o[o.interstitial=102]="interstitial",o[o.nativeTemp=103]="nativeTemp",o[o.record=104]="record",o[o.rewardedVideo=105]="rewardedVideo",o[o.share=106]="share",o[o.vibrate=107]="vibrate",(r=t.EPlatformType||(t.EPlatformType={}))[r.web=99]="web",r[r.wx=1]="wx",r[r.qq=2]="qq",r[r.tt=3]="tt",r[r.vivo=4]="vivo",r[r.oppo=5]="oppo",r[r.hbs=7]="hbs",r[r.xiaomi=8]="xiaomi",r[r.taptap=9]="taptap",r[r.overseas_android_xgame=10]="overseas_android_xgame",r[r.a360=11]="a360",r[r.overseas_kwai=12]="overseas_kwai",r[r.overseas_weiyou=13]="overseas_weiyou",r[r.ks=14]="ks",r[r.ios=15]="ios",function(t){t[t.chinese=0]="chinese",t[t.traditional=1]="traditional",t[t.english=2]="english",t[t.spanish=3]="spanish",t[t.vietnamese=4]="vietnamese",t[t.portuguese=5]="portuguese",t[t.indonesia=6]="indonesia"}(a=t.ELanguageType||(t.ELanguageType={})),t.CLanguageName=((e={})[a.chinese]="简体中文",e[a.traditional]="繁体中文",e[a.english]="English",e)}(apeng||(apeng={})),function(t){var e=[[1e3,"K"],[1e6,"M"],[1e9,"B"],[1e12,"T"],[1e15,"Q"]],i=function(){function t(){}return t.valueByString=function(i,n){if(void 0===n&&(n=1),i<1e3)return i+"";for(var o=0;o<e.length;o++){var r=e[o],a=e[o+1];if(i>=r[0]&&(!a||i<a[0])){var s=i/r[0];return s<100?t.toFixed(s,n)+r[1]:Math.floor(s)+r[1]}}return""},t.isRange=function(t,e,i){return Math.abs(t-e)<=i},t.isEven=function(t){return t%2==0},t.toRadian=function(e){return e*t._d2r},t.decimal=function(t){return t-=Math.floor(t)},t.toDegree=function(e,i){return void 0===i&&(i=!0),null==e?0:(i&&(e=this.normalizeRadian(e)),e*t._r2d)},t.normalizeRadian=function(e){return(e%=t.PI2)<0&&(e+=t.PI2),e},t.normalizeAngle=function(t){return(t%=360)<0&&(t+=360),t},t.lerp=function(t,e,i){return t+(e-t)*i},t.clamp01=function(t){return t<0?0:t<1?t:1},t.clampf=function(t,e,i){if(e>i){var n=e;e=i,i=n}return t<e?e:t<i?t:i},t.isClampf=function(t,e,i){if(e>i){var n=e;e=i,i=n}return t<=i&&t>=e},t.isRandom=function(t,e){return!!t&&(t>=1||!(t<=0)&&(e||(e=Math.random()),t>e))},t.minToMax=function(t,e,i,n){return void 0===i&&(i=!0),t==e?t:(n||(n=Math.random()),t<0?i?Math.round(n*(Math.abs(t)+e))+t:n*(Math.abs(t)+e)+t:i?Math.round(n*(e-t))+t:n*(e-t)+t)},t.zeroToMax=function(t,e){return t<=1?0:(e||(e=Math.random()),Math.floor((1==e?.5:e)*t))},t.toFixed=function(t,e){var i=Math.pow(10,e);return Math.floor(t*i)/i},t.arrAdd=function(t){for(var e,i=0,n=u(t);!(e=n()).done;){i+=e.value}return i},t.findNumSection=function(t,e,i,n){void 0===n&&(n=!1),i||(i={i:0,count:0}),i.i=t.length,i.count=0;for(var o=0;o<t.length;o++)if(i.count+=t[o],n){if(e<=i.count)return i.i=o,i}else if(e<i.count)return i.i=o,i;return i},t.widgetRandom=function(t){for(var e=this.arrAdd(t)*Math.random(),i=0,n=0;n<t.length;n++){var o=t[n];if(e>=i&&e<i+o)return n;i+=o}return t.length-1},t.keep2Decimal=function(t){return Math.floor(100*t)/100},t}();i.PI=Math.PI,i.PI2=2*Math.PI,i._d2r=i.PI/180,i._r2d=180/i.PI,t.Maths=i}(apeng||(apeng={})),function(t){var e=function(){function e(t){void 0===t&&(t=!0),this.values=[],this.isRepeat=!0,this.isRepeat=t;for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];this.add.apply(this,i)}e.forEach=function(t,e,i){if(void 0===i&&(i=!1),i)for(var n=t.length-1;n>=0&&!e(t[n],n);n--);else for(var o=0;o<t.length&&!e(t[o],o);o++);},e.updateItemCount=function(t,e,i){if(!(t<0||e<0)&&t!=e){var n=t-e;if(n>0)for(var o=0;o<n;o++)i(!0);else for(var r=0,a=Math.abs(n);r<a;r++)i(!1)}},e.pop=function(t,e){return void 0===e&&(e=!1),e?t.pop():t[t.length-1]},e.delete=function(t,e){if(null==e||null==e)return!1;if(0==t.length)return!1;var i=t.indexOf(e);return-1!=i&&(t.splice(i,1),!0)},e.bubblingSort=function(t,e){for(var i=t.length,n=0;n<i-1;n++)for(var o=0;o<i-1-n;o++)if(e(t[o],t[o+1])){var r=t[o];t[o]=t[o+1],t[o+1]=r}},e.reverse=function(t){for(var e=0;e<t.length/2;e++){var i=t[e];t[e]=t[t.length-1-e],t[t.length-1-e]=i}return t},e.map=function(t,e){for(var i=[],n=0;n<t.length;n++){var o=e(t[n],n,t);i.push(o)}return i},e.has=function(t,e,i){return void 0===i&&(i=!1),!!t&&(0!=t.length&&-1!=(i?this.map(t,(function(t){return t.toString()})).indexOf(e.toString()):t.indexOf(e)))},e.add=function(t){for(var e=0;e<(arguments.length<=1?0:arguments.length-1);e++){var i=e+1<1||arguments.length<=e+1?void 0:arguments[e+1];this.has(t,i)||t.push(i)}},e.random=function(e,i,n){if(0==e.length)return null;if(i){for(var o=[],r=0,a=e.length;r<a;r++)i(e[r],r)||o.push(e[r]);return this.random(o)}return e[t.Maths.zeroToMax(e.length,n?n():Math.random())]},e.randomOf=function(e,i,n){if(0==e.length)return null;if(i){for(var o=[],r=0,a=e.length;r<a;r++)i(e[r],r)||o.push(e[r]);return this.randomOf(o)}return t.Maths.zeroToMax(e.length,n?n():Math.random())},e.getAt=function(e,i){return e[i=t.Maths.clampf(i,0,e.length-1)]},e.filterValue=function(t,e,i){void 0===i&&(i=!1);var n=this.filterOf(t,e,i);return-1==n?null:t[n]},e.insert=function(t,e,i){var n=t.splice(i);return t.push(e),t.push.apply(t,n),t},e.filterOf=function(t,e,i){if(void 0===i&&(i=!1),i){for(var n=t.length-1;n>=0;n--)if(void 0!==t[n]&&e(t[n],n))return n}else for(var o=0;o<t.length;o++)if(void 0!==t[o]&&e(t[o],o))return o;return-1},e.filter=function(t,e,i){i||(i=[]);for(var n=0;n<t.length;n++)void 0!==t[n]&&e(t[n],n)&&i.push(t[n]);return i},e.push=function(t,e){if(Array.isArray(e))for(var i,n=u(e);!(i=n()).done;){var o=i.value;t.push(o)}else t.push(e);return t},e.sortMax=function(t,e){return t.sort((function(t,i){return e(i)-e(t)}))},e.sortMin=function(t,e){return t.sort((function(t,i){return e(t)-e(i)}))},e.shuffle=function(t,e,i){if(void 0===e&&(e=!0),i||(i=Math.random),e)return t.sort((function(t,e){return i()>.5?1:-1})),t;var n=t.concat();return n.sort((function(t,e){return i()>.5?1:-1})),n},e.randomArray=function(t,e){void 0===e&&(e=1);for(var i=this.shuffle(t,!1),n=[],o=0;o<e;o++)i[o]&&n.push(i[o]);return n};var i=e.prototype;return i.indexOf=function(t){return this.values.indexOf(t)},i.clear=function(){this.values.length=0},i.shift=function(t){return void 0===t&&(t=!0),t?this.values.shift():this.values.concat()[0]},i.toString=function(){return this.values.toString()},i.forEach=function(t,i){return void 0===i&&(i=!1),e.forEach(this.values,t,i),this},i.add=function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return e.add.apply(e,[this.values].concat(i)),this},i.delete=function(t){return e.delete(this.values,t)},i.has=function(t,i){return void 0===i&&(i=!1),e.has(this.values,t,i)},i.map=function(t){return e.map(this.values,t)},i.filterOf=function(t){return e.filterOf(this.values,t)},i.filterValue=function(t){return e.filterValue(this.values,t)},i.filter=function(t){return e.filter(this.values,t,[])},l(e,[{key:"size",get:function(){return this.values.length}}]),e}();t.Sets=e}(apeng||(apeng={})),function(t){var e=function(){function t(t,e,i,n){this.maxCount=t,this.onObj=e,this.onClear=i,this.onDestroy=n,this.data=[]}var e=t.prototype;return e.instantiate=function(t){for(var e=0;e<t;e++){var i=this.onObj();this.data[this.data.length]=i}},e.get=function(){var t=this.data.pop();return t||(t=this.onObj()),this.onClear(t),t},e.put=function(t){this.onClear(t);var e=this.data.length;if(e>this.maxCount){var i=this.data.shift();i&&(this.onClear(i),this.onDestroy&&this.onDestroy(i)),this.put(t)}else this.data[e]=t},e.clear=function(){for(var t,e=u(this.data);!(t=e()).done;){var i=t.value;this.onClear(i),this.onDestroy&&this.onDestroy(i)}this.data.length=0},e.size=function(){return this.data.length},t}();t.PoolOnce=e;var i=function(){function t(t,e,i,n){this.maxCount=t,this.onObj=e,this.onClear=i,this.onDestroy=n,this.datas=new Map}var i=t.prototype;return i.instantiate=function(t,e){return this.pool(t).instantiate(e)},i.get=function(t){return this.pool(t).get()},i.put=function(t){return this.pool(t.poolLoadUrl).put(t)},i.clear=function(){this.datas.forEach((function(t,e){return t.clear()})),this.datas.clear()},i.size=function(){var t=0;return this.datas.forEach((function(e){t+=e.size()})),t},i.pool=function(t){var i=this,n=this.datas.get(t);return n||(n=new e(this.maxCount,(function(){var e=i.onObj(t);return e.poolLoadUrl=t,e}),(function(e){return i.onClear(e,t)}),this.onDestroy?function(e){return i.onDestroy(e,t)}:null),this.datas.set(t||"pool",n)),n},t}();t.Pool=i;var n=function(){function t(t){this.pool=t,this.data=[]}var e=t.prototype;return e.clear=function(){for(var t,e=u(this.data);!(t=e()).done;){var i=t.value;this.pool.put(i)}this.data.length=0},e.add=function(){var t=this.pool.get();return this.data[this.data.length]=t,t},e.size=function(){return this.data.length},e.get=function(t){return this.data[t]},t}();t.PoolArray=n,t.CPoolArray=new e(1e5,(function(){return[]}),(function(t){return t.length=0}))}(apeng||(apeng={})),function(t){var e=function(){function t(t,e,i,n){void 0===n&&(n=""),this.count=0,this.onFinish=null,this.onSub=null,this.logPrefix="",this.count=t,this.onSub=i,this.onFinish=e,this.logPrefix=n}return t.prototype.subCount=function(t){var e=this;return function(){e.count--,e.count<0&&console.error("引用计数错误"),e.logPrefix&&console.log("引用计数:"+e.logPrefix+"-"+e.count),e.onSub&&e.onSub(t),e.count<=0&&e.onFinish&&e.onFinish()}},t}();t.LoadDir=e}(apeng||(apeng={})),function(t){var e=function(){function e(e,i,n){void 0===e&&(e=null),void 0===i&&(i=-1),void 0===n&&(n=""),this.complete=e,this.interval=i,this.log=n,this.loadDir=new t.LoadDir(0,null),this.values=[],this._values=[],this.isRun=!1}var i=e.prototype;return i.add=function(t,e){return void 0===e&&(e=!1),this.values.push(t),e&&this._values.push(t),this},i.remove=function(e){var i=this.values[e];i&&(t.Sets.delete(this._values,i),this.values[e]=null)},i.remove2=function(t){var e=this.values.indexOf(t);-1!=e&&this.remove(e)},i.has=function(t){return!!this.values[t]},i.runIndex=function(t,e){void 0===e&&(e=function(){});var i=this.values[t];i&&(i(e),this.remove(t))},i.run=function(t){var e=this;if(void 0===t&&(t=1),!this.isRun){this._values.length=0;for(var i,n=u(this.values);!(i=n()).done;){var o=i.value;o&&this._values.push(o)}}this.isRun=!0;var r=this._values.splice(0,t);if(0==r.length)return this.isRun=!1,void(this.complete&&this.complete());this.log&&("function"==typeof this.log?console.log("Queue run "+this.log(this.values.length-this._values.length-1)):console.log("Queue run "+this.log,this.values.length-this._values.length));var a=function(){0!=e.interval?setTimeout(e.run.bind(e,t),1e3*e.interval):e.run(t)};if(1==t)r[0](a);else{this.loadDir.onFinish=a,this.loadDir.count=r.length;for(var s,l=u(r);!(s=l()).done;){(0,s.value)(this.loadDir.subCount())}}},i.clear=function(){this.values.length=0},i.dispose=function(){this.clear(),this.complete=null,this.interval=-1,this.isRun=!1,this.log=""},e}();e.pool=new t.PoolOnce(100,(function(){return new e}),(function(t){return t.dispose()})),t.Queue=e}(apeng||(apeng={})),function(t){t.EventDispatcherEventType={ON:"ON",OFF:"OFF",CLEAR:"CLEAR"};var e=function(){function e(){this.eventMap=new Map}var i=e.prototype;return i.on=function(e,i,n,o){if(void 0===o&&(o=0),"number"!=typeof o)throw new Error("检查注册事件");var r=this.eventMap.get(e);return r||(r=[],this.eventMap.set(e,r)),r.push({callBack:i,caller:n,priority:o}),t.Sets.sortMin(r,(function(t){return t.priority})),this.emit(t.EventDispatcherEventType.ON),i},i.once=function(t,e,i,n){void 0===n&&(n=0);var o=this,r=function n(){var r=e.apply(i,arguments);(null==r||r)&&o.off(t,n,i)};return this.on(t,r,i,n),r},i.off=function(e,i,n){var o=this.eventMap.get(e);if(o)for(var r=0;r<o.length;r++){var a=o[r];if(a&&a.callBack==i&&a.caller==n)return o.splice(r,1),void this.emit(t.EventDispatcherEventType.OFF)}},i.offAll=function(t){return this.eventMap.delete(t)},i.emit=function(t){var e=this.eventMap.get(t),i=[];if(!e)return i;e=[].concat(e);for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];for(var a,s=u(e);!(a=s()).done;){var l=a.value;i.push(l.callBack.apply(l.caller,o))}return i},i.emitQueue=function(e,i,n,o){void 0===i&&(i=-1),void 0===o&&(o="");for(var r=arguments.length,a=new Array(r>4?r-4:0),s=4;s<r;s++)a[s-4]=arguments[s];var l=this.eventMap.get(e);if(!l)return n&&n(),null;if(0==(l=[].concat(l)).length)return n&&n(),null;var h=t.Queue.pool.get();h.interval=i,h.log=o,h.complete=function(){n&&n(),t.Queue.pool.put(h)};for(var c,p=function(){var t=c.value;h.add((function(e){var i;(i=t.callBack).call.apply(i,[t.caller,e].concat(a))}))},d=u(l);!(c=d()).done;)p();return h.run(),h},i.hasEvent=function(t,e,i){var n=this.eventMap.get(t);if(!n)return!1;for(var o,r=u(n);!(o=r()).done;){var a=o.value;if(a&&a.callBack==e&&a.caller==i)return!0}return!1},i.hasEventName=function(t){var e=this.eventMap.get(t);return!!e&&0!=e.length},i.clearEvent=function(){this.eventMap.clear(),this.emit(t.EventDispatcherEventType.CLEAR)},e}();t.EventDispatcher=e}(apeng||(apeng={})),function(t){var e=function(){function e(t){if(this._values={},this.isKeyNumber=!1,this._onceValue=null,this._lastKey=null,this._curKey=null,this.keyArray=[],this.setCount=0,t)for(var e in t)this.set(e,t[e])}e.filterValue=function(t,e){var i=this.filterKey(t,e);return i?t[i]:null},e.size=function(t){var e=0;for(var i in t)e++;return e},e.filterKey=function(t,i,n){if(void 0===n&&(n=!1),n)for(var o=e.keys(t),r=o.length-1;r>=0;r--){var a=o[r];if(i(t[a],a))return a}else for(var s in t)if(i(t[s],s))return s;return null},e.shiftKey=function(t){for(var e in t)return e;return""},e.shiftValue=function(t){for(var e in t)return t[e];return null},e.converValueArray=function(t){var e=[];for(var i in t)e.push(t[i]);return e},e.forEach=function(t,e,i){if(void 0===i&&(i=!1),i){var n=[],o=[];for(var r in t)n.push(t[r]),o.push(r);for(var a=0;a<n.length&&!(n[a]&&e&&e(n[a],o[a],a));a++);}else{var s=-1;for(var l in t)if(s++,t[l]&&e&&e(t[l],l,s))break}},e.randomValue=function(e,i){if(0==this.size(e))return null;var n=this.values(e,i);return n[t.Maths.zeroToMax(n.length)]},e.randomKey=function(e,i){if(0==this.size(e))return null;var n=this.keys(e,i);return n[t.Maths.zeroToMax(n.length)]},e.values=function(t,e,i){for(var n in null==i&&(i=[]),t)e&&e(t[n],n)||i.push(t[n]);return i},e.map=function(t,e){var i={};for(var n in t)i[n]=e(t[n],n);return i},e.keys=function(t,e,i){for(var n in null==i&&(i=[]),t)e&&e(t[n],n)||i.push(n);return i},e.valuesMap=function(t,e){var i=[];for(var n in t)i.push(e(n,t[n]));return i};var i=e.prototype;return i.set=function(e,i){return this.isKeyNumber="number"==typeof e,null!=this._curKey&&(this._lastKey=this._curKey),this._curKey=e,this._values[e]=i,this._onceValue||(this._onceValue=i),t.Sets.add(this.keyArray,e),this.setCount++,this},i.has=function(t){var e=this._values[t];return!(null==e||null==e||!1===e)},i.get=function(t){return this._values[t]},i.gets=function(t){for(var e=[],i=0;i<t.length;i++){var n=this.get(t[i]);n&&e.push(n)}return e},i.getValueByIndex=function(e){var i=this;return t.Sets.filterOf(this.keyArray,(function(t){return i.get(t)==e}))},i.delete=function(e){t.Sets.delete(this.keyArray,e),this._values[e]==this._onceValue&&(this._onceValue=null),this._curKey==e&&(this._curKey=this._lastKey,this._lastKey=null),delete this._values[e]},i.clear=function(){this.keyArray.length=0,this._onceValue=null,this._lastKey=null,this._curKey=null,this._values={},this.setCount=0},i.shiftValue=function(){return this._onceValue?this._onceValue:e.shiftValue(this._values)},i.lastValue=function(){return this.get(this._lastKey)},i.curValue=function(){return this.get(this._curKey)},i.converKey=function(t){return this.isKeyNumber?Number(t):t},i.forEachArray=function(e,i){var n=this;void 0===i&&(i=!1),t.Sets.forEach(this.keyArray,(function(t,i){return!!e(n._values[t],t,i)}),i)},i.filterValue=function(t){return e.filterValue(this._values,t)},i.filterKey=function(t){return e.filterKey(this._values,t)},i.randomValue=function(){return e.randomValue(this._values)},i.values=function(t,i){return e.values(this._values,t,i)},i.keys=function(){return e.keys(this._values)},i.valuesMap=function(t){return e.valuesMap(this._values,t)},i.forEach=function(t,i){var n=this;return void 0===i&&(i=!1),e.forEach(this._values,(function(e,i){return i=n.isKeyNumber?Number(i):i,t(e,i)}),i),this},l(e,[{key:"length",get:function(){return this.keyArray.length}},{key:"size",get:function(){return e.size(this._values)}}]),e}();t.Maps=e}(apeng||(apeng={})),function(t){var e=function(){function t(){}return t.getEnumValue=function(t,e){var i=[];for(var n in t){var o=t[n];"number"==typeof o&&(i.push(o),e&&e(o))}return i},t.getEnumByNums=function(t){if(!t.__num__){for(var e in t.__num__=[],t){var i=t[e];"number"==typeof i&&t.__num__.push(i)}t.__num__.sort((function(t,e){return t-e}))}return t.__num__},t.promiseDelay=function(t){return c(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,1e3*t)})));case 1:case"end":return e.stop()}}),e)})))},t.minxi=function(t){if(null==t||0===t||""===t)return t;return"object"==typeof t?this._mixin(Array.isArray(t)?[]:{},t):t},t.deep=function(t){return null==t?t:"object"==typeof t?JSON.parse(JSON.stringify(t)):t},t.parseArray=function(t){return t?JSON.parse(t):[]},t._copyprop=function(t,e,i){var n=this._getPropertyDescriptor(e,t);Object.defineProperty(i,t,n)},t._getPropertyDescriptor=function(t,e){for(;t;){var i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Object.getPrototypeOf(t)}return null},t.isNullObj=function(t){if(!t)return!1;for(var e in t)return!1;return!0},t.isValid=function(t){return null!=t&&null!=t&&!1!==t},t._mixin=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];t=t||{};for(var o=1,r=arguments.length;o<r;o++){var a=arguments[o];if(a){if("object"!=typeof a)continue;for(var s in a)this._copyprop(s,a,t)}}return t},t.download=function(t,e,i){i||(i="application/octet-stream");var n=document.createElement("a"),o=new Blob([e],{type:i});n.href=window.URL.createObjectURL(o),n.download=t,n.click()},t.isPromise=function(t){return!!t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.then},t.copyContent=function(t){var e=function(){var e=!0,i=document.createElement("textarea");return i.setAttribute("readonly","readonly"),i.value=t,document.body.appendChild(i),i.select(),document.execCommand("copy")?console.log("复制成功"):(console.log("复制失败"),e=!1),document.body.removeChild(i),e};window.navigator.clipboard?window.navigator.clipboard.writeText(t).then((function(t){return console.log("复制成功"),true})).catch((function(t){console.log("复制失败--采取第二种复制方案",t),e()})):e()},t}();t.JS=e}(apeng||(apeng={})),function(t){var e=function(){function t(t,e){this.type=t,this.storage=e}var e=t.prototype;return e.set=function(t,e,i){this.storage.set(this.type,t,e,i)},e.get=function(t,e){return this.storage.get(this.type,t,e)},e.delete=function(t){this.storage.delete(this.type,t)},e.getPrefixKeys=function(t){return this.storage.getPrefixKeys(i.getKey(this.type,t))},t}();t.BaseInstanceStorage=e;var i=function(){function e(t,e,i){void 0===e&&(e=.4),this.localStorage=t,this.delayCache=e,this.getObjData=i,this.cache={},this.updateCache=[],this.timeId=-1}e.getKey=function(t,e){return t+"-"+e},e.parse=function(t){if(void 0===t)return null;var e=t[0];switch(t=t.substring(1),e){case"b":t="true"==t;break;case"n":t=Number(t);break;case"o":t=JSON.parse(t);break;case"s":break;default:t=null}return t};var i=e.prototype;return i.byteSize=function(t){for(var e,i=this.getPrefixKeys(t+"-"),n={},o=this.getObjData(),r=u(i);!(e=r()).done;){var a=e.value;n[a]=o[a]}return(JSON.stringify(n).length/1024).toFixed(2)+"kb"},i.getPrefixKeys=function(t){var e=this.getObjData(),i=[];for(var n in e)0==n.indexOf(t)&&i.push(n);return i},i.set=function(i,n,o,r){void 0===r&&(r=!0),n=e.getKey(i,n),this.checkCacheValue(o)&&(this.cache[n]=o,t.Sets.add(this.updateCache,n),r?t._timer.once(this,this.onSet,this.delayCache):this.onSet())},i.get=function(i,n,o){n=e.getKey(i,n);var r=this.cache[n];return this.checkCacheValue(r)||(r=this.localStorage.getItem(n),this.checkCacheValue(r)?null===(r=e.parse(r))&&(r=t.JS.deep(o)):r=t.JS.deep(o),this.cache[n]=r),this.cache[n]},i.has=function(t,e){return!!this.get(t,e,null)},i.delete=function(t,i){i=e.getKey(t,i),delete this.cache[i],this.localStorage.removeItem(i)},i.clear=function(t){this.cache={},t?this.localStorage.clear(t):this.localStorage.clear()},i.checkCacheValue=function(t){return null!==t&&"null"!==t&&void 0!==t&&""!==t},i.onSet=function(){for(var t,e=u(this.updateCache);!(t=e()).done;){var i=t.value,n=this.cache[i],o=typeof n;switch(o){case"boolean":case"number":n+="";break;case"object":n=JSON.stringify(n);break;case"string":break;default:n=null}null!=n&&this.localStorage.setItem(i,o[0]+n)}this.updateCache.length=0},e}();t.BaseStorage=i}(apeng||(apeng={})),function(t){t.StorageMgr=new t.BaseStorage(t.sys.localStorage,void 0,(function(){return t.sys.localStorage})),t.CStorageDefaultType=1,t.StorageOnceMgr=new t.BaseInstanceStorage(t.CStorageDefaultType,t.StorageMgr),t.CDataStorage=new(function(){function t(){this._data={}}var e=t.prototype;return e.setItem=function(t,e){e!==this._data[t]&&(this._data[t]=e)},e.removeItem=function(t){delete this._data[t]},e.clear=function(){for(var t in this._data)delete this._data[t]},e.getItem=function(t){return this._data[t]},t}()),t.DataStorageMgr=new t.BaseStorage(t.CDataStorage,void 0,(function(){return t.CDataStorage})),t.DataStorageOnceMgr=new t.BaseInstanceStorage(t.CStorageDefaultType,t.DataStorageMgr)}(apeng||(apeng={})),function(t){t.BaseModule=function(){this.storage=null};var e=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).storage=null,e}return o(e,t),e}(t.EventDispatcher);t.BaseModuleEvent=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).EventType={INSTANCE:"INSTANCE",START_UP:"START_UP",RUN_COMLETE:"RUN_COMLETE"},t.modules={},t.modelTypeOrgin=null,t._adds={},t}o(i,e);var n=i.prototype;return n.add=function(t){var e=this;return function(i){e._adds[t]=i}},n.get=function(t){return this.modules[t]},n.instanceOnce=function(e){var i=this._adds[e],n=this.modules[e]=new i;return null===n.storage&&(n.storage=new t.BaseInstanceStorage(t.CStorageDefaultType,t.StorageMgr)),n.onBeforeInstance&&n.onBeforeInstance(),n.onInstance&&n.onInstance(),n},n.instance=function(e,i){var n=this,o=this._adds;t.initData.isLog&&console.log("module count:"+t.Maps.size(o)),t.Maps.forEach(o,(function(i,o){var r=n.modules[o]=new i;null===r.storage&&(r.storage=new t.BaseInstanceStorage(e?Number(o):t.CStorageDefaultType,t.StorageMgr)),r.onBeforeInstance&&r.onBeforeInstance()})),i&&i(),t.Maps.forEach(this.modules,(function(t){t.onInstance&&t.onInstance()})),this.emit(this.EventType.INSTANCE)},n.forEach=function(e){t.Maps.forEach(this.modules,e)},n.run=function(e,i){var n=this;t.initData.isLog&&console.log("module START_UP start"),this.emitQueue(this.EventType.START_UP,-1,(function(){t.initData.isLog&&console.log("module START_UP complete"),t.Maps.forEach(n.modules,(function(t){t.onCreate&&t.onCreate()})),t.Maps.forEach(n.modules,(function(t){t.onLogic&&t.onLogic()})),t.Maps.forEach(n.modules,(function(t){t.onComplete&&t.onComplete()})),e(),n.emit(n.EventType.RUN_COMLETE)}),i?function(t){return"START_UP "+i[t]}:"START_UP")},i}(t.EventDispatcher);t.ModuleMgr=e}(apeng||(apeng={}));var d=Date.now();!function(t){function e(){t.sp&&t.sp.Skeleton&&t.sp.Skeleton.prototype&&t.js.mixin(t.sp.Skeleton.prototype,{update:function(t){if(!this.paused)if(t*=1*this._timeScale,this.isAnimationCached()){if(this._isAniComplete){if(0===this._animationQueue.length&&!this._headAniInfo){var e=this._frameCache;if(e&&e.isInvalid()){e.updateToFrame();var i=e.frames;this._curFrame=i[i.length-1]}return}if(this._headAniInfo||(this._headAniInfo=this._animationQueue.shift()),this._accTime+=t,this._accTime>this._headAniInfo.delay){var n=this._headAniInfo;this._headAniInfo=null,this.setAnimation(0,n.animationName,n.loop)}return}this._updateCache(t)}else this._updateRealtime(t)}})}t._main=null,t._language=null,t._platform=null,t._timer=null,t._resouces=null,t._ui=null,t._audio=null,t._scene=null,t._privacy=null,t._gm=null,t._guide=null,t._login=null,t._prop=null,t._rank=null,t.EDITOR=_cc_.EDITOR,t.moduleMgr=new t.ModuleMgr,t.platformMgr=new t.ModuleMgr,t.platformLogicMgr=new t.ModuleMgr,t.initData=null,t._config_=null,t.initCore=function(i,n){if(t.initData=i,t.EDITOR)t.game.once(t.Game.EVENT_ENGINE_INITED,e,this);else{console.log("apeng core versionCode:"+t.versionCode),t.AudioSource.prototype.onDisable=function(){},t.AudioSource.prototype.onEnable=function(){},t.input._dispatchImmediately=!0,t.Move.setPosition=t.NodeHelper.setPosition.bind(t.NodeHelper),t.Move.getPosition=t.NodeHelper.getPosition.bind(t.NodeHelper),t.Move.lookAt=t.NodeHelper.lookAt.bind(t.NodeHelper),t.Move.getDeltaTime=function(e){return e?t._timer.dt:t._timer.dtDefault},t.EventHandlerCC.clickSoundUrl=t.initData.audioClickUrl;var o=function(e){if("App"==e.name){t.moduleMgr.instance(t.initData.useModuleStorageType,(function(){t._language=t.moduleMgr.get(t.EModuleType.language),t._platform=t.moduleMgr.get(t.EModuleType.platform),t._timer=t.moduleMgr.get(t.EModuleType.timer),t._resouces=t.moduleMgr.get(t.EModuleType.resouces),t._ui=t.moduleMgr.get(t.EModuleType.ui),t._audio=t.moduleMgr.get(t.EModuleType.audio),t._scene=t.moduleMgr.get(t.EModuleType.scene),t._main=t.moduleMgr.get(t.EModuleType.main),t._privacy=t.moduleMgr.get(t.EModuleType.privacy),t._gm=t.moduleMgr.get(t.EModuleType.gm),t._guide=t.moduleMgr.get(t.EModuleType.guide),t._login=t.moduleMgr.get(t.EModuleType.login),t._prop=t.moduleMgr.get(t.EModuleType.prop),t._rank=t.moduleMgr.get(t.EModuleType.rank)}));var i=e.getComponentInChildren(t.Canvas),o=i.node.getChildByName("Loading");o.setSiblingIndex(t._ui.stageUp.getSiblingIndex()-1);var r=t.initData.newUseEnterGame&&t._login.isNewUser,a=new t.LoadDir(8,(function(){t._ui.open(t.initData.uiUrl.indexBg,void 0,void 0,void 0,!1);var e=function(){var e=t.initData.isWaitScene,r=function(){var e;t._ui.Loading.screen(!1,(new t.Color).fromHEX(t.initData.loadingCompleteColorAnim)),null===(e=i.getComponent("App"))||void 0===e||e.destroy(),o.destroy(),n&&n(t.EInitCoreState.openIndex)};e||(t.initData.loadingDuration>0?setTimeout(r,1e3*t.initData.loadingDuration):r());var a=new t.LoadDir(2,(function(){n&&n(t.EInitCoreState.openScene)}));t.assetManager.getBundle("main2").loadDir("texture/preload",a.subCount()),t._scene.change(t.initData.initSceneUrl,(function(){a.subCount()(),e&&r()}))};r?e():(t._ui.open(t.initData.uiUrl.index,null,e,void 0,!1),t.initData.uiUrl.prop&&t._ui.open(t.initData.uiUrl.prop,void 0,void 0,void 0,!1))}));t._privacy.show((function(){r?a.subCount()():(t._ui.load(t.initData.uiUrl.index,a.subCount()),t.initData.uiUrl.prop&&(a.count++,t._ui.load(t.initData.uiUrl.prop,a.subCount()))),t._ui.load(t.initData.uiUrl.indexBg,a.subCount()),t._platform.isOverseas?t.assetManager.loadBundle("languageTexture",a.subCount()):a.subCount()(),t._resouces.loadDefaultSpriteFrame(a.subCount()),t.assetManager.getBundle("main2").load(t.initData.configUrl,t.TextAsset,(function(e,i){a.subCount()(),t._config_=new t.ConfigHelper(JSON.parse(i.text),t.initData.configDefine),n&&n(t.EInitCoreState.config),t._platform.init(a.subCount()),t.moduleMgr.run(a.subCount(),t.EModuleType)})),n&&n(t.EInitCoreState.private)}),a.subCount()),n&&n(t.EInitCoreState.init)}},r=t.director.getScene();r?setTimeout((function(){return o(r)})):t.director.once(t.Director.EVENT_AFTER_SCENE_LAUNCH,o),t.initData.isLog&&console.log("apeng core complete duration:"+(Date.now()-d))}};var i=new t.Size,n=new t.Vec2,o=new t.Vec2,r=new t.Size;function a(e,n){return t.EDITOR?t.view.getVisibleSize():(0==i.width&&0==i.height&&i.set(t.view.getVisibleSize()),r.set(i),null!=e&&(r.width+=e),null!=n&&(r.height+=n),r)}t.winSize=a,t.winCenterPostion=function(t,e){return 0==n.x&&0==n.y&&(n.x=a().width/2,n.y=a().height/2),t||e?(o.x=n.x+(t||0),o.y=n.y+(e||0),o):n}}(apeng||(apeng={})),function(t){var e=function(){function e(){this.groups={},this.colliders={},this._checkGroup={}}var i=e.prototype;return i.add=function(e){null==this.groups[e]&&(this.groups[e]=Math.pow(2,t.Maps.size(this.groups)))},i.setCollider=function(e,i){null==this.colliders[e]&&(this.colliders[e]=[]),t.Sets.add(this.colliders[e],i)},i.setColliders=function(t,e){for(var i,n=u(e);!(i=n()).done;){var o=i.value;this.setCollider(t,o)}},i.has=function(t,e){var i=this._checkGroup[t];if(null==i){i=0;var n=this.colliders[t];if(n)for(var o,r=u(n);!(o=r()).done;){var a=o.value;i|=this.groups[a]}this._checkGroup[t]=i}return 0!=(i&this.groups[e])},e}();t.ColliderGroup=e}(apeng||(apeng={})),function(t){var e;(e=t.ECollider2DShapeType||(t.ECollider2DShapeType={}))[e.None=0]="None",e[e.Circle=1]="Circle",e[e.Point=2]="Point",e[e.Polygon=3]="Polygon";var i=function(){function e(){this.Collider2DRoot=null,this.mul=1,this.owner=null,this.position=new t.Vector2,this.group=null,this._isCollider=!0,this.offset=new t.Vector2,this.angle=null,this.onColliderEnter=null,this.onColliderExit=null,this.onColliderUpdate=null,this.onSetCollider=null,this.onClear=null,this.id=null,this.otherCollider=[],this.selfCollider=[],this.dataDirty=!0,this.updateShape=null,this.octree=[],this.root=null,this.isColliderEnter=!1}var i=e.prototype;return i.clear=function(){for(var t,e=u(this.selfCollider);!(t=e()).done;){var i=t.value;i&&i.hasExit(this)}this.selfCollider.length=0,this.otherCollider.length=0,this.dataDirty=!0,this.isColliderEnter=!1,this.removeFormOctreeItem(),this.id=null,this.onClear&&this.onClear()},i.hasExit=function(e){t.Sets.has(this.otherCollider,e)&&(t.Sets.delete(this.otherCollider,e),t.Sets.delete(e.selfCollider,this),this.onColliderExit&&this.onColliderExit(this,e))},i.hasColliderOther=function(){return this.otherCollider.length>0},i.updatePosition=function(t,e){this.position.set(t,e),this.dataDirty=!0},i.updateAngle=function(e){this.angle=t.Maths.toRadian(e),this.dataDirty=!0},i.setOffset=function(t,e){this.offset.set(t,e)},i.removeFormOctreeItem=function(){if(this.octree.length>0){for(var t,e=u(this.octree);!(t=e()).done;){t.value.remove(this)}this.octree.length=0}},l(e,[{key:"isCollider",get:function(){return this._isCollider},set:function(t){this._isCollider!=t&&(this._isCollider=t,this.onSetCollider&&this.onSetCollider(this._isCollider))}}]),e}();t.Collider2DShape=i}(apeng||(apeng={})),function(t){var e=0,i=0,n=function(){function n(t,e){this.x=0,this.y=0,this.set(t,e)}n.min=function(t,e,i){return t.x=Math.min(e.x,i.x),t.y=Math.min(e.y,i.y),t},n.max=function(t,e,i){return t.x=Math.max(e.x,i.x),t.y=Math.max(e.y,i.y),t},n.twoAngle=function(e,i,o,r){void 0===o&&(o=n.ZERO),void 0===r&&(r=!1);var a=e.x-o.x,s=e.y-o.y,l=i.x-o.x,u=i.y-o.y,h=(Math.pow(a,2)+Math.pow(s,2)+Math.pow(l,2)+Math.pow(u,2)-(Math.pow(l-a,2)+Math.pow(u-s,2)))/(2*Math.sqrt(Math.pow(a,2)+Math.pow(s,2))*Math.sqrt(Math.pow(l,2)+Math.pow(u,2))),c=1;r&&(l*s-u*a>0&&(c=-1));return t.Maths.toDegree(Math.acos(h))*c},n.sort=function(t){o.set();for(var e,i=u(t);!(e=i()).done;){var n=e.value;o.addSelf(n)}var r=t.length;o.x/=r,o.y/=r;for(var a=0;a<r-1;a++)for(var s=0;s<r-1-a;s++)if(this.sortItem(t[s],t[s+1],o)){var l=t[s];t[s]=t[s+1],t[s+1]=l}return t},n.sortItem=function(t,e,i){return r.set(t).subSelf(i),a.set(e).subSelf(i),!(this.dot(r,a)>0)},n.distance=function(t,n){return e=t.x-n.x,i=t.y-n.y,Math.sqrt(e*e+i*i)},n.distanceSqr=function(t,n){return e=t.x-n.x,i=t.y-n.y,e*e+i*i},n.mul=function(t,e,i){return n.set(t,e),"number"==typeof i?(t.x*=i,t.y*=i):(t.x*=i.x,t.y*=i.y),t},n.equals=function(t,e,i){return void 0===i&&(i=.01),Math.abs(t.x-e.x)<=i&&Math.abs(t.y-e.y)<=i},n.equalsZero=function(t,e){return t.x==e.x&&t.y==e.y},n.equals2f=function(t,e,i){return t.x===e&&t.y===i},n.angle360=function(t,e,i){void 0===i&&(i=0);var r=o.set(e).subSelf(t);return n.angle(r,i)},n.angle=function(e,i){void 0===i&&(i=0),0!=i&&(i=360-i,n.rotate(e,e,t.Maths.toRadian(i)));var o=t.Maths.toDegree(Math.atan2(e.y,e.x));return o=t.Maths.normalizeAngle(o),o},n.scale=function(t,e,i){i.x=t.x*e,i.y=t.y*e},n.dot=function(t,e){return t.x*e.y-t.y*e.x},n.normalize=function(t,e){var i=e.x,n=e.y,o=i*i+n*n;return o>0&&(o=1/Math.sqrt(o),t.x=i*o,t.y=n*o),t},n.lerp=function(t,n,o,r){return e=n.x,i=n.y,t.x=e+r*(o.x-e),t.y=i+r*(o.y-i),t},n.toString=function(t){return"("+t.x.toFixed(2)+", "+t.y.toFixed(2)+")"},n.rotate=function(t,n,o){e=n.x,i=n.y;var r=Math.sin(o),a=Math.cos(o);return t.x=a*e-r*i,t.y=r*e+a*i,t},n.sub=function(t,e,i){return t.x=e.x-i.x,t.y=e.y-i.y,t},n.len=function(t){return Math.sqrt(n.lengthSqr(t))},n.lengthSqr=function(t){return t.x*t.x+t.y*t.y},n.add=function(t,e,i){return t.x=e.x+i.x,t.y=e.y+i.y,t},n.center=function(t,e,i){return n.lerp(t,e,i,.5)},n.clampf=function(e,i,n,o){return e.x=t.Maths.clampf(i.x,n.x,o.x),e.y=t.Maths.clampf(i.y,n.y,o.y),e},n.set=function(t,e,i){return e&&void 0!==e[0]?(t.x=e[0],t.y=e[1]):e&&"object"==typeof e?(t.x=e.x,t.y=e.y):(t.x=e||0,t.y=i||0),t},n.polygonByCenterPoint=function(t,e){for(var i,n=e[0].x,o=e[0].x,r=e[0].y,a=e[0].y,s=u(e);!(i=s()).done;){var l=i.value;n>l.x&&(n=l.x),o<l.x&&(o=l.x),r>l.y&&(r=l.y),a<l.y&&(a=l.y)}return t.x=n+Math.abs(o-n)/2,t.y=r+Math.abs(a-r)/2,t},n.fuzzyEquals=function(t,e,i){return t.x-i<=e.x&&e.x<=t.x+i&&t.y-i<=e.y&&e.y<=t.y+i};var s=n.prototype;return s.mul=function(t,e){return n.mul(t,this,e)},s.mulSelf=function(t){return n.mul(this,this,t)},s.len=function(){return n.len(this)},s.lengthSqr=function(){return n.lengthSqr(this)},s.equals=function(t){return n.equals(this,t)},s.equals2f=function(t,e){return n.equals2f(this,t,e)},s.set=function(t,e){return n.set(this,t,e)},s.sub=function(t,e){return n.sub(t,this,e)},s.subSelf=function(t){return n.sub(this,this,t)},s.rotate=function(t,e){return n.rotate(t,this,e)},s.rotateSelf=function(t){return n.rotate(this,this,t)},s.normalize=function(t){return n.normalize(t,this)},s.normalizeSelf=function(){return n.normalize(this,this)},s.add=function(t,e){return n.add(t,this,e)},s.addSelf=function(t){return n.add(this,this,t)},s.toString=function(){return n.toString(this)},s.clampf=function(t,e,i){return n.clampf(t,this,e,i)},s.clampfSelf=function(t,e){return n.clampf(this,this,t,e)},n}();n.pool=new t.PoolOnce(1e3,(function(){return new n}),(function(t){t.set()})),n.ZERO=new n(0,0),n.ONE=new n(1,1),n.UP=new n(0,1),n.RIGHT=new n(1,0),n.LEFT=new n(-1,0),n.DOWN=new n(0,-1),t.Vector2=n;var o=new n(1,1),r=new n(1,1),a=new n(1,1)}(apeng||(apeng={})),function(t){var e=new t.Vector2,i=function(i){function n(e,n,o){var r;return(r=i.call(this)||this).type=t.ECollider2DShapeType.Polygon,r.polygon=[],r._polygon=[],r.group=n,r.updatePolygon(e,o),r}o(n,i),n.createByRectange=function(e,i,o){return o?o.updatePolygon(t.Vector2.ZERO,e.angleCenter()):o=new n(t.Vector2.ZERO,i,e.angleCenter()),o};var r=n.prototype;return r.updatePolygon=function(i,n){t.Vector2.set(this.position,i);var o=n.length;this._polygon.length=o,this.polygon.length=o;for(var r=0;r<o;r++){this.polygon[r]||(this.polygon[r]={dir:new t.Vector2,offsetDir:new t.Vector2,len:0,offsetLen:0},this._polygon[r]=new t.Vector2),t.Vector2.normalize(e,n[r]);var a=t.Vector2.len(n[r]);this.polygon[r].dir.set(e),this.polygon[r].offsetDir.set(e),this.polygon[r].len=a,this.polygon[r].offsetLen=a}this.dataDirty=!0},r.getPolygon=function(){if(!this.dataDirty)return this._polygon;this.dataDirty=!1;for(var t=0;t<this.polygon.length;t++){var e=this.polygon[t];this._polygon[t].set(e.offsetDir),this.angle&&this._polygon[t].rotateSelf(this.angle),this._polygon[t].mulSelf(e.offsetLen*this.mul),this._polygon[t].addSelf(this.position)}return this._polygon},r.setOffset=function(t,n){i.prototype.setOffset.call(this,t,n);for(var o=0;o<this.polygon.length;o++){var r=this.polygon[o];r.dir.mul(e,r.len),e.addSelf(this.offset),e.normalize(r.offsetDir),r.offsetLen=e.len()}},n}(t.Collider2DShape);t.Collider2DPolygon=i}(apeng||(apeng={})),function(t){var e=function(e){function i(i,n,o,r){return e.call(this,i,n,[new t.Vector2(-o/2,-r/2),new t.Vector2(o/2,-r/2),new t.Vector2(o/2,r/2),new t.Vector2(-o/2,r/2)])||this}return o(i,e),i}(t.Collider2DPolygon);t.Collider2DBox=e}(apeng||(apeng={})),function(t){var e=new t.Vector2,i=function(i){function n(e,n,o){var r;return(r=i.call(this)||this).type=t.ECollider2DShapeType.Circle,r.radius=0,r.circle=new t.Circle,t.Vector2.set(r.position,e),r.group=n,r.radius=o,r}return o(n,i),n.prototype.getCircle=function(){return this.dataDirty?(this.dataDirty=!1,e.set(this.offset),0!=this.angle&&(this.offset.equals(t.Vector2.ZERO)||e.rotateSelf(this.angle)),e.addSelf(this.position),this.circle.set(e.x,e.y,this.radius*this.mul)):this.circle},n}(t.Collider2DShape);t.Collider2DCircle=i}(apeng||(apeng={})),function(t){t.ccclass=t._decorator.ccclass,t.menu=t._decorator.menu,t.menuComponent=function(e){return t._decorator.menu("apeng/"+e)},t.menuUI=function(e){return t._decorator.menu("apeng/ui扩展/"+e)},t.menuAnim=function(e){return t._decorator.menu("apeng/动画/"+e)},t.menuList=function(e){return t._decorator.menu("apeng/列表/"+e)},t.menuBtn=function(e){return t._decorator.menu("apeng/按钮/"+e)},t.menuScene=function(e){return t._decorator.menu("apeng/场景/"+e)},t.menuController=function(e){return t._decorator.menu("apeng/控制器/"+e)},t.menuShape=function(e){return t._decorator.menu("apeng/形状/"+e)},t.menuEntity=function(e){return t._decorator.menu("apeng/entity/"+e)},t.menuP2=function(e){return t._decorator.menu("apeng/p2/"+e)},t.requireComponent=t._decorator.requireComponent,t.executeInEditMode=t._decorator.executeInEditMode,t.property=t._decorator.property}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).CLOSE_ON_CC=!1,t.backupDescribe="",t.onUpdateInterval=null,t.isUpdate=!0,t._cacheComponents=new Map,t._eventMap=[],t.isEventOn=!1,t._autoMember=!1,t.__isPreload=!1,t.orginLabelColor=null,t.orginLabel2Color=null,t.isEventSelf=!0,t._isPersistRootNode=null,t._coordinateTracker=null,t}o(i,e);var n=i.prototype;return n.__preload=function(){t.EDITOR?this.onPreLoad&&this.onPreLoad():this.__isPreload||(this.__isPreload=!0,this.update&&this.update!=this._update&&console.error("勿使用update，请使用onUdate(内置全局管理 暂停恢复 帧率控制)"),(this.onUpdate||this._onUpdate)&&(this.update=this._update),this._onLoad=this.onLoad,this.onLoad=function(){this.CLOSE_ON_CC||this._onLoad()},this._onEnable=this.onEnable,this._onDisable=this.onDisable,this.onEnable=function(){this.CLOSE_ON_CC||this.isPersistRootNode&&t._scene.isChange||this._onEnable()},this.onDisable=function(){this.CLOSE_ON_CC||this.isPersistRootNode&&t._scene.isChange||this._onDisable()},this.onPreLoad&&this.onPreLoad())},n.autoMember=function(){this._autoMember||(t.EDITOR||t.AutoMemberNodeAttribute.init(this.node,this),this._autoMember=!0)},n.onLoad=function(){var e=this;this.isEventSelf=!0,t.NodeHelper.getUITransform(this.node)&&(this.addEvent(t.Node.EventType.SIZE_CHANGED,this.onSizeChange,this,this.node),this.addEvent(t.Node.EventType.ANCHOR_CHANGED,this.onAnchorChange,this,this.node),t.EDITOR||(this.addEvent(t.Node.EventType.TOUCH_START,this.onTouchStart,this,this.node),this.addEvent(t.Node.EventType.TOUCH_MOVE,this.onTouchMove,this,this.node),this.addEvent(t.Node.EventType.TOUCH_END,this.onTouchEnd,this,this.node),this.addEvent(t.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this,this.node),this.addEvent(t.Node.EventType.MOUSE_WHEEL,this.onMouseWheel,this,this.node),this.onClickCatch&&this.addEvent(t.Node.EventType.TOUCH_END,this.onClickCatch,this,this.node,!0),this.onClick&&t.EventHandlerCC.onClick(this.node,this.onClick,this))),t.EDITOR||(this.addEvent(t.Input.EventType.TOUCH_START,this.onStageTouchStart,this,t.EventHandlerCC.touchEvent),this.addEvent(t.Input.EventType.TOUCH_MOVE,this.onStageTouchMove,this,t.EventHandlerCC.touchEvent),this.addEvent(t.Input.EventType.TOUCH_END,this.onStageTouchEnd,this,t.EventHandlerCC.touchEvent),this.addEvent(t.Input.EventType.TOUCH_END,this.onStageClick,this,t.EventHandlerCC.touchEvent),this.onKeyDown&&this.addEvent(t.Input.EventType.KEY_DOWN,this.onKeyDown,this,t.input),this.onKeyUp&&this.addEvent(t.Input.EventType.KEY_UP,this.onKeyUp,this,t.input)),this.onPositionChange&&this.addEvent(t.Node.EventType.TRANSFORM_CHANGED,(function(i){i&t.Node.TransformBit.POSITION&&e.onPositionChange()}),this,this.node),this.onScaleChange&&this.addEvent(t.Node.EventType.TRANSFORM_CHANGED,(function(i){i&t.Node.TransformBit.SCALE&&e.onScaleChange()}),this,this.node),this.onRotationChange&&this.addEvent(t.Node.EventType.TRANSFORM_CHANGED,(function(i){i&t.Node.TransformBit.ROTATION&&e.onRotationChange()}),this,this.node),this.isEventSelf=!1,this.autoMember()},n.start=function(){},n.onEnable=function(){if(!this.isEventOn){this.isEventOn=!0;for(var t,e=u(this._eventMap);!(t=e()).done;){var i=t.value;this._addEventRegist(i,!0)}}},n.onDisable=function(){if(this.isEventOn){this.isEventOn=!1;for(var e,i=u(this._eventMap);!(e=i()).done;){var n=e.value;this._addEventRegist(n,!1)}}t.EDITOR||(t._timer.clearAll(this),this.unscheduleAllCallbacks())},n.onDestroy=function(){t.AutoMemberNodeAttribute.clearMember(this),this.clearCacheComponent(),this.isEventOn=!1,this.isUpdate=!0,this._autoMember=!1,this._eventMap.length=0},n.clearCacheComponent=function(){this._cacheComponents.clear()},n._update=function(){t.EDITOR||this.isUpdate&&(this.onUpdate&&(null!=this.onUpdateInterval?t._timer.hasUpdateIntervale(this.uuid+"onUpdate",this.onUpdateInterval,!0)&&this.onUpdate():this.onUpdate()),this._onUpdate&&this._onUpdate())},n.setClick=function(e,i){t.EventHandlerCC.offAllClick(this.node),t.EventHandlerCC.onClick(this.node,e,i)},n.clearEventMap=function(){var e=this;t.Sets.forEach(this._eventMap,(function(i){i.isSelf||(e._addEventRegist(i,!1),t.Sets.delete(e._eventMap,i))}),!0)},n.scheduleOnceCover=function(t,e){void 0===e&&(e=0),this.unschedule(t),this.scheduleOnce(t,e)},n.addEvent=function(t,e,i,n,o,r){if(void 0===r&&(r=!1),!e)return null;var a={type:t,callBack:e,caller:i,registTarget:n,fourByarg:o,once:r,isSelf:this.isEventSelf};return this._eventMap.push(a),this.isEventOn&&this._addEventRegist(a,!0),e},n._addEventRegist=function(t,e){("function"==typeof t.registTarget?t.registTarget():t.registTarget)[e?t.once?"once":"on":"off"](t.type,t.callBack,t.caller,t.fourByarg)},n.setSize=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.NodeHelper.setSize(this.node,e,i)},n.getChildByCreate=function(e,i,n,o){return void 0===n&&(n=-1),void 0===o&&(o=!1),t.NodeHelper.getChildByCreate(this.node,e,i,n,o)},n.getNodeComponents=function(e){return t.NodeHelper.getNodeComponents(this.node,e)},n.getParentByName=function(e){return t.NodeHelper.getParentByName(this.node,e)},n.getParentByNameChild=function(e){return t.NodeHelper.getParentByNameChild(this.node,e)},n.walkAllChild=function(e,i){void 0===i&&(i=!0),t.NodeHelper.walkAllChild(this.node,e,i)},n.walkAllDeepChild=function(e){t.NodeHelper.walkAllDeepChild(this.node,e)},n.followTarget=function(e,i,n,o,r){return void 0===n&&(n=null),void 0===o&&(o=!0),t.NodeHelper.followTarget(this.node,e,i,n,o,r)},n.lerpScaleTarget=function(e,i,n){return void 0===n&&(n=!0),t.NodeHelper.lerpScaleTarget(this.node,e,i,n)},n.lerpTarget=function(e,i,n,o,r){return void 0===n&&(n=null),void 0===o&&(o=!0),t.NodeHelper.lerpTarget(this.node,e,i,n,o,r)},n.lookAt=function(e,i){void 0===i&&(i=null),t.NodeHelper.lookAt(this.node,e,i)},n.getPosition=function(e,i,n,o){return t.NodeHelper.getPosition(this.node,e,i,n,o)},n.getRotate=function(e){return t.NodeHelper.getRotate(this.node,e)},n.getRotateV3=function(e){return t.NodeHelper.getRotateV3(this.node,e)},n.setRotate=function(e,i){t.NodeHelper.setRotate(this.node,e,i)},n.setRotateX=function(e,i){t.NodeHelper.setRotateX(this.node,e,i)},n.setRotateY=function(e,i){t.NodeHelper.setRotateY(this.node,e,i)},n.setRotateZ=function(e,i){t.NodeHelper.setRotateZ(this.node,e,i)},n.rotateX=function(e,i){t.NodeHelper.rotateX(this.node,e,i)},n.rotateY=function(e,i){t.NodeHelper.rotateY(this.node,e,i)},n.rotateZ=function(e,i){t.NodeHelper.rotateZ(this.node,e,i)},n.setPosition=function(e,i,n,o,r){t.NodeHelper.setPosition(this.node,e,i,n,o,r)},n.setPositionXY=function(e,i){t.NodeHelper.setPositionXY(this.node,e,i)},n.setPositionX=function(e,i){t.NodeHelper.setPositionX(this.node,e,i)},n.setPositionY=function(e,i){t.NodeHelper.setPositionY(this.node,e,i)},n.setPositionZ=function(e,i){t.NodeHelper.setPositionZ(this.node,e,i)},n.getScale=function(e){return t.NodeHelper.getScale(this.node,e)},n.setScale=function(e,i){t.NodeHelper.setScale(this.node,e,i)},n.setScaleNum=function(e,i){t.NodeHelper.setScaleNum(this.node,e,i)},n.setScaleX=function(e,i){t.NodeHelper.setScaleX(this.node,e,i)},n.setScaleY=function(e,i){t.NodeHelper.setScaleY(this.node,e,i)},n.setScaleZ=function(e,i){t.NodeHelper.setScaleZ(this.node,e,i)},n.getYMin=function(e){return t.NodeHelper.getYMin(this.node,e)},n.getYMax=function(e){return t.NodeHelper.getYMax(this.node,e)},n.getXMax=function(e){return t.NodeHelper.getXMax(this.node,e)},n.getXMin=function(e){return t.NodeHelper.getXMin(this.node,e)},n.getChildrenByComponents=function(e,i,n){return t.NodeHelper.getChildrenByComponents(this.node,e,i,n)},n.getChildrenByComponent=function(e){return t.NodeHelper.getChildrenByComponent(this.node,e)},n.getParentByComponent=function(e){return t.NodeHelper.getParentByComponent(this.node.parent,e)},n.findChildrenByNameOnce=function(e){return t.NodeHelper.findChildrenByNameOnce(this.node,e)},n.findChildrenByNamePrefixs=function(e,i){return t.NodeHelper.findChildrenByNamePrefixs(this.node,e,i)},n.findChildrenByPrefixNameOnce=function(e){return t.NodeHelper.findChildrenByPrefixNameOnce(this.node,e)},n.convertSelfToOtherNodeSpaceAR=function(e,i,n){return t.NodeHelper.convertSelfToOtherNodeSpaceAR(e,this.node,i,n)},n.convertToNodeSpaceAR=function(e,i){return t.NodeHelper.convertToNodeSpaceAR(e,this.node,i)},n.convertToWorldSpaceAR=function(e,i){return t.NodeHelper.convertToWorldSpaceAR(e,this.node,i)},n.distance=function(e,i){return void 0===i&&(i="xyz"),t.NodeHelper.distance(this.node,e,i)},n.move=function(e,i,n){return t.NodeHelper.move(this.node,e,i,n)},n.setOpacity=function(e){return t.NodeHelper.setOpacity(this.node,e)},n.getOpacity=function(){return t.NodeHelper.getOpacity(this.node)},n.isHit=function(e){return t.NodeHelper.isHit(this.node,e)},n.getRectangle=function(e,i,n){return void 0===n&&(n=!1),t.NodeHelper.getRectangle(e,this.node,i,n)},n.gray=function(e){return t.NodeHelper.gray(this.node,e)},n.zIndexSort=function(e){return t.NodeHelper.zIndexSort(this.node.children,e)},n.coordinateTracker=function(e,i,n,o,r){return this._coordinateTracker||(this._coordinateTracker={converPosition:new t.Vec3,scale:1}),t.NodeHelper.coordinateTracker(this._coordinateTracker,e,i,n,o,r)},n.getCacheComponent=function(e){var i=this._cacheComponents.get(e);return void 0===i&&(i=t.NodeHelper.getAllByComponent(this.node,e),this._cacheComponents.set(e,i)),i},l(i,[{key:"editorUpdateData",get:function(){return!1},set:function(t){this.onEditorUpdateData&&this.onEditorUpdateData()}},{key:"editorClearData",get:function(){return!1},set:function(t){this.onEditorClearData&&this.onEditorClearData()}},{key:"isPersistRootNode",get:function(){if(null===this._isPersistRootNode){this._isPersistRootNode=!1;for(var t=this.node.parent;t;){if(t._persistNode){this._isPersistRootNode=!0;break}t=t.parent}}return this._isPersistRootNode}},{key:"isVisible",get:function(){return!!(t.isValid(this,!0)&&t.isValid(this.node,!0)&&this.enabledInHierarchy)}},{key:"AnimtorCC",get:function(){return this.getCacheComponent("AnimtorCC")}},{key:"AutoTargetSizeCC",get:function(){return this.getCacheComponent("AutoTargetSizeCC")}},{key:"ButtonCC",get:function(){return this.getCacheComponent("ButtonCC")}},{key:"ControllerCC",get:function(){return this.getCacheComponent("ControllerCC")}},{key:"MoveCC",get:function(){return this.getCacheComponent("MoveCC")}},{key:"SwitchChildrenCC",get:function(){return this.getCacheComponent("SwitchChildrenCC")}},{key:"SwitchSpriteCC",get:function(){return this.getCacheComponent("SwitchSpriteCC")}},{key:"ListCC",get:function(){return this.getCacheComponent("ListCC")}},{key:"DragonBonesCC",get:function(){return this.getCacheComponent("DragonBonesCC")}},{key:"SpriteLoaderCC",get:function(){return this.getCacheComponent("SpriteLoaderCC")}},{key:"AnimtorByTweenCC",get:function(){return this.getCacheComponent("AnimtorByTweenCC")}},{key:"LayoutCC",get:function(){return this.getCacheComponent("LayoutCC")}},{key:"CreatePrefabToEditorCC",get:function(){return this.getCacheComponent("CreatePrefabToEditorCC")}},{key:"CreatePrefabToEditorOnceCC",get:function(){return this.getCacheComponent("CreatePrefabToEditorOnceCC")}},{key:"RenderOpacityAnimCC",get:function(){return this.getCacheComponent("RenderOpacityAnimCC")}},{key:"SpineCC",get:function(){return this.getCacheComponent("SpineCC")}},{key:"ListRollCC",get:function(){return this.getCacheComponent("ListRollCC")}},{key:"FontCC",get:function(){return this.getCacheComponent("FontCC")}},{key:"ClickChangeViewCC",get:function(){return this.getCacheComponent("ClickChangeViewCC")}},{key:"SubContextViewCC",get:function(){return this.getCacheComponent("SubContextViewCC")}},{key:"LevelRollCC",get:function(){return this.getCacheComponent("LevelRollCC")}},{key:"LayoutCircleCC",get:function(){return this.getCacheComponent("LayoutCircleCC")}},{key:"DragViewCC",get:function(){return this.getCacheComponent("DragViewCC")}},{key:"CameraOrbitControlCC",get:function(){return this.getCacheComponent("CameraOrbitControlCC")}},{key:"JoystickCC",get:function(){return this.getCacheComponent("JoystickCC")}},{key:"SpriteFrameAnimCC",get:function(){return this.getCacheComponent("SpriteFrameAnimCC")}},{key:"P2ConstraintEditorCC",get:function(){return this.getCacheComponent("P2ConstraintEditorCC")}},{key:"P2ShapeEditorCC",get:function(){return this.getCacheComponent("P2ShapeEditorCC")}},{key:"ProgressCC",get:function(){return this.getCacheComponent("ProgressCC")}},{key:"CameraTouchMoveCC",get:function(){return this.getCacheComponent("CameraTouchMoveCC")}},{key:"LabelNumRollCC",get:function(){return this.getCacheComponent("LabelNumRollCC")}},{key:"ParticleSystem2DCC",get:function(){return this.getCacheComponent("ParticleSystem2DCC")}},{key:"Collider2DEditorCC",get:function(){return this.getCacheComponent("ParticleSystem2DCC")}},{key:"Label",get:function(){return this.getCacheComponent(t.Label)}},{key:"Sprite",get:function(){return this.getCacheComponent(t.Sprite)}},{key:"MotionStreak",get:function(){return this.getCacheComponent(t.MotionStreak)}},{key:"Collider2D",get:function(){return this.getCacheComponent(t.Collider2D)}},{key:"Layout",get:function(){return this.getCacheComponent(t.Layout)}},{key:"Widget",get:function(){return this.getCacheComponent(t.Widget)}},{key:"RigidBody2D",get:function(){return this.getCacheComponent(t.RigidBody2D)}},{key:"ScrollView",get:function(){return this.getCacheComponent(t.ScrollView)}},{key:"ScrollBar",get:function(){return this.getCacheComponent(t.ScrollBar)}},{key:"Mask",get:function(){return this.getCacheComponent(t.Mask)}},{key:"PageView",get:function(){return this.getCacheComponent(t.PageView)}},{key:"UITransform",get:function(){return this.getCacheComponent(t.UITransform)}},{key:"UIOpacity",get:function(){return this.getCacheComponent(t.UIOpacity)}},{key:"Camera",get:function(){return this.getCacheComponent(t.Camera)}},{key:"MeshRenderer",get:function(){return this.getCacheComponent(t.MeshRenderer)}},{key:"Graphics",get:function(){return this.getCacheComponent(t.Graphics)}},{key:"UIRenderer",get:function(){return this.getCacheComponent(t.UIRenderer)}},{key:"spSkeleton",get:function(){return this.getCacheComponent(t.sp.Skeleton)}},{key:"BlockInputEvents",get:function(){return this.getCacheComponent(t.BlockInputEvents)}},{key:"DragonBonesArmatureDisplay",get:function(){return this.getCacheComponent(t.dragonBones.ArmatureDisplay)}},{key:"EditBox",get:function(){return this.getCacheComponent(t.EditBox)}},{key:"Animation",get:function(){return this.getCacheComponent(t.Animation)}},{key:"ParticleSystem2D",get:function(){return this.getCacheComponent(t.ParticleSystem2D)}}]),i}(_cc_.Component);p([t.property({tooltip:"对组件进行的备注 功能之类",displayName:"组件备注",readonly:!0,visible:function(){return this.backupDescribe}})],e.prototype,"backupDescribe",void 0),p([t.property({displayName:"更新数据",visible:function(){return this.onEditorUpdateData}})],e.prototype,"editorUpdateData",null),p([t.property({displayName:"清除数据",visible:function(){return this.onEditorClearData}})],e.prototype,"editorClearData",null),e=p([t.ccclass("BaseComponent"),t.menuComponent("BaseComponent")],e),t.BaseComponent=e}(apeng||(apeng={})),function(t){var e,i,n=new t.Size,r=new t.Vec3;!function(t){t[t.None=0]="None",t[t.Circle=1]="Circle",t[t.Point=2]="Point",t[t.Polygon=3]="Polygon",t[t.Box=4]="Box"}(i||(i={})),t.ccenum(i);var a=e=function(a){function s(){var e;return(e=a.apply(this,arguments)||this).backupDescribe="范围框调试",e.editorColor=new t.Color(0,255,0),e.editorLineWidth=6,e.runEditorShow=!0,e.tag="",e._shapeType=i.None,e._circleRadius=0,e._boxSize=new t.Size,e._shapeOffset=new t.Vec2,e._poygonPoints=[],e.onEditorUpdateData=e.updateCCGraphics,e.shape=null,e}o(s,a);var u=s.prototype;return u.onLoad=function(){if(a.prototype.onLoad.call(this),t.EDITOR)switch(this._shapeType){case i.Circle:0==this._circleRadius&&(this.circleRadius=this.UITransform.width/2);break;case i.Box:0==this._boxSize.width&&0==this._boxSize.height&&(n.set(this.UITransform.contentSize),this.boxSize=n);break;case i.Polygon:if(0==this._poygonPoints.length){for(var e=[],o=this.UITransform.contentSize,r=0;r<4;r++)0==r?e[r]=new t.Vec2(-o.width/2,-o.height/2):1==r?e[r]=new t.Vec2(o.width/2,-o.height/2):2==r?e[r]=new t.Vec2(o.width/2,o.height/2):3==r&&(e[r]=new t.Vec2(-o.width/2,o.height/2));this._poygonPoints=e}}else this.updateCCGraphics()},u.onFocusInEditor=function(){this.updateCCGraphics()},u.onLostFocusInEditor=function(){this._shapeType!=i.None&&this.getGraphics().clear()},u.updateCCGraphics=function(){if(!t.EDITOR){if(!this.runEditorShow)return;if(!e.debug)return}if(this._shapeType!=i.None){var n=this.getGraphics();switch(n.strokeColor=this.editorColor,n.lineWidth=this.editorLineWidth,n.clear(),this._shapeType){case i.Circle:n.circle(this._shapeOffset.x,this._shapeOffset.y,this._circleRadius);break;case i.Box:n.rect(this._shapeOffset.x-this._boxSize.width/2,this._shapeOffset.y-this._boxSize.height/2,this._boxSize.width,this._boxSize.height);break;case i.Polygon:if(this._poygonPoints.length>2){n.moveTo(this._poygonPoints[0].x+this._shapeOffset.x,this._poygonPoints[0].y+this._shapeOffset.y);for(var o=1,r=this._poygonPoints.length+1;o<r;o++){var a=o==r-1?0:o,s=this._poygonPoints[a];n.lineTo(s.x+this._shapeOffset.x,s.y+this._shapeOffset.y)}}break;case i.Point:n.circle(this._shapeOffset.x,this._shapeOffset.y,5),n.fill()}n.stroke()}},u.getGraphics=function(){return this.getChildByCreate(this.uuid+"graphics",(function(e){e.addComponent(t.Graphics)})).getComponent(t.Graphics)},u.getShape=function(t,i){var n=this;return i||(i=this.node.position),this.shape?(this.shape.updatePosition(i),this.shape):(this.shape=this._getShape(t,i),this.updateNodeByShape(),e.debug&&this.runEditorShow&&(this.shape.onSetCollider=function(t){t?n.onFocusInEditor():n.onLostFocusInEditor()},this.shape.onClear=function(){n.onLostFocusInEditor()}),this.shape)},u._getShape=function(e,n){var o=null;if(this._shapeType==i.None)return o;switch(this._shapeType){case i.Circle:o=new t.Collider2DCircle(n,e,this._circleRadius);break;case i.Point:o=new t.Collider2DPoint(n,e);break;case i.Box:o=new t.Collider2DBox(n,e,this._boxSize.width,this._boxSize.height);break;case i.Polygon:this._poygonPoints.length>2&&(o=new t.Collider2DPolygon(n,e,this._poygonPoints))}return o},u.updateNodeByShape=function(){this.shape&&(this.shape.mul=this.node.scale.x,this.shape.updateAngle(t.Maths.toRadian(this.node.rotation.getEulerAngles(r).z)),this.shape.setOffset(this._shapeOffset))},l(s,[{key:"shapeType",get:function(){return this._shapeType},set:function(t){this._shapeType!=t&&(this._shapeType=t,this.updateCCGraphics())}},{key:"circleRadius",get:function(){return this._circleRadius},set:function(t){this._circleRadius!=t&&(this._circleRadius=t,this.updateCCGraphics())}},{key:"boxSize",get:function(){return this._boxSize},set:function(t){this._boxSize.equals(t)||(this._boxSize.set(t),this.updateCCGraphics())}},{key:"poygonPoints",get:function(){return this._poygonPoints},set:function(t){this._poygonPoints=t,this.updateCCGraphics()}},{key:"shapeOffset",get:function(){return this._shapeOffset},set:function(t){this._shapeOffset.equals(t)||(this._shapeOffset.set(t),this.updateCCGraphics())}}]),s}(t.BaseComponent);a.debug=!0,p([t.property({displayName:"编辑框颜色"})],a.prototype,"editorColor",void 0),p([t.property({displayName:"编辑框线宽"})],a.prototype,"editorLineWidth",void 0),p([t.property({displayName:"运行时显示线框"})],a.prototype,"runEditorShow",void 0),p([t.property({tooltip:"当有多个组件挂在相同节点时 方便区分"})],a.prototype,"tag",void 0),p([t.property({type:i,displayName:"碰撞器类型"})],a.prototype,"shapeType",null),p([t.property({step:1,displayName:"半径",visible:function(){return this._shapeType==i.Circle}})],a.prototype,"circleRadius",null),p([t.property({displayName:"宽高",visible:function(){return this._shapeType==i.Box}})],a.prototype,"boxSize",null),p([t.property({type:[t.Vec2],displayName:"范围点",visible:function(){return this._shapeType==i.Polygon}})],a.prototype,"poygonPoints",null),p([t.property({step:1,displayName:"形状偏移",visible:function(){return this._shapeType!=i.None}})],a.prototype,"shapeOffset",null),p([t.property({serializable:!0})],a.prototype,"_shapeType",void 0),p([t.property({serializable:!0})],a.prototype,"_circleRadius",void 0),p([t.property({serializable:!0})],a.prototype,"_boxSize",void 0),p([t.property({serializable:!0})],a.prototype,"_shapeOffset",void 0),p([t.property({serializable:!0})],a.prototype,"_poygonPoints",void 0),a=e=p([t.ccclass("Collider2DEditorCC"),t.executeInEditMode,t.menuShape("Collider2DEditorCC")],a),t.Collider2DEditorCC=a}(apeng||(apeng={})),function(t){var e=function(e){function i(i,n){var o;return(o=e.call(this)||this).type=t.ECollider2DShapeType.Point,o.point=new t.Vector2,t.Vector2.set(o.position,i),o.group=n,o}return o(i,e),i.prototype.getPoint=function(){return this.dataDirty?(this.dataDirty=!1,this.point.set(this.offset),0!=this.angle&&(this.offset.equals(t.Vector2.ZERO)||this.point.rotateSelf(this.angle)),this.point.addSelf(this.position)):this.point},i}(t.Collider2DShape);t.Collider2DPoint=e}(apeng||(apeng={})),function(t){var e=function(){function e(){this.root=null,this.parent=null,this.rect=null,this.child=null,this.curLevel=0,this.colliders=[],this.colliderByGroup={},this.colliderSize=0}var i=e.prototype;return i.addShape=function(t){this.colliders.push(t),this.colliderSize=this.colliders.length;var e=this.colliderByGroup[t.group];null==e&&(e=[],this.colliderByGroup[t.group]=e),e.push(t)},i.remove=function(e){t.Sets.delete(this.colliders,e),this.colliderSize=this.colliders.length;var i=this.colliderByGroup[e.group];i&&t.Sets.delete(i,e)},i.clear=function(){if(this.child)for(var t,e=u(this.child);!(t=e()).done;){t.value.clear()}for(var i in this.parent=null,this.rect=null,this.child=null,this.curLevel=0,this.colliders.length=0,this.colliderSize=0,this.colliderByGroup)this.colliderByGroup[i].length=0},i.add=function(t){if(this.rect&&this.hasRect(this.rect,t))if(null==this.child)if(this.addShape(t),this.curLevel<this.root.maxLevel){this.child=[];for(var i,n=u(this.rect.quadtree());!(i=n()).done;){var o=i.value,r=new e;r.rect=o,r.parent=this,r.root=this.root,r.curLevel=r.getLevel();for(var a,s=u(this.colliders);!(a=s()).done;){var l=a.value;r.add(l)}this.child.push(r)}this.colliders.length=0,this.colliderSize=this.colliders.length}else this.parent&&t.octree.push(this);else for(var h,c=u(this.child);!(h=c()).done;){h.value.add(t)}},i.getLevel=function(){for(var t=0,e=this.parent;e;)e=e.parent,t++;return t},i.hasRect=function(e,i){switch(i.type){case t.ECollider2DShapeType.Polygon:return t.Polygon.rectPolygon(e,i.getPolygon());case t.ECollider2DShapeType.Point:return e.contains(i.getPoint());case t.ECollider2DShapeType.Circle:return t.Polygon.rectCircle(e,i.getCircle())}return!1},e}();t.Collider2DQuadtree=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.call(this)||this)._frame=60,i._frameInterval=1/60,i._enableQuadTree=!1,i.group=new t.ColliderGroup,i.maxLevel=3,i.ids=0,i.updateShapes=[],i.cycleCount=0,i._updateAABB=!1,i.curFrameDelta=0,i.preOnUpdate=null,i.root=n(i),i}o(i,e),i.has=function(e,i){var n=e.type,o=i.type,r=!1,a=t.ECollider2DShapeType.Circle,s=t.ECollider2DShapeType.Polygon,l=t.ECollider2DShapeType.Point;if(n==s){var u=e.getPolygon();o==s?r=t.Polygon.polygonPolygon(u,i.getPolygon()):o==l?r=t.Polygon.pointInPolygon(i.getPoint(),u):o==t.ECollider2DShapeType.Circle&&(r=t.Polygon.polygonCircle(u,i.getCircle()))}else if(n==a){var h=e.getCircle();o==s?r=t.Polygon.polygonCircle(i.getPolygon(),h):o==l?r=h.contains(i.getPoint()):o==a&&(r=h.intersects(i.getCircle()))}else if(n==l){var c=e.getPoint();o==s?r=t.Polygon.pointInPolygon(c,i.getPolygon()):o==l?r=c.equals(i.getPoint()):o==a&&(r=i.getCircle().contains(c))}return r};var r=i.prototype;return r.initQuadtree=function(e,i,n,o,r){void 0===r&&(r=3),this.rect=new t.Rectangle(e,i,n,o),this.maxLevel=r,this.enableQuadTree=!0},r.add=function(t){this.addShape(t),e.prototype.add.call(this,t)},r.addShape=function(t){null===t.id&&(t.id=this.ids,t.root=this,this.ids++,t.updateShape&&this.updateShapes.push(t),e.prototype.addShape.call(this,t))},r.remove=function(i){t.Sets.delete(this.root.updateShapes,i),i.clear(),e.prototype.remove.call(this,i)},r.onUpdate=function(t){this.preOnUpdate&&this.preOnUpdate(),this.updateShape(),this.cycleCount=0,this._enableQuadTree?this.quadtreeCollider(this.child):this.defaultCollider();for(var e,i=u(this.colliders);!(e=i()).done;){e.value.dataDirty=!0}},r.updateShape=function(){if(0!=this.updateShapes.length)for(var t,e=u(this.updateShapes);!(t=e()).done;){var i=t.value;this._enableQuadTree?i.octree.length>0&&(this._updateAABB=i.updateShape(i),this._updateAABB&&this.updateShapeByQuadtree(i)):i.updateShape(i)}},r.updateShapeByQuadtree=function(t){this._enableQuadTree&&(t.removeFormOctreeItem(),this.add(t))},r.defaultCollider=function(){this.colliderSize<2||this.groupByCollider(this.colliderByGroup)},r.groupByCollider=function(t){var e=this.group.colliders,i=0,n=null,o=null,r=null;for(var a in t)if(r=e[a])for(n=t[a],i=0;i<r.length;i++)(o=t[r[i]])&&this.colliderOther(n,o)},r.quadtreeCollider=function(t){if(t)for(var e,i=u(t);!(e=i()).done;){var n=e.value;null==n.child?this.groupByCollider(n.colliderByGroup):this.quadtreeCollider(n.child)}},r.clear=function(){for(var t,i=u(this.colliders);!(t=i()).done;){t.value.clear()}this.cycleCount=0,this.ids=0,this.updateShapes.length=0,this.curFrameDelta=0,e.prototype.clear.call(this)},r.colliderOther=function(t,e){var n=null,o=null,r=null,a=0,s=-1,l=null,u=null,h=null;for(a=0;a<t.length;a++)if((n=t[a])._isCollider&&null!=n.id&&(l=n.onColliderUpdate,u=n.onColliderEnter,h=n.onColliderExit,!!(u||l||h))){r=n.otherCollider;for(var c=0;c<e.length;c++)if(n!=(o=e[c])&&o._isCollider&&null!=o.id){o.selfCollider;var p=i.has(n,o);p?(-1==(s=r.indexOf(o))&&(r.push(o),o.selfCollider.push(n),u&&u(n,o)),l&&l(n,o)):-1!=(s=r.indexOf(o))&&(r.splice(s,1),-1!=(s=o.selfCollider.indexOf(n))&&o.selfCollider.splice(s,1),h&&h(n,o)),n.isColliderEnter=p}this.cycleCount++}},r.getItemAllCount=function(){var t=0;return function e(i){if(i)for(var n,o=u(i);!(n=o()).done;){var r=n.value;t+=r.colliders.length,e(r.child)}}(this.child),t},l(i,[{key:"frame",get:function(){return this._frame},set:function(t){this._frame=t,this._frameInterval=1/this._frame}},{key:"enableQuadTree",get:function(){return this._enableQuadTree},set:function(t){this._enableQuadTree=t,this.cycleCount=0}}]),i}(t.Collider2DQuadtree);t.Collider2DRoot=e}(apeng||(apeng={})),function(t){var e=0,i=0,n=0,o=function(){function o(t,e,i){this.x=0,this.y=0,this.z=0,this.set(t,e,i)}o.equals=function(t,e,i){return void 0===i&&(i=.01),Math.abs(t.x-e.x)<=i*Math.max(1,Math.abs(t.x),Math.abs(e.x))&&Math.abs(t.y-e.y)<=i*Math.max(1,Math.abs(t.y),Math.abs(e.y))&&Math.abs(t.z-e.z)<=i*Math.max(1,Math.abs(t.z),Math.abs(e.z))},o.equalsZero=function(t,e){return void 0===t.z?t.x==e.x&&t.y==e.y:t.x==e.x&&t.y==e.y&&t.z==e.z},o.add=function(t,e,i){return t.x=e.x+i.x,t.y=e.y+i.y,t.z=e.z+i.z,t},o.sub=function(t,e,i){return t.x=e.x-i.x,t.y=e.y-i.y,t.z=e.z-i.z,t},o.rotateX=function(e,i,n,o){var r=i.x-n.x,a=i.y-n.y,s=i.z-n.z,l=t.Maths.toRadian(o),u=Math.cos(l),h=Math.sin(l),c=r,p=a*u-s*h,d=a*h+s*u;return e.x=c+n.x,e.y=p+n.y,e.z=d+n.z,e},o.rotateY=function(e,i,n,o){var r=i.x-n.x,a=i.y-n.y,s=i.z-n.z,l=t.Maths.toRadian(o),u=Math.cos(l),h=Math.sin(l),c=s*h+r*u,p=a,d=s*u-r*h;return e.x=c+n.x,e.y=p+n.y,e.z=d+n.z,e},o.rotateZ=function(e,i,n,o){var r=i.x-n.x,a=i.y-n.y,s=i.z-n.z,l=t.Maths.toRadian(o),u=Math.cos(l),h=Math.sin(l),c=r*u-a*h,p=r*h+a*u,d=s;return e.x=c+n.x,e.y=p+n.y,e.z=d+n.z,e},o.mul=function(t,e,i){return"number"==typeof i?(t.x=e.x*i,t.y=e.y*i,t.z=e.z*i):(t.x=e.x*i.x,t.y=e.y*i.y,t.z=e.z*i.z),t},o.cloneTo=function(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e},o.set=function(t,e,i,n){return e&&void 0!==e[0]?(t.x=e[0],t.y=e[1],t.z=e[2]||0):e&&"object"==typeof e?(t.x=e.x,t.y=e.y,t.z=e.z):(t.x=e||0,t.y=i||0,t.z=n||0),t},o.toString=function(t){return"("+t.x.toFixed(2)+", "+t.y.toFixed(2)+", "+t.z.toFixed(2)+")"},o.len=function(t){return Math.sqrt(o.lengthSqr(t))},o.lengthSqr=function(t){return t.x*t.x+t.y*t.y+t.z*t.z},o.normalize=function(t,e){var i=e.x,n=e.y,o=e.z,r=i*i+n*n+o*o;return r>0&&(r=1/Math.sqrt(r),t.x=i*r,t.y=n*r,t.z=o*r),t},o.polygonByCenterPoint=function(t,e){for(var i,n=e[0].x,o=e[0].x,r=e[0].y,a=e[0].y,s=e[0].z,l=e[0].z,h=u(e);!(i=h()).done;){var c=i.value;n>c.x&&(n=c.x),o<c.x&&(o=c.x),r>c.y&&(r=c.y),a<c.y&&(a=c.y),s>c.z&&(s=c.z),l<c.z&&(l=c.z)}return t.x=n+Math.abs(o-n)/2,t.y=r+Math.abs(a-r)/2,t.z=s+Math.abs(l-s)/2,t},o.distanceSqr=function(t,e){return r.x=t.x-e.x,r.y=t.y-e.y,r.z=t.z-e.z,r.x*r.x+r.y*r.y+r.z*r.z},o.distance=function(t,e){return Math.sqrt(this.distanceSqr(t,e))},o.lerp=function(t,o,a,s){return e=o.x,i=o.y,n=o.z,"number"==typeof s?r.set(s,s,s):r.set(s),t.x=e+r.x*(a.x-e),t.y=i+r.y*(a.y-i),t.z=n+r.z*(a.z-n),t};var a=o.prototype;return a.set=function(t,e,i){return o.set(this,t,e,i)},a.equals=function(t,e){return void 0===e&&(e=.01),o.equals(this,t,e)},a.sub=function(t,e){return o.sub(t,this,e)},a.subSelf=function(t){return o.sub(this,this,t)},a.add=function(t,e){return o.add(t,this,e)},a.addSelf=function(t){return o.add(this,this,t)},a.clone=function(){return new o(this)},a.len=function(){return o.len(this)},a.toString=function(){return o.toString(this)},a.lengthSqr=function(){return o.lengthSqr(this)},a.mul=function(t,e){return o.mul(t,this,e)},a.mulSelf=function(t){return o.mul(this,this,t)},a.rotateX=function(t,e){return o.rotateX(this,this,t,e)},a.rotateY=function(t,e){return o.rotateY(this,this,t,e)},a.rotateZ=function(t,e){return o.rotateZ(this,this,t,e)},a.normalize=function(t){return o.normalize(t,this)},a.normalizeSelf=function(){return o.normalize(this,this)},o}();o.pool=new t.PoolOnce(1e3,(function(){return new o}),(function(t){t.set()})),o.ZERO=new o(0,0),o.ONE=new o(1,1,1),t.Vector3=o;var r=new o}(apeng||(apeng={})),function(t){var e=function(){function e(e,i){this.center=new t.Vector3,this.radius=0,this.set(e,i)}e.toAABB=function(t,e){return e.center.set(t.center),e.halfExtents.set(t.radius,t.radius,t.radius),e},e.set=function(e,i,n){return i&&t.Vector3.set(e.center,i),e.radius=n||0,e};var i=e.prototype;return i.set=function(t,i){return e.set(this,t,i)},i.toAABB=function(t){return e.toAABB(this,t)},e}();t.Sphere=e}(apeng||(apeng={})),function(t){var e;!function(t){t[t.box=0]="box",t[t.Sphere=1]="Sphere",t[t.cylinder=2]="cylinder"}(e=t.EAabbShape||(t.EAabbShape={}));var i=new t.Vector3,n=new t.Vector3,o=new t.Vector3,r=new t.Vector3,a=function(){function a(i,n,o){this.center=new t.Vector3,this.halfExtents=new t.Vector3,this.shape=e.box,this._octree=null,this._cylindreTemp=null,this._sphereTemp=null,this._randomPosition=new t.Vector3,this._min=new t.Vector3,this._max=new t.Vector3,this._getBottomPolygon=null,this.set(i,n),null!=o&&(this.shape=o)}a.toSphere=function(t,e){return e.center.set(t.center),e.radius=Math.min(t.halfExtents.x,t.halfExtents.y,t.halfExtents.z),e},a.toCylinder=function(t,e){return e.center.set(t.center),e.radius=Math.min(t.halfExtents.x,t.halfExtents.z),e.height=2*t.halfExtents.y,e},a.ptPointAabb=function(t,e){return i.set(e),n.set(t.min()),o.set(t.max()),i.x=i.x<n.x?n.x:i.x,i.y=i.y<n.y?n.y:i.y,i.z=i.z<n.z?n.z:i.z,i.x=i.x>o.x?o.x:i.x,i.y=i.y>o.y?o.y:i.y,i.z=i.z>o.z?o.z:i.z,i},a.containsAABB=function(t,e){return n.set(t.min()),o.set(t.max()),i.set(e.min()),r.set(e.max()),n.x<=i.x&&o.x>=r.x&&n.y<=i.y&&o.y>=r.y&&n.z<=i.z&&o.z>=r.z},a.create=function(t,e){return new a(t,e)},a.fromPoints=function(e,n,o){return t.Vector3.add(i,o,n),t.Vector3.sub(i,o,n),t.Vector3.mul(e.center,i,.5),t.Vector3.mul(e.halfExtents,i,.5),e},a.set=function(e,i,n){return i&&t.Vector3.set(e.center,i),n&&t.Vector3.set(e.halfExtents,n),e},a.octree=function(t,e){i.set(e.halfExtents.x/2,e.halfExtents.y/2,e.halfExtents.z/2);for(var n=0;n<8;n++)t[n].halfExtents.set(i);return t[0].center.set(e.center.x-i.x,e.center.y+i.y,e.center.z+i.z),t[1].center.set(e.center.x+i.x,e.center.y+i.y,e.center.z+i.z),t[2].center.set(e.center.x-i.x,e.center.y-i.y,e.center.z+i.z),t[3].center.set(e.center.x+i.x,e.center.y-i.y,e.center.z+i.z),t[4].center.set(e.center.x-i.x,e.center.y+i.y,e.center.z-i.z),t[5].center.set(e.center.x+i.x,e.center.y+i.y,e.center.z-i.z),t[6].center.set(e.center.x-i.x,e.center.y-i.y,e.center.z-i.z),t[7].center.set(e.center.x+i.x,e.center.y-i.y,e.center.z-i.z),t},a.randomPosition=function(e,i){var n=i.min(),o=i.max();return e.x=t.Maths.minToMax(n.x,o.x),e.y=t.Maths.minToMax(n.y,o.y),e.z=t.Maths.minToMax(n.z,o.z),e},a.min=function(e,i){return t.Vector3.sub(e,i.center,i.halfExtents)},a.max=function(e,i){return t.Vector3.add(e,i.center,i.halfExtents)},a.contains=function(t,e){var i=t.min(),n=t.max();return i.x<=e.x&&n.x>=e.x&&i.y<=e.y&&n.y>=e.y&&i.z<=e.z&&n.z>=e.z},a.getBottomPolygon=function(e,i){var n=i.min(),o=i.max();return t.Vector2.set(e[0],n.x,n.z),t.Vector2.set(e[1],o.x,n.z),t.Vector2.set(e[2],o.x,o.z),t.Vector2.set(e[3],n.x,o.z),e};var s=a.prototype;return s.octree=function(){if(null==this._octree){this._octree=[];for(var t=0;t<8;t++)this._octree[t]=new a}return a.octree(this._octree,this)},s.getCylinder=function(){return null==this._cylindreTemp&&(this._cylindreTemp=new t.Cylinder),a.toCylinder(this,this._cylindreTemp)},s.getBottomPolygon=function(){if(null==this._getBottomPolygon){this._getBottomPolygon=[];for(var e=0;e<4;e++)this._getBottomPolygon.push(new t.Vector2)}return a.getBottomPolygon(this._getBottomPolygon,this)},s.getSphere=function(){return null==this._sphereTemp&&(this._sphereTemp=new t.Sphere),a.toSphere(this,this._sphereTemp)},s.set=function(t,e){return a.set(this,t,e)},s.randomPosition=function(){return a.randomPosition(this._randomPosition,this)},s.min=function(){return a.min(this._min,this)},s.max=function(){return a.max(this._max,this)},s.containsAABB=function(t){return a.containsAABB(this,t)},s.contains=function(t){return a.contains(this,t)},a}();a.intersection={intersectsShape:function(t,i){switch(t.shape){case e.box:switch(i.shape){case e.box:return a.intersection.aabbAabb(t,i);case e.Sphere:return a.intersection.aabbSphere(t,i.getSphere());case e.cylinder:return a.intersection.aabbCylinder(t,i.getCylinder())}case e.Sphere:switch(i.shape){case e.box:return a.intersection.aabbSphere(i,t.getSphere());case e.Sphere:return a.intersection.sphereSphere(t.getSphere(),i.getSphere());case e.cylinder:return a.intersection.sphereCylinder(t.getSphere(),i.getCylinder())}case e.cylinder:switch(i.shape){case e.box:return a.intersection.aabbCylinder(i,t.getCylinder());case e.Sphere:return a.intersection.sphereCylinder(t.getSphere(),i.getCylinder());case e.cylinder:return a.intersection.cylinderCylinder(t.getCylinder(),i.getCylinder())}}return!1},aabbAabb:function(t,e){return i.set(t.min()),n.set(t.max()),o.set(e.min()),r.set(e.max()),i.x<=r.x&&n.x>=o.x&&i.y<=r.y&&n.y>=o.y&&i.z<=r.z&&n.z>=o.z},aabbSphere:function(e,n){return i.set(a.ptPointAabb(e,n.center)),t.Vector3.distanceSqr(n.center,i)<=n.radius*n.radius},aabbCylinder:function(e,i){return i.toAABB(s),!(!a.intersection.aabbAabb(e,s)||!t.Polygon.polygonCircle(e.getBottomPolygon(),i.getCircle()))},sphereSphere:function(e,i){return t.Vector3.distanceSqr(e.center,i.center)<=(e.radius+i.radius)*(e.radius+i.radius)},sphereCylinder:function(t,e){return a.intersection.aabbSphere(e.toAABB(s),t)},cylinderCylinder:function(t,e){return t.toAABB(s),e.toAABB(l),a.intersection.aabbAabb(s,l),!!t.getCircle().intersects(e.getCircle())}},t.AABB=a;new t.Sphere;var s=new a,l=new a}(apeng||(apeng={})),function(t){var e=function(){function e(){this.root=null,this.parent=null,this.aabb=null,this.child=null,this.curLevel=0,this.containData=[]}var i=e.prototype;return i.clear=function(){if(this.child)for(var t,e=u(this.child);!(t=e()).done;){t.value.clear()}this.root=null,this.parent=null,this.aabb=null,this.child=null,this.curLevel=0,this.containData.length=0},i.add=function(i){if(this.root.addShape(i),t.AABB.intersection.aabbAabb(this.aabb,i.aabb))if(null==this.child)if(this.containData.push(i),this.curLevel<this.root.maxLevel){this.child=[];for(var n,o=u(this.aabb.octree());!(n=o()).done;){var r=n.value,a=new e;a.aabb=r,a.parent=this,a.root=this.root,a.curLevel=a.getLevel();for(var s,l=u(this.containData);!(s=l()).done;){var h=s.value;a.add(h)}this.child.push(a)}this.containData.length=0}else this.parent&&i.octree.push(this);else for(var c,p=u(this.child);!(c=p()).done;){c.value.add(i)}},i.getLevel=function(){for(var t=0,e=this.parent;e;)e=e.parent,t++;return t},e}();t.Collider3DOctree=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.call(this)||this).group=new t.ColliderGroup,i.maxLevel=3,i.ids=0,i.colliders=[],i.updateShapes=[],i.cycleCount=0,i._isOpen=!0,i._updateShape=!1,i.root=n(i),i}o(i,e);var r=i.prototype;return r.initOctree=function(t,e){void 0===e&&(e=3),this.aabb=t,this.maxLevel=e,this.setOpen(!0)},r.setOpen=function(t){this._isOpen=t,this.cycleCount=0},r.addShape=function(t){null===t.id&&(t.id=this.ids,t.root=this,this.ids++,this.colliders.push(t),t.updateShape&&this.updateShapes.push(t))},r.remove=function(t){t.clear()},r.onUpdate=function(){this.updateShape(),this.cycleCount=0,this._isOpen?this.octreeCollider(this.child):this.defaultCollider()},r.updateShape=function(){if(0!=this.updateShapes.length)for(var t,e=u(this.updateShapes);!(t=e()).done;){var i=t.value;i.octree.length>0&&(this._updateShape=i.updateShape(i.aabb),this._updateShape&&this._isOpen&&(i.removeFormOctreeItem(),this.add(i)))}},r.defaultCollider=function(){this.cycle(this.colliders)},r.octreeCollider=function(t){if(t)for(var e,i=u(t);!(e=i()).done;){var n=e.value;null==n.child&&this.cycle(n.containData),this.octreeCollider(n.child)}},r.clear=function(){e.prototype.clear.call(this);for(var t,i=u(this.colliders);!(t=i()).done;){t.value.clear()}this.cycleCount=0,this.ids=0,this.colliders.length=0,this.updateShapes.length=0},r.cycle=function(e){if(!(e.length<2))for(var i,n=u(e);!(i=n()).done;){var o=i.value;if(o)for(var r,a=u(e);!(r=a()).done;){var s=r.value;s&&(o!=s&&o.isCollider&&s.isCollider&&o.group!=s.group&&this.group.has(o.group,s.group)&&(t.AABB.intersection.intersectsShape(o.aabb,s.aabb)?(o.isColliderEnter=!0,o.hasEnter(s)&&o.onEnter&&o.onEnter(o,s),o.onUpdate&&o.onUpdate(o,s)):(o.isColliderEnter=!1,o.hasExit(s)&&o.onExit&&o.onExit(o,s)),this.cycleCount++))}}},r.getAddItemAllCount=function(){var t=0;return function e(i){if(i)for(var n,o=u(i);!(n=o()).done;){var r=n.value;t+=r.containData.length,e(r.child)}}(this.child),t},i}(t.Collider3DOctree);t.Collider3DRoot=e}(apeng||(apeng={})),function(t){var e=function(){function e(e,i,n,o,r){void 0===r&&(r=null),this.aabb=null,this.updateShape=null,this.isCollider=!0,this.group=null,this.onEnter=null,this.onUpdate=null,this.onExit=null,this.id=null,this.octree=[],this.root=null,this.otherCollider=[],this.selfCollider=[],this.owner=null,this.isColliderEnter=!1,this.aabb=new t.AABB(e,i,n),this.group=o,this.updateShape=r}var i=e.prototype;return i.hasEnter=function(e){return!t.Sets.has(this.otherCollider,e)&&(this.otherCollider.push(e),e.selfCollider.push(this),!0)},i.hasExit=function(e){return!!t.Sets.has(this.otherCollider,e)&&(t.Sets.delete(this.otherCollider,e),t.Sets.delete(e.selfCollider,this),!0)},i.clear=function(){if(this.isColliderEnter=!1,this.otherCollider.length=0,this.selfCollider.length=0,t.Sets.delete(this.root.updateShapes,this),t.Sets.delete(this.root.colliders,this),this.octree.length>0){for(var e,i=u(this.octree);!(e=i()).done;){var n=e.value;t.Sets.delete(n.containData,this)}this.octree.length=0}this.id=null},i.removeFormOctreeItem=function(){if(this.octree.length>0){for(var e,i=u(this.octree);!(e=i()).done;){var n=e.value;t.Sets.delete(n.containData,this)}this.octree.length=0}},e}();t.Collider3DShape=e}(apeng||(apeng={})),function(t){var e=function(){function e(e,i,n){this.center=new t.Vector3,this.radius=0,this.height=0,this._circle=new t.Circle,this.set(e,i,n)}e.toAABB=function(t,e){return e.center.set(t.center),e.halfExtents.set(t.radius,t.height/2,t.radius),e},e.getCircle=function(t,e){return t.set(e.center.x,e.center.z,e.radius)},e.set=function(e,i,n,o){return i&&t.Vector3.set(e.center,i),e.radius=n||0,e.height=o||0,e};var i=e.prototype;return i.set=function(t,i,n){return e.set(this,t,i,n)},i.getCircle=function(){return e.getCircle(this._circle,this)},i.toAABB=function(t){return e.toAABB(this,t)},e}();t.Cylinder=e}(apeng||(apeng={})),function(t){var e;!function(t){t[t.None=0]="None",t[t.Breathe=1]="Breathe",t[t.BreatheLinear=2]="BreatheLinear",t[t.UIshow=3]="UIshow",t[t.TipShow=4]="TipShow",t[t.Rotate=5]="Rotate",t[t.ScaleZeroToMax=6]="ScaleZeroToMax",t[t.ScaleTo=7]="ScaleTo",t[t.MoveLeftRight=8]="MoveLeftRight",t[t.ScaleTo2=9]="ScaleTo2",t[t.BreatheLinear2=10]="BreatheLinear2",t[t.Shake=11]="Shake",t[t.UISHowScale=12]="UISHowScale",t[t.TipShowTop=13]="TipShowTop",t[t.MoveTopDown=14]="MoveTopDown"}(e=t.ETweenType||(t.ETweenType={})),t.ccenum(e);var i=function(){function i(){}return i.setDefaultData=function(t,e){this._defaultData[t]=e},i.stop=function(e,i){if(i){var n=this.getTween(e,i);if(n){n.stop();var o=e["_Tweens_orgin"+i];o&&o()}}else t.Tween.stopAllByTarget(e);return this},i.default=function(n,o,r){return i.stop(n,o),this.getTween(n,o,(function(a){switch(o){case e.Breathe:var s=n.getScale(),l=s.clone();return a.call((function(){l.x=.9*s.x,l.y=.95*s.y})).to(.3,{scale:l},{easing:"fade"}).call((function(){l.x=1.07*s.x,l.y=1*s.y})).to(.3,{scale:l},{easing:"circInOut"}).call((function(){l.x=s.x,l.y=s.y})).to(.1,{scale:l}).delay(1).union().repeatForever(),{scale:s};case e.BreatheLinear:var u=n.getScale(),h=u.clone();return a.call((function(){h.x=1.1*u.x,h.y=1.1*u.y})).to(.8,{scale:h},{easing:"backOut"}).call((function(){h.x=1*u.x,h.y=1*u.y})).to(.5,{scale:h}).union().repeatForever(),{scale:u};case e.BreatheLinear2:var c=n.getScale(),p=c.clone();return a.call((function(){p.x=1.3*c.x,p.y=1.3*c.y})).to(.8,{scale:p},{easing:"backOut"}).call((function(){p.x=1*c.x,p.y=1*c.y})).to(.5,{scale:p}).union().repeatForever(),{scale:c};case e.UIshow:var d=n.getPosition(),f=d.clone();return a.call((function(){f.y=t.winSize().height+t.NodeHelper.getUITransform(n).height,n.setPosition(f),f.y=d.y-80})).to(.3,{position:f},{easing:"quadOut"}).to(.2,{position:d},{easing:"quadIn"}),{position:d};case e.TipShow:var y=n.getPosition(),g=y.clone(),m=y.clone(),v=y.clone(),C=y.clone();return a.call((function(){m.x=-t.winSize().width-t.NodeHelper.getUITransform(n).width,n.setPosition(m),y.x=g.x+80,v.x=g.x-80,C.x=-m.x})).to(.3,{position:y},{easing:"quadOut"}).to(.2,{position:g},{easing:"quadIn"}).delay(1).to(.2,{position:v},{easing:"quadIn"}).to(.3,{position:C},{easing:"quadOut"}).call((function(){r&&r()})),{position:y};case e.Rotate:return a.by(3,{angle:-360}).union().repeatForever(),{angle:0};case e.ScaleZeroToMax:var _=n.getScale();return a.call((function(){n.setScale(new t.Vec3(0,0,1))})).to(1,{scale:new t.Vec3(1.5,1.5,1)}),{scale:_};case e.ScaleTo:var S=n.getScale(),E=S.clone();return a.call((function(){t.Vector3.mul(E,S,1.2)})).to(.3,{scale:E},{easing:"quadOut"}).to(.2,{scale:S},{easing:"quadIn"}),{scale:S};case e.ScaleTo2:var b=n.getScale(),T=b.clone();return a.call((function(){t.Vector3.mul(T,b,1.05)})).to(.15,{scale:T},{easing:"quadOut"}).to(.1,{scale:b},{easing:"quadIn"}),{scale:b};case e.MoveLeftRight:var w=n.getPosition(),I=w.clone();I.x-=300;var P=w.clone();return P.x+=300,a.to(1,{position:I}).to(1,{position:P}).delay(.5).union().repeatForever(),{position:w};case e.Shake:return a.set({angle:0}).to(.3,{angle:-10}).to(.6,{angle:10}).to(.3,{angle:0}).delay(.5).union().repeatForever(),{angle:0};case e.UISHowScale:var N=n.getScale(),M=N.clone().multiplyScalar(1.07),x=n["_Tweens2_"+o]=new t.Tween(n);return x.delay(.1).call((function(){r&&r("one")})).union(),a.call((function(){n.setScale(t.Vec3.ZERO),x.start()})).to(.25,{scale:M},{easing:"quadOut"}).to(.15,{scale:N},{easing:"quadOut"}).call((function(){r&&r("two")})),i.UISHowScaleDuration=.4,{scale:N,__callTween2:function(){return x.stop()}};case e.TipShowTop:var B=n.getPosition(),L=B.clone(),O=B.clone(),A=B.clone();return a.call((function(){A.y=t.winSize().height+t.NodeHelper.getUITransform(n).height,n.setPosition(A),O.y=B.y;var o=i._defaultData[e.TipShowTop];void 0!==o&&"number"==typeof o&&(O.y+=o,L.y+=o),L.y=O.y-80})).to(.3,{position:L},{easing:"quadOut"}).to(.2,{position:O},{easing:"quadIn"}).delay(1).to(.2,{position:L},{easing:"quadIn"}).to(.3,{position:A},{easing:"quadOut"}).call((function(){r&&r()})),{position:L};case e.MoveTopDown:var D=i._defaultData[e.MoveTopDown],R=20,k=.5;void 0!==D&&(R+=D.dis,k+=D.duration);var U=n.getPosition(),V=U.clone(),z=U.clone();return a.call((function(){V.y=U.y+R,z.y=U.y-R})).to(k,{position:V}).to(k,{position:z}).union().repeatForever(),{position:U}}return null})).start()},i.getTween=function(e,i,n){var o=e["_Tweens_"+i];if(!o&&n){var r=n(o=e["_Tweens_"+i]=new t.Tween(e));r&&(e["_Tweens_orgin"+i]=function(){for(var t in r){var i=r[t];"function"==typeof i?i():e[t]=i}})}return o},i.duration=function(t){if(t){for(var e,i=0,n=u(t._actions);!(e=n()).done;){i+=e.value._duration}return i}return 0},i.setDuration=function(t,e,i){var n=t._actions[e];return n&&n.initWithDuration(i),this},i.pause=function(e){return t.TweenSystem.instance.ActionManager.pauseTarget(e),this},i.resume=function(e){return t.TweenSystem.instance.ActionManager.resumeTarget(e),this},i.hasPause=function(e){var i=t.TweenSystem.instance.ActionManager._hashTargets.get(e);return!!i&&i.paused},i.hasRun=function(e){return t.TweenSystem.instance.ActionManager.getNumberOfRunningActionsInTarget(e)>0},i}();i.UISHowScaleDuration=.4,i._defaultData={},t.TweenHelper=i}(apeng||(apeng={})),function(t){var e;!function(t){t[t.none=0]="none",t[t.constant=1]="constant",t[t.linear=2]="linear",t[t.quadIn=3]="quadIn",t[t.quadOut=4]="quadOut",t[t.quadInOut=5]="quadInOut",t[t.cubicIn=6]="cubicIn",t[t.cubicOut=7]="cubicOut",t[t.cubicInOut=8]="cubicInOut",t[t.quartIn=9]="quartIn",t[t.quartOut=10]="quartOut",t[t.quartInOut=11]="quartInOut",t[t.quintIn=12]="quintIn",t[t.quintOut=13]="quintOut",t[t.quintInOut=14]="quintInOut",t[t.sineIn=15]="sineIn",t[t.sineOut=16]="sineOut",t[t.sineInOut=17]="sineInOut",t[t.expoIn=18]="expoIn",t[t.expoOut=19]="expoOut",t[t.expoInOut=20]="expoInOut",t[t.circIn=21]="circIn",t[t.circOut=22]="circOut",t[t.circInOut=23]="circInOut",t[t.elasticIn=24]="elasticIn",t[t.elasticOut=25]="elasticOut",t[t.elasticInOut=26]="elasticInOut",t[t.backIn=27]="backIn",t[t.backOut=28]="backOut",t[t.backInOut=29]="backInOut",t[t.bounceIn=30]="bounceIn",t[t.bounceOut=31]="bounceOut",t[t.bounceInOut=32]="bounceInOut",t[t.smooth=33]="smooth",t[t.fade=34]="fade",t[t.quadOutIn=35]="quadOutIn",t[t.cubicOutIn=36]="cubicOutIn",t[t.quartOutIn=37]="quartOutIn",t[t.quintOutIn=38]="quintOutIn",t[t.sineOutIn=39]="sineOutIn",t[t.expoOutIn=40]="expoOutIn",t[t.circOutIn=41]="circOutIn",t[t.backOutIn=42]="backOutIn",t[t.bounceOutIn=43]="bounceOutIn"}(e=t.EEaseType||(t.EEaseType={})),t.ccenum(e),t.easing=function(t,n){var o=i[e[t]];return o&&(n=o(n)),n};var i={constant:function(){return 0},linear:function(t){return t},quadIn:function(t){return t*t},quadOut:function(t){return t*(2-t)},quadInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quartIn:function(t){return t*t*t*t},quartOut:function(t){return 1- --t*t*t*t},quartInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quintIn:function(t){return t*t*t*t*t},quintOut:function(t){return--t*t*t*t*t+1},quintInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sineIn:function(t){return 1-Math.cos(t*Math.PI/2)},sineOut:function(t){return Math.sin(t*Math.PI/2)},sineInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},expoIn:function(t){return 0===t?0:Math.pow(1024,t-1)},expoOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},expoInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},circIn:function(t){return 1-Math.sqrt(1-t*t)},circOut:function(t){return Math.sqrt(1- --t*t)},circInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},elasticOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},elasticInOut:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=n*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*.5+1)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)},bounceIn:function(t){return 1-i.bounceOut(1-t)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){return t<.5?.5*i.bounceIn(2*t):.5*i.bounceOut(2*t-1)+.5},smooth:function(t){return t<=0?0:t>=1?1:t*t*(3-2*t)},fade:function(t){return t<=0?0:t>=1?1:t*t*t*(t*(6*t-15)+10)},quadOutIn:function(t){},cubicOutIn:function(t){},quartOutIn:function(t){},quintOutIn:function(t){},sineOutIn:function(t){},expoOutIn:function(t){},circOutIn:function(t){},elasticOutIn:function(t){},backOutIn:function(t){},bounceOutIn:function(t){}};function n(t,e){return function(i){return i<.5?e(2*i)/2:t(2*i-1)/2+.5}}i.quadOutIn=n(i.quadIn,i.quadOut),i.cubicOutIn=n(i.cubicIn,i.cubicOut),i.quartOutIn=n(i.quartIn,i.quartOut),i.quintOutIn=n(i.quintIn,i.quintOut),i.sineOutIn=n(i.sineIn,i.sineOut),i.expoOutIn=n(i.expoIn,i.expoOut),i.circOutIn=n(i.circIn,i.circOut),i.backOutIn=n(i.backIn,i.backOut),i.bounceOutIn=n(i.bounceIn,i.bounceOut)}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).backupDescribe="内置tween",i.type=t.ETweenType.None,i.isEnablePlay=!0,i.delayPlay=-1,i.delayPlayByOpacityZeor=!1,i}o(i,e);var n=i.prototype;return n.onEnable=function(){e.prototype.onEnable.call(this),this.isEnablePlay&&this.play()},n.onDisable=function(){this.stop(),e.prototype.onDisable.call(this)},n.stop=function(){t.TweenHelper.stop(this.node,this.type)},n.play=function(e){var i=this;this.ListCC&&this.ListCC.otherAnimComplete(!0);var n=e;this.ListCC&&(n=function(t){i.ListCC.otherAnimComplete(!1,t),e&&e()}),-1!=this.delayPlay?(this.delayPlayByOpacityZeor&&this.setOpacity(0),this.scheduleOnce((function(){t.TweenHelper.default(i.node,i.type,n),i.delayPlayByOpacityZeor&&i.setOpacity(1)}),this.delayPlay)):t.TweenHelper.default(this.node,this.type,n)},n.getDuration=function(){return t.TweenHelper.duration(t.TweenHelper.getTween(this.node,this.type))},i}(t.BaseComponent);p([t.property({type:t.ETweenType,displayName:"类型"})],e.prototype,"type",void 0),p([t.property({displayName:"激活时执行",visible:function(){return this.type!=t.ETweenType.None}})],e.prototype,"isEnablePlay",void 0),p([t.property({displayName:"延迟执行",visible:function(){return this.isEnablePlay}})],e.prototype,"delayPlay",void 0),p([t.property({displayName:"延迟时 透明度置为0 防止看起来闪现",visible:function(){return this.isEnablePlay&&-1!=this.delayPlay}})],e.prototype,"delayPlayByOpacityZeor",void 0),e=p([t.ccclass("AnimtorByTweenCC"),t.menuAnim("AnimtorByTweenCC")],e),t.AnimtorByTweenCC=e}(apeng||(apeng={})),function(t){var e=new t.Vector2,i=new t.Vector2,n={width:0,height:0},o=function(){function o(e,i,n,o){this.x=0,this.y=0,this.width=0,this.height=0,this.angle=0,this._origin=new t.Vector2,this._center=new t.Vector2,this._v2s=null,this._layoutOut=null,this._layoutXCount=null,this._layoutYCount=null,this._layoutCenter=null,this._quadtree=null,this.set(e,i,n,o)}o.set=function(t,e,i,n,o){return e&&"object"==typeof e?(t.x=e.x,t.y=e.y,t.width=e.width||0,t.height=e.height||0):(t.x=e||0,t.y=i||0,t.width=n||0,t.height=o||0),t},o.fromMinMax=function(t,e,i){var n=Math.min(e.x,i.x),o=Math.min(e.y,i.y),r=Math.max(e.x,i.x),a=Math.max(e.y,i.y);return t.x=n,t.y=o,t.width=r-n,t.height=a-o,t},o.equalsXY=function(e,i,n){return e.width==i.width&&(e.height==i.height&&(!!t.Maths.isRange(e.x,i.x,n)&&!!t.Maths.isRange(e.y,i.y,n)))},o.intersection=function(t,e,i){var n=e.x,o=e.y,r=e.x+e.width,a=e.y+e.height,s=i.x,l=i.y,u=i.x+i.width,h=i.y+i.height;return t.x=Math.max(n,s),t.y=Math.max(o,l),t.width=Math.min(r,u)-t.x,t.height=Math.min(a,h)-t.y,t},o.union=function(t,e,i){var n=e.x,o=e.y,r=e.width,a=e.height,s=i.x,l=i.y,u=i.width,h=i.height;return t.x=Math.min(n,s),t.y=Math.min(o,l),t.width=Math.max(n+r,s+u)-t.x,t.height=Math.max(o+a,l+h)-t.y,t},o.containsRect=function(t,e){return t.x<=e.x&&t.x+t.width>=e.x+e.width&&t.y<=e.y&&t.y+t.height>=e.y+e.height},o.contains=function(t,e){return t.x<e.x&&t.x+t.width>e.x&&t.y<e.y&&t.y+t.height>e.y},o.intersects=function(t,e){var i=t.x+t.width,n=t.y+t.height,o=e.x+e.width,r=e.y+e.height;return!(i<e.x||o<t.x||n<e.y||r<t.y)},o.equals=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},o.angleCenter=function(e,i,n){var o=i.center,r=i.size,a=t.Maths.toRadian(n);t.Vector2.set(e[0],-r.width/2,-r.height/2),t.Vector2.set(e[1],r.width/2,-r.height/2),t.Vector2.set(e[2],r.width/2,r.height/2),t.Vector2.set(e[3],-r.width/2,r.height/2);for(var s,l=u(e);!(s=l()).done;){s.value.rotateSelf(a).addSelf(o)}return e},o.lerp=function(t,e,i,n){var o=e.x,r=e.y,a=e.width,s=e.height;return t.x=o+(i.x-o)*n,t.y=r+(i.y-r)*n,t.width=a+(i.width-a)*n,t.height=s+(i.height-s)*n,t},o.mul=function(t,n,o){return i.set(n.center),e.set(o,o),t.width=n.width*e.x,t.height=n.height*e.y,t.center=i,t},o.add=function(t,e,n,o){return i.set(e.center),t.width=e.width+n,t.height=e.height+o,t.center=i,t},o.layout=function(e,i,n,r,a){for(var s=0;s<n;s++){null==e[s]&&(e[s]=[]);for(var l=0;l<r;l++)null==e[s][l]&&(e[s][l]=new t.Vector2),o.layoutPoint(e[s][l],i,s,l,n,r,a)}return e},o.converPointToOther=function(e,i,n,o){return t.Vector2.sub(e,n.origin,o.origin),t.Vector2.add(e,e,i),e},o.layoutPoint=function(t,e,i,n,o,r,a){return a?(t.x=e.x+(i+.5)/o*e.width,t.y=e.y+(n+.5)/r*e.height):(t.x=e.x+i/(o-1)*e.width,t.y=e.y+n/(r-1)*e.height),t},o.layoutPointByIndex=function(i,n,r,a,s){return s&&(t.Vector2.sub(e,n,i.origin),o._layoutPointByIndex.i=Math.floor(e.x/(r-.5)),o._layoutPointByIndex.j=Math.floor(e.y/(a-.5))),o._layoutPointByIndex},o.create=function(t,e,i,n){return new o(t,e,i,n)},o.clone=function(t){return(new o).set(t)},o.polygon=function(e,i){return t.Vector2.set(e[0],i.xMin,i.yMin),t.Vector2.set(e[1],i.xMin,i.yMax),t.Vector2.set(e[2],i.xMax,i.yMax),t.Vector2.set(e[3],i.xMax,i.yMin),e},o.quadtree=function(t,i){for(var n=i.width/2,o=i.height/2,r=0;r<4;r++)t[r].width=n,t[r].height=o;return t[0].origin=e.set(i.x,i.y+o),t[1].origin=e.set(i.x+n,i.y+o),t[2].origin=e.set(i.x,i.y),t[3].origin=e.set(i.x+n,i.y),t};var r=o.prototype;return r.layoutSelf=function(t,e,i){return null==this._layoutOut&&(this._layoutOut=[]),this._layoutXCount=t,this._layoutYCount=e,this._layoutCenter=i,o.layout(this._layoutOut,this,this._layoutXCount,this._layoutYCount,this._layoutCenter)},r.layoutPoint=function(t,e,i){return o.layoutPoint(t,this,e,i,this._layoutXCount,this._layoutYCount,this._layoutCenter)},r.layoutPointByIndex=function(t){return o.layoutPointByIndex(this,t,this._layoutXCount,this._layoutYCount,this._layoutCenter)},r.polygon=function(){return o.polygon(this.v2s,this)},r.set=function(t,e,i,n){return o.set(this,t,e,i,n)},r.lerp=function(t,e,i){return o.lerp(t,this,e,i)},r.lerpSelf=function(t,e){return o.lerp(this,this,t,e)},r.equals=function(t){return o.equals(this,t)},r.intersects=function(t){return o.intersects(this,t)},r.contains=function(t){return o.contains(this,t)},r.containsRect=function(t){return o.containsRect(this,t)},r.union=function(t,e){return o.union(t,this,e)},r.unionSelf=function(t){return o.union(this,this,t)},r.intersection=function(t,e){return o.intersection(t,this,e)},r.intersectionSelf=function(t){return o.intersection(this,this,t)},r.equalsXY=function(t,e){return o.equalsXY(this,t,e)},r.mul=function(t,e){return o.mul(t,this,e)},r.mulSelf=function(t){return o.mul(this,this,t)},r.add=function(t,e,i){return o.add(t,this,e,i)},r.addSelf=function(t,e){return o.add(this,this,t,e)},r.layout=function(t,e,i,n){return o.layout(t,this,e,i,n)},r.converPointToOther=function(t,e,i){return o.converPointToOther(t,e,this,i)},r.fromMinMax=function(t,e){return o.fromMinMax(this,t,e)},r.clone=function(){return o.clone(this)},r.angleCenter=function(t){return void 0===t&&(t=0),0!=this.angle?o.angleCenter(this.v2s,this,this.angle+t):o.polygon(this.v2s,this)},r.quadtree=function(){if(null==this._quadtree){this._quadtree=[];for(var t=0;t<4;t++)this._quadtree[t]=new o}return o.quadtree(this._quadtree,this)},l(o,[{key:"origin",get:function(){return this._origin.set(this.x,this.y)},set:function(t){this.x=t.x,this.y=t.y}},{key:"center",get:function(){return this._center.set(this.x+this.width/2,this.y+this.height/2)},set:function(t){this.x=t.x-this.width/2,this.y=t.y-this.height/2}},{key:"centerDisLeft",get:function(){return this.center.x-this.width/2}},{key:"centerDisRight",get:function(){return this.center.x+this.width/2}},{key:"centerDisTop",get:function(){return this.center.y+this.height/2}},{key:"centerDisDown",get:function(){return this.center.y-this.height/2}},{key:"yMax",get:function(){return this.y+this.height},set:function(t){this.height=t-this.y}},{key:"yMin",get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t}},{key:"xMax",get:function(){return this.x+this.width},set:function(t){this.width=t-this.x}},{key:"xMin",get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t}},{key:"size",get:function(){return n.width=this.width,n.height=this.height,n},set:function(t){this.width=t.width,this.height=t.height}},{key:"v2s",get:function(){return null==this._v2s&&(this._v2s=[new t.Vector2,new t.Vector2,new t.Vector2,new t.Vector2]),this._v2s}}]),o}();o.TEMP=new o,o._layoutPointByIndex={},t.Rectangle=o;new o}(apeng||(apeng={})),function(t){new t.Vector2;var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).backupDescribe="创建预制体到场景",t.Pool=null,t.prefabItemByUuid="",t.prefabItemDeep=null,t.isPool=!0,t.isPlayAnim=!1,t._isPreloadPrefab=!0,t._numItems=0,t._itemScale=-1,t._runClearItem=!0,t._prefabItem=null,t.isLoadPrefab=!1,t.loadPrefabUrl="",t._renderData={},t.isRenderItems=!0,t}o(i,e),i.itemAnimIgnore=function(t,e){t.itemAnimIgnore=e};var n=i.prototype;return n.onEditorUpdateData=function(){this.updatePreloadPrefab(),this.updateItem()},n.onEditorClearData=function(){t.Sets.forEach(this.content.children,(function(t){t.removeFromParent(),t.destroy()}),!0)},n.onPreLoad=function(){this.node.layer=this.node.parent.layer,t.EDITOR?(this.updateItem(),this.updatePreloadPrefab()):(this.isPool&&(this.Pool=new t.PoolOnce(1e3,this.createNode.bind(this),(function(t){return t.removeFromParent()}),(function(t){return t.destroy()}))),this._runClearItem?this._numItems=0:this.updateItem())},n.onEnable=function(){e.prototype.onEnable.call(this),t.EDITOR||this.isPlayAnim&&(this.clearAnim(),this.scheduleOnceCover(this.playItemAnim,0))},n.onDisable=function(){t.EDITOR||this.isPlayAnim&&this.clearAnim(this.itemOrginScale),e.prototype.onDisable.call(this)},n.onDestroy=function(){this.Pool&&this.Pool.clear(),e.prototype.onDestroy.call(this)},n.clearAnim=function(e){void 0===e&&(e=0);for(var i,n=u(this.items);!(i=n()).done;){var o=i.value;t.TweenHelper.stop(o,"itemsAnim"),t.NodeHelper.setScaleNum(o,e,!1)}},n.forEach=function(e,i){t.NodeHelper.getChildrenByComponents(this.content,e,i)},n.createNode=function(){var e=t.instantiate(this.prefabItem);return t.NodeHelper.setHideFlags(e,t.CCObject.Flags.HideInHierarchy,t.CCObject.Flags.DontSave),e},n.updatePreloadPrefab=function(){this._isPreloadPrefab?this.prefabItemDeep=this.prefabItem:this.prefabItemDeep=null,this.prefabItemByUuid=this.prefabItem?this.prefabItem._uuid:""},n.preloadPrefab=function(e,i,n){var o=this;if(void 0===i&&(i=!1),e&&e!=this.loadPrefabUrl&&(this._prefabItem=null,this.isLoadPrefab=!1,this.loadPrefabUrl=""),this.isVisible){if(this._isPreloadPrefab||this.isLoadPrefab)return i&&(this.removeItem(),this.addItem()),void(n&&n(!0));e||(e=this.getPrefabUuidByUrl()),t._resouces.loadPrefab(e,(function(t){o._prefabItem=t,o.isLoadPrefab=!0,o.loadPrefabUrl=e,o.isVisible?(i&&(o.removeItem(),o.addItem()),n&&n(!0)):n&&n(!1)}))}else n&&n(!1)},n.getPrefabUuidByUrl=function(){return t._resouces.getUuidByUrl(this.prefabItemByUuid)},n.updateItem=function(){var e=this;this.prefabItem&&(this.LayoutCC&&(this.LayoutCC.numItems=this._numItems,0==this.LayoutCC.itemByPosition.length&&this.LayoutCC.updateView()),t.Sets.updateItemCount(this._numItems,this.content.children.length,(function(t){t?e.addItem():e.removeItem()})),this.LayoutCC&&this.LayoutCC.updateItemPosition(),-1!=this._itemScale&&t.Sets.forEach(this.items,(function(i){t.NodeHelper.setScaleNum(i,e._itemScale,!1)})),this.onUpdateItem&&this.onUpdateItem())},n.render=function(e,i,n,o,r){if(void 0===r&&(r=!1),!this.isRenderItems&&this.isPlayAnim)return this._renderData.datas=e,this._renderData.comp=i,this._renderData.render=n,this._renderData.sort=o,void(this._renderData.sortChangDatas=r);t.EDITOR||this.onRenderBefore&&this.onRenderBefore();var a="number"==typeof e,s=null;if(!a&&o)if(r)t.Sets.sortMax(e,o);else{s=[];for(var l=0;l<e.length;l++)s.push(l);t.Sets.sortMax(s,(function(t){return o(e[t])}))}this.numItems=a?e:e.length;for(var u=this.items,h=0;h<u.length;h++){var c=u[h].getComponent(i);c||(c=u[h].getComponentInChildren(i));var p=h;if(s&&(p=s[h]),i instanceof t.BaseComponent&&i.autoMember(),n(c,a?null:e[p],h,p))break}t.EDITOR||(this.isPlayAnim&&(this.clearAnim(),this.scheduleOnceCover(this.playItemAnim,0)),this.onRenderComplete&&this.onRenderComplete())},n.addItem=function(e){var i=this;return e||((e=this.isPool&&this.Pool?this.Pool.get():this.createNode()).layer=this.node.layer,t.NodeHelper.walkAllChild(e,(function(t){t.layer=i.node.layer;var e=t.getComponent("BaseComponent");e&&e.autoMember()}))),t.EDITOR||this.isPlayAnim&&t.NodeHelper.setScaleNum(e,0,!1),this.onAddItem(e),e},n.removeItem=function(t,e){if(void 0===e&&(e=!0),!this.prefabItem)return null;t||(t=this.items[this.items.length-1]),t&&(this.isPool&&this.Pool?this.Pool.put(t):(t.removeFromParent(),e&&t.destroy())),this._numItems=this.items.length},n.playItemAnim=function(){var e=this,i=this.items;if(0!=i.length)for(var n=this.hasPlayScaleAnim(),o=this.itemOrginScale,r=0,a=function(a){var s=i[a];if(!s.itemAnimIgnore&&s.active){var l=t.TweenHelper.getTween(s,"itemsAnim",(function(i){if(n){var r=new t.Vec3(o,o,1);return i.delay(.03*a).to(.3,{scale:r},{easing:"circOut"}),{scale:r}}var l=null;s.getComponent(t.UIRenderer)||s.getComponent(t.UIOpacity)||s.addComponent(t.UIOpacity),(l=s.getComponent("RenderOpacityAnimCC"))||(l=s.addComponent("RenderOpacityAnimCC")),l&&(l.showEaseType=t.EEaseType.linear,l.speed=1);var u=t.NodeHelper.getUITransform(s).height,h=new t.Vec3,c=new t.Vec3,p=new t.Vec3;return i.call((function(){t.Vector2.set(h,e.LayoutCC.getItemPosition(a,!1)),t.Vector2.set(c,h.x,h.y+.05*u),t.Vector2.set(p,h.x,h.y-1.8*u-a*(.25*u)),l&&l.setOpacity(0),t.NodeHelper.setPositionXY(s,p,!1)})).delay(.1*(a+1)).call((function(){t.NodeHelper.setScaleNum(s,o,!1),l&&l.play(!0)})).to(.3,{position:c},{easing:"sineOut"}).to(.1,{position:h},{easing:"sineOut"}).call((function(){l&&l.play(!0,null,!1)})),{position:h}}));n?t.TweenHelper.setDuration(l,0,.03*r):t.TweenHelper.setDuration(l,1,.1*(r+1)),l.start(),r++}else t.NodeHelper.setScaleNum(s,o,!1)},s=0;s<i.length;s++)a(s)},n.hasPlayScaleAnim=function(){return!this.LayoutCC||this.LayoutCC.type!=t.ELayoutType.Vertical||this.LayoutCC.verticalDirection!=t.EVerticalDirection.TopToBottom},n.onAddItem=function(t){this.content.addChild(t)},l(i,[{key:"prefabItem",get:function(){return this.prefabItemDeep?this.prefabItemDeep:this._prefabItem?this._prefabItem:this.prefabItemByUuid?t._resouces.get(this.getPrefabUuidByUrl()):null},set:function(t){this._prefabItem!=t&&(this._prefabItem=t,this.onEditorUpdateData())}},{key:"isPreloadPrefab",get:function(){return this._isPreloadPrefab},set:function(t){this._isPreloadPrefab!=t&&(this._isPreloadPrefab=t,this.updatePreloadPrefab())}},{key:"numItems",get:function(){return this._numItems},set:function(t){this._numItems!=t&&(this._numItems=t,this.onItemCountChange&&this.onItemCountChange(),this.updateItem())}},{key:"runClearItem",get:function(){return this._runClearItem},set:function(t){this._runClearItem!=t&&(this._runClearItem=t)}},{key:"itemScale",get:function(){return this._itemScale},set:function(t){this._itemScale!=t&&(this._itemScale=t,this.updateItem())}},{key:"itemOrginScale",get:function(){return-1!=this._itemScale?this._itemScale:this.prefabItem.data.scale.x}},{key:"itemOrginUITransform",get:function(){return this.prefabItem.data.getComponent(t.UITransform)}},{key:"content",get:function(){return this.node}},{key:"contentUITransform",get:function(){return this.content?t.NodeHelper.getUITransform(this.content):null}},{key:"items",get:function(){return this.content.children}}]),i}(t.BaseComponent);p([t.property({type:t.Prefab,displayName:"子预制体"})],e.prototype,"prefabItem",null),p([t.property({displayName:"绑定加载预制体",visible:function(){return!!this._prefabItem}})],e.prototype,"isPreloadPrefab",null),p([t.property({displayName:"预制体uuid"})],e.prototype,"prefabItemByUuid",void 0),p([t.property({type:t.Prefab,displayName:"引用预制体 方便绑定加载",visible:function(){return!0}})],e.prototype,"prefabItemDeep",void 0),p([t.property({step:1,displayName:"当前个数"})],e.prototype,"numItems",null),p([t.property({displayName:"运行时清空"})],e.prototype,"runClearItem",null),p([t.property({displayName:"使用对象池"})],e.prototype,"isPool",void 0),p([t.property({displayName:"播放动画",tooltip:"layoutCC 为 Vertical && TopToBottom 播放 从下往上动画"})],e.prototype,"isPlayAnim",void 0),p([t.property({displayName:"item缩放"})],e.prototype,"itemScale",null),p([t.property({serializable:!0})],e.prototype,"_isPreloadPrefab",void 0),p([t.property({serializable:!0})],e.prototype,"_numItems",void 0),p([t.property({serializable:!0})],e.prototype,"_itemScale",void 0),p([t.property({serializable:!0})],e.prototype,"_runClearItem",void 0),p([t.property({serializable:!0,editorOnly:!0})],e.prototype,"_prefabItem",void 0),e=p([t.ccclass("CreatePrefabToEditorCC"),t.executeInEditMode,t.menuUI("CreatePrefabToEditorCC")],e),t.CreatePrefabToEditorCC=e}(apeng||(apeng={})),function(t){var e=function(t){this.key=t,this.nodes=[],this.localOpacitys=[],this.childrens=[],this.next=null,this.prev=null},i=function(){function t(){this.items={},this.head=null}var e=t.prototype;return e.set=function(t,e){this.items[e.key]=e,this.head?(e.next=t.next,t.next=e,e.prev=t):this.head=e},e.clear=function(){this.head=null,this.items={}},t}();t.ListCCByRenderQueue=i;var n=function(){function i(){this.enable=!0,this.lists=[],this.queues=[]}var n=i.prototype;return n.init=function(){var e=this;t.director.on(t.Director.EVENT_BEFORE_DRAW,(function(t){for(var i=0;i<e.lists.length;i++){var n=e.lists[i];n.isVisible&&e.start(n,e.queues[i])}})),t.director.on(t.Director.EVENT_AFTER_DRAW,(function(t){for(var i=0;i<e.lists.length;i++){var n=e.lists[i];n.isVisible&&e.end(n,e.queues[i])}e.lists.length=0,e.queues.length=0}))},n.lateUpdate=function(t){this.enable&&(this.lists.push(t),this.queues.push(t.renderQueue))},n.render=function(t,i,n,o,r,a,s,l){void 0===l&&(l=1);var u=i._uiProps,h=u.uiComp;l*=u.localOpacity;var c=o;if(h){c=o+"+"+s+"-"+n,0==s&&(c="t");var p=r.items[c];p||(p=new e(c),r.set(t,p)),t=p;var d=p.nodes,f=p.localOpacitys,y=h.color?h.color.a/255:1;a&&(d.push(i),f.push(u.localOpacity),u.localOpacity=l),l*=y}for(var g=i.children,m=0;m<g.length;m++){var v=!!g[m].active&&a;t=this.render(t,g[m],m,c,r,v,s+1,l)}return t},n.start=function(t,e){for(var i=t.content.children,n=0;n<i.length;n++){var o=i[n];if(o.parent&&o.activeInHierarchy){if(!t.intersectsRectItem(n))continue;this.render(null,o,n,"",e,!0,0)}}t.orginChilds=t.content._children;for(var r=t.content._children=[],a=e.head;a;){for(var s=a.nodes,l=a.childrens,u=0;u<s.length;u++)l[u]=s[u]._children,s[u]._children=[];r.push.apply(r,s),a=a.next}},n.end=function(t,e){t.content._children.length=0,t.content._children=t.orginChilds;for(var i=e.head;i;){for(var n=i.nodes,o=i.childrens,r=i.localOpacitys,a=0;a<n.length;a++){n[a]._children=o[a],n[a]._uiProps.localOpacity=r[a]}o.length=0,n.length=0,i=i.next}e.clear()},i}();t.ListCCByRender=new n;var o=function(){function i(){this.enable=!0,this.parents=[],this.queues=[]}var n=i.prototype;return n.init=function(){var e=this;t.director.on(t.Director.EVENT_BEFORE_DRAW,(function(t){for(var i=0;i<e.parents.length;i++){var n=e.parents[i];n.active&&n.activeInHierarchy&&e.start(n,e.queues[i])}})),t.director.on(t.Director.EVENT_AFTER_DRAW,(function(t){for(var i=0;i<e.parents.length;i++){var n=e.parents[i];n.active&&n.activeInHierarchy&&e.end(n,e.queues[i])}e.parents.length=0,e.queues.length=0}))},n.lateUpdate=function(t,e){this.enable&&(this.parents.push(t),this.queues.push(e))},n.render=function(t,i,n,o,r,a,s){var l=o;l=o+"+"+s+"-"+n,0==s&&(l="t");var u=r.items[l];u||(u=new e(l),r.set(t,u)),t=u;var h=u.nodes;a&&h.push(i);for(var c=i.children,p=0;p<c.length;p++){var d=!!c[p].active&&a;t=this.render(t,c[p],p,l,r,d,s+1)}return t},n.start=function(t,e){for(var i=t.children,n=0;n<i.length;n++){var o=i[n];o.parent&&o.activeInHierarchy&&this.render(null,o,n,"",e,!0,0)}t.orginChilds=t._children;for(var r=t._children=[],a=e.head;a;){for(var s=a.nodes,l=a.childrens,u=0;u<s.length;u++)l[u]=s[u]._children,s[u]._children=[];r.push.apply(r,s),a=a.next}},n.end=function(t,e){t._children.length=0,t._children=t.orginChilds;for(var i=e.head;i;){for(var n=i.nodes,o=i.childrens,r=0;r<n.length;r++)n[r]._children=o[r];o.length=0,n.length=0,i=i.next}e.clear()},i}();t.ListCCByRender2=new o,t.moduleMgr.once(t.moduleMgr.EventType.INSTANCE,(function(){t.ListCCByRender.init(),t.ListCCByRender2.init()}))}(apeng||(apeng={})),function(t){var e=new t.Rectangle,i=new t.Color,n=function(n){function r(){var e;return(e=n.apply(this,arguments)||this).EventType={ADD_ITEM:"ADD_ITEM",RENDER_DELAY:"RENDER_DELAY"},e.backupDescribe="列表",e.removeRender=!0,e.removeRenderByResetSort=!0,e.uiAnimCheck=!0,e.isClickMove=!1,e.btnMoveTop=null,e.btnMoveBottom=null,e.btnMoveLeft=null,e.btnMoveRight=null,e.borderHideBtn=!0,e.maxCountEnableDrag=0,e.renderBoxScale=new t.Vec2(1,1),e.resoucesDelay=!1,e._intervalAddCount=10,e._intervalAddTime=0,e.rectangle=new t.Rectangle,e._delayItems=[],e._items=[],e.contentOrginPosition=new t.Vec3,e._onRenderComplete=!1,e.orginChilds=null,e.renderQueue=new t.ListCCByRenderQueue,e.loadQueueResouces=null,e.isLoadQueueResouces=!1,e.isDragScrolling=!1,e.dragScrollContentY=-1,e.onPositionChange=e.updateRect,e.onSizeChange=e.updateRect,e}o(r,n);var a=r.prototype;return a.itemShow=function(t){return t._intersectsRectItem_},a.onLoad=function(){var e=this;if(n.prototype.onLoad.call(this),t.EDITOR){var i=this.node.getComponent(t.ScrollView);i||((i=this.node.addComponent(t.ScrollView)).horizontal=!1,i.vertical=!0,i.inertia=!0,i.brake=.75,i.elastic=!0,i.bounceDuration=.23,i.content=this.content,i.cancelInnerEvents=!0);var o=this.node.getComponent(t.Mask);o||((o=this.node.addComponent(t.Mask)).inverted=!1,o.type=t.Mask.Type.GRAPHICS_RECT)}else this.addEvent(t.ScrollView.EventType.SCROLLING,this.onEventScrolling,this,this.node),this.Layout&&this.addEvent(t.Node.EventType.SIZE_CHANGED,(function(){return e.setVisibleByRectangeListView(!1)}),this,this.Layout.node),this.btnMoveTop&&(t.EventHandlerCC.onClick(this.btnMoveTop,(function(){e.node.active&&e.enabled&&e.ScrollView.scrollToTop(1,!0)}),this),this.btnMoveTop.active=!1),this.btnMoveBottom&&(t.EventHandlerCC.onClick(this.btnMoveBottom,(function(){e.node.active&&e.enabled&&e.ScrollView.scrollToBottom(1,!0)}),this),this.btnMoveBottom.active=!1),this.btnMoveLeft&&(t.EventHandlerCC.onClick(this.btnMoveLeft,(function(){e.node.active&&e.enabled&&e.ScrollView.scrollToLeft(1,!0)}),this),this.btnMoveLeft.active=!1),this.btnMoveRight&&(t.EventHandlerCC.onClick(this.btnMoveRight,(function(){e.node.active&&e.enabled&&e.ScrollView.scrollToRight(1,!0)}),this),this.btnMoveRight.active=!1),this.updateRect(),this.scheduleOnceCover(this.updateRect,0),this.content.getPosition(this.contentOrginPosition),this.ScrollBar&&(this.ScrollView.vertical&&(this.ScrollView.verticalScrollBar=this.ScrollBar),this.ScrollView.horizontal&&(this.ScrollView.horizontalScrollBar=this.ScrollBar)),this.isLoadQueueResouces=!!this.prefabItem.data.getComponent("ListCCByBaseItemCC")},a.onEnable=function(){n.prototype.onEnable.call(this),this.updateItem(),this.setVisibleByRectangeListView(!1),this.updateScrollBar(),this.isDragScrolling=!1,this.dragScrollContentY=this.content.position.y},a.onDisable=function(){this.clearLoadResoucesQueue();var t=this._numItems;this.clearAll(),this._numItems=t,n.prototype.onDisable.call(this)},a.lateUpdate=function(e){this.removeRender&&this.removeRenderByResetSort&&t.ListCCByRender.lateUpdate(this)},a.updateRect=function(){this.getRectangle(this.rectangle,!0,!0),this.rectangle.mulSelf(this.renderBoxScale),this.setVisibleByRectangeListView(!1)},a.otherAnimComplete=function(t,e){this.isPlayAnim&&(this.uiAnimCheck?t?(this.isRenderItems=!1,this.numItems=0):"one"==e?(this.updateRect(),this.isRenderItems=!0,this.render(this._renderData.datas,this._renderData.comp,this._renderData.render,this._renderData.sort,this._renderData.sortChangDatas),this.node.emit(this.EventType.RENDER_DELAY)):"two"==e&&(this.updateRect(),this.updateScrollBar(),this.scheduleOnceCover(this.setVisibleByRectangeListView,.1)):"two"==e&&this.updateRect())},a.updateScrollBar=function(){if(this.ScrollBar){var e=this.ScrollBar.getComponent(t.Sprite);e&&(i.set(e.color),i.a=255,e.color=i),this.ScrollBar._opacity=255,this.ScrollBar.onScroll(t.Vec2.ZERO),this.ScrollView._updateScrollBarState()}},a.clearAll=function(){var e=this;t._timer&&(t._timer.deleteDirtyMark("setVisibleByRectangeListView"),t._timer.clearAll(this)),t.Sets.forEach(this._delayItems,(function(t){e.removeItem(t)}),!0),t.Sets.forEach(this.items,(function(t){e.removeItem(t)}),!0),this._delayItems.length=0},a.onUpdateItem=function(){this._numItems>this.maxCountEnableDrag?this.ScrollView.enabled=!0:(this.ScrollView.enabled=!1,this.content.setPosition(this.contentOrginPosition)),this.setVisibleByRectangeListView(!1),this.updateScrollBar()},a.onAddItem=function(e){e._intersectsRectItem_=!1,t.EDITOR||0==this._intervalAddTime?this.addItemToScene(e):(this._delayItems.push(e),t._timer.loop(this,this._delayAddItem,this._intervalAddTime,-1))},a._delayAddItem=function(){if(this.isVisible){var e=this._delayItems.splice(0,this._intervalAddCount);if(0==e.length)console.log("delay addItem complete"),t._timer.clear(this,this._delayAddItem);else for(var i,n=u(e);!(i=n()).done;){var o=i.value;this.addItemToScene(o)}}else this.clearAll()},a.addItemToScene=function(t){var e=this.items.length;this.content.addChild(t),this.LayoutCC&&this.LayoutCC.updateItemPosition(e),this.setVisibleByRectangeListView(!0,e),this.node.emit(this.EventType.ADD_ITEM,t)},a.onEventScrolling=function(){this.setVisibleByRectangeListView(!0),Math.abs(this.dragScrollContentY-this.content.position.y)>3&&(this.isDragScrolling=!0)},a.updateClickBtnMove=function(e){if(void 0===e&&(e=4),this.borderHideBtn&&this.isVisible){var i=this.ScrollView.getScrollOffset(),n=i.y,o=i.x;this.btnMoveTop&&(this.btnMoveTop.active=n>=e),this.btnMoveBottom&&(this.btnMoveBottom.active=this.getYMax(!0)-t.NodeHelper.getYMax(this.content,!0)<-e),this.btnMoveLeft&&(this.btnMoveLeft.active=o<e),this.btnMoveRight&&(this.btnMoveRight.active=this.getXMax(!0)-t.NodeHelper.getXMax(this.content,!0)<-e)}},a.setVisibleByRectangeListView=function(e,i){if(void 0===i&&(i=-1),!t.EDITOR&&(!e||t._timer.dirtyMark("setVisibleByRectangeListView"))){if(this.updateClickBtnMove(),!this.removeRender)return;if(!this.removeRenderByResetSort)if(-1==i)for(var n=0,o=this.items;n<=o.length;n++)this.setVisibleItem(n);else this.setVisibleItem(i)}},a.setVisibleItem=function(t){if(this.removeRender&&!this.removeRenderByResetSort){var e=this.items[t];if(e&&e.parent){var i=this.intersectsRectItem(t);this.LayoutCC?e.active=i:this.Layout&&this.setItemVisible(e,i)}}},a.setItemVisible=function(e,i){if(this.removeRender&&!this.removeRenderByResetSort){var n=e.getComponentInChildren(t.ListCCByLayoutItemRenderCC);if(n)n.node.active=i;else{t.NodeHelper.setOpacity(e,i?1:0);var o=function(e){var n=e.getComponent(t.UIRenderer);n&&(n.enabled=i)};o(e),t.NodeHelper.walkAllDeepChild(e,o)}}},a.onRenderComplete=function(){if(this.scheduleOnceCover(this.setVisibleByRectangeListView,.1),!this._onRenderComplete&&this.isLoadQueueResouces){var e=.12;this.resoucesDelay&&(e=t.TweenHelper.UISHowScaleDuration+.01),this.scheduleOnceCover(this.onDelayRenderComplete,e)}},a.renderComplete=function(){this.unschedule(this.onDelayRenderComplete),this.onDelayRenderComplete()},a.onDelayRenderComplete=function(){var t=this;if(this.loadQueueResouces){this.dragScrollContentY=this.content.position.y,this.isDragScrolling=!1,this._onRenderComplete=!0;for(var e=this.items,i=function(){var i=e[n];t.loadQueueResouces.add((function(t){i.getComponent("ListCCByBaseItemCC").listInit(),t()})),t.checkLoadResouces(n)},n=0;n<e.length;n++)i();this.loadQueueResouces.run()}},a.onRenderBefore=function(){this.dragScrollContentY=this.content.position.y,this.isDragScrolling=!1,this._onRenderComplete=!1,this.isLoadQueueResouces&&(this.clearLoadResoucesQueue(),this.loadQueueResouces=t.Queue.pool.get(),this.loadQueueResouces.interval=2,this.loadQueueResouces.complete=this.clearLoadResoucesQueue.bind(this))},a.clearLoadResoucesQueue=function(){this.unschedule(this.onDelayRenderComplete),this.loadQueueResouces&&(t.Queue.pool.put(this.loadQueueResouces),this.loadQueueResouces=null)},a.checkLoadResouces=function(t){return!!this._onRenderComplete&&(!!this.isLoadQueueResouces&&(!!(this.items[t]._intersectsRectItem_&&this.loadQueueResouces&&this.loadQueueResouces.has(t))&&(this.loadQueueResouces.runIndex(t),!0)))},a.intersectsRectItem=function(i){var n=this.items[i];this.LayoutCC?this.LayoutCC.getItemRectange(e,i,!0):this.Layout&&t.NodeHelper.getRectangle(e,n,!0,!1);var o=n._intersectsRectItem_=e.intersects(this.rectangle);return this._onRenderComplete||t.CreatePrefabToEditorCC.itemAnimIgnore(n,!o),this.checkLoadResouces(i),o},a.containsRectItem=function(i){return this.LayoutCC?this.LayoutCC.getItemRectange(e,i,!0):this.Layout&&t.NodeHelper.getRectangle(e,this.items[i],!0,!1),this.rectangle.containsRect(e)},a.setContentPosition=function(t,e){this.content.setPosition(t,e),this.setVisibleByRectangeListView(!1)},a.setContentDeviation=function(t,e){var i=this.content.getPosition();this.content.setPosition(i.x+t,i.y+e)},l(r,[{key:"intervalAddTime",get:function(){return this._intervalAddTime},set:function(t){this._intervalAddTime!=t&&(this._intervalAddTime=t)}},{key:"intervalAddCount",get:function(){return this._intervalAddCount},set:function(t){this._intervalAddCount!=t&&(this._intervalAddCount=t)}},{key:"content",get:function(){return this.getChildByCreate("content",(function(e){e.addComponent("LayoutCC"),e.addComponent(t.Widget)}),-1,!0)}},{key:"items",get:function(){return 0==this._intervalAddTime?this.content.children:(this._items.length=0,(t=this._items).push.apply(t,this.content.children),(e=this._items).push.apply(e,this._delayItems),this._items);var t,e}}]),r}(t.CreatePrefabToEditorCC);p([t.property({tooltip:"0不启用, 调用addItem时 会延迟添加到场景中",displayName:"分帧加载间隔时间"})],n.prototype,"intervalAddTime",null),p([t.property({step:1,min:1,displayName:"分帧加载个数",visible:function(){return 0!=this.intervalAddTime}})],n.prototype,"intervalAddCount",null),p([t.property({displayName:"不可见移除渲染队列"})],n.prototype,"removeRender",void 0),p([t.property({tooltip:"item每层分开渲染，合并dc 反之只隐藏",displayName:"渲染重排序",visible:function(){return this.removeRender}})],n.prototype,"removeRenderByResetSort",void 0),p([t.property({displayName:"弹窗动画延检测"})],n.prototype,"uiAnimCheck",void 0),p([t.property({displayName:"点击滚动"})],n.prototype,"isClickMove",void 0),p([t.property({type:t.Node,displayName:"点击滑动顶部",visible:function(){return this.isClickMove}})],n.prototype,"btnMoveTop",void 0),p([t.property({type:t.Node,displayName:"点击滑动底部",visible:function(){return this.isClickMove}})],n.prototype,"btnMoveBottom",void 0),p([t.property({type:t.Node,displayName:"点击滑动左边",visible:function(){return this.isClickMove}})],n.prototype,"btnMoveLeft",void 0),p([t.property({type:t.Node,displayName:"点击滑动右边",visible:function(){return this.isClickMove}})],n.prototype,"btnMoveRight",void 0),p([t.property({displayName:"边界隐藏按钮",visible:function(){return this.isClickMove}})],n.prototype,"borderHideBtn",void 0),p([t.property({displayName:"超过指定个数开启拖动"})],n.prototype,"maxCountEnableDrag",void 0),p([t.property({displayName:"渲染区域缩放"})],n.prototype,"renderBoxScale",void 0),p([t.property({displayName:"资源加载延迟"})],n.prototype,"resoucesDelay",void 0),p([t.property({serializable:!0})],n.prototype,"_intervalAddCount",void 0),p([t.property({serializable:!0})],n.prototype,"_intervalAddTime",void 0),n=p([t.ccclass("ListCC"),t.executeInEditMode,t.menuList("ListCC")],n),t.ListCC=n}(apeng||(apeng={})),function(t,e){var i,n=new t.EventTouch([],!1,""),o=((e={})[t.Input.EventType.TOUCH_START]=t.Input.EventType.MOUSE_DOWN,e[t.Input.EventType.TOUCH_MOVE]=t.Input.EventType.MOUSE_MOVE,e[t.Input.EventType.TOUCH_END]=t.Input.EventType.MOUSE_UP,e[t.Input.EventType.TOUCH_CANCEL]=t.Input.EventType.MOUSE_UP,e),r=(t.Node.EventType.TOUCH_START,t.Node.EventType.TOUCH_END,t.Node.EventType.TOUCH_MOVE,t.Node.EventType.MOUSE_DOWN,t.Node.EventType.MOUSE_MOVE,t.Node.EventType.MOUSE_UP,t.Node.EventType.MOUSE_ENTER,t.Node.EventType.MOUSE_LEAVE,t.Node.EventType.MOUSE_WHEEL,i=function(){function e(){this.event=new t.EventHandler,this.events=[],this.emitHandler=null,this._addEvents=[]}e.stopPropagation=function(t){t.propagationStopped=!0},e.onClick=function(e,n,o){this.offClick(e,n,o);var r=e.getComponent("ButtonCC");if(r)r.eventHandler.addEvent({caller:o,callBack:n});else{var a=function(e){if(i.enableClick){i.stopPropagation(e);var r=n.call(o,e);void 0!==r&&!0!==r||i.clickSoundUrl&&t._audio.play(i.clickSoundUrl)}};this.getCallBacks(e).push({callBack:n,caller:o,fn:a}),e.on(t.Node.EventType.TOUCH_END,a,o),e.getComponent(t.BlockInputEvents)||e.addComponent(t.BlockInputEvents)}},e.offClick=function(e,i,n){var o=e.getComponent("ButtonCC");if(o)o.eventHandler.offEvent({caller:n,callBack:i});else{var r=this.getCallBacks(e),a=t.Sets.filterValue(r,(function(t){return t.callBack==i&&t.caller==n}));a&&(t.Sets.delete(r,a),e.off(t.Node.EventType.TOUCH_END,a.fn,a.caller))}},e.offAllClick=function(e){var i=e.getComponent("ButtonCC");if(i)i.eventHandler.offAllEvent();else{var n=this.getCallBacks(e);t.Sets.forEach(n,(function(i){t.Sets.delete(n,i),e.off(t.Node.EventType.TOUCH_END,i.fn,i.caller)}),!0)}},e.getCallBacks=function(t){var e=t.onClickByCallBack;return null==e&&(e=t.onClickByCallBack=[]),e},e.runClick=function(t,e){var i=t.getComponent("ButtonCC");if(i)i.onTouchStart(e),i.onTouchEnd(e);else for(var n,o=u(this.getCallBacks(t));!(n=o()).done;){n.value.fn(e)}},e.dispatchEvent=function(t,e,i,o,r){void 0===o&&(o=null),n._touches=e.getTouches(),n.touch=e.touch,n.bubbles=e.bubbles,n.type=i,void 0!==r&&(e.eventPhase=Event.CAPTURING_PHASE),n.simulate=!1,n.emitData=o,t.dispatchEvent(n)};var o=e.prototype;return o.emit=function(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];var r=!0;if(!this.isCall)return r;if(null==this.emitHandler){this.emitHandler=[];for(var a,s=u(this.events);!(a=s()).done;){var l=a.value;l&&this.emitHandler.push(l)}this.emitHandler.push(this.event)}(e=t.EventHandler).emitEvents.apply(e,[this.emitHandler].concat(n));for(var h,c=u(this._addEvents);!(h=c()).done;){var p,d=h.value;n=n.slice(),d.args&&(p=n).push.apply(p,d.args),d.caller?!1===d.callBack.apply(d.caller,n)&&(r=!1):!1===d.callBack.apply(d,n)&&(r=!1)}return r},o.addEvent=function(e){t.Sets.filterValue(this._addEvents,(function(t){return t.caller==e.caller&&t.callBack==e.callBack}))||this._addEvents.push(e)},o.offEvent=function(e){var i=t.Sets.filterValue(this._addEvents,(function(t){return t.caller==e.caller&&t.callBack==e.callBack}));i&&t.Sets.delete(this._addEvents,i)},o.offAllEvent=function(){var e=this;t.Sets.forEach(this._addEvents,(function(t){e.offEvent(t)}),!0)},l(e,[{key:"isCall",get:function(){return!!this.event.handler||(this.events.length>0||this._addEvents.length>0)}}]),e}());r.enableClick=!0,r.touchIsMove=!1,r.touchIsMoveRun=!1,r.clickSoundUrl="",r.touchEvent=new(function(){function e(){}var i=e.prototype;return i.on=function(e,i,n){return t.sys.hasFeature(t.sys.Feature.INPUT_TOUCH)&&t.input._touchInput._eventTarget.on(e,i,n),t.sys.hasFeature(t.sys.Feature.EVENT_MOUSE)&&t.input._mouseInput._eventTarget.on(o[e],i,n),this},i.off=function(e,i,n){return t.sys.hasFeature(t.sys.Feature.INPUT_TOUCH)&&t.input._touchInput._eventTarget.off(e,i,n),t.sys.hasFeature(t.sys.Feature.EVENT_MOUSE)&&t.input._mouseInput._eventTarget.off(o[e],i,n),this},e}()),p([t.property({type:t.EventHandler,displayName:"单事件"})],r.prototype,"event",void 0),p([t.property({type:[t.EventHandler],displayName:"事件池",visible:function(){return this.event.target}})],r.prototype,"events",void 0),r=i=p([t.ccclass("EventHandlerCC")],r),t.EventHandlerCC=r}(apeng||(apeng={})),function(t){var e=function(){function t(){this.cb=null,this._cb=null}var e=t.prototype;return e.set=function(t){void 0===t&&(t=null),this.cb=t,this._cb=t},e.run=function(){var t=this.cb;return this.cb=null,t?t.apply(void 0,arguments):null},e.clear=function(){this.cb=null},t}();t.CompleteCallBack=e}(apeng||(apeng={})),function(t){var e,i=e=function(){function i(){this.delay=0,this.eventHandler=new t.EventHandlerCC}return i.create=function(t,i){var n=new e;return n.delay=t,n.eventHandler.addEvent(i),n},i}();p([t.property({displayName:"延迟时长"})],i.prototype,"delay",void 0),p([t.property({type:t.EventHandlerCC,displayName:"触发回调"})],i.prototype,"eventHandler",void 0),i=e=p([t.ccclass("AnimtorCCStateItemFrame")],i),t.AnimtorCCStateItemFrame=i;var n=function(){function e(){this.animName="",this.crossFade=0,this.finishPlayName="",this.eventHandlerFinish=new t.EventHandlerCC,this.frames=[],this.animtor=null}var i=e.prototype;return i.play=function(){var t=this;0!=this.crossFade?this.animtor.anim.crossFade(this.animName,this.crossFade):this.animtor.anim.play(this.animName);for(var e,i=function(){var i=e.value;0!=i.delay&&i.eventHandler.isCall&&t.animtor.scheduleOnce((function(){t.animtor.curPlayAnimName==t.animName&&i.eventHandler.emit()}),i.delay)},n=u(this.frames);!(e=n()).done;)i()},i.onFinish=function(){this.eventHandlerFinish.emit(),this.finishPlayName&&this.animtor.play(this.finishPlayName)},e}();p([t.property({displayName:"clip名"})],n.prototype,"animName",void 0),p([t.property({displayName:"切换过渡时间"})],n.prototype,"crossFade",void 0),p([t.property({displayName:"播放完后继续播放"})],n.prototype,"finishPlayName",void 0),p([t.property({type:t.EventHandlerCC,displayName:"播放完成"})],n.prototype,"eventHandlerFinish",void 0),p([t.property({type:[i],displayName:"帧事件"})],n.prototype,"frames",void 0),n=p([t.ccclass("AnimtorCCStateItem")],n),t.AnimtorCCStateItem=n;var r=function(e){function r(){var i;return(i=e.apply(this,arguments)||this).backupDescribe="动画组件",i.anim=null,i.autoPlay=!1,i.animCompleteUpdateList=null,i.items=[],i.curPlayAnimName="",i.curPlayAnimNameCb=new t.CompleteCallBack,i.itemsMap={},i}o(r,e);var a=r.prototype;return a.onLoad=function(){if(e.prototype.onLoad.call(this),t.EDITOR)this.anim||(this.anim=this.getComponent(t.Animation));else{for(var i,n=u(this.items);!(i=n()).done;){i.value.animtor=this}this.addEvent(t.Animation.EventType.FINISHED,this.onEventAnimFinish,this,this.anim)}},a.onEnable=function(){e.prototype.onEnable.call(this),t.EDITOR||this.autoPlay&&this.playDefault()},a.onDisable=function(){this.isPersistRootNode||(this.curPlayAnimName="",this.curPlayAnimNameCb.clear()),e.prototype.onDisable.call(this)},a.getClipIndexByName=function(t){if(!this.anim)return"";var e=null;if(null==t)for(var i,n=u(this.anim.clips);!(i=n()).done;){var o=i.value;if(o){e=o;break}}else e=this.anim.clips[t];return e.name},a.addStateFrameEvent=function(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var r=this.getStateItem(t);r.frames[o]?r.frames[o].eventHandler.addEvent(e):r.frames[o]=i.create(n,e)},a.getStateItem=function(t){var e=this.getAnimNameByItem(t);return e||((e=new n).animName=t,e.animtor=this,this.items.push(e)),e},a.getAnimNameByItem=function(e){return this.itemsMap[e]||(this.itemsMap[e]=t.Sets.filterValue(this.items,(function(t){return t.animName==e}))),this.itemsMap[e]},a.play=function(t,e,i,n){if(void 0===e&&(e=0),this.anim&&t){this.curPlayAnimName=t,this.curPlayAnimNameCb.set(i),null!=n&&this.setAnimSpeed(t,n),this.animCompleteUpdateList&&this.animCompleteUpdateList.otherAnimComplete(!0);var o=this.getAnimNameByItem(t);o?o.play():0!=e?this.anim.crossFade(t,e):this.anim.play(t)}},a.hasPlayComplete=function(t){void 0===t&&(t="");var e=this.getCurState();return!e||(!(!t||e.name==t)||e.isPlaying)},a.changeState=function(t){this.curPlayAnimName!=t&&this.play(t)},a.setAnimSpeed=function(t,e){if(this.anim&&t&&null!=e){var i=this.anim.getState(t);i&&(i.speed=e)}},a.getCurState=function(){return this.getState(this.curPlayAnimName)},a.getState=function(t){if(this.anim)return this.anim.getState(t)},a.setAnimDurationBySpeed=function(t,e){if(this.anim&&t&&e){var i=this.anim.getState(t);this.setAnimSpeed(t,i.duration/e)}},a.pause=function(t){var e;t||(t=this.getClipIndexByName()),null===(e=this.getState(t))||void 0===e||e.pause()},a.resume=function(t){var e;t||(t=this.getClipIndexByName()),null===(e=this.getState(t))||void 0===e||e.resume()},a.playDefault=function(t){this.play(this.getClipIndexByName(),0,t)},a.getDefaultClip=function(){return this.anim?this.anim.clips[0]:null},a.stop=function(){this.anim&&this.anim.stop()},a.onEventAnimFinish=function(t,e){if(e.clip.name==this.curPlayAnimName){var i=this.getAnimNameByItem(e.clip.name);i&&i.onFinish(),this.curPlayAnimNameCb.run(),this.animCompleteUpdateList&&this.animCompleteUpdateList.otherAnimComplete(!1)}},r}(t.BaseComponent);p([t.property({type:t.Animation,displayName:"动画组件"})],r.prototype,"anim",void 0),p([t.property({displayName:"显示时播放动画"})],r.prototype,"autoPlay",void 0),p([t.property({type:t.ListCC,displayName:"播放完成 更新rect"})],r.prototype,"animCompleteUpdateList",void 0),p([t.property({type:[n],displayName:"配置"})],r.prototype,"items",void 0),r=p([t.ccclass("AnimtorCC"),t.executeInEditMode,t.menuAnim("AnimtorCC")],r),t.AnimtorCC=r}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).backupDescribe="自动撑开目标节点Size",t.target=null,t.autoWidth=!1,t.autoHeight=!1,t.widgets=[],t._paddingWidth=0,t._ratioWidth=1,t._paddingHeight=0,t._ratioHeight=1,t.onEditorUpdateData=t.onSizeChange,t.isSizeChangeUpdate=!0,t}o(i,e);var n=i.prototype;return n.onLoad=function(){e.prototype.onLoad.call(this),t.EDITOR&&(this.target||(this.target=this.node.parent))},n.onEnable=function(){e.prototype.onEnable.call(this),this.onSizeChange()},n.onSizeChange=function(){this.isSizeChangeUpdate&&this.updateView()},n.updateView=function(){if(this.target){var e=this.getSize(),i=null,n=null,o=t.NodeHelper.getUITransform(this.target);if(this.autoWidth){var r=e.width*this.getScale(!1).x*this._ratioWidth+this._paddingWidth;o.width!=r&&(i=r)}if(this.autoHeight){var a=e.height*this.getScale(!1).y*this._ratioHeight+this._paddingHeight;o.height!=a&&(n=a)}t.NodeHelper.setSize(this.target,i,n),null==i&&null==n||this.scheduleOnceCover(this.updateRender),this.updateWidget(),t.EDITOR||this.scheduleOnceCover(this.updateWidget)}},n.updateRender=function(){var e=t.NodeHelper.getUIRenderer(this.target);e&&e.markForUpdateRenderData()},n.updateWidget=function(){for(var t,e=u(this.widgets);!(t=e()).done;){var i=t.value;i&&i.updateAlignment()}},n.getSize=function(){return this.UITransform.contentSize},l(i,[{key:"paddingWidth",get:function(){return this._paddingWidth},set:function(t){this._paddingWidth=t,this.onSizeChange()}},{key:"ratioWidth",get:function(){return this._ratioWidth},set:function(t){this._ratioWidth=t,this.onSizeChange()}},{key:"paddingHeight",get:function(){return this._paddingHeight},set:function(t){this._paddingHeight=t,this.onSizeChange()}},{key:"ratioHeight",get:function(){return this._ratioHeight},set:function(t){this._ratioHeight=t,this.onSizeChange()}}]),i}(t.BaseComponent);p([t.property({type:t.Node,tooltip:"自动对齐父节点",displayName:"对齐的节点"})],e.prototype,"target",void 0),p([t.property({displayName:"自动对齐宽"})],e.prototype,"autoWidth",void 0),p([t.property({displayName:"宽的边距",visible:function(){return this.autoWidth}})],e.prototype,"paddingWidth",null),p([t.property({displayName:"宽的比率",visible:function(){return this.autoWidth}})],e.prototype,"ratioWidth",null),p([t.property({displayName:"自动对齐高"})],e.prototype,"autoHeight",void 0),p([t.property({displayName:"高的边距",visible:function(){return this.autoHeight}})],e.prototype,"paddingHeight",null),p([t.property({displayName:"高的比率",visible:function(){return this.autoHeight}})],e.prototype,"ratioHeight",null),p([t.property({type:[t.Widget],displayName:"更新Widget"})],e.prototype,"widgets",void 0),p([t.property({serializable:!0})],e.prototype,"_paddingWidth",void 0),p([t.property({serializable:!0})],e.prototype,"_ratioWidth",void 0),p([t.property({serializable:!0})],e.prototype,"_paddingHeight",void 0),p([t.property({serializable:!0})],e.prototype,"_ratioHeight",void 0),e=p([t.ccclass("AutoTargetSizeCC"),t.executeInEditMode,t.menuUI("AutoTargetSizeCC")],e),t.AutoTargetSizeCC=e}(apeng||(apeng={})),function(t){var e=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).backupDescribe="按钮置灰时排除当前或所有子节点",e}return o(e,t),e}(_cc_.Component);e=p([t.ccclass("ButtonByChildGrayExcludeCC"),t.menuBtn("ButtonByChildGrayExcludeCC")],e),t.ButtonByChildGrayExcludeCC=e}(apeng||(apeng={})),function(t){var e=new t.Vec2,i=[t.Node.EventType.MOUSE_DOWN,t.Node.EventType.MOUSE_MOVE,t.Node.EventType.MOUSE_UP,t.Node.EventType.MOUSE_ENTER,t.Node.EventType.MOUSE_LEAVE,t.Node.EventType.MOUSE_WHEEL],n=function(n){function r(){var e;return(e=n.apply(this,arguments)||this).backupDescribe="按钮组件",e.isPlayAudio=!0,e.isPlayAnimPress=!0,e.pressDuration=.1,e.pressScale=1.2,e.coolingTime=.2,e.breatheLinear=!1,e.uiUrl="",e.globalControl=!0,e.eventHandler=new t.EventHandlerCC,e._isGray=!1,e._isPlayBreathe=!1,e._interactable=!0,e._originalScale=new t.Vec3,e._transitionFinished=!0,e._time=0,e._targetScale=new t.Vec3,e._fromScale=new t.Vec3,e._toScale=new t.Vec3,e._pressed=!1,e._isCooling=!1,e._playBreathe=!1,e._playPress=!1,e.tweenType=t.ETweenType.None,e}o(r,n);var a=r.prototype;return a.onLoad=function(){n.prototype.onLoad.call(this),this.node.getScale(this._originalScale),this.clearData(),this.tweenType=this.breatheLinear?t.ETweenType.BreatheLinear:t.ETweenType.Breathe,this._isPlayBreathe&&(this._playBreathe=!0),this.isPlayAnimPress&&(this._playPress=!0);for(var e=0,o=i;e<o.length;e++){var r=o[e];this.addEvent(r,t.EventHandlerCC.stopPropagation,t.EventHandlerCC,this.node)}},a.onEnable=function(){n.prototype.onEnable.call(this),this.clearData(),this.updateScale(),this.gray(this._isGray)},a.onDisable=function(){n.prototype.onDisable.call(this),this.clearData()},a.onUpdate=function(){if(!this._transitionFinished&&this.isPlayAnimPress){this._time+=t._timer.dtDefault;var e=1;(e=this._time/this.pressDuration)>=1&&(e=1),this.node.getScale(this._targetScale),this._targetScale.x=t.lerp(this._fromScale.x,this._toScale.x,e),this._targetScale.y=t.lerp(this._fromScale.y,this._toScale.y,e),this.node.setScale(this._targetScale),e>=1&&(this._transitionFinished=!0)}},a.setStopClick=function(t,e,i){void 0===i&&(i=!0),i&&(this._isGray=t),this._playBreathe&&(this._isPlayBreathe=!t),this._playPress&&(this.isPlayAnimPress=!t),e&&(this.interactable=!t),this.clearData(),this.updateScale(),this.gray(this._isGray)},a.onTouchStart=function(e){this.hasEmitEvent()&&(this._pressed=!0,this.updateScale(),t.EventHandlerCC.stopPropagation(e))},a.onTouchMove=function(i){if(this.hasEmitEvent()&&this._pressed&&i){var n=i.touch;if(n)this.UITransform.isHit(n.getUILocation(e))?(t.Vec3.copy(this._fromScale,this._originalScale),t.Vec3.multiplyScalar(this._toScale,this._originalScale,this.pressScale),this._transitionFinished=!1):(this._time=0,this.node.setScale(this._originalScale),this._transitionFinished=!0),t.EventHandlerCC.stopPropagation(i)}},a.onTouchEnd=function(e){if(this.hasEmitEvent()){if(this._isCooling=!0,this.coolingTime<=0?this.onTouchNodeEndTimerOnce():this.scheduleOnceCover(this.onTouchNodeEndTimerOnce,this.coolingTime),this._pressed)this.eventHandler.emit(e)&&this.isPlayAudio&&t.EventHandlerCC.clickSoundUrl&&t._audio.play(t.EventHandlerCC.clickSoundUrl),this.uiUrl&&t._ui.open(this.uiUrl,null,null,null,!0);this._pressed=!1,this.updateScale(),t.EventHandlerCC.stopPropagation(e)}},a.onTouchCancel=function(t){this.hasEmitEvent()&&(this._pressed=!1,this.updateScale())},a.updateScale=function(){if(!t.EDITOR){if(t.TweenHelper.stop(this.node,this.tweenType),this._pressed)t.Vec3.copy(this._fromScale,this._originalScale),t.Vec3.multiplyScalar(this._toScale,this._originalScale,this.pressScale),this._isPlayBreathe&&(this.node.setScale(this._originalScale),t.TweenHelper.stop(this.node,this.tweenType));else if(this.node.getScale(this._fromScale),t.Vec3.copy(this._toScale,this._originalScale),this._isPlayBreathe)return this.node.setScale(this._originalScale),void t.TweenHelper.default(this.node,this.tweenType);this._time=0,this._transitionFinished=!1}},a.onTouchNodeEndTimerOnce=function(){this._isCooling=!1},a.clearData=function(){t.TweenHelper.stop(this.node,this.tweenType),this._pressed=!1,this._time=0,this._isCooling=!1,t.EDITOR||this.node.setScale(this._originalScale)},a.hasEmitEvent=function(){return!!this._interactable&&(!!this.enabledInHierarchy&&(!t.EventHandlerCC.enableClick&&this.globalControl?(console.log("buttonCC event close, ButEnabled = "+t.EventHandlerCC.enableClick),!1):!this._isCooling||(console.log("buttonCC cooling"),!1)))},l(r,[{key:"isPlayBreathe",get:function(){return this._isPlayBreathe},set:function(t){this._isPlayBreathe!=t&&(this._isPlayBreathe=t,this.updateScale(),this._interactable||this.clearData())}},{key:"isGray",get:function(){return this._isGray},set:function(t){this._isGray!=t&&(this._isGray=t,this.gray(this._isGray),this.updateScale())}},{key:"interactable",get:function(){return this._interactable},set:function(t){(this._interactable=t)||(this._interactable=t,this.updateScale(),this._interactable||this.clearData())}}]),r}(t.BaseComponent);p([t.property({displayName:"播放音效"})],n.prototype,"isPlayAudio",void 0),p([t.property({displayName:"按压效果"})],n.prototype,"isPlayAnimPress",void 0),p([t.property({displayName:"按压过渡时间",visible:function(){return this.isPlayAnimPress}})],n.prototype,"pressDuration",void 0),p([t.property({displayName:"按压缩放的大小",visible:function(){return this.isPlayAnimPress}})],n.prototype,"pressScale",void 0),p([t.property({displayName:"冷却时间"})],n.prototype,"coolingTime",void 0),p([t.property({displayName:"播放呼吸动画"})],n.prototype,"isPlayBreathe",null),p([t.property({displayName:"线性呼吸",visible:function(){return this._isPlayBreathe}})],n.prototype,"breatheLinear",void 0),p([t.property({displayName:"置灰"})],n.prototype,"isGray",null),p([t.property({displayName:"响应事件"})],n.prototype,"interactable",null),p([t.property({displayName:"打开ui路径"})],n.prototype,"uiUrl",void 0),p([t.property({tooltip:"进入EventHandlerCC.enableClick控制",displayName:"全局控制"})],n.prototype,"globalControl",void 0),p([t.property({type:t.EventHandlerCC,displayName:"派发事件"})],n.prototype,"eventHandler",void 0),p([t.property({serializable:!0})],n.prototype,"_isGray",void 0),p([t.property({serializable:!0})],n.prototype,"_isPlayBreathe",void 0),p([t.property({serializable:!0})],n.prototype,"_interactable",void 0),n=p([t.ccclass("ButtonCC"),t.menuBtn("ButtonCC")],n),t.ButtonCC=n}(apeng||(apeng={})),function(t){var e=function(){function e(t,e,i){return void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),this.radius=1,this.phi=0,this.theta=0,this.radius=t,this.phi=e,this.theta=i,this}var i=e.prototype;return i.set=function(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this},i.copy=function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},i.makeSafe=function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},i.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},i.setFromCartesianCoords=function(e,i,n){return this.radius=Math.sqrt(e*e+i*i+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(t.math.clamp(i/this.radius,-1,1))),this},i.clone=function(){return(new e).copy(this)},i.toVec3=function(t){var e=this.phi,i=this.radius,n=this.theta,o=Math.sin(e)*i;return t.x=o*Math.sin(n),t.y=Math.cos(e)*i,t.z=o*Math.cos(n),this},e}(),i=-1,n=t.math.EPSILON,r=2*Math.PI,a=(new t.Vec3,new t.Vec3,new t.Vec2),s=new t.Vec2,u=new t.Vec2,h=new t.Vec2,c=function(c){function p(){var n;return(n=c.apply(this,arguments)||this).target=new t.Vec3,n.minDistance=0,n.maxDistance=9999999,n.isAutoEvent=!0,n.minPolarAngle=0,n.maxPolarAngle=Math.PI,n.minAzimuthAngle=-1/0,n.maxAzimuthAngle=1/0,n.enableDamping=!1,n.dampingFactor=.05,n.enableZoom=!0,n.zoomSpeed=1,n.enableRotate=!0,n.rotateSpeed=1,n.enablePan=!0,n.panSpeed=1,n.screenSpacePanning=!0,n.keyPanSpeed=7,n.autoRotate=!1,n.autoRotateSpeed=2,n.object=null,n.camera=null,n.state=i,n.spherical=new e,n.sphericalDelta=new e,n.scale=1,n.panOffset=new t.Vec3,n.zoomChanged=!1,n.rotateStart=new t.Vec2,n.rotateEnd=new t.Vec2,n.rotateDelta=new t.Vec2,n.panStart=new t.Vec2,n.panEnd=new t.Vec2,n.panDelta=new t.Vec2,n.dollyStart=new t.Vec2,n.dollyEnd=new t.Vec2,n.dollyDelta=new t.Vec2,n.pointers=[],n.pointerPositions={},n._scaleAdd=1,n.offset=new t.Vec3,n.quat=new t.Quat,n.quatInverse=new t.Quat,n.lastPosition=new t.Vec3,n.lastQuaternion=new t.Quat,n}o(p,c);var d=p.prototype;return d.onLoad=function(){this.object=this.node,this.camera=this.node.getComponent(t.Camera)},d.start=function(){this.reset()},d.reset=function(){t.Quat.rotationTo(this.quat,this.object.up,t.Vec3.UP),t.Quat.invert(this.quatInverse,this.quat),this.spherical.radius=t.Vec3.distance(this.object.position,this.target)},d.onEnable=function(){this.isAutoEvent&&(t.input.on(t.Input.EventType.MOUSE_WHEEL,this.onMouseWheel,this),t.input.on(t.Input.EventType.TOUCH_MOVE,this.onMouseMove,this))},d.onDisable=function(){this.isAutoEvent&&(t.input.off(t.Input.EventType.MOUSE_WHEEL,this.onMouseWheel,this),t.input.off(t.Input.EventType.TOUCH_MOVE,this.onMouseMove,this))},d.onDestroy=function(){},d.onMouseDown=function(t){},d.rotateLeft=function(t){this.sphericalDelta.theta-=t},d.rotateUp=function(t){this.sphericalDelta.phi-=t},d.handleMouseMoveRotate=function(e){var i=this.rotateDelta,n=t.winSize().height;e.getDelta(i),this.rotateDelta.multiplyScalar(this.rotateSpeed),this.rotateLeft(2*Math.PI*i.x/n),this.rotateUp(-2*Math.PI*i.y/n),this.updateObject()},d.onMouseMove=function(e){var i=e.getTouches();if(i.length>=2){var n=i[0],o=i[1];n.getLocation(a),o.getLocation(s),t.Vector2.sub(u,a,s),n.getDelta(a),o.getDelta(s),t.Vector2.sub(h,a,s);var r=this._scaleAdd;Math.abs(u.x)>Math.abs(u.y)?this._scaleAdd=(u.x+h.x)/u.x*this._scaleAdd:this._scaleAdd=(u.y+h.y)/u.y*this._scaleAdd,r>this._scaleAdd?this.handleMouseWheel(!1,.3):r<this._scaleAdd&&this.handleMouseWheel(!0,.3)}else this.handleMouseMoveRotate(e)},d.panLeft=function(t){var e=this.object.right;e.multiplyScalar(-t),this.panOffset.add(e)},d.panUp=function(t){var e=this.object.up;e.multiplyScalar(-t),this.panOffset.add(e)},d.pan=function(e,i){var n=t.winSize().height,o=this,r=this.offset,a=o.object.position;r.set(a).subtract(o.target);var s=r.length();s*=Math.tan(o.camera.fov/2*Math.PI/180),this.panLeft(2*e*s/n),this.panUp(2*i*s/n)},d.onMouseWheel=function(t){var e=t.getScrollY();e>0?this.handleMouseWheel(!0):e<0&&this.handleMouseWheel(!1)},d.getZoomScale=function(){return Math.pow(.95,this.zoomSpeed)},d.dollyOut=function(t){this.scale/=t},d.dollyIn=function(t){this.scale*=t},d.handleMouseWheel=function(t,e){void 0===e&&(e=1),this.zoomSpeed=e,t?this.dollyIn(this.getZoomScale()):this.dollyOut(this.getZoomScale()),this.updateObject()},d.updateObject=function(){var e=this,i=this.offset,o=this.quat,a=this.quatInverse,s=this.lastPosition,l=this.lastQuaternion,u=this.spherical,h=this.sphericalDelta,c=this.panOffset,p=e.object.position;i.set(p).subtract(e.target),t.Vec3.transformQuat(i,i,o),u.setFromVector3(i),e.autoRotate&&this.state,e.enableDamping?(u.theta+=h.theta*e.dampingFactor,u.phi+=h.phi*e.dampingFactor):(u.theta+=h.theta,u.phi+=h.phi);var d=e.minAzimuthAngle,f=e.maxAzimuthAngle;return isFinite(d)&&isFinite(f)&&(d<-Math.PI?d+=r:d>Math.PI&&(d-=r),f<-Math.PI?f+=r:f>Math.PI&&(f-=r),u.theta=d<=f?Math.max(d,Math.min(f,u.theta)):u.theta>(d+f)/2?Math.max(d,u.theta):Math.min(f,u.theta)),u.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,u.phi)),u.makeSafe(),u.radius*=this.scale,u.radius=Math.max(e.minDistance,Math.min(e.maxDistance,u.radius)),!0===e.enableDamping?t.Vec3.scaleAndAdd(e.target,e.target,c,e.dampingFactor):e.target.add(c),u.toVec3(i),t.Vec3.transformQuat(i,i,a),p.set(e.target).add(i),e.object.position=p,e.object.lookAt(e.target),!0===e.enableDamping?(h.theta*=1-e.dampingFactor,h.phi*=1-e.dampingFactor,c.multiplyScalar(1-e.dampingFactor)):(h.set(0,0,0),c.set(0,0,0)),this.scale=1,!!(this.zoomChanged||t.Vec3.squaredDistance(s,e.object.position)>n||8*(1-t.Quat.dot(l,e.object.rotation))>n)&&(s.set(e.object.position),l.set(e.object.rotation),this.zoomChanged=!1,!0)},d.update=function(t){this.updateObject()},l(p,[{key:"scaleRatio",get:function(){return this._scaleAdd}}]),p}(t.Component);p([t.property({displayName:"目标位置"})],c.prototype,"target",void 0),p([t.property({displayName:"放到最大"})],c.prototype,"minDistance",void 0),p([t.property({displayName:"最小"})],c.prototype,"maxDistance",void 0),p([t.property({displayName:"自动注册手指事件"})],c.prototype,"isAutoEvent",void 0),p([t.property({displayName:"自动滚动"})],c.prototype,"enableDamping",void 0),p([t.property({displayName:"自动滚动插值"})],c.prototype,"dampingFactor",void 0),c=p([t.ccclass("CameraOrbitControlCC"),t.menuScene("CameraOrbitControlCC")],c),t.CameraOrbitControlCC=c}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).backupDescribe="摄像机拖动组件 方便测试",i.changeZ=!0,i.speed=1,i.v3_t=new t.Vec3,i.quat_t=new t.Quat,i.result=new t.Vec3,i}o(i,e);var n=i.prototype;return n.onStageTouchMove=function(e){if(t.EventHandlerCC.touchIsMoveRun){var i=e.getDeltaX(),n=e.getDeltaY(),o=this.node.getRotation(this.quat_t);0!=i&&t.Quat.rotateAround(o,o,this._getDirection(0,-1,0),i/5/360*t.Maths.PI*this.speed),0!=n&&t.Quat.rotateAround(o,o,this._getDirection(1,0,0),n/5/360*t.Maths.PI*this.speed),o.getEulerAngles(this.v3_t),this.node.setWorldRotationFromEuler(this.v3_t.x,this.v3_t.y,this.changeZ?this.v3_t.z:0)}},n._getDirection=function(e,i,n){return this.result.set(e,i,n),t.Vec3.transformQuat(this.result,this.result,this.node.getRotation()),this.result},i}(t.BaseComponent);p([t.property({displayName:"改变z轴"})],e.prototype,"changeZ",void 0),p([t.property({displayName:"滚动速度"})],e.prototype,"speed",void 0),e=p([t.ccclass("CameraTouchMoveCC"),t.menuScene("CameraTouchMoveCC")],e),t.CameraTouchMoveCC=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).EventType={CHANGE:"CHANGE"},t.backupDescribe="点击切换显示",t._index=0,t.otherBtns=null,t.onEditorUpdateData=t.updateView,t.hasChange=null,t}o(i,e);var n=i.prototype;return n.onLoad=function(){if(e.prototype.onLoad.call(this),!t.EDITOR)for(var i,n=u(this.btns.children);!(i=n()).done;){var o=i.value;t.EventHandlerCC.onClick(o,this.onClickChildren,this)}},n.onEnable=function(){this.btns.active=!0,e.prototype.onEnable.call(this),this.updateView()},n.onDisable=function(){this.btns.active=!1,e.prototype.onDisable.call(this)},n.onClickChildren=function(t){var e=t.getCurrentTarget(),i=this.btns.children.indexOf(e);this.index=i},n.setIndex=function(t){"string"==typeof t&&(t=Number(t)),this.index=t},n.updateView=function(){for(var t=this.btns,e=0;e<t.children.length;e++){var i=t.children[e];i&&(i.children[1]&&(i.children[1].active=e==this._index),i.children[0]&&(i.children[0].active=e!=this._index))}t=this.views;for(var n=0;n<t.children.length;n++)t.children[n]&&(t.children[n].active=n==this._index)},n.getBtnIndexByName=function(t){var e=this.btns.children[t];return e?e.name:""},n.getIndexByName=function(t){var e=this.views.children[t];return e?e.name:""},n.setIndexByName=function(t){if(this.views.children)for(var e=0;e<this.views.children.length;e++)this.views.children[e].name==t&&(this.index=e)},l(i,[{key:"index",get:function(){return this._index},set:function(e){e!=this._index&&(this.hasChange&&!this.hasChange(e)||(this._index=t.Maths.clampf(e,0,Math.max(this.views.children.length,this.btns.children.length)-1),this.updateView(),this.node.emit(this.EventType.CHANGE,this._index)))}},{key:"views",get:function(){return this.getChildByCreate("views",null,-1,!0)}},{key:"btns",get:function(){return this.otherBtns||this.getChildByCreate("btns",null,-1,!0)}},{key:"curIndexByName",get:function(){return this.getIndexByName(this._index)}},{key:"curBtnIndexByName",get:function(){return this.getBtnIndexByName(this._index)}}]),i}(t.BaseComponent);p([t.property({step:1,displayName:"显示索引"})],e.prototype,"index",null),p([t.property({serializable:!0})],e.prototype,"_index",void 0),p([t.property({type:t.Node,displayName:"按钮"})],e.prototype,"otherBtns",void 0),e=p([t.ccclass("ClickChangeViewCC"),t.executeInEditMode,t.menuUI("ClickChangeViewCC")],e),t.ClickChangeViewCC=e}(apeng||(apeng={})),function(t){var e=function(){this.controllerName="",this.visible=!0};p([t.property({readonly:!0,displayName:"名称"})],e.prototype,"controllerName",void 0),p([t.property({displayName:"显示"})],e.prototype,"visible",void 0),e=p([t.ccclass("ControllerByChildItem")],e),t.ControllerByChildItem=e;var i=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).backupDescribe="子控制器",t.remove=!1,t.items=[],t._all=!1,t._noClear=!1,t}return o(i,e),i.prototype.setVisible=function(e){this.remove||(this.node.active=t.Sets.filterValue(this.items,(function(t){return t.controllerName==e})).visible)},l(i,[{key:"all",get:function(){return this._all},set:function(t){for(var e,i=u(this.items);!(e=i()).done;){e.value.visible=!0}}},{key:"noClear",get:function(){return this._noClear},set:function(t){for(var e,i=u(this.items);!(e=i()).done;){e.value.visible=!1}}}]),i}(t.BaseComponent);p([t.property({displayName:"排除"})],i.prototype,"remove",void 0),p([t.property({readonly:!0,type:[e],displayName:"配置"})],i.prototype,"items",void 0),p([t.property({displayName:"全选"})],i.prototype,"all",null),p([t.property({displayName:"清空"})],i.prototype,"noClear",null),p([t.property({serializable:!0})],i.prototype,"_all",void 0),p([t.property({serializable:!0})],i.prototype,"_noClear",void 0),i=p([t.ccclass("ControllerByChildCC"),t.menuController("ControllerByChildCC")],i),t.ControllerByChildCC=i}(apeng||(apeng={})),function(t){var e=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).backupDescribe="控制器排除当前或所有子节点",e.remove=!0,e}return o(e,t),e}(_cc_.Component);p([t.property({displayName:"排除"})],e.prototype,"remove",void 0),e=p([t.ccclass("ControllerByChildExcludeCC"),t.menuController("ControllerByChildExcludeCC")],e),t.ControllerByChildExcludeCC=e}(apeng||(apeng={})),function(t){var e=function(){this.controllerName=""};p([t.property({displayName:"名称"})],e.prototype,"controllerName",void 0),e=p([t.ccclass("ControllerCCItem2")],e),t.ControllerCCItem2=e;var i=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).backupDescribe="模拟fgui控制器",t.items=[],t._index=0,t._itemName="",t.itemNameMap={},t.onEditorUpdateData=t.updateView,t}o(i,e);var n=i.prototype;return n.onEditorClearData=function(){this.walkAllChild((function(e){var i=e.getComponent(t.ControllerByChildCC);i&&i.destroy()}))},n.onLoad=function(){e.prototype.onLoad.call(this),this.updateView()},n.setIndex=function(t){"string"==typeof t&&(t=Number(t)),this.index=t},n.setItemName=function(e,i){void 0===i&&(i=-1),void 0===this.itemNameMap[e]&&(this.itemNameMap[e]=t.Sets.filterOf(this.items,(function(t){return t.controllerName==e}))),-1!=this.itemNameMap[e]?this.index=this.itemNameMap[e]:-1!=i&&(this.index=i)},n.updateView=function(){var e=this;if(this.items[this._index]){var i=this.items[this._index].controllerName;this.walkAllDeepChild((function(n){if(n.getComponent("ControllerCC"))return 1;var o=n.getComponent("ControllerByChildExcludeCC");if(o&&o.remove)return 1;var r=n.getComponent("ListCC")||n.getComponent("CreatePrefabToEditorCC")||n.getComponent("CreatePrefabToEditorOnceCC"),a=n.getComponent(t.ControllerByChildCC);if(!a){a=n.addComponent(t.ControllerByChildCC);for(var s,l=[],h=u(e.items);!(s=h()).done;){s.value;l.push(new t.ControllerByChildItem)}a.items=l,a.remove=!!r}for(var c=0;c<e.items.length;c++)a.items[c].controllerName=e.items[c].controllerName;a.setVisible(i)}))}},l(i,[{key:"index",get:function(){return this._index},set:function(e){e!=this._index&&(this._index=t.Maths.clampf(e,0,this.items.length-1),this._itemName=this.items[this._index].controllerName,this.updateView())}},{key:"itemName",get:function(){return this._itemName},set:function(t){t!=this._itemName&&(this._itemName=t,this.setItemName(this._itemName))}}]),i}(t.BaseComponent);p([t.property({type:[e],displayName:"控制器"})],i.prototype,"items",void 0),p([t.property({min:0,step:1,displayName:"显示索引",visible:function(){return 0!=this.items.length}})],i.prototype,"index",null),p([t.property({serializable:!0})],i.prototype,"_index",void 0),p([t.property({displayName:"显示名称",visible:function(){return 0!=this.items.length}})],i.prototype,"itemName",null),p([t.property({serializable:!0})],i.prototype,"_itemName",void 0),i=p([t.ccclass("ControllerCC"),t.menuController("ControllerCC")],i),t.ControllerCC=i}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).prefabItemDeep=null,t.prefabItemByUuid="",t.runClearItem=!0,t._prefabItem=null,t._isPreloadPrefab=!1,t.isLoadPrefab=!1,t.loadPrefabUrl="",t}o(i,e);var n=i.prototype;return n.getPool=function(){return null},n.onEditorUpdateData=function(){this.updatePreloadPrefab(),this.updateItem()},n.onEditorClearData=function(){t.Sets.forEach(this.content.children,(function(t){t.removeFromParent(),t.destroy()}),!0)},n.onPreLoad=function(){this.content.layer=this.node.parent.layer,t.EDITOR&&this.updateItem(),this.runClearItem||this.updateItem()},n.updatePreloadPrefab=function(){this._isPreloadPrefab?this.prefabItemDeep=this.prefabItem:(this.prefabItemDeep=null,this.prefabItemByUuid=this.prefabItem?this.prefabItem._uuid:"")},n.preloadPrefab=function(e,i,n){var o=this;if(void 0===i&&(i=!1),e&&e!=this.loadPrefabUrl&&(this._prefabItem=null,this.isLoadPrefab=!1,this.loadPrefabUrl=""),this.isVisible){if(this.isLoadPrefab)return i&&(this.removeItem(),this.addItem()),void(n&&n(!0));e||(e=t._resouces.getUuidByUrl(this.prefabItemByUuid)),t._resouces.loadPrefab(e,(function(t){o._prefabItem=t,o.isLoadPrefab=!0,o.loadPrefabUrl=e,o.isVisible?(o.clearCacheComponent(),i&&(o.removeItem(),o.addItem()),n&&n(!0)):n&&n(!1)}))}else n&&n(!1)},n.updateItem=function(){var e=this;this.prefabItem&&t.Sets.updateItemCount(1,this.content.children.length,(function(t){t?e.addItem():e.removeItem()}))},n.addItem=function(){var e=this;if(!this.prefabItem)return null;var i=this.getPool(),n=i?i.get(this.loadPrefabUrl||t._resouces.getUuidByUrl(this.prefabItemByUuid)):t.instantiate(this.prefabItem);return t.NodeHelper.setHideFlags(n,t.CCObject.Flags.HideInHierarchy,t.CCObject.Flags.DontSave),n.layer=this.content.layer,t.NodeHelper.walkAllChild(n,(function(t){t.layer=e.content.layer;var i=t.getComponent("BaseComponent");i&&i.autoMember()})),this.onAddItem(n),n},n.removeItem=function(t,e){if(void 0===e&&(e=!0),!this.prefabItem)return null;if(t||(t=this.content.children[this.content.children.length-1]),t){var i=this.getPool();i?i.put(t):(t.removeFromParent(),e&&t.destroy())}this.onRemoveItem&&this.onRemoveItem()},n.getPrefabUuidByUrl=function(){return t._resouces.getUuidByUrl(this.prefabItemByUuid)},n.removeAll=function(){var e=this;t.Sets.forEach(this.content.children,(function(t){e.removeItem(t)}),!0)},n.onAddItem=function(t){this.content.addChild(t)},l(i,[{key:"item",get:function(){return this.content.children[0]}},{key:"prefabItem",get:function(){return this._prefabItem||this.prefabItemDeep},set:function(t){this._prefabItem!=t&&(this._prefabItem=t,this.onEditorUpdateData())}},{key:"isPreloadPrefab",get:function(){return this._isPreloadPrefab},set:function(t){this._isPreloadPrefab!=t&&(this._isPreloadPrefab=t,this.updatePreloadPrefab())}},{key:"content",get:function(){return this.node}}]),i}(t.BaseComponent);p([t.property({type:t.Prefab,displayName:"子预制体"})],e.prototype,"prefabItem",null),p([t.property({readonly:!0,type:t.Prefab,displayName:"引用预制体 方便绑定加载",visible:function(){return!0}})],e.prototype,"prefabItemDeep",void 0),p([t.property({displayName:"绑定加载预制体",visible:function(){return!!this._prefabItem}})],e.prototype,"isPreloadPrefab",null),p([t.property({readonly:!0,displayName:"预制体uuid",visible:function(){return this._prefabItem&&!this._isPreloadPrefab}})],e.prototype,"prefabItemByUuid",void 0),p([t.property({displayName:"运行时清空"})],e.prototype,"runClearItem",void 0),p([t.property({serializable:!0,editorOnly:!0})],e.prototype,"_prefabItem",void 0),p([t.property({serializable:!0})],e.prototype,"_isPreloadPrefab",void 0),e=p([t.ccclass("CreatePrefabToEditorOnceCC"),t.executeInEditMode,t.menuUI("CreatePrefabToEditorOnceCC")],e),t.CreatePrefabToEditorOnceCC=e}(apeng||(apeng={})),function(t){var e=1e-4,i=new t.Vec3,n=new t.Vec3,r=new t.Vec2,a=new t.Vec2,s=new t.Vec2,h=new t.Vec2,c=new t.Vector2,d=(new t.Vector2,new t.Vec3),f=new t.Vec3,y=new t.Vec3,g=function(p){function g(){var e;return(e=p.apply(this,arguments)||this).backupDescribe="拖拽视图",e.content=null,e.dragReverse=!0,e.brake=.5,e.scaleViewMin=.5,e.scaleCamera=null,e.isAutoEvent=!0,e.lerpTouchDelay=2,e._autoScrolling=!1,e._topBoundary=0,e._bottomBoundary=0,e._leftBoundary=0,e._rightBoundary=0,e._touchMoveDisplacements=[],e._touchMoveTimeDeltas=[],e._touchMovePreviousTimestamp=0,e._touchMoved=!1,e._autoScrollAttenuate=!1,e._autoScrollStartPosition=new t.Vec3,e._autoScrollTargetDelta=new t.Vec3,e._autoScrollTotalTime=0,e._autoScrollAccumulatedTime=0,e._autoScrollCurrentlyOutOfBoundary=!1,e._autoScrollBraking=!1,e._autoScrollBrakingStartPosition=new t.Vec3,e._outOfBoundaryAmount=new t.Vec3,e._outOfBoundaryAmountDirty=!0,e._stopMouseWheel=!1,e._mouseWheelEventElapsedTime=0,e._isScrollEndedWithThresholdEventFired=!1,e._deltaPos=new t.Vec3,e._orginCameraOrthoheight=-1,e._orginContentSize=new t.Size,e._scaleCameraRatio=new t.Size,e._scaleAdd=1,e._scaleCheckBoundary=!1,e.isTouchStart=!1,e.isTouchStartDealy=!1,e.scaleMax=1,e._scaleToLerpSpeed=-1,e._scaleToRatio=-1,e._scaleToMinRatio=.001,e._scaleToStart=!1,e.onSizeChange=e._calculateBoundary,e}o(g,p);var m=g.prototype;return m.onLoad=function(){if(p.prototype.onLoad.call(this),!t.EDITOR){this.isAutoEvent&&(this.addEvent(t.Node.EventType.TOUCH_START,this._onTouchBegan,this,this.node,!0),this.addEvent(t.Node.EventType.TOUCH_END,this._onTouchEnded,this,this.node,!0),this.addEvent(t.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this,this.node,!0),this.addEvent(t.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,this.node,!0),this.addEvent(t.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,this.node,!0)),this._calculateBoundary(),this.scaleCamera&&(this._orginCameraOrthoheight=this.scaleCamera.orthoHeight);var e=t.winSize();this._scaleCameraRatio.width=e.width/this._orginCameraOrthoheight,this._scaleCameraRatio.height=e.height/this._orginCameraOrthoheight,this.content&&this.updateContentSize(this.contentUITransform.contentSize)}},m.updateContentSize=function(e){var i=t.winSize();this._orginContentSize.width=e.width,this._orginContentSize.height=e.height,this.scaleMax=Math.max(1,Math.min(this._orginContentSize.height/i.height,this._orginContentSize.width/i.width))},m.onUpdate=function(){this._autoScrolling&&this._processAutoScrolling(t._timer.dtDefault),this._scaleToStart&&(this._scaleAdd=t.Maths.lerp(this._scaleAdd,this._scaleToRatio,this._scaleToLerpSpeed*t._timer.dtSecond),Math.abs(this._scaleToRatio-this._scaleAdd)<this._scaleToMinRatio&&(this._scaleAdd=this._scaleToRatio,this._scaleToStart=!1,console.log("缩放动画完成")),this.scaleView(!1,this._scaleCheckBoundary))},m.onDisable=function(){p.prototype.onDisable.call(this),this.isTouchStart=!1,this._autoScrolling=!1,this._autoScrollAccumulatedTime=this._autoScrollTotalTime},m.getScaleToByRatio=function(){return(this._scaleAdd-this.scaleViewMin)/(this.scaleMax-this.scaleViewMin)},m.scaleTo=function(e,i,n,o){void 0===n&&(n=!0),void 0===o&&(o=.001),this._scaleCheckBoundary=n,this._scaleToStart=!0,this._scaleToLerpSpeed=e,this._scaleToMinRatio=o,this._scaleToRatio=t.Maths.lerp(this.scaleViewMin,this.scaleMax,i)},m.scaleTo2=function(e){this._scaleAdd=t.Maths.lerp(this.scaleViewMin,this.scaleMax,e),this.scaleView(!1,!1)},m._onMouseWheel=function(t,e){this.enabledInHierarchy&&(this._hasNestedViewGroup(t,e)||(this._scaleToStart=!1,this._scaleAdd=this._scaleAdd+(t.getScrollY()<0?.1:-.1),this.scaleView(!1),this._mouseWheelEventElapsedTime=0,this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60,NaN,0),this._stopMouseWheel=!0),this._stopPropagationIfTargetIsMe(t)))},m._onTouchBegan=function(t,e){this.enabledInHierarchy&&this.content&&(this._hasNestedViewGroup(t,e)||(this._scaleToStart=!1,this._handlePressLogic(),this._touchMoved=!1,this._stopPropagationIfTargetIsMe(t),this.isTouchStart=!0,this.isTouchStartDealy=!0,this.unschedule(this._touchEndDelay)))},m._onTouchMoved=function(e,i){if(this.enabledInHierarchy&&this.content&&!this._hasNestedViewGroup(e,i)){var n=e.getTouches();if(n.length>=2){var o=n[0],l=n[1];o.getLocation(r),l.getLocation(a),t.Vector2.sub(s,r,a),o.getDelta(r),l.getDelta(a),t.Vector2.sub(h,r,a),Math.abs(s.x)>Math.abs(s.y)?this._scaleAdd=(s.x+h.x)/s.x*this._scaleAdd:this._scaleAdd=(s.y+h.y)/s.y*this._scaleAdd,this.scaleView(!0),this._touchMoved=!0}else{var u=e.touch;this._getLocalAxisAlignDelta(this._deltaPos,u),this._processDeltaMove(this._deltaPos)}this._stopPropagationIfTargetIsMe(e)}},m.scaleView=function(e,i){if(void 0===i&&(i=!0),this.scaleCamera&&this.content){var n=this.scaleMax,o=this._scaleAdd=t.Maths.clampf(this._scaleAdd,this.scaleViewMin,n);e&&(o=n-o+this.scaleViewMin),this.scaleCamera.orthoHeight=o*this._orginCameraOrthoheight;var r=this._orginCameraOrthoheight-o*this._orginCameraOrthoheight;t.NodeHelper.setSize(this.content,this._orginContentSize.width+this._scaleCameraRatio.width*r,this._orginContentSize.height+this._scaleCameraRatio.height*r),i&&this._calculateBoundary()}},m._onTouchEnded=function(t,e){if(this.enabledInHierarchy&&this.content&&t&&!this._hasNestedViewGroup(t,e)){var i=t.touch;this._handleReleaseLogic(i),this._touchMoved?t.propagationStopped=!0:this._stopPropagationIfTargetIsMe(t),this._touchEnd()}},m._onTouchCancelled=function(t,e){if(this.enabledInHierarchy&&this.content&&!this._hasNestedViewGroup(t,e)){if(this._touchEnd(),t&&!t.simulate){var i=t.touch;this._handleReleaseLogic(i)}this._stopPropagationIfTargetIsMe(t)}},m._touchEnd=function(){this.isTouchStart=!1,this.scheduleOnceCover(this._touchEndDelay,this.lerpTouchDelay)},m._touchEndDelay=function(){this.isTouchStartDealy=!1},m._calculateBoundary=function(){if(this.content){var e=this.content.parent;if(e){var n=t.NodeHelper.getUITransform(e),o=n.width*n.anchorX,r=n.height*n.anchorY;this._leftBoundary=-o,this._bottomBoundary=-r,this._rightBoundary=this._leftBoundary+n.width,this._topBoundary=this._bottomBoundary+n.height;var a=n.contentSize,s=this._getContentBottomBoundary()-this._bottomBoundary;s=-s;var l=0,u=this._getContentLeftBoundary()-this._leftBoundary;u=-u;var h=this.contentUITransform.contentSize;h.height<a.height?(l=h.height-a.height,d.y=s-l):d.y=0,h.width<a.width?(l=h.width-a.width,c.x=u):d.x=0,d.z=0,this._moveContent(d),this._outOfBoundaryAmountDirty=!0,this._isOutOfBoundary()&&(i.set(this.content.position),i.add(this._getHowMuchOutOfBoundary(d)),this.setContentPosition(i))}}},m.setContentPosition=function(t){this.content.setPosition(t)},m._hasNestedViewGroup=function(e,i){if(!e||e.eventPhase!==Event.CAPTURING_PHASE)return!1;if(i)for(var n,o=u(i);!(n=o()).done;){var r=n.value;if(this.node===r)return!(!e.target||!e.target.getComponent(t.ViewGroup));if(r.getComponent(t.ViewGroup))return!0}return!1},m._calculateAttenuatedFactor=function(t){return this.brake<=0?1-this.brake:(1-this.brake)*(1/(1+14e-6*t+t*t*8e-9))},m._startAttenuatingAutoScroll=function(i,n){var o=n.length();if(f.set(i),t.Vector3.normalize(d,f),this.content&&this.content.parent){var r=this.contentUITransform.contentSize,a=t.NodeHelper.getUITransform(this.content.parent).contentSize,s=r.width-a.width,l=r.height-a.height,u=this._calculateAttenuatedFactor(s),h=this._calculateAttenuatedFactor(l);d.x=d.x*s*(1-this.brake)*u,d.y=d.y*l*h*(1-this.brake),d.z=0}var c=f.length(),p=d.length()/c;d.add(f),this.brake>0&&p>7&&(p=Math.sqrt(p),t.Vector3.mul(d,f,p),d.add(f));var y=Math.sqrt(Math.sqrt(o/5));this.brake>0&&p>3&&(y*=p=3),0===this.brake&&p>1&&(y*=p),this._autoScrolling=!0,this._autoScrollTargetDelta.set(d),this._autoScrollAttenuate=!0,t.Vec3.copy(this._autoScrollStartPosition,this.content.position),this._autoScrollTotalTime=y,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._isScrollEndedWithThresholdEventFired=!1,this._autoScrollBrakingStartPosition.set(0,0,0),this._getHowMuchOutOfBoundary(d).equals(t.Vec3.ZERO,e)||(this._autoScrollCurrentlyOutOfBoundary=!0)},m._moveContent=function(t){if(i.set(this.content.position),i.add(t),i.set(Math.round(1e4*i.x)*e,Math.round(1e4*i.y)*e,i.z),this.content){var n=this.content.position;Math.abs(i.x-n.x)<e&&Math.abs(i.y-n.y)<e||(this.setContentPosition(i),this._outOfBoundaryAmountDirty=!0)}},m._getContentLeftBoundary=function(){if(!this.content)return-1;var t=this.contentUITransform;return this.content.position.x-t.anchorX*t.width},m._getContentRightBoundary=function(){if(!this.content)return-1;var t=this.contentUITransform;return this._getContentLeftBoundary()+t.width},m._getContentTopBoundary=function(){if(!this.content)return-1;var t=this.contentUITransform;return this._getContentBottomBoundary()+t.height},m._getContentBottomBoundary=function(){if(!this.content)return-1;var t=this.contentUITransform;return this.content.position.y-t.anchorY*t.height},m._getHowMuchOutOfBoundary=function(i,n){if((n=n||t.Vec3.ZERO).equals(t.Vec3.ZERO,e)&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var o=this._getContentLeftBoundary(),r=this._getContentRightBoundary();o+n.x>this._leftBoundary?i.x=this._leftBoundary-(o+n.x):r+n.x<this._rightBoundary?i.x=this._rightBoundary-(r+n.x):i.x=0;var a=this._getContentTopBoundary(),s=this._getContentBottomBoundary();return a+n.y<this._topBoundary?i.y=this._topBoundary-(a+n.y):s+n.y>this._bottomBoundary?i.y=this._bottomBoundary-(s+n.y):i.y=0,i.z=0,n.equals(t.Vec3.ZERO,e)&&(this._outOfBoundaryAmount.set(i),this._outOfBoundaryAmountDirty=!1),this._clampDelta(i),i},m._stopPropagationIfTargetIsMe=function(t){t.eventPhase===Event.AT_TARGET&&t.target===this.node&&(t.propagationStopped=!0)},m.openLerp=function(){this._touchEndDelay(),this.unschedule(this._touchEndDelay),this._autoScrolling=!1},m.lerpMove=function(e,i,n,o){if(void 0===n&&(n=!0),void 0===o&&(o=.01),this._autoScrolling||this.isTouchStart||this.isTouchStartDealy)return!1;if(n&&this._scaleToStart)return!1;var r=this.content.position;if(t.Vector2.equals(e,r,o))return!0;t.Vector2.lerp(c,r,e,i*t._timer.dtSecond),t.Vector2.sub(y,c,r);var a=!1;return y.length()<o&&(t.Vector2.sub(y,e,r),a=!0),y.z=0,this._processDeltaMove(y,!1),a},m._processDeltaMove=function(t,e){void 0===e&&(e=!0),this._clampDelta(t),this._getHowMuchOutOfBoundary(d,t),t.add(d),this._moveContent(t),e&&this._gatherTouchMove(t)},m._handleReleaseLogic=function(t){this._getLocalAxisAlignDelta(this._deltaPos,t),this._gatherTouchMove(this._deltaPos),this._processInertiaScroll()},m._getLocalAxisAlignDelta=function(e,o){var s=this.UITransform;o.getUILocation(r),o.getUIPreviousLocation(a),this.dragReverse&&(r.multiplyScalar(-1),a.multiplyScalar(-1)),i.set(r.x,r.y,0),n.set(a.x,a.y,0),s.convertToNodeSpaceAR(i,i),s.convertToNodeSpaceAR(n,n),t.Vec3.subtract(e,i,n)},m._handlePressLogic=function(){this._autoScrolling=!1,this._touchMovePreviousTimestamp=(new Date).getMilliseconds();for(var e,i=u(this._touchMoveDisplacements);!(e=i()).done;){var n=e.value;t.Vector3.pool.put(n)}this._touchMoveDisplacements.length=0,this._touchMoveTimeDeltas.length=0},m._clampDelta=function(e){if(this.content&&this.content.parent){var i=t.NodeHelper.getUITransform(this.content.parent).contentSize,n=this.contentUITransform;n.width<i.width&&(e.x=0),n.height<i.height&&(e.y=0)}},m._gatherTouchMove=function(e){var i=t.Vector3.pool.get().set(e);for(this._clampDelta(i);this._touchMoveDisplacements.length>=5;){var n=this._touchMoveDisplacements.shift();n&&t.Vector3.pool.put(n),this._touchMoveTimeDeltas.shift()}this._touchMoveDisplacements.push(i);var o=(new Date).getMilliseconds();this._touchMoveTimeDeltas.push((o-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=o},m._processInertiaScroll=function(){var i=t.Maths.arrAdd(this._touchMoveTimeDeltas);if(i<=0||i>=.5)d.set();else{f.set();for(var n,o=u(this._touchMoveDisplacements);!(n=o()).done;){var r=n.value;t.Vector3.add(f,f,r)}d.set(f.x*(1-this.brake)/i,f.y*(1-this.brake)/i,f.z)}!d.equals(t.Vec3.ZERO,e)&&this.brake<1&&(t.Vector3.mul(f,d,.7),this._startAttenuatingAutoScroll(f,d))},m._isOutOfBoundary=function(){return!this._getHowMuchOutOfBoundary(d).equals(t.Vec3.ZERO,e)},m._isNecessaryAutoScrollBrake=function(){if(this._autoScrollBraking)return!0;if(this._isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition.set(this.content.position),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},m._processAutoScrolling=function(i){var n=this._isNecessaryAutoScrollBrake()?.05:1;this._autoScrollAccumulatedTime+=i*(1/n);var o,r=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(o=r,r=(o-=1)*o*o*o*o+1),t.Vector3.mul(y,this._autoScrollTargetDelta,r),y.add(this._autoScrollStartPosition);var a=Math.abs(r-1)<=e;Math.abs(r-1)<=e&&!this._isScrollEndedWithThresholdEventFired&&(this._isScrollEndedWithThresholdEventFired=!0),d.set(y),d.subtract(this.content.position),this._getHowMuchOutOfBoundary(f,d),f.equals(t.Vec3.ZERO,e)||(y.add(f),a=!0),a&&(this._autoScrolling=!1),y.subtract(this.content.position),this._clampDelta(y),this._moveContent(y)},m._checkMouseWheel=function(i){if(!this._getHowMuchOutOfBoundary(d).equals(t.Vec3.ZERO,e))return this._processInertiaScroll(),this.unschedule(this._checkMouseWheel),void(this._stopMouseWheel=!1);this._mouseWheelEventElapsedTime+=i,this._mouseWheelEventElapsedTime>.1&&(this.unschedule(this._checkMouseWheel),this._stopMouseWheel=!1)},m._calculateMovePercentDelta=function(e,i,n,o){this._calculateBoundary();var r=this._getContentBottomBoundary()-this._bottomBoundary;r=-r;var a=this._getContentLeftBoundary()-this._leftBoundary;if(a=-a,this.content&&this.content.parent){var s=0,l=t.NodeHelper.getUITransform(this.content).contentSize,u=t.NodeHelper.getUITransform(this.content.parent).contentSize;i&&(s=l.width-u.width,o.x=a-s*t.Maths.clamp01(e.x)),n&&(s=l.height-u.height,o.y=r-s*t.Maths.clamp01(e.y))}return o},m.moveTo=function(t,e){c.x=(this.UITransform.width*this.UITransform.anchorX-t.x)/this.UITransform.width,c.y=(this.UITransform.height*this.UITransform.anchorY-t.y)/this.UITransform.height,this._calculateMovePercentDelta(c,!0,!0,y),this._startAutoScroll(y,e,!0)},m._startAutoScroll=function(i,n,o){this._autoScrolling=!0,this._autoScrollTargetDelta.set(i),this._autoScrollAttenuate=o,t.Vec3.copy(this._autoScrollStartPosition,this.content.position),this._autoScrollTotalTime=n,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._isScrollEndedWithThresholdEventFired=!1,this._autoScrollBrakingStartPosition.set(0,0,0),this._getHowMuchOutOfBoundary(d).equals(t.Vec3.ZERO,e)||(this._autoScrollCurrentlyOutOfBoundary=!0)},l(g,[{key:"scaleRatio",get:function(){return this._scaleAdd}},{key:"contentUITransform",get:function(){return this.content?t.NodeHelper.getUITransform(this.content):null}}]),g}(t.BaseComponent);p([t.property({type:t.Node,displayName:"可滚动展示内容的节点"})],g.prototype,"content",void 0),p([t.property({displayName:"拖动方向取反"})],g.prototype,"dragReverse",void 0),p([t.property({range:[0,1,.1],displayName:"惯性滑动比率"})],g.prototype,"brake",void 0),p([t.property({displayName:"最小缩放"})],g.prototype,"scaleViewMin",void 0),p([t.property({type:t.Camera,displayName:"缩放摄像机"})],g.prototype,"scaleCamera",void 0),p([t.property({displayName:"自动注册手指事件"})],g.prototype,"isAutoEvent",void 0),p([t.property({displayName:"插值触摸延迟"})],g.prototype,"lerpTouchDelay",void 0),g=p([t.ccclass("DragViewCC"),t.menuUI("DragViewCC"),t.requireComponent(t.UITransform)],g),t.DragViewCC=g}(apeng||(apeng={})),function(t){var e=t.dragonBones?t.dragonBones.ArmatureDisplay:t.Asset,i=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).EventType={PLAY:"PLAY"},t.backupDescribe="龙骨组件",t.anim=null,t.crossFade=0,t.curPlayAnimName="",t.curPlayTimes=-1,t.curState=null,t.lastPlayAnim="",t.curPlayAnimNameCb=null,t.hasPlay=null,t.initTimeScale=1,t.playing={},t}o(i,e);var n=i.prototype;return n.onLoad=function(){e.prototype.onLoad.call(this),t.EDITOR?this.anim||(this.anim=this.getComponent(t.dragonBones.ArmatureDisplay)):this.anim&&(this.addEvent(t.dragonBones.EventObject.COMPLETE,this.onEventAnimComplete,this,this.anim),this.initTimeScale=this.anim.timeScale)},n.onDisable=function(){this.curPlayAnimName="",this.lastPlayAnim="",this.curState=null,this.curPlayAnimNameCb=null,e.prototype.onDisable.call(this)},n.onEventAnimComplete=function(t){t.animationState.name==this.curPlayAnimName&&(this.playing[this.curPlayAnimName]=!1,this.curPlayAnimNameCb&&(this.curPlayAnimNameCb(),this.curPlayAnimNameCb=null))},n.pause=function(){this.anim&&(this.anim.timeScale=0)},n.resume=function(){this.anim&&(this.anim.timeScale=this.initTimeScale)},n.play=function(t,e,i,n){void 0===e&&(e=0),void 0===n&&(n=!0),this.anim&&t&&(n&&this.curPlayAnimName==t||this.hasPlay&&this.hasPlay(t)||(this.curPlayAnimName&&(this.lastPlayAnim=this.curPlayAnimName),this.curPlayAnimName=t,this.curPlayTimes=e,this.curPlayAnimNameCb=i,this.playing[t]=!0,this.curState=this.anim.playAnimation(t,e),this.curState&&this.crossFade>0&&(this.curState.autoFadeOutTime=this.crossFade),this.node.emit(this.EventType.PLAY)))},n.playDefault=function(t,e,i){if(void 0===i&&(i=!0),this.anim){var n=this.anim.getAnimationNames(this.anim.armatureName);n[0]&&this.play(n[0],t,e,i)}},n.hasPlaying=function(t){return this.playing[t]||!1},n.getState=function(t){return this.anim?this.anim.armature().animation.getState(t):null},n.changeState=function(t,e){this.curPlayAnimName!=t&&this.play(t,e)},n.getCurPlayTime=function(){var t;return null===(t=this.getState(this.curPlayAnimName))||void 0===t?void 0:t.currentTime},n.duration=function(t){return this.anim?this.anim.armature().animation.animations[t].duration:0},n.animNames=function(){return this.anim?this.anim.armature().animation.animationNames:[]},n.setCurrentTime=function(t,e,i){this.play(t,i),this.getState(t).currentTime=e},i}(t.BaseComponent);p([t.property({type:e,displayName:"动画组件"})],i.prototype,"anim",void 0),p([t.property({displayName:"过渡时间"})],i.prototype,"crossFade",void 0),i=p([t.ccclass("DragonBonesCC"),t.executeInEditMode,t.menuAnim("DragonBonesCC")],i),t.DragonBonesCC=i}(apeng||(apeng={})),function(t){var e=function(){function e(){this.string="",this.offsetHight=0,this.offsetWidth=0,this._sf=null}return l(e,[{key:"sf",get:function(){return this._sf},set:function(e){e&&e instanceof t.SpriteFrame&&(this._sf=e,!this.string&&this._sf.name&&this._sf.name.length>0&&(this.string=this._sf.name[this._sf.name.length-1]))}},{key:"width",get:function(){return this.sf.originalSize.width}},{key:"height",get:function(){return this.sf.originalSize.height}}]),e}();p([t.property({displayName:"字符"})],e.prototype,"string",void 0),p([t.property({type:t.SpriteFrame,displayName:"图片"})],e.prototype,"sf",null),p([t.property({displayName:"上下偏移"})],e.prototype,"offsetHight",void 0),p([t.property({displayName:"左右偏移"})],e.prototype,"offsetWidth",void 0),p([t.property({serializable:!0})],e.prototype,"_sf",void 0),e=p([t.ccclass("CCFontItem")],e),t.CCFontItem=e;var i=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).backupDescribe="字体组件",i.Pool=new t.PoolOnce(30,(function(){var e=new t.Node("PrivateNode");return e.hideFlags|=t.CCObject.Flags.HideInHierarchy|t.CCObject.Flags.DontSave,e.layer=i.node.layer,e.addComponent(t.UITransform),e.addComponent(t.Sprite),e}),(function(t){return t.removeFromParent()}),(function(t){return t.destroy()})),i.items=[],i._isBold=!1,i._isGray=!1,i._string="",i._space=0,i._color=new t.Color(255,255,255),i.itemsByStringMap=null,i.onEditorUpdateData=i.updateView,i}o(i,e);var n=i.prototype;return n.onEditorClearData=function(){t.Sets.forEach(this.node.children,(function(t){t.removeFromParent(),t.destroy()}),!0)},n.onLoad=function(){e.prototype.onLoad.call(this),this.updateView()},n.onDestroy=function(){this.Pool.clear(),e.prototype.onDestroy.call(this)},n.getItem=function(e){if(!this.itemsByStringMap){this.itemsByStringMap={};for(var i,n=u(this.items);!(i=n()).done;){var o=i.value;o.string&&o.sf&&(this.itemsByStringMap[o.string]=o)}}var r=this.itemsByStringMap[e];return t.EDITOR&&(this.itemsByStringMap=null),r},n.updateView=function(){var e=this;t.Sets.updateItemCount(this._string.length,this.node.children.length,(function(i){if(i)e.node.addChild(e.Pool.get());else{var n=t.Sets.pop(e.node.children,!1);n&&e.Pool.put(n)}}));for(var i=this.string.split(""),n=null,o=0,r=null,a=0,s=0,l=0,u=0;u<i.length;u++)(r=this.getItem(i[u]))&&((n=this.node.children[u].getComponent(t.Sprite)).color=this.color,n.spriteFrame=r.sf,n.grayscale=this._isGray,u>0?o+=r.width/2:l=r.width,a+=r.width+this.space,t.NodeHelper.setPositionX(n.node,o+r.offsetWidth,!1),t.NodeHelper.setPositionY(n.node,r.offsetHight,!1),o+=r.width/2+this.space,s=Math.max(s,r.height),this.node.addChild(n.node));var h=-(a-=this.space)/2+l/2;h-=(this.UITransform.anchorX-.5)*this.UITransform.width;for(var c=this.node.children.length-1;c>=0;c--)t.NodeHelper.setPositionX(this.node.children[c],this.node.children[c].position.x+h,!1);t.NodeHelper.setSize(this.node,a,s)},l(i,[{key:"space",get:function(){return this._space},set:function(t){this._space!=t&&(this._space=t,this.updateView())}},{key:"string",get:function(){return this._string},set:function(t){this._string!=t&&(this._string=t,this.updateView(),this.scheduleOnceCover(this.updateView))}},{key:"color",get:function(){return this._color},set:function(t){this._color.equals(t)||(this._color.set(t),this.updateView())}},{key:"isGray",get:function(){return this._isGray},set:function(t){this._isGray!=t&&(this._isGray=t,this.updateView())}},{key:"isBold",get:function(){return this._isBold},set:function(t){this._isBold!==t&&(this._isBold=t,this.updateView())}}]),i}(t.BaseComponent);p([t.property({displayName:"字间距"})],i.prototype,"space",null),p([t.property({displayName:"显示的文字"})],i.prototype,"string",null),p([t.property({type:t.Color,displayName:"颜色"})],i.prototype,"color",null),p([t.property({displayName:"置灰"})],i.prototype,"isGray",null),p([t.property({type:[e],displayName:"字符集"})],i.prototype,"items",void 0),p([t.property({displayName:"加粗"})],i.prototype,"isBold",null),p([t.property({serializable:!0})],i.prototype,"_isBold",void 0),p([t.property({serializable:!0})],i.prototype,"_isGray",void 0),p([t.property({serializable:!0})],i.prototype,"_string",void 0),p([t.property({serializable:!0})],i.prototype,"_space",void 0),p([t.property({serializable:!0})],i.prototype,"_color",void 0),i=p([t.ccclass("FontCC"),t.executeInEditMode,t.menuUI("main/component/FontCC")],i),t.FontCC=i}(apeng||(apeng={})),function(t){var e=new t.Vec2,i=new t.Vec3,n=function(n){function r(){var e;return(e=n.apply(this,arguments)||this).EventType={MOVE:"MOVE",START:"START",END:"END",ANIM_COMPLETE:"ANIM_COMPLETE"},e.backupDescribe="摇杆",e.orginNode=null,e.orginImgNode=null,e.dragNode=null,e.radius=300,e._touchId=-1,e.angle=150,e.len=150,e.dir=new t.Vector2,e.isAnim=!1,e.onTouchCancel=e.onTouchEnd,e}o(r,n);var a=r.prototype;return a.onEnable=function(){n.prototype.onEnable.call(this),this.stopAnim()},a.onTouchStart=function(n){-1==this._touchId&&(this._touchId=n.getID(),this.isAnim=!1,this.dragNode.active=!0,this.orginImgNode.active=!0,n.getUILocation(e),this.convertToNodeSpaceAR(i,e),t.NodeHelper.setPositionXY(this.orginNode,i,!1),t.NodeHelper.setPositionXY(this.dragNode,t.Vec3.ZERO,!1),this.len=0,this.setAngle(i),this.node.emit(this.EventType.START))},a.onTouchMove=function(n){-1!=this._touchId&&this._touchId==n.getID()&&(n.getUILocation(e),t.NodeHelper.convertToNodeSpaceAR(i,this.orginNode,e),this.setAngle(i),this.len=t.Vector2.len(i),this.len>this.radius&&(this.len=this.radius,t.Vector2.normalize(i,i),t.Vector2.mul(i,i,this.radius)),t.NodeHelper.setPositionXY(this.dragNode,i,!1),this.node.emit(this.EventType.MOVE))},a.onTouchEnd=function(e){-1!=this._touchId&&this._touchId==e.getID()&&(this._touchId=-1,this.orginImgNode.active=!1,t.NodeHelper.setRotateZ(this.dragNode,this.angle+180,!1),this.isAnim=!0,this.len=0,this.node.emit(this.EventType.END))},a.onUpdate=function(){this.isAnim&&t.NodeHelper.lerpTarget(this.dragNode,t.Vector3.ZERO,.1,void 0,!1,void 0,.3)&&(this.stopAnim(),this.node.emit(this.EventType.ANIM_COMPLETE))},a.stopAnim=function(){this.isAnim=!1,this.dragNode.active=!1,this.orginImgNode.active=!0,t.NodeHelper.setRotateZ(this.dragNode,0,!1)},a.setAngle=function(e){0==e.x&&0==e.y||(this.dir.set(e),this.dir.normalizeSelf(),this.angle=t.Vector2.angle(e),t.NodeHelper.setRotateZ(this.dragNode,this.angle,!1))},r}(t.BaseComponent);p([t.property({type:t.Node,displayName:"原点"})],n.prototype,"orginNode",void 0),p([t.property({type:t.Node,displayName:"原点图片"})],n.prototype,"orginImgNode",void 0),p([t.property({type:t.Node,displayName:"拖动点"})],n.prototype,"dragNode",void 0),p([t.property({displayName:"最大拖动范围"})],n.prototype,"radius",void 0),n=p([t.ccclass("JoystickCC"),t.menuUI("JoystickCC")],n),t.JoystickCC=n}(apeng||(apeng={})),function(t){var e,i=e=function(i){function n(){var t;return(t=i.apply(this,arguments)||this).backupDescribe="数字滚动组件",t.lastStr="",t.duration=1,t.strInterval=",",t._to=-1,t._from=-1,t.isAnim=!1,t._dtCount=0,t.cur=0,t}o(n,i);var r=n.prototype;return r.onEnable=function(){i.prototype.onEnable.call(this),this.isAnim=!1,this._dtCount=0},r.onUpdate=function(){if(this.isAnim){if(this._dtCount+=t._timer.dtDefault,this._dtCount>this.duration)return this._dtCount=0,this.isAnim=!1,void this.updateString(this._to);var e=t.Maths.clamp01(this._dtCount/this.duration);e=t.easing(t.EEaseType.linear,e),this.updateString(Math.floor(t.Maths.lerp(this._from,this._to,e)))}},r.toByString=function(t){if(this._from=this.cur,this._to=t,this._to<this._from)return this.isAnim=!1,void this.updateString(this._to);this._dtCount=0,this.isAnim=!0},r.updateString=function(t){this.cur=t;var i="";if(t>9999999)i=Math.floor(t/1e4)+e.texts[20002];else if(t>99999)i=Math.floor(t/1e3)+e.texts[20001];else if(i=t+this.lastStr,!this.lastStr&&this.strInterval){var n=i,o=-1;i="";for(var r=n.length-1;r>=0;r--)o%3==2&&(i=this.strInterval+i),i=n[r]+i,o++}(this.Label||this.FontCC).string=i},r.setString=function(t){this.isAnim=!1,this.updateString(t)},n}(t.BaseComponent);i.texts={20001:"k",20002:"w"},p([t.property({displayName:"后缀"})],i.prototype,"lastStr",void 0),p([t.property({displayName:"滚动动画时长"})],i.prototype,"duration",void 0),p([t.property({displayName:"数字间隔"})],i.prototype,"strInterval",void 0),i=e=p([t.ccclass("LabelNumRollCC"),t.menuUI("LabelNumRollCC")],i),t.LabelNumRollCC=i}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).backupDescribe="多语言静态文本",t.configID=-1,t.lb=null,t}o(i,e);var n=i.prototype;return n.__preload=function(){-1!=this.configID&&(this.lb=this.getComponent(t.Label),this.lb&&this.lb.cacheMode==t.Label.CacheMode.BITMAP&&(this.lb.cacheMode=t.Label.CacheMode.NONE))},n.onEnable=function(){-1!=this.configID&&this.lb&&(t._language.on(t._language.EventType.CHANGE,this.onEventChange,this),this.onEventChange((function(){})))},n.onDisable=function(){-1!=this.configID&&this.lb&&t._language.off(t._language.EventType.CHANGE,this.onEventChange,this)},n.onEventChange=function(e){this.lb.string=t._language.get(this.configID),e()},i}(_cc_.Component);p([t.property({displayName:"lang表ID"})],e.prototype,"configID",void 0),e=p([t.ccclass("LanguageLabelCC"),t.menuUI("LanguageLabelCC")],e),t.LanguageLabelCC=e}(apeng||(apeng={})),function(t){var e,i,n;!function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical",t[t.HorizontalGrid=2]="HorizontalGrid",t[t.VerticalGrid=3]="VerticalGrid"}(e=t.ELayoutType||(t.ELayoutType={})),t.ccenum(e),function(t){t[t.BottomToTop=0]="BottomToTop",t[t.TopToBottom=1]="TopToBottom"}(i=t.EVerticalDirection||(t.EVerticalDirection={})),t.ccenum(i),function(t){t[t.LeftToRight=0]="LeftToRight",t[t.RightToLeft=1]="RightToLeft"}(n=t.EHorizontalDirection||(t.EHorizontalDirection={})),t.ccenum(n);var r=new t.Vec3,a=new t.Rectangle,s=function(s){function u(){var o;return(o=s.apply(this,arguments)||this).backupDescribe="网格排布",o.content=null,o._itemSize=new t.Size(40,40),o._numItems=0,o._horizontalItemY=0,o._verticalItemX=0,o._horizontalGridCount=1,o._verticalGridCount=1,o._isSetContentSize=!0,o._type=e.Horizontal,o._horizontalDirection=n.LeftToRight,o._verticalDirection=i.TopToBottom,o._paddingLeft=0,o._paddingRight=0,o._paddingTop=0,o._paddingBottom=0,o._spacingX=0,o._spacingY=0,o._horizontalAddByLevel=0,o._verticalAddByLevel=0,o._ratatePosition=0,o._applyItemRotate=!1,o._showItemByLabelIndex=!1,o._gridOneCenter=!1,o.onEditorUpdateData=o.updateView,o.onAnchorChange=o.updateView,o.itemByPosition=[],o}o(u,s);var h=u.prototype;return h.onLoad=function(){s.prototype.onLoad.call(this),t.EDITOR&&(this.content||(this.content=this.node)),this.updateView()},h.start=function(){s.prototype.start.call(this),this.updateView()},h.updateView=function(){var i=null,n=null;switch(this._type){case e.Horizontal:i=this.getHorizontalWidth(),this._doLayoutHorizontal(i);break;case e.Vertical:n=this.getVerticalHeight(),this._doLayoutVertical(n);break;case e.HorizontalGrid:i=this.getHorizontalWidth(),n=this.getVerticalHeight(Math.min(this._horizontalGridCount,this._numItems)),this._doLayoutHorizontalGrid(i);break;case e.VerticalGrid:i=this.getHorizontalWidth(Math.min(this._verticalGridCount,this._numItems)),n=this.getVerticalHeight(),this._doLayoutVerticalGrid(n)}this.updateItemPosition(),this.updateItemRotate(),this.isSetContentSize&&t.NodeHelper.setSize(this.content,i,n)},h.getItemRectange=function(t,e,i,n){return t.size=this._itemSize,t.center=this.getItemPosition(e,i,n),this._applyItemRotate&&(t.angle=this._ratatePosition),t},h.getPositionByIndex=function(t){for(var e=0;e<this._numItems;e++)if(this.getItemRectange(a,e,!1),a.contains(t))return e;return-1},h._doLayoutVertical=function(t){var e=1,i=this._paddingBottom;1==this._verticalDirection&&(e=-1,i=this._paddingTop);for(var n=(this._verticalDirection-this.contentTransform.anchorY)*t+e*i-e*this._spacingY,o=0;o<this._numItems;o++){var r=.5*e*this._itemSize.height;n+=e*(.5*this._itemSize.height+this._spacingY),this.setItemPosition(o,this._verticalItemX,n,o),n+=r}},h._doLayoutHorizontal=function(t){var e=1,i=this._paddingLeft;1==this._horizontalDirection&&(e=-1,i=this._paddingRight);for(var n=(this._horizontalDirection-this.contentTransform.anchorX)*t+e*i-e*this._spacingX,o=0;o<this._numItems;o++){var r=.5*e*this._itemSize.width;n+=e*(.5*this._itemSize.width+this._spacingX),this.setItemPosition(o,n,this._horizontalItemY,o),n+=r}},h._doLayoutHorizontalGrid=function(t){var e=1,i=this._paddingLeft;1==this._horizontalDirection&&(e=-1,i=this._paddingRight);for(var n=(this._horizontalDirection-this.contentTransform.anchorX)*t+e*i-e*this._spacingX,o=this.getHorizontalCount(),r=0;r<o;r++){var a=.5*e*this._itemSize.width;n+=e*(.5*this._itemSize.width+this._spacingX);for(var s=0;s<this._horizontalGridCount;s++){var l=-(s-(this._horizontalGridCount-1)/2)*(this._itemSize.height+this._spacingY);if(this._gridOneCenter&&r==o-1){var u=this._horizontalGridCount-this._numItems%this._horizontalGridCount;u!=this._horizontalGridCount&&(l-=u*(this._itemSize.height+this._spacingY)/2)}this.setItemPosition(r*this._horizontalGridCount+s,n,l,r)}n+=a}},h._doLayoutVerticalGrid=function(t){var e=1,i=this._paddingBottom;1==this._verticalDirection&&(e=-1,i=this._paddingTop);for(var n=(this._verticalDirection-this.contentTransform.anchorY)*t+e*i-e*this._spacingY,o=this.geVerticalCount(),r=0;r<o;r++){var a=.5*e*this._itemSize.height;n+=e*(.5*this._itemSize.height+this._spacingY);for(var s=0;s<this._verticalGridCount;s++){var l=(s-(this._verticalGridCount-1)/2)*(this._itemSize.width+this._spacingX);if(this._gridOneCenter&&r==o-1){var u=this._verticalGridCount-this._numItems%this._verticalGridCount;u!=this._verticalGridCount&&(l+=u*(this._itemSize.width+this._spacingX)/2)}this.setItemPosition(r*this._verticalGridCount+s,l,n,r)}n+=a}},h.setItemPosition=function(e,i,n,o){var r=this.itemByPosition[e];r||(r=this.itemByPosition[e]=new t.Vector2),r.x=o*this._horizontalAddByLevel,r.y=o*this._verticalAddByLevel,r.x+=i,r.y+=n,0!=this._ratatePosition&&t.Vector2.rotate(r,r,t.Maths.toRadian(this._ratatePosition))},h.getItemPosition=function(e,i,n){return this.itemByPosition[e]?(t.Vector2.set(r,this.itemByPosition[e]),i&&t.NodeHelper.convertToWorldSpaceAR(r,this.content,r),n&&t.Vector2.add(r,r,n),r):null},h.updateItemRotate=function(){if(this._applyItemRotate&&0!=this._ratatePosition)for(var e=0;e<this.content.children.length;e++)t.NodeHelper.setRotateZ(this.content.children[e],this._ratatePosition,!1)},h.updateItemPosition=function(e){if(void 0===e&&(e=-1),-1==e){for(var i=0;i<this.content.children.length;i++)if(t.NodeHelper.setPositionXY(this.content.children[i],this.itemByPosition[i],!1),this._showItemByLabelIndex){var n=this.content.children[i].getComponentInChildren(t.Label);n&&(n.string=i+"")}}else t.NodeHelper.setPositionXY(this.content.children[e],this.itemByPosition[e],!1)},h.getHorizontalWidth=function(t){return t||(t=this.getHorizontalCount()),t*this._itemSize.width+(t-1)*this._spacingX+this._getPaddingH()},h.getVerticalHeight=function(t){return t||(t=this.geVerticalCount()),t*this._itemSize.height+(t-1)*this._spacingY+this._getPaddingV()},h.getHorizontalCount=function(){return Math.ceil(this._numItems/this._horizontalGridCount)},h.geVerticalCount=function(){return Math.ceil(this._numItems/this._verticalGridCount)},h._getPaddingH=function(){return this._paddingLeft+this._paddingRight},h._getPaddingV=function(){return this._paddingTop+this._paddingBottom},l(u,[{key:"itemSize",get:function(){return this._itemSize},set:function(t){this._itemSize.equals(t)||(this._itemSize.set(t),this.updateView())}},{key:"numItems",get:function(){return this._numItems},set:function(t){this._numItems!=t&&(this._numItems=t,this.updateView())}},{key:"type",get:function(){return this._type},set:function(t){this._type!=t&&(this._type=t,this.updateView())}},{key:"horizontalGridCount",get:function(){return this._horizontalGridCount},set:function(e){this._horizontalGridCount!=e&&(this._horizontalGridCount=t.Maths.clampf(e,1,9999),this.updateView())}},{key:"verticalGridCount",get:function(){return this._verticalGridCount},set:function(e){this._verticalGridCount!=e&&(this._verticalGridCount=t.Maths.clampf(e,1,9999),this.updateView())}},{key:"horizontalDirection",get:function(){return this._horizontalDirection},set:function(t){this._horizontalDirection!=t&&(this._horizontalDirection=t,this.updateView())}},{key:"verticalDirection",get:function(){return this._verticalDirection},set:function(t){this._verticalDirection!=t&&(this._verticalDirection=t,this.updateView())}},{key:"paddingLeft",get:function(){return this._paddingLeft},set:function(t){this._paddingLeft!=t&&(this._paddingLeft=t,this.updateView())}},{key:"paddingRight",get:function(){return this._paddingRight},set:function(t){this._paddingRight!=t&&(this._paddingRight=t,this.updateView())}},{key:"paddingTop",get:function(){return this._paddingTop},set:function(t){this._paddingTop!=t&&(this._paddingTop=t,this.updateView())}},{key:"paddingBottom",get:function(){return this._paddingBottom},set:function(t){this._paddingBottom!=t&&(this._paddingBottom=t,this.updateView())}},{key:"spacingX",get:function(){return this._spacingX},set:function(t){this._spacingX!=t&&(this._spacingX=t,this.updateView())}},{key:"spacingY",get:function(){return this._spacingY},set:function(t){this._spacingY!=t&&(this._spacingY=t,this.updateView())}},{key:"horizontalItemY",get:function(){return this._horizontalItemY},set:function(t){this._horizontalItemY!=t&&(this._horizontalItemY=t,this.updateView())}},{key:"verticalItemX",get:function(){return this._verticalItemX},set:function(t){this._verticalItemX!=t&&(this._verticalItemX=t,this.updateView())}},{key:"horizontalAddByLevel",get:function(){return this._horizontalAddByLevel},set:function(t){this._horizontalAddByLevel!=t&&(this._horizontalAddByLevel=t,this.updateView())}},{key:"verticalAddByLevel",get:function(){return this._verticalAddByLevel},set:function(t){this._verticalAddByLevel!=t&&(this._verticalAddByLevel=t,this.updateView())}},{key:"isSetContentSize",get:function(){return this._isSetContentSize},set:function(t){this._isSetContentSize!=t&&(this._isSetContentSize=t,this.updateView())}},{key:"ratatePosition",get:function(){return this._ratatePosition},set:function(t){this._ratatePosition!=t&&(this._ratatePosition=t,this.updateView())}},{key:"applyItemRotate",get:function(){return this._applyItemRotate},set:function(t){this._applyItemRotate!=t&&(this._applyItemRotate=t,this.updateView())}},{key:"showItemByLabelIndex",get:function(){return this._showItemByLabelIndex},set:function(t){this._showItemByLabelIndex!=t&&(this._showItemByLabelIndex=t,this.updateView())}},{key:"gridOneCenter",get:function(){return this._gridOneCenter},set:function(t){this._gridOneCenter!=t&&(this._gridOneCenter=t,this.updateView())}},{key:"contentTransform",get:function(){return t.NodeHelper.getUITransform(this.content)}}]),u}(t.BaseComponent);p([t.property({type:t.Node,displayName:"容器"})],s.prototype,"content",void 0),p([t.property({displayName:"格子大小"})],s.prototype,"itemSize",null),p([t.property({step:1,displayName:"当前个数"})],s.prototype,"numItems",null),p([t.property({type:e,displayName:"排版"})],s.prototype,"type",null),p([t.property({displayName:"横向行数",visible:function(){return this._type==e.HorizontalGrid}})],s.prototype,"horizontalGridCount",null),p([t.property({displayName:"纵向列数",visible:function(){return this._type==e.VerticalGrid}})],s.prototype,"verticalGridCount",null),p([t.property({type:n,displayName:"横向顺序",visible:function(){return this._type==e.Horizontal||this._type==e.HorizontalGrid}})],s.prototype,"horizontalDirection",null),p([t.property({type:i,displayName:"纵向顺序",visible:function(){return this._type==e.Vertical||this._type==e.VerticalGrid}})],s.prototype,"verticalDirection",null),p([t.property({displayName:"左边距",visible:function(){return this._type==e.Horizontal||this._type==e.HorizontalGrid}})],s.prototype,"paddingLeft",null),p([t.property({displayName:"右边距",visible:function(){return this._type==e.Horizontal||this._type==e.HorizontalGrid}})],s.prototype,"paddingRight",null),p([t.property({displayName:"上边距",visible:function(){return this._type==e.Vertical||this._type==e.VerticalGrid}})],s.prototype,"paddingTop",null),p([t.property({displayName:"下边距",visible:function(){return this._type==e.Vertical||this._type==e.VerticalGrid}})],s.prototype,"paddingBottom",null),p([t.property({displayName:"水平间距",visible:function(){return this._type==e.Horizontal||this._type==e.HorizontalGrid||this._type==e.VerticalGrid}})],s.prototype,"spacingX",null),p([t.property({displayName:"纵向间距",visible:function(){return this._type==e.Vertical||this._type==e.HorizontalGrid||this._type==e.VerticalGrid}})],s.prototype,"spacingY",null),p([t.property({displayName:"横向时Y",visible:function(){return this._type==e.Horizontal}})],s.prototype,"horizontalItemY",null),p([t.property({displayName:"纵向时X",visible:function(){return this._type==e.Vertical}})],s.prototype,"verticalItemX",null),p([t.property({displayName:"横向递增"})],s.prototype,"horizontalAddByLevel",null),p([t.property({displayName:"纵向递增"})],s.prototype,"verticalAddByLevel",null),p([t.property({displayName:"设置容器宽高"})],s.prototype,"isSetContentSize",null),p([t.property({displayName:"旋转角度"})],s.prototype,"ratatePosition",null),p([t.property({displayName:"子节点旋转"})],s.prototype,"applyItemRotate",null),p([t.property({displayName:"显示itemLabel"})],s.prototype,"showItemByLabelIndex",null),p([t.property({displayName:"网格剩一排居中",visible:function(){return this._type==e.HorizontalGrid||this.type==e.VerticalGrid}})],s.prototype,"gridOneCenter",null),p([t.property({serializable:!0})],s.prototype,"_itemSize",void 0),p([t.property({serializable:!0})],s.prototype,"_numItems",void 0),p([t.property({serializable:!0})],s.prototype,"_horizontalItemY",void 0),p([t.property({serializable:!0})],s.prototype,"_verticalItemX",void 0),p([t.property({serializable:!0})],s.prototype,"_horizontalGridCount",void 0),p([t.property({serializable:!0})],s.prototype,"_verticalGridCount",void 0),p([t.property({serializable:!0})],s.prototype,"_isSetContentSize",void 0),p([t.property({serializable:!0})],s.prototype,"_type",void 0),p([t.property({serializable:!0})],s.prototype,"_horizontalDirection",void 0),p([t.property({serializable:!0})],s.prototype,"_verticalDirection",void 0),p([t.property({serializable:!0})],s.prototype,"_paddingLeft",void 0),p([t.property({serializable:!0})],s.prototype,"_paddingRight",void 0),p([t.property({serializable:!0})],s.prototype,"_paddingTop",void 0),p([t.property({serializable:!0})],s.prototype,"_paddingBottom",void 0),p([t.property({serializable:!0})],s.prototype,"_spacingX",void 0),p([t.property({serializable:!0})],s.prototype,"_spacingY",void 0),p([t.property({serializable:!0})],s.prototype,"_horizontalAddByLevel",void 0),p([t.property({serializable:!0})],s.prototype,"_verticalAddByLevel",void 0),p([t.property({serializable:!0})],s.prototype,"_ratatePosition",void 0),p([t.property({serializable:!0})],s.prototype,"_applyItemRotate",void 0),p([t.property({serializable:!0})],s.prototype,"_showItemByLabelIndex",void 0),p([t.property({serializable:!0})],s.prototype,"_gridOneCenter",void 0),s=p([t.ccclass("LayoutCC"),t.executeInEditMode,t.menuUI("LayoutCC")],s),t.LayoutCC=s}(apeng||(apeng={})),function(t){var e=new t.Vector2,i=(new t.Vector2,function(i){function n(){var t;return(t=i.apply(this,arguments)||this).backupDescribe="网格排布",t.allCount=3,t._mulDisCount=3,t._mulCount=[],t.positions=[],t}o(n,i);var r=n.prototype;return r.onUpdateItem=function(){var i=0;this.positions[i]||(this.positions[i]=t.Vector2.pool.get()),this.positions[i].set();for(var n=0;n<this._mulCount.length;n++)for(var o=this._mulCount[n],r=0;r<o;r++){i++,this.positions[i]||(this.positions[i]=t.Vector2.pool.get());var a=(r+1)/o*360;e.set(1,0),e.rotateSelf(t.Maths.toRadian(a));var s=this._mulDisCount*(n+1);t.Vector2.mul(this.positions[i],e,s)}this.allCount=i+1;var l=this.content.children,u=this.positions.length-l.length;if(u>0)for(var h=0;h<u;h++)t.Vector2.pool.put(this.positions.pop());t.Sets.sortMax(this.positions,(function(t){return t.y+1e6}));for(var c=0;c<l.length;c++)l[c]&&t.NodeHelper.setPositionXY(l[c],this.positions[c],!1)},r.getRadius=function(){var e=0,i=this.prefabItem;if(i){var n=i.data;if(n){var o=t.NodeHelper.getUITransform(n);if(o){var r=o.contentSize;e=Math.max(r.width,r.height)}}}return this._mulCount.length*this._mulDisCount+e},l(n,[{key:"mulCount",get:function(){return this._mulCount},set:function(t){this._mulCount=t,this.onUpdateItem()}},{key:"mulDisCount",get:function(){return this._mulDisCount},set:function(t){this._mulDisCount!=t&&(this._mulDisCount=t,this.onUpdateItem())}}]),n}(t.CreatePrefabToEditorCC));p([t.property({type:[t.CCInteger],displayName:"圈数"})],i.prototype,"mulCount",null),p([t.property({displayName:"每圈距离"})],i.prototype,"mulDisCount",null),p([t.property({displayName:"总个数"})],i.prototype,"allCount",void 0),p([t.property({serializable:!0})],i.prototype,"_mulDisCount",void 0),p([t.property({serializable:!0})],i.prototype,"_mulCount",void 0),i=p([t.ccclass("LayoutCircleCC"),t.executeInEditMode,t.menuUI("LayoutCircleCC")],i),t.LayoutCircleCC=i}(apeng||(apeng={})),function(t){var e,i=e=function(i){function n(){var e;return(e=i.apply(this,arguments)||this).prefabItem=null,e.prefabBg=null,e.sfOnce=null,e.sfLast=null,e.sfLoop=[],e.itemYOffset=new t.Vec2,e.itemCount=0,e.bgCount=0,e.parses=null,e.bgs=[],e.items=[],e.contentTrans=null,e.screenH=-1,e.showBgs={},e.showItems={},e}o(n,i),n.getBgIndexByData=function(t,e){if(0==t)return e.source.items.once;if(t==e.bgsY.length-1)return e.source.items.last;var i=e.source.items.loop;return i[(t-1)%i.length]},n.getBgIndexBySf=function(t,e,i){if(0==t)return i.sfOnce;if(t==e.bgsY.length-1)return i.sfLast;var n=e.source.items.loop;return i.sfLoop[(t-1)%n.length]},n.parseData=function(t){for(var e,i={source:t,onceY:0,loopY:[],itemsY:[],bgsY:[]},n=t.items,o=0,r=u(n.loop);!(e=r()).done;){o+=e.value.position.length}var a=(t.count-n.once.position.length-n.last.position.length)/o;i.bgsY.push(0);for(var s,l=0,h=u(n.once.position);!(s=h()).done;){var c=s.value;i.itemsY.push([c.x,c.y+l])}for(var p=0;p<a;p++){for(var d,f=[],y=u(n.loop);!(d=y()).done;){var g=d.value,m=l+n.once.height;f.push(m),i.bgsY.push(m),l+=g.height;for(var v,C=u(g.position);!(v=C()).done;){var _=v.value;i.itemsY.push([_.x,_.y+l])}}i.loopY.push(f)}i.lastY=l+n.once.height,i.bgsY.push(i.lastY);for(var S,E=u(n.last.position);!(S=E()).done;){var b=S.value;i.itemsY.push([b.x,b.y+i.lastY])}return i.allHeight=i.lastY+n.last.height,i};var r=n.prototype;return r.createNode=function(e){var i=e.addComponent(t.Widget);i.isAlignBottom=!0,i.bottom=0,t.NodeHelper.getUITransform(e).setAnchorPoint(.5,0)},r.onLoad=function(){if(i.prototype.onLoad.call(this),t.EDITOR){var e=this.node.getComponent(t.ScrollView);return e||((e=this.node.addComponent(t.ScrollView)).horizontal=!1,e.vertical=!0,e.inertia=!0,e.brake=.75,e.elastic=!0,e.bounceDuration=.23,e.content=this.content,e.cancelInnerEvents=!0),this.bgParent,this.itemParent,void(this.contentTrans=t.NodeHelper.getUITransform(this.content))}this.screenH=t.winSize().height+10,this.contentTrans=t.NodeHelper.getUITransform(this.content),this.addEvent(t.ScrollView.EventType.SCROLLING,this.updateView,this,this.node);for(var n=0;n<this.bgCount;n++){var o=t.instantiate(this.prefabBg),r=o.getComponent("LevelRollCCBg");this.bgs.push(r),this.bgParent.addChild(o),t.NodeHelper.setPositionY(o,-1e4,!1)}for(var a=0;a<this.itemCount;a++){var s=t.instantiate(this.prefabItem),l=s.getComponent("LevelRollCCItem");this.items.push(l),this.itemParent.addChild(s),t.NodeHelper.setPositionY(s,-1e4,!1)}},r.init=function(t){this.parses=t,this.contentTrans.height=this.parses.allHeight,this.updateView()},r.updateView=function(){for(var i=-this.content.position.y-10,n=i+this.screenH,o=this.parses.bgsY,r=0;r<o.length;r++){var a=o[r];if(t.Polygon.oneLineLine(i,n,a,a+e.getBgIndexByData(r,this.parses).height)){if(!this.showBgs[r]){var s=this.bgs.pop();if(!s)continue;s.updateView(this,r),this.showBgs[r]=s}}else this.showBgs[r]&&(this.bgs.push(this.showBgs[r]),this.showBgs[r].setPositionY(-1e4,!1),delete this.showBgs[r])}for(var l=this.parses.itemsY,u=0;u<l.length;u++){var h=l[u][1];if(t.Polygon.oneLineLine(i,n,h-this.itemYOffset.x,h+this.itemYOffset.y)){if(!this.showItems[u]){var c=this.items.pop();if(!c)continue;c.updateView(this,u),this.showItems[u]=c}}else this.showItems[u]&&(this.items.push(this.showItems[u]),this.showItems[u].setPositionY(-1e4,!1),delete this.showItems[u])}},r.clearShow=function(){for(var t in this.showBgs)this.bgs.push(this.showBgs[t]),this.showBgs[t].setPositionY(-1e4,!1),delete this.showBgs[t];for(var e in this.showBgs)this.items.push(this.showItems[e]),this.showItems[e].setPositionY(-1e4,!1),delete this.showItems[e]},r.scrollToIndex=function(e,i,n){i>0?this.ScrollView.scrollToPercentVertical(e/this.parses.itemsY.length,i):(this.ScrollView.setContentPosition(new t.Vec3(0,-this.parses.itemsY[e][1]+n,0)),this.updateView())},r.getItemWithIndex=function(t){return this.showItems[t]},l(n,[{key:"content",get:function(){return t.NodeHelper.getChildByCreate(this.node,"content",this.createNode.bind(this),void 0,!0)}},{key:"bgParent",get:function(){return t.NodeHelper.getChildByCreate(this.content,"bg",this.createNode.bind(this),0,!0)}},{key:"itemParent",get:function(){return t.NodeHelper.getChildByCreate(this.content,"item",this.createNode.bind(this),1,!0)}}]),n}(t.BaseComponent);p([t.property({type:t.Prefab,displayName:"item"})],i.prototype,"prefabItem",void 0),p([t.property({type:t.Prefab,displayName:"背景"})],i.prototype,"prefabBg",void 0),p([t.property({type:t.SpriteFrame,displayName:"第一张图"})],i.prototype,"sfOnce",void 0),p([t.property({type:t.SpriteFrame,displayName:"最后一张图"})],i.prototype,"sfLast",void 0),p([t.property({type:[t.SpriteFrame],displayName:"循环图"})],i.prototype,"sfLoop",void 0),p([t.property({displayName:"item Y范围偏移"})],i.prototype,"itemYOffset",void 0),p([t.property({displayName:"实例化item个数"})],i.prototype,"itemCount",void 0),p([t.property({displayName:"实例化背景个数"})],i.prototype,"bgCount",void 0),i=e=p([t.ccclass("LevelRollCC"),t.executeInEditMode,t.menuUI("LevelRollCC")],i),t.LevelRollCC=i}(apeng||(apeng={})),function(t){var e=function(e){function i(){return e.apply(this,arguments)||this}return o(i,e),i.prototype.updateView=function(e,i){this.Sprite.spriteFrame=t.LevelRollCC.getBgIndexBySf(i,e.parses,e),this.setPositionY(e.parses.bgsY[i],!1)},i}(t.BaseComponent);e=p([t.ccclass("LevelRollCCBg"),t.menuUI("LevelRollCCBg")],e),t.LevelRollCCBg=e}(apeng||(apeng={})),function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e.prototype.updateView=function(t,e){this.setPositionXY(t.parses.itemsY[e],!1)},e}(t.BaseComponent);e=p([t.ccclass("LevelRollCCItem"),t.menuUI("LevelRollCCItem")],e),t.LevelRollCCItem=e}(apeng||(apeng={})),function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e.prototype.listInit=function(){},e}(t.BaseComponent);e=p([t.ccclass("ListCCByBaseItemCC"),t.menuList("ListCCByBaseItemCC")],e),t.ListCCByBaseItemCC=e}(apeng||(apeng={})),function(t){var e=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).backupDescribe="列表使用layout 显隐节点",e}return o(e,t),e}(_cc_.Component);e=p([t.ccclass("ListCCByLayoutItemRenderCC"),t.menuList("ListCCByLayoutItemRenderCC")],e),t.ListCCByLayoutItemRenderCC=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).backupDescribe="列表",t.renderTop=100,t.renderBottom=100,t.topPadding=0,t.bottomPadding=0,t.ySpace=0,t.itemHeight=100,t.itemDatas=null,t.itemDataLength=-1,t.itemHeights=[],t.itemYs=[],t.itemByIndexs=[],t.curRenderMin=-1,t.curRenderMax=-1,t.itemDataRender=null,t.onSizeChange=t.updateRenderRange,t.onEventScrolling=t.updateItems,t}o(i,e);var n=i.prototype;return n.onLoad=function(){if(e.prototype.onLoad.call(this),t.EDITOR){var i=this.node.getComponent(t.ScrollView);i||((i=this.node.addComponent(t.ScrollView)).horizontal=!1,i.vertical=!0,i.inertia=!0,i.brake=.75,i.elastic=!0,i.bounceDuration=.23,i.content=this.content,i.cancelInnerEvents=!0);var n=this.node.getComponent(t.Mask);n||((n=this.node.addComponent(t.Mask)).inverted=!1,n.type=t.Mask.Type.GRAPHICS_RECT)}else this.addEvent(t.ScrollView.EventType.SCROLLING,this.onEventScrolling,this,this.node)},n.onEnable=function(){e.prototype.onEnable.call(this),this.updateRange(),this.scheduleOnceCover(this.updateRange)},n.onDisable=function(){this.clearItems(),e.prototype.onDisable.call(this)},n.updateRange=function(){this.updateRenderRange(),this.updateContentSize()},n.clearItems=function(){this.itemByIndexs.length=0;for(var t=this.items,e=t.length-1;e>=0;e--)this.removeItem(t[e])},n.setItemDatas=function(t){"number"==typeof t?(this.itemDatas=null,this.itemDataLength=t):(this.itemDatas=t,this.itemDataLength=this.itemDatas.length),this.itemYs.length=this.itemDataLength,this.itemHeights.length=this.itemDataLength;for(var e=0;e<this.itemDataLength;e++)void 0===this.itemHeights[e]&&(this.itemHeights[e]=this.itemHeight),void 0===this.itemYs[e]&&(this.itemYs[e]=this.getItemY(e));this.updateContentSize()},n.updateRenderRange=function(){this.curRenderMax=this.renderTop,this.curRenderMin=-this.UITransform.height-this.renderBottom},n.updateItems=function(){for(var e=!1,i=this.content.position.y,n=0;n<this.itemYs.length;n++){var o=this.itemYs[n]+i,r=o-this.itemHeights[n];if(t.Polygon.oneLineLine(r,o,this.curRenderMin,this.curRenderMax)){if(-1==this.itemByIndexs.indexOf(n)){this.itemByIndexs.push(n);var a=this.addItem();this.itemDataRender&&this.itemDataRender(this.itemDatas?this.itemDatas[n]:n,a,n),e=!0}}else{var s=this.itemByIndexs.indexOf(n);-1!=s&&(this.itemByIndexs.splice(s,1),this.removeItem(this.items[s]))}}e&&this.scheduleOnceCover(this.onDealyAddItem)},n.onDealyAddItem=function(){for(var e=this.items,i=0;i<this.itemByIndexs.length;i++){var n=this.itemByIndexs[i],o=e[i];this.itemHeights[n]=t.NodeHelper.getUITransform(o).height;var r=this.getItemY(n);this.itemYs[n]=r,t.NodeHelper.setPositionY(o,r,!1)}for(var a=this.itemByIndexs[this.itemByIndexs.length-1];a<this.itemYs.length;a++)this.itemYs[a]=this.getItemY(a);this.updateContentSize()},n.getItemY=function(t){var e=t-1;return-1==e?-this.topPadding:this.itemYs[e]-this.ySpace-this.itemHeights[e]},n.updateContentSize=function(){var t=this.topPadding+this.bottomPadding;t+=Math.max(0,this.itemDataLength-1)*this.ySpace;for(var e,i=u(this.itemHeights);!(e=i()).done;){t+=e.value}this.contentUITransform.height=t},n.updateItemData=function(e){if(this.itemDataRender){var i=t.Sets.filterOf(this.itemByIndexs,(function(t){return t==e}));-1!=i&&(this.itemDataRender(this.itemDatas?this.itemDatas[e]:e,this.items[i],e),this.scheduleOnceCover(this.onDealyAddItem))}},n.updateItemDatas=function(){for(var t,e=u(this.itemByIndexs);!(t=e()).done;){var i=t.value;this.updateItemData(i)}},n.showIndex=function(t,e){void 0===e&&(e=0);var i=(1==this.contentUITransform.anchorY?this.topPadding:this.bottomPadding)+(this.ySpace+this.itemHeight)*t;0==t&&(i=0),this.content.setPosition(0,Math.max(0,i+e)),this.updateItems()},l(i,[{key:"content",get:function(){return this.getChildByCreate("content",(function(e){e.addComponent(t.Widget)}),-1,!0)}}]),i}(t.CreatePrefabToEditorCC);p([t.property({displayName:"顶部渲染距离"})],e.prototype,"renderTop",void 0),p([t.property({displayName:"底部渲染距离"})],e.prototype,"renderBottom",void 0),p([t.property({displayName:"上边距"})],e.prototype,"topPadding",void 0),p([t.property({displayName:"下边距"})],e.prototype,"bottomPadding",void 0),p([t.property({displayName:"纵向间距"})],e.prototype,"ySpace",void 0),p([t.property({displayName:"初始item高度"})],e.prototype,"itemHeight",void 0),e=p([t.ccclass("ListRollCC"),t.executeInEditMode,t.menuList("ListRollCC")],e),t.ListRollCC=e}(apeng||(apeng={})),function(t){var e=null;function i(){return null==e&&(e=t.winSize().clone()).height/e.width>1.98&&(e.height=1.98*e.width),e}t.uiMaxSize=i;var n=function(e){function n(){var t;return(t=e.apply(this,arguments)||this).backupDescribe="可视范围控制",t._bottomOffset=0,t._topOffset=0,t._isTop=!0,t._isBottom=!0,t.onEditorUpdateData=t.updateView,t}o(n,e),n.worldYBottom=function(){return(t.winSize().height-i().height)/2},n.worldYTop=function(){var e=i().height;return(t.winSize().height-e)/2+e};var r=n.prototype;return r.onLoad=function(){e.prototype.onLoad.call(this),this.updateView()},r.updateView=function(){var e=i(),n=e.width,o=e.height,r=t.winSize().height,a=(r-o)/2,s=0;this._isTop?this._isBottom?!this._isTop&&this._isBottom&&(o=r):(o+=a,s-=a/2):(o+=a,s+=a/2),0!=a&&(this._isTop&&0!=this._topOffset&&(o+=this._topOffset,s+=this._topOffset/2),this._isBottom&&0!=this._bottomOffset&&(o+=this._bottomOffset,s-=this._bottomOffset/2)),this.setPositionY(s,!1),this.setSize(n,o)},l(n,[{key:"isTop",get:function(){return this._isTop},set:function(t){this._isTop!=t&&(this._isTop=t,this.updateView())}},{key:"topOffset",get:function(){return this._topOffset},set:function(t){this._topOffset!=t&&(this._topOffset=t,this.updateView())}},{key:"isBottom",get:function(){return this._isBottom},set:function(t){this._isBottom!=t&&(this._isBottom=t,this.updateView())}},{key:"bottomOffset",get:function(){return this._bottomOffset},set:function(t){this._bottomOffset!=t&&(this._bottomOffset=t,this.updateView())}}]),n}(t.BaseComponent);p([t.property({displayName:"空出顶部"})],n.prototype,"isTop",null),p([t.property({visible:function(){return this._isBottom},displayName:"顶部长度偏移"})],n.prototype,"topOffset",null),p([t.property({displayName:"空出底部"})],n.prototype,"isBottom",null),p([t.property({visible:function(){return this._isBottom},displayName:"底部长度偏移"})],n.prototype,"bottomOffset",null),p([t.property({serializable:!0})],n.prototype,"_bottomOffset",void 0),p([t.property({serializable:!0})],n.prototype,"_topOffset",void 0),p([t.property({serializable:!0})],n.prototype,"_isTop",void 0),p([t.property({serializable:!0})],n.prototype,"_isBottom",void 0),n=p([t.ccclass("MaxBoxCC"),t.executeInEditMode,t.menuUI("MaxBoxCC")],n),t.MaxBoxCC=n}(apeng||(apeng={})),function(t){var e=new t.Vector3,i=function(){function i(){this.endCallBack=new t.CompleteCallBack,this.node=null,this.isWorld=!0,this.speed=100,this.isSlowMotion=!0,this.fromTarget=new t.Vector3,this.isPause=!0,this.laseIndex=-1,this.lookAtNode=null,this.lookAtNodeRotate=-1,this.allDuration=0,this.states=[],this.datas=[],this._index=-1,this.setPosition=null,this.getPosition=null,this._v3T=new t.Vector3,this._v3T2=new t.Vector3}i.getPosition=function(t,e){return null},i.setPosition=function(t,e,i){return null},i.lookAt=function(t,e,i,n){},i.getDeltaTime=function(t){return 1/60};var n=i.prototype;return n.init=function(t,e,i,n){void 0===n&&(n=!0),this.node=t,this.isWorld=e,this.speed=i,this.isSlowMotion=n,this.clear()},n.dispose=function(){this.endCallBack.clear(),this.clear();for(var t,e=u(this.states);!(t=e()).done;){var n=t.value;i.IMoveState.put(n)}this.states.length=0;for(var o,r=u(this.datas);!(o=r()).done;){var a=o.value;i.IMove.put(a)}this.datas.length=0,this.node=null,this.lookAtNode=null,this.lookAtNodeRotate=-1,this.isWorld=!0,this.speed=100,this.isSlowMotion=!0},n.clear=function(){this.fromTarget.set(),this.isPause=!0,this.laseIndex=-1,this._index=-1,this.allDuration=0},n.setLookAt=function(t,e){this.lookAtNode=t,this.lookAtNodeRotate=e},n.setRunData=function(e,n){var o=this;t.Sets.updateItemCount(e,this.datas.length,(function(t){t?o.datas.push(i.IMove.get()):i.IMove.put(o.datas.pop())}));for(var r=0;r<e;r++)i.IMove.onClear(this.datas[r]),n(this.datas[r],r)},n.run=function(e){var n=this,o=this.datas.length;if(0!=o)if(1==o&&t.Vector3.equals((this.getPosition||i.getPosition)(this.node,this.isWorld),this.datas[0].target))e&&e();else{this.clear(),this.endCallBack.set(e),this.fromTarget.set((this.getPosition||i.getPosition)(this.node,this.isWorld)),t.Sets.updateItemCount(o,this.states.length,(function(t){t?n.states.push(i.IMoveState.get()):i.IMoveState.put(n.states.pop())}));for(var r=0;r<o;r++){var a=this.states[r];a.dtTotal=0,void 0!==this.datas[r].delay&&this.datas[r].delay>0?a.duration=this.datas[r].delay:a.duration=t.Vector3.distance(0==r?this.fromTarget:this.datas[r-1].target,this.datas[r].target)/this.getTargetSpeed(r),a.isPause=!1,a.endRatioPoint.set(),a.isStartRatio=null!=this.datas[r].startRatio,this.allDuration+=a.duration}this.isPause=!1}},n.getTargetSpeed=function(t){var e=this.speed;return this.states[t]?(this.datas[t].speed&&(e=this.datas[t].speed),this.datas[t].speedMul&&(e*=this.datas[t].speedMul),e):e},n.onUpdate=function(){if(!this.isPause){var e=i.getDeltaTime(this.isSlowMotion);if(e>this.allDuration){this.isPause=!0,this.setPopTarget();for(var n,o=u(this.datas);!(n=o()).done;){var r=n.value;r.onStart&&r.onStart(),r.onUpdate&&r.onUpdate(0),r.onEnd&&r.onEnd()}this.endCallBack.run()}else{this._index=0;for(var a=0;a<this.states.length;a++){if(!this.states[a].isPause){this._index=a;break}}var s=this.states[this._index],l=this.datas[this._index],h=this.datas[this.laseIndex];s.dtTotal+=e,l.startRatio&&s.isStartRatio&&0!=l.startRatio&&(s.isStartRatio=!1,s.dtTotal+=s.duration*l.startRatio-e);var c=s.dtTotal/s.duration;l.endRatio&&c>=l.endRatio&&(s.dtTotal+=s.duration*(1-l.endRatio),s.endRatioPoint.set((this.getPosition||i.getPosition)(this.node,this.isWorld)),s.isPause=!0),c>=1&&(s.isPause=!0),null!=l.ease&&(c=t.easing(l.ease,c));var p=this.datas[this._index].target,d=0==this._index?this.fromTarget:this.datas[this._index-1].target;if(l.bezierTarget&&!l.bezierTarget.equals(t.Vector3.ZERO)){var f=d;l.bezierTargetFrom&&!l.bezierTargetFrom.equals(t.Vector3.ZERO)&&(f=l.bezierTargetFrom),l.splineTraget&&!l.splineTraget.equals(t.Vector3.ZERO)?t.Curve.Spline.vec2.get(f,l.bezierTarget,l.splineTraget,p,0,c,this._v3T):(t.Curve.Bezier.vec3.getCurveByControl(f,p,l.bezierTarget,.5,this._v3T),t.Curve.Bezier.vec3.getControlByCurve(f,p,this._v3T,c,this._v3T))}else t.Vector3.lerp(this._v3T,d,p,c);(this.setPosition||i.setPosition)(this.node,this._v3T,this.isWorld),this.lookAtNode&&(t.Vector3.set(this._v3T2,p),i.lookAt(this.lookAtNode,this._v3T2,this.lookAtNodeRotate)),-1==this.laseIndex?l.onStart&&l.onStart():this.laseIndex!==this._index&&(h&&h.onEnd&&h.onEnd(),l.onStart&&l.onStart()),l.onUpdate&&l.onUpdate(c),this.laseIndex=this._index,this._index==this.states.length-1&&s.isPause&&(this.isPause=!0,this.setPopTarget(),null!=this.states&&(this.endCallBack.run(),this.datas[this.laseIndex]&&this.datas[this.laseIndex].onEnd&&this.datas[this.laseIndex].onEnd()))}}},n.setPopTarget=function(){var t=this.states[this.states.length-1],n=this.datas[this.states.length-1];t.endRatioPoint.equals(e)?(this.setPosition||i.setPosition)(this.node,n.target,this.isWorld):(this.setPosition||i.setPosition)(this.node,t.endRatioPoint,this.isWorld)},i}();i.pool=new t.PoolOnce(1e3,(function(){return new i}),(function(t){return t.dispose()})),i.IMove=new t.PoolOnce(1e3,(function(){return{target:new t.Vector3,bezierTarget:new t.Vector3,bezierTargetFrom:new t.Vector3,splineTraget:new t.Vector3}}),(function(t){var e,i,n;t.target.set(),t.speed=void 0,t.speedMul=void 0,t.ease=void 0,t.onUpdate=void 0,t.onStart=void 0,t.onEnd=void 0,t.delay=void 0,t.bezierTarget&&(null===(e=t.bezierTarget)||void 0===e||e.set()),t.bezierTargetFrom&&(null===(i=t.bezierTargetFrom)||void 0===i||i.set()),t.splineTraget&&(null===(n=t.splineTraget)||void 0===n||n.set()),t.endRatio=void 0,t.startRatio=void 0})),i.IMoveState=new t.PoolOnce(1e3,(function(){return{dtTotal:0,duration:-1,isPause:!1,endRatioPoint:new t.Vector3,isStartRatio:!1}}),(function(t){t.endRatioPoint.set(),t.dtTotal=0,t.duration=-1,t.isPause=!1,t.isStartRatio=!1})),t.Move=i}(apeng||(apeng={})),function(t){var e=function(){this.target=null,this.targetV3=new t.Vec3,this.speed=0,this.speedMul=1,this.ease=t.EEaseType.linear,this.endRatio=1,this.startRatio=0,this.isBezier=!1,this.bezierTarget=null,this.bezierTargetFrom=null,this.isEmitCall=!1,this.onStart=new t.EventHandlerCC,this.onEnd=new t.EventHandlerCC,this.onUpdate=new t.EventHandlerCC};p([t.property({type:t.Node,displayName:"目标点"})],e.prototype,"target",void 0),p([t.property({tooltip:"相对自身位置的目标点 node优先",displayName:"相对目标点"})],e.prototype,"targetV3",void 0),p([t.property({tooltip:"当前段的移速，0代表使用全局的",displayName:"移动速度"})],e.prototype,"speed",void 0),p([t.property({displayName:"速度倍率"})],e.prototype,"speedMul",void 0),p([t.property({type:t.EEaseType,displayName:"缓动值"})],e.prototype,"ease",void 0),p([t.property({displayName:"到指定比率即结束"})],e.prototype,"endRatio",void 0),p([t.property({displayName:"从开始比率移动"})],e.prototype,"startRatio",void 0),p([t.property({displayName:"曲线移动"})],e.prototype,"isBezier",void 0),p([t.property({type:t.Node,displayName:"贝塞尔控制点",visible:function(){return this.isBezier}})],e.prototype,"bezierTarget",void 0),p([t.property({type:t.Node,displayName:"贝塞尔起始点",visible:function(){return this.isBezier}})],e.prototype,"bezierTargetFrom",void 0),p([t.property({displayName:"派发回调"})],e.prototype,"isEmitCall",void 0),p([t.property({type:t.EventHandlerCC,displayName:"开始移动时",visible:function(){return this.isEmitCall}})],e.prototype,"onStart",void 0),p([t.property({type:t.EventHandlerCC,displayName:"移动结束时",visible:function(){return this.isEmitCall}})],e.prototype,"onEnd",void 0),p([t.property({type:t.EventHandlerCC,displayName:"正在移动",visible:function(){return this.isEmitCall}})],e.prototype,"onUpdate",void 0),e=p([t.ccclass("MoveCCItem")],e),t.MoveCCItem=e;var i=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).backupDescribe="移动组件",i.tag="",i.target=null,i.isWorldMove=!0,i.speed=100,i.loopCount=1,i.autoPlay=!1,i.node_lookAt=null,i.lookAtAngle=0,i.items=[],i._move=new t.Move,i.curLoopCount=0,i.orginPosition=null,i.completeCb=null,i.endPos=new t.Vector3,i}o(i,e);var n=i.prototype;return n.onLoad=function(){var i=this;e.prototype.onLoad.call(this),t.EDITOR?this.target||(this.target=this.node):(this._move.init(this.target,this.isWorldMove,this.speed,!0),this.node_lookAt&&this._move.setLookAt(this.node_lookAt,this.lookAtAngle),this._move.setRunData(this.items.length,(function(e,n){var o,r,a=i.items[n];if(e.speed=0==a.speed?null:a.speed,e.speedMul=a.speedMul,e.ease=a.ease,e.endRatio=a.endRatio,e.startRatio=a.startRatio,a.isEmitCall&&(a.onStart.isCall&&(e.onStart=a.onStart.emit.bind(a.onStart,i.node)),a.onUpdate.isCall&&(e.onUpdate=a.onUpdate.emit.bind(a.onUpdate,i.node)),a.onEnd.isCall&&(e.onEnd=a.onEnd.emit.bind(a.onEnd,i.node))),a.isBezier&&(a.bezierTarget&&(null===(o=e.bezierTarget)||void 0===o||o.set(t.NodeHelper.getPosition(a.bezierTarget,i.isWorldMove))),a.bezierTargetFrom&&(null===(r=e.bezierTargetFrom)||void 0===r||r.set(t.NodeHelper.getPosition(a.bezierTargetFrom,i.isWorldMove)))),i.items.length==n+1){var s=e.onEnd;e.onEnd=function(){s&&s(),t.NodeHelper.setPosition(i.target,i.endPos,i.isWorldMove),i.completeCb&&i.completeCb(),i.completeCb=null,i.curLoopCount++,(0==i.loopCount||i.curLoopCount<i.loopCount)&&i.startMove()}}})))},n.onEnable=function(){e.prototype.onEnable.call(this),t.EDITOR||(this.curLoopCount=0,this.autoPlay&&this.startMove())},n.onDestroy=function(){t.EDITOR||(e.prototype.onDestroy.call(this),this._move.dispose())},n.onUpdate=function(){t.EDITOR||this._move.onUpdate()},n.startMove=function(e){if(this.node.active){this.orginPosition?this.resetPos():this.orginPosition=this.node.getPosition(),e&&(this.completeCb=e);for(var i,n=-1,o=u(this._move.datas);!(i=o()).done;){var r=i.value;n++;var a=this.items[n];a.target?t.Vector3.set(r.target,t.NodeHelper.getPosition(a.target,this.isWorldMove)):t.Vector3.add(r.target,a.targetV3,this.getPosition(this.isWorldMove)),n==this.items.length-1&&this.endPos.set(r.target)}this._move.run()}else e&&e()},n.resetPos=function(){this.orginPosition&&this.node.setPosition(this.orginPosition)},i}(t.BaseComponent);p([t.property({displayName:"标记"})],i.prototype,"tag",void 0),p([t.property({type:t.Node,displayName:"移动节点"})],i.prototype,"target",void 0),p([t.property({displayName:"世界坐标移动"})],i.prototype,"isWorldMove",void 0),p([t.property({displayName:"移动速度"})],i.prototype,"speed",void 0),p([t.property({tooltip:"0无限循环",displayName:"循环次数"})],i.prototype,"loopCount",void 0),p([t.property({displayName:"显示时自动移动"})],i.prototype,"autoPlay",void 0),p([t.property({type:t.Node,displayName:"设置朝向的节点"})],i.prototype,"node_lookAt",void 0),p([t.property({displayName:"看向目标点 朝向旋转角度",visible:function(){return this.node_lookAt}})],i.prototype,"lookAtAngle",void 0),p([t.property({type:[e],displayName:"点配置"})],i.prototype,"items",void 0),i=p([t.ccclass("MoveCC"),t.executeInEditMode,t.menuAnim("MoveCC")],i),t.MoveCC=i}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).backupDescribe="透明度动画",i.speed=1,i.showEaseType=t.EEaseType.quadOut,i.hideSpeed=1,i.hideEaseType=t.EEaseType.quadIn,i._curOpacity=1,i.orginOpacity=0,i.isFadeIn=!0,i.playComplete=new t.CompleteCallBack,i}o(i,e);var n=i.prototype;return n.onLoad=function(){e.prototype.onLoad.call(this),t.EDITOR||(this.orginOpacity=this.getOpacity())},n.onDisable=function(){e.prototype.onDisable.call(this),this._curOpacity=1,this.isFadeIn=!0,this.playComplete.clear()},n.onUpdate=function(){if(1!=this._curOpacity){this._curOpacity=this._curOpacity+2*t._timer.dtDefault*(this.isFadeIn?this.speed:this.hideSpeed),this._curOpacity>1&&(this._curOpacity=1);var e=t.easing(this.isFadeIn?this.showEaseType:this.hideEaseType,this._curOpacity);this.updateView(e),1==this._curOpacity&&this.playComplete.run()}},n.play=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!0),0!=this.orginOpacity&&(this.isFadeIn=t,this.playComplete.set(e),i?(this._curOpacity=0,this.updateView(this._curOpacity)):(this._curOpacity=1,this.updateView(this._curOpacity),this.playComplete.run()))},n.updateView=function(t){this.isFadeIn||(t=1-t),this._setOpacity(this.orginOpacity*t)},n.isPlayComplete=function(){return 1==this._curOpacity},n._setOpacity=function(t){this.setOpacity(t)},i}(t.BaseComponent);p([t.property({displayName:"渐显速度"})],e.prototype,"speed",void 0),p([t.property({type:t.EEaseType,displayName:"渐显曲线"})],e.prototype,"showEaseType",void 0),p([t.property({displayName:"渐隐速度"})],e.prototype,"hideSpeed",void 0),p([t.property({type:t.EEaseType,displayName:"渐隐曲线"})],e.prototype,"hideEaseType",void 0),e=p([t.ccclass("RenderOpacityAnimCC"),t.menuAnim("RenderOpacityAnimCC")],e),t.RenderOpacityAnimCC=e}(apeng||(apeng={})),function(t){var e=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).backupDescribe="透明度循环动画",e.showDelay=1,e.hideDelay=1,e}o(e,t);var i=e.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.hide()},i.show=function(){var t=this;this.play(!0,(function(){t.scheduleOnce(t.hide,t.showDelay)}))},i.hide=function(){var t=this;this.play(!1,(function(){t.scheduleOnce(t.show,t.hideDelay)}))},e}(t.RenderOpacityAnimCC);p([t.property({displayName:"显示停留时间"})],e.prototype,"showDelay",void 0),p([t.property({displayName:"隐藏停留时间"})],e.prototype,"hideDelay",void 0),e=p([t.ccclass("OpacityLoopAnimCC"),t.menuAnim("OpacityLoopAnimCC")],e),t.OpacityLoopAnimCC=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).backupDescribe="粒子2D",t.isAutoPlay=!0,t.delayPlay=0,t}o(i,e);var n=i.prototype;return n.onLoad=function(){e.prototype.onLoad.call(this),this.ParticleSystem2D.playOnLoad=!1},n.onEnable=function(){e.prototype.onEnable.call(this),t.EDITOR||this.isAutoPlay&&(this.delayPlay>0?this.scheduleOnce(this._play,this.delayPlay):this._play())},n.onDisable=function(){e.prototype.onDisable.call(this),t.EDITOR||this.ParticleSystem2D.stopSystem()},n.play=function(t){this.isAutoPlay||this._play();var e=this.ParticleSystem2D.duration;e&&this.scheduleOnce(t,e+5)},n._play=function(){this.ParticleSystem2D.resetSystem()},i}(t.BaseComponent);p([t.property({displayName:"激活自动播放"})],e.prototype,"isAutoPlay",void 0),p([t.property({displayName:"延迟时间",visible:function(){return this.isAutoPlay}})],e.prototype,"delayPlay",void 0),e=p([t.ccclass("ParticleSystem2DCC"),t.requireComponent(t.ParticleSystem2D),t.menuAnim("ParticleSystem2DCC")],e),t.ParticleSystem2DCC=e}(apeng||(apeng={})),function(t){var e=new t.Vec3,i=38,n=101,r=function(r){function a(){var t;return(t=r.apply(this,arguments)||this).EventType={COMPLETE:"COMPLETE",CHANGE:"CHANGE"},t.backupDescribe="进度条",t.sp=null,t.lb=null,t.lb2=null,t.strAfterPix="",t.strLastPix="%",t.ratioBySpriteLitte=3,t.ratioByLabelLitte=0,t.ratioFollowNode=null,t.isDragRatioFollowNode=!1,t.followNodeXScale=1,t.followNodeXOffset=0,t.ratioPrefab=null,t.isToMax=!1,t.clickAddNode=null,t.clickSubNode=null,t.clickAddRatio=.1,t.maxShow=-1,t._ratioPrefabValues=[],t._ratio=0,t.onEditorUpdateData=t.updateView,t.progress=null,t.dtCount=0,t.dtCount2=0,t.addSpeed=5,t.addSpeed2=30,t.isRun=!1,t.maxShowMin=0,t}o(a,r);var s=a.prototype;return s.onEditorClearData=function(){var e=this.getChildByCreate("ratioPrefabValuesParent",(function(){}));t.Sets.forEach(e.children,(function(t){t.destroy()}),!0)},s.onLoad=function(){var i=this;r.prototype.onLoad.call(this),this.isDragRatioFollowNode&&this.ratioFollowNode&&this.addEvent(t.Node.EventType.TOUCH_MOVE,(function(n){e.set(n.getUILocation().x,0,0),i.convertToNodeSpaceAR(e,e),e.x+=i.UITransform.width*i.UITransform.anchorX,i.ratio=t.Maths.clamp01(e.x/i.UITransform.width)}),this,this.ratioFollowNode),this.clickAddNode&&t.EventHandlerCC.onClick(this.clickAddNode,(function(){i.ratio+=i.clickAddRatio}),this),this.clickSubNode&&t.EventHandlerCC.onClick(this.clickSubNode,(function(){i.ratio-=i.clickAddRatio}),this),this.updateView()},s.onUpdate=function(){if(this.isRun){var e=0;this.progress&&(e=this.progress());var o=t._timer.dtDefault;this.dtCount=Math.min(this.dtCount+o*this.addSpeed2,n),this.dtCount2=Math.min(this.dtCount2+o*this.addSpeed,i);var r=(70*e+.3*(this.dtCount+this.dtCount2))/100;this.ratio=Math.max(r,this._ratio),this._ratio>=1&&(this.isRun=!1,this.dtCount=n,this.dtCount2=i,this.node.emit(this.EventType.COMPLETE))}},s.setMaxShow=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this.maxShow=t,this.maxShowMin=e,this.clickAddRatio=1/t,-1!=i&&(this._ratio=-1,this.ratio=this.clickAddRatio*i)},s.getMaxCurCount=function(){return Math.round(this._ratio*this.maxShow)},s.run=function(t,e){this.progress=t,this.dtCount=0,this.dtCount2=0,this.ratio=0,e&&e>0?(this.addSpeed2=n/e,this.addSpeed=i/e):(this.addSpeed=5,this.addSpeed2=30),this.isRun=!0,this.updateView()},s.getRatioByLocalX=function(t){return this.UITransform.width*(t-this.UITransform.anchorX)},s.getRatioByWorldX=function(t){var i=this.getRatioByLocalX(t);return e.set(i,0,0),this.convertToWorldSpaceAR(e,e),e.x},s.updateView=function(){var i=this,n=this._ratio;if(this.sp){var o=t.Maths.clamp01(n),r=Math.pow(10,this.ratioBySpriteLitte);o=Math.floor(o*r)/r,this.sp.fillRange=o}var a=100*n;a=this.ratioByLabelLitte>0?a.toFixed(this.ratioByLabelLitte):Math.floor(a),this.maxShow>=0&&(a=this.getMaxCurCount());var s=this.strAfterPix+a+this.strLastPix;this.maxShow>=0&&(s+=this.maxShow),this.lb&&(this.lb.string=s),this.lb2&&(this.lb2.string=s),e.set(this.getRatioByLocalX(t.Maths.clamp01(n))*this.followNodeXScale,0,0),e.x+=this.followNodeXOffset,this.ratioFollowNode&&(this.ratioFollowNode.parent==this.node||this.convertSelfToOtherNodeSpaceAR(e,this.ratioFollowNode.parent,e),t.NodeHelper.setPositionX(this.ratioFollowNode,e.x,!1));var l=this.getChildByCreate("ratioPrefabValuesParent",(function(){}));t.Sets.updateItemCount(this._ratioPrefabValues.length,l.children.length,(function(e){if(e){var n=t.instantiate(i.ratioPrefab);t.NodeHelper.setPositionY(n,0,!1),l.addChild(n)}else{var o=t.Sets.pop(i.node.children,!1);o&&(o.removeFromParent(),o.destroy())}}));for(var h,c=0,p=u(l.children);!(h=p()).done;){var d=h.value,f=this._ratioPrefabValues[c];t.NodeHelper.setPositionX(d,this.getRatioByLocalX(f),!1);var y=n>=f?0:1,g=d.getComponent("SwitchChildrenCC");g&&g.setIndex(y);var m=d.getComponent("SwitchSpriteCC");m&&m.setIndex(y);var v=d.getComponent("ControllerCC");v&&v.setIndex(y),c++}},s.getRatioValues=function(){return this._ratioPrefabValues},l(a,[{key:"ratio",get:function(){return this._ratio},set:function(e){if(this._ratio!=e){if(this._ratio=this.isToMax?e:t.Maths.clamp01(e),this.maxShow>0){var i=1/this.maxShow,n=Math.max(this.maxShowMin,Math.round(this._ratio/i));this._ratio=i*n}else 0==this.maxShow&&(this._ratio=0);this.node.emit(this.EventType.CHANGE,this._ratio),this.updateView()}}},{key:"ratioPrefabValues",get:function(){return this._ratioPrefabValues},set:function(t){this._ratioPrefabValues=t,this.updateView()}},{key:"isRunMax",get:function(){return this.dtCount==n&&this.dtCount2==i}}]),a}(t.BaseComponent);p([t.property({type:t.Sprite,displayName:"进度条图片"})],r.prototype,"sp",void 0),p([t.property({type:t.Label,displayName:"文字"})],r.prototype,"lb",void 0),p([t.property({type:t.FontCC,displayName:"文字2"})],r.prototype,"lb2",void 0),p([t.property({displayName:"文字节点前缀",visible:function(){return!(!this.lb&&!this.lb2)}})],r.prototype,"strAfterPix",void 0),p([t.property({displayName:"文字节点后缀",visible:function(){return!(!this.lb&&!this.lb2)}})],r.prototype,"strLastPix",void 0),p([t.property({range:[0,1,.01],slide:!0,displayName:"进度百分比"})],r.prototype,"ratio",null),p([t.property({displayName:"进度图片取几位小数",visible:function(){return!!this.sp}})],r.prototype,"ratioBySpriteLitte",void 0),p([t.property({displayName:"进度文本取几位小数",visible:function(){return!(!this.lb&&!this.lb2)}})],r.prototype,"ratioByLabelLitte",void 0),p([t.property({type:t.Node,displayName:"进度跟随节点"})],r.prototype,"ratioFollowNode",void 0),p([t.property({displayName:"跟随节点可拖动",visible:function(){return!!this.ratioFollowNode}})],r.prototype,"isDragRatioFollowNode",void 0),p([t.property({range:[0,1],slide:!0,displayName:"跟随节点位置缩放比率",visible:function(){return!!this.ratioFollowNode}})],r.prototype,"followNodeXScale",void 0),p([t.property({displayName:"跟随节点位置偏移",visible:function(){return!!this.ratioFollowNode}})],r.prototype,"followNodeXOffset",void 0),p([t.property({type:t.Prefab,displayName:"比率节点"})],r.prototype,"ratioPrefab",void 0),p([t.property({type:[t.CCFloat],visible:function(){return!!this.ratioPrefab},displayName:"个数"})],r.prototype,"ratioPrefabValues",null),p([t.property({displayName:"可超出1"})],r.prototype,"isToMax",void 0),p([t.property({type:t.Node,displayName:"点击+"})],r.prototype,"clickAddNode",void 0),p([t.property({type:t.Node,displayName:"点击-"})],r.prototype,"clickSubNode",void 0),p([t.property({displayName:"点击递增比率"})],r.prototype,"clickAddRatio",void 0),p([t.property({displayName:"最大值并滑动整数"})],r.prototype,"maxShow",void 0),p([t.property({serializable:!0})],r.prototype,"_ratioPrefabValues",void 0),p([t.property({serializable:!0})],r.prototype,"_ratio",void 0),r=p([t.ccclass("ProgressCC"),t.executeInEditMode,t.menuUI("ProgressCC")],r),t.ProgressCC=r}(apeng||(apeng={})),function(t){var e=t.sp?t.sp.Skeleton:t.Asset,i=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).backupDescribe="龙骨组件",i.anim=null,i.curPlayAnimName="",i.loop=!0,i.curState=null,i.lastPlayAnim="",i.initTimeScale=1,i.curPlayAnimNameCb=new t.CompleteCallBack,i}o(i,e);var n=i.prototype;return n.onLoad=function(){e.prototype.onLoad.call(this),t.EDITOR?this.anim||(this.anim=this.getComponent(t.sp.Skeleton)):this.anim&&(this.initTimeScale=this.anim.timeScale,this.anim.setCompleteListener(this.onEventAnimFinish.bind(this)))},n.onDisable=function(){t.EDITOR||(this.curPlayAnimName="",this.lastPlayAnim="",this.curState=null,this.stop()),e.prototype.onDisable.call(this)},n.onEventAnimFinish=function(){this.curPlayAnimNameCb.run()},n.stop=function(){this.anim&&this.curPlayAnimNameCb.clear()},n.pause=function(){this.anim&&(this.anim.timeScale=0)},n.resume=function(){this.anim&&(this.anim.timeScale=this.initTimeScale)},n.play=function(t,e,i,n){void 0===n&&(n=!0),this.anim&&t&&(n&&this.curPlayAnimName==t||(this.curPlayAnimName&&(this.lastPlayAnim=this.curPlayAnimName),this.curPlayAnimName=t,this.loop=e,this.curPlayAnimNameCb.set(i),this.curState=this.anim.setAnimation(0,t,e)))},n.playDefault=function(t,e){if(void 0===t&&(t=!1),this.anim){var i=this.anim.animation;i||(i=this.animNames()[0]),this.play(i,t,e,!1)}},n.playRandom=function(e,i){void 0===e&&(e=!1),this.anim&&this.play(t.Sets.random(this.animNames()),e,i)},n.hasPlayComplete=function(t){return void 0===t&&(t=""),!this.curState||(!(!t||this.curPlayAnimName==t)||this.curState.isComplete())},n.animNames=function(){return this.anim?this.anim.skeletonData.getRuntimeData().animations.map((function(t){return t.name})):[]},i}(t.BaseComponent);p([t.property({type:e,displayName:"动画组件"})],i.prototype,"anim",void 0),i=p([t.ccclass("SpineCC"),t.menuAnim("SpineCC"),t.executeInEditMode,t.requireComponent(t.UITransform)],i),t.SpineCC=i}(apeng||(apeng={})),function(t){var e=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).backupDescribe="激活时渐显",e}return o(e,t),e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this.play(!0)},e}(t.RenderOpacityAnimCC);e=p([t.ccclass("SpriteEnableFadeInCC"),t.menuAnim("SpriteEnableFadeInCC")],e),t.SpriteEnableFadeInCC=e}(apeng||(apeng={})),function(t){var e=function(){this.sfs=[]};p([t.property({type:[t.SpriteFrame],displayName:"帧图片"})],e.prototype,"sfs",void 0),e=p([t.ccclass("SpriteFrameAnimCCItem")],e),t.SpriteFrameAnimCCItem=e;var i=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).EventType={PLAY_COMPLETE:"PLAY_COMPLETE",PLAY_COUNT_COMPLETE:"PLAY_COUNT_COMPLETE"},t.backupDescribe="序列帧动画",t.items=[],t.itemIndex=0,t.fps=10,t.autoPlay=!0,t.playCount=0,t.sp=null,t._dts=0,t._index=0,t._count=0,t.isPause=!1,t}o(i,e);var n=i.prototype;return n.onLoad=function(){this.sp=this.getComponent(t.Sprite)},n.onEnable=function(){this._index=0,this._dts=0,this._count=0,this.setIndex(this.item,this._index),this.autoPlay?this.isPause=!1:this.isPause=!0},n.update=function(t){if(!this.isPause&&(this._dts+=t,this._dts>1/this.fps)){this._dts=0,this._index++;var e=this.item;if(e){var i=e.sfs.length,n=this._index%i;this.setIndex(e,n),this.playCount>0&&n==i-1&&(this._count++,this.node.emit(this.EventType.PLAY_COMPLETE),this._count>=this.playCount&&(this.isPause=!1,this.node.emit(this.EventType.PLAY_COUNT_COMPLETE)))}}},n.registAnimComplete=function(t){this.node.once(this.EventType.PLAY_COUNT_COMPLETE,t)},n.setIndex=function(t,e){t&&(this.sp.spriteFrame=t.sfs[e]||null)},l(i,[{key:"item",get:function(){return this.items[this.itemIndex]}}]),i}(t.Component);p([t.property({type:[e],displayName:"帧队列"})],i.prototype,"items",void 0),p([t.property({displayName:"队列索引"})],i.prototype,"itemIndex",void 0),p([t.property({tooltip:"一秒多少帧,1/fps"})],i.prototype,"fps",void 0),p([t.property({displayName:"激活播放"})],i.prototype,"autoPlay",void 0),p([t.property({tooltip:"0无限循环，>0指定次数",displayName:"播放次数"})],i.prototype,"playCount",void 0),i=p([t.ccclass("SpriteFrameAnimCC"),t.executeInEditMode,t.menuAnim("SpriteFrameAnimCC"),t.requireComponent(t.Sprite)],i),t.SpriteFrameAnimCC=i}(apeng||(apeng={})),function(t){var e,i,n;!function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right"}(e=t.EAlignType||(t.EAlignType={})),t.ccenum(e),function(t){t[t.Top=0]="Top",t[t.Middle=1]="Middle",t[t.Bottom=2]="Bottom"}(i=t.EVertAlignType||(t.EVertAlignType={})),t.ccenum(i),function(t){t[t.None=0]="None",t[t.Scale=1]="Scale",t[t.ScaleByHeight=2]="ScaleByHeight",t[t.ScaleByWidth=3]="ScaleByWidth",t[t.ScaleShowAll=4]="ScaleShowAll",t[t.ScaleNoBorder=5]="ScaleNoBorder"}(n=t.ESpriteSimpleFillType||(t.ESpriteSimpleFillType={})),t.ccenum(n);var r=new t.Vector2,a=function(a){function s(){var o;return(o=a.apply(this,arguments)||this).backupDescribe="模拟fgui装载器",o.isLanguage=!1,o.enterLoadQueue2=!0,o.autoLoad=!0,o.spriteFrameByUuid="",o.spriteFrameDeep=null,o._alignType=e.Center,o._vertAlignType=i.Middle,o._spriteSimpleFillType=n.None,o._shrinkOnly=!1,o._bindLoad=!0,o._autoSize=!1,o._isTrim=!0,o._mat=null,o._spriteFrame=null,o._spriteColor=new t.Color(255,255,255,255),o.spriteFrameUrl="",o.orginSpriteFrameUrl="",o.isLoadSpriteFrame=!1,o.loadSpriteFrames=new t.Sets,o._listByMark=!1,o._listByMarkUrl="",o._loadSf=null,o._sp=null,o}o(s,a);var u=s.prototype;return u.onEditorUpdateData=function(){this.updateLayout(),this.updateBindLoad()},u.onLoad=function(){var e=this;if(a.prototype.onLoad.call(this),t.EDITOR)return this.updateLayout(),void this.updateBindLoad();this._spriteFrame=null,this.autoLoad&&this.loadDefaultSpriteFrame(),this.isLanguage&&this.addEvent(t._language.EventType.CHANGE,(function(i){e.orginSpriteFrameUrl?e.setSpriteFrameUrl(t._language.converSpriteFrameUrl(e.orginSpriteFrameUrl),!0,null,i):i()}),this,t._language)},u.onEnable=function(){a.prototype.onEnable.call(this),t.EDITOR||this.isLanguage&&this.orginSpriteFrameUrl&&this.setSpriteFrameUrl(this.orginSpriteFrameUrl,!0)},u.onDisable=function(){t.EDITOR||(this._sp&&this._sp.spriteFrame||(this.spriteFrameUrl=""),t._resouces.cancleSpriteFrame(this._loadSf)),a.prototype.onDisable.call(this)},u.onDestroy=function(){this.loadSpriteFrames.forEach((function(t){t.decRef(!0)})),this.loadSpriteFrames.clear(),a.prototype.onDestroy.call(this)},u.listByMark=function(t){this._listByMark=t,t||this.scheduleOnceCover(this.onDelayListByMarkSetSprite,1)},u.onDelayListByMarkSetSprite=function(){this._listByMark||this.setSpriteFrameUrl(this._listByMarkUrl,!0)},u.loadDefaultSpriteFrame=function(e){this._spriteFrame=null,this.setSpriteFrameUrl(t._resouces.getUuidByUrl(this.spriteFrameByUuid),!1,e)},u.setSpriteFrameUrl=function(e,i,n,o){var r=this;if(void 0===i&&(i=!1),this._listByMark)return this._listByMarkUrl=e,n&&n(),void(o&&o());if(!e)return console.error("检查图片路径--节点名:"+this.node.name),n&&n(),void(o&&o());if(this.orginSpriteFrameUrl=e,this.isLanguage&&!t.EDITOR){var a=e.indexOf("/spriteFrame");-1!=a&&(e=e.substr(0,a)),e=t._language.getSpriteFrame(e)}if(this.spriteFrameUrl!=e||i){this.spriteFrameUrl=e;var s=this.getSprite();this._loadSf=t._resouces.setSpriteFrame(s,e,(function(t){if(!t)return r.spriteFrameUrl="",void(o&&o());r._spriteFrame=t,r.isLoadSpriteFrame=!0,r._spriteFrame&&(r.spriteFrameByUuid=r._spriteFrame._uuid),r._spriteFrame.addRef(),r.loadSpriteFrames.add(r._spriteFrame),s.spriteFrame=r._spriteFrame,r.updateLayout(),n&&n(),o&&o()}),this.enterLoadQueue2)}else o&&o()},u.setSpriteFrame=function(t){this._spriteFrame=t,this.updateLayout()},u.updateBindLoad=function(){this._spriteFrame&&(this.autoLoad&&this.bindLoad?this.spriteFrameDeep=this._spriteFrame:this.spriteFrameDeep=null)},u.getSprite=function(){var e=this;return this._sp||(this._sp=this.getChildByCreate(this.uuid+"sprite",(function(i){i.getComponent(t.UITransform).setAnchorPoint(0,1);var n=i.addComponent(t.Sprite);e._mat&&!n.customMaterial&&(n.customMaterial=e._mat),n.type=t.Sprite.Type.SIMPLE}),0).getComponent(t.Sprite)),this._sp},u.onSizeChange=function(){this.updateLayout()},u.updateLayout=function(){var o=this.getSprite();if(t.EDITOR&&(o.spriteFrame=this._spriteFrame),o.color=this._spriteColor,o.trim=this._isTrim,this._spriteFrame){var a=this._spriteFrame.originalSize,s=a.width,l=a.height,u=-this.UITransform.anchorX*this.UITransform.width,h=this.UITransform.anchorY*this.UITransform.height;if(this._autoSize)return 0==s&&(s=50),0==l&&(l=30),this.setSize(s,l),u=-this.UITransform.anchorX*this.UITransform.width,h=(1-this.UITransform.anchorY)*this.UITransform.height,o.getComponent(t.UITransform).setContentSize(s,l),r.set(u,h),void t.NodeHelper.setPositionXY(o.node,r,!1);var c,p,d=1,f=1;this._spriteSimpleFillType!=n.None&&(d=this.UITransform.width/a.width,f=this.UITransform.height/a.height,1==d&&1==f||(this._spriteSimpleFillType==n.ScaleByHeight?d=f:this._spriteSimpleFillType==n.ScaleByWidth?f=d:this._spriteSimpleFillType==n.Scale?d>f?d=f:f=d:this._spriteSimpleFillType==n.ScaleNoBorder&&(d>f?f=d:d=f),this._shrinkOnly&&(d>1&&(d=1),f>1&&(f=1)),s=a.width*d,l=a.height*f)),o.getComponent(t.UITransform).setContentSize(s,l),c=this._alignType==e.Left?0:this._alignType==e.Center?Math.floor((this.UITransform.width-s)/2):this.UITransform.width-s,p=-(p=this._vertAlignType==i.Top?0:this._vertAlignType==i.Middle?Math.floor((this.UITransform.height-l)/2):this.UITransform.height-l),r.set(u+c,h+p),t.NodeHelper.setPositionXY(o.node,r,!1)}},l(s,[{key:"mat",get:function(){return this._mat},set:function(t){this._mat!=t&&(this._mat=t,this.getSprite().customMaterial=this._mat)}},{key:"bindLoad",get:function(){return this._bindLoad},set:function(t){this._bindLoad!=t&&(this._bindLoad=t,this.updateBindLoad())}},{key:"spriteColor",get:function(){return this._spriteColor},set:function(t){if(!this._spriteColor.equals(t)){this._spriteColor=t;var e=this.getSprite();e&&e.spriteFrame&&(e.color=this._spriteColor)}}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(t){this._spriteFrame!=t&&(this._spriteFrame=t,this.spriteFrameByUuid=this._spriteFrame?this._spriteFrame._uuid:"",this.updateLayout())}},{key:"spriteSimpleFillType",get:function(){return this._spriteSimpleFillType},set:function(t){this._spriteSimpleFillType!=t&&(this._spriteSimpleFillType=t,this.updateLayout())}},{key:"isTrim",get:function(){return this._isTrim},set:function(t){this._isTrim!=t&&(this._isTrim=t,this.updateLayout())}},{key:"shrinkOnly",get:function(){return this._shrinkOnly},set:function(t){this._shrinkOnly!=t&&(this._shrinkOnly=t,this.updateLayout())}},{key:"autoSize",get:function(){return this._autoSize},set:function(t){this._autoSize!=t&&(this._autoSize=t,this.updateLayout())}},{key:"alignType",get:function(){return this._alignType},set:function(t){this._alignType!=t&&(this._alignType=t,this.updateLayout())}},{key:"vertAlignType",get:function(){return this._vertAlignType},set:function(t){this._vertAlignType!=t&&(this._vertAlignType=t,this.updateLayout())}}]),s}(t.BaseComponent);p([t.property({type:t.Material,displayName:"设置材质"})],a.prototype,"mat",null),p([t.property({tooltip:"使用多语言 的路径加载",displayName:"多语言"})],a.prototype,"isLanguage",void 0),p([t.property({tooltip:"加载图片队列 一部分一部分加载",displayName:"进入加载队列"})],a.prototype,"enterLoadQueue2",void 0),p([t.property({displayName:"激活自动加载"})],a.prototype,"autoLoad",void 0),p([t.property({tooltip:"绑定到资源加载时加载，反之onLoad加载",displayName:"绑定加载",visible:function(){return this.autoLoad}})],a.prototype,"bindLoad",null),p([t.property({type:t.Color,displayName:"颜色"})],a.prototype,"spriteColor",null),p([t.property({tooltip:"会在onLoad时进行加载图片",displayName:"图片uuid"})],a.prototype,"spriteFrameByUuid",void 0),p([t.property({type:t.SpriteFrame,displayName:"原图片"})],a.prototype,"spriteFrame",null),p([t.property({type:t.SpriteFrame,displayName:"引用图片 方便绑定加载",visible:function(){return this.autoLoad&&this.bindLoad}})],a.prototype,"spriteFrameDeep",void 0),p([t.property({type:n,displayName:"填充处理"})],a.prototype,"spriteSimpleFillType",null),p([t.property({displayName:"裁剪透明像素"})],a.prototype,"isTrim",null),p([t.property({displayName:"仅允许缩小"})],a.prototype,"shrinkOnly",null),p([t.property({displayName:"自动大小"})],a.prototype,"autoSize",null),p([t.property({type:e,displayName:"横向对齐"})],a.prototype,"alignType",null),p([t.property({type:i,displayName:"纵向对齐"})],a.prototype,"vertAlignType",null),p([t.property({serializable:!0})],a.prototype,"_alignType",void 0),p([t.property({serializable:!0})],a.prototype,"_vertAlignType",void 0),p([t.property({serializable:!0})],a.prototype,"_spriteSimpleFillType",void 0),p([t.property({serializable:!0})],a.prototype,"_shrinkOnly",void 0),p([t.property({serializable:!0})],a.prototype,"_bindLoad",void 0),p([t.property({serializable:!0})],a.prototype,"_autoSize",void 0),p([t.property({serializable:!0})],a.prototype,"_isTrim",void 0),p([t.property({serializable:!0})],a.prototype,"_mat",void 0),p([t.property({serializable:!0,editorOnly:!0})],a.prototype,"_spriteFrame",void 0),p([t.property({serializable:!0})],a.prototype,"_spriteColor",void 0),a=p([t.ccclass("SpriteLoaderCC"),t.executeInEditMode,t.menuUI("SpriteLoaderCC")],a),t.SpriteLoaderCC=a}(apeng||(apeng={})),function(t){var e=function(e){function i(){return e.apply(this,arguments)||this}o(i,e);var n=i.prototype;return n.onLoad=function(){if(this._content.layer=this.node.layer,e.prototype.onLoad.call(this),this._openDataContext){var i=t.NodeHelper.getUITransform(this.node);this._openDataContext.postMessage({event:"canvasSize",width:i.contentSize.width,height:i.contentSize.height})}},n.onEnable=function(){e.prototype.onEnable.call(this),this._openDataContext&&this._openDataContext.postMessage({event:"updateRender"})},n._initSharedCanvas=function(){if(this._openDataContext){var e=this._openDataContext.canvas,i=t.NodeHelper.getUITransform(this.node);e.width=i.contentSize.width,e.height=i.contentSize.height}},i}(t.SubContextView);e=p([t.ccclass("SubContextViewCC"),t.menuUI("SubContextViewCC")],e),t.SubContextViewCC=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).EventType={CHANGE:"CHANGE"},t.backupDescribe="只显示一个子节点",t.noIndex=!1,t._index=0,t.onEditorUpdateData=t.updateView,t}o(i,e);var n=i.prototype;return n.onEnable=function(){e.prototype.onEnable.call(this),this.updateView()},n.setIndex=function(t){"string"==typeof t&&(t=Number(t)),this.index=t},n.updateView=function(){for(var t=0;t<this.node.children.length;t++)this.node.children[t].active=this.noIndex?t!=this._index:t==this._index},n.getIndexNode=function(){return this.node.children[this._index]},l(i,[{key:"index",get:function(){return this._index},set:function(e){e!=this._index&&(this._index=t.Maths.clampf(e,0,this.node.children.length-1),this.updateView(),this.node.emit(this.EventType.CHANGE,this._index))}}]),i}(t.BaseComponent);p([t.property({displayName:"反向显示"})],e.prototype,"noIndex",void 0),p([t.property({step:1,displayName:"显示索引"})],e.prototype,"index",null),p([t.property({serializable:!0})],e.prototype,"_index",void 0),e=p([t.ccclass("SwitchChildrenCC"),t.executeInEditMode,t.menuUI("SwitchChildrenCC")],e),t.SwitchChildrenCC=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).backupDescribe="切换图片",t.sp=null,t.sfs=[],t._index=0,t.onEditorUpdateData=t.updateSp,t}o(i,e);var n=i.prototype;return n.onLoad=function(){e.prototype.onLoad.call(this),t.EDITOR&&(this.sp||(this.sp=this.getComponent(t.Sprite),this.sp&&(this.sfs[0]||(this.sfs[0]=this.sp.spriteFrame))))},n.onEnable=function(){e.prototype.onEnable.call(this),this.updateSp()},n.setIndex=function(t){"string"==typeof t&&(t=Number(t)),this.index=t},n.updateSp=function(){if(this.enabled){var t=this.sfs[this._index];this.sp.spriteFrame=t}},l(i,[{key:"index",get:function(){return this._index},set:function(e){e!=this._index&&(this._index=t.Maths.clampf(e,0,this.sfs.length-1),this.updateSp())}}]),i}(t.BaseComponent);p([t.property({type:t.Sprite,displayName:"图片节点"})],e.prototype,"sp",void 0),p([t.property({type:[t.SpriteFrame],displayName:"图片",visible:function(){return this.sp}})],e.prototype,"sfs",void 0),p([t.property({step:1,displayName:"显示索引",visible:function(){return this.sp}})],e.prototype,"index",null),p([t.property({serializable:!0})],e.prototype,"_index",void 0),e=p([t.ccclass("SwitchSpriteCC"),t.executeInEditMode,t.menuUI("SwitchSpriteCC")],e),t.SwitchSpriteCC=e}(apeng||(apeng={})),function(t){var e=new t.Vec3,i=function(i){function n(){var e;return(e=i.apply(this,arguments)||this).backupDescribe="同步目标节点位置",e.target=null,e.isWorldPos=!1,e.lerpRatio=1,e.isOffset=!0,e.offsetPosition=new t.Vec3,e}o(n,i);var r=n.prototype;return r.onLoad=function(){i.prototype.onLoad.call(this),this.isOffset&&this.target&&t.Vector3.sub(this.offsetPosition,this.curPos,this.targetPos)},r.onUpdate=function(){this.target&&(t.Vector3.add(e,this.offsetPosition,this.targetPos),this.lerpRatio<1?t.NodeHelper.lerpTarget(this.node,e,this.lerpRatio*t._timer.dtSecond,void 0,this.isWorldPos):this.setPosition(e,this.isWorldPos))},l(n,[{key:"curPos",get:function(){return this.isWorldPos?this.node.worldPosition:this.node.position}},{key:"targetPos",get:function(){return this.isWorldPos?this.target.worldPosition:this.target.position}}]),n}(t.BaseComponent);p([t.property({type:_cc_.Node,tooltip:"自动对齐父节点",displayName:"目标节点"})],i.prototype,"target",void 0),p([t.property({tooltip:"使用世界坐标对齐",displayName:"世界坐标"})],i.prototype,"isWorldPos",void 0),p([t.property({range:[0,1,.001],slide:!0,tooltip:"解决抖动 从快到慢的动画, 1不使用插值",displayName:"插值跟随"})],i.prototype,"lerpRatio",void 0),p([t.property({tooltip:"初始化时 记录偏移值，始终保持偏移",displayName:"保留偏移"})],i.prototype,"isOffset",void 0),i=p([t.ccclass("SyncPositionTargetCC"),t.menuUI("SyncPositionTargetCC")],i),t.SyncPositionTargetCC=i}(apeng||(apeng={})),function(t){var e=new t.Vector2(5e3),i=function(i){function r(){var e;return(e=i.apply(this,arguments)||this).backupDescribe="实体组件",e.CLOSE_ON_CC=!0,e.updateStateMachineHead=!1,e.lateUpdateState=!1,e.isPreLoadResouces=!1,e.isLoadResouces=!0,e.isLoadResoucesOnce=!0,e.entityMgr=null,e.orginCreatePrefabDelayPositon=null,e.url="",e.entityID=0,e.entityStateMackine=new t.StateMackine({caller:n(e),states:[{type:t.EEntityState.Load,onEnter:e.onStateEnterLoad},{type:t.EEntityState.Run,onEnter:e.onStateEnterRun,onUpdate:e.onStateUpdateRun},{type:t.EEntityState.Reset,onEnter:e.onStateEnterReset,onUpdate:e.onStateUpdateReset},{type:t.EEntityState.Over,onEnter:e.onStateEnterOver,onUpdate:e.onStateUpdateOver},{type:t.EEntityState.Exit,onEnter:e.onStateEnterExit}]}),e}o(r,i);var a=r.prototype;return a.onStateEnterLoad=function(){var i=this.getDelayVisibleNode();i&&(this.orginCreatePrefabDelayPositon=new t.Vector2(i.position),t.NodeHelper.setPositionXY(i,e,!1)),this.isLoadResoucesOnce=!0},a.onStateEnterRun=function(){},a.onStateUpdateRun=function(){},a.onStateEnterReset=function(){},a.onStateUpdateReset=function(){},a.onStateEnterOver=function(t){this.unscheduleAllCallbacks()},a.onStateUpdateOver=function(){},a.onStateEnterExit=function(){this.unscheduleAllCallbacks(),t._timer.clearAll(this)},a.loadResouces=function(e){var i=this;"function"!=typeof e&&(e=null),this.onLoadResouces&&this.onLoadResouces();var n=function(){var n=function(){i.onLoadResoucesComplete&&i.onLoadResoucesComplete();var n=i.getDelayVisibleNode();n&&i.scheduleOnce((function(){t.NodeHelper.setPositionXY(n,i.orginCreatePrefabDelayPositon,!1)})),e&&e(),i.isLoadResoucesOnce=!1};i.loadOtherResouces?t._resouces.loadDir(i.loadOtherResouces(),n):n()},o=function(){var t=i.getResoucesUrl();t?i.loadResoucesByComp(t,n):n()};this.preLoadBundles?t._resouces.loadBundles(this.preLoadBundles(),o):o()},a.loadResoucesByComp=function(t,e){this.SpriteLoaderCC?this.setSpriteLoaderCCUrl(t,e):this.CreatePrefabToEditorCC?this.CreatePrefabToEditorCC.preloadPrefab(t,!0,e):this.getCreatePrefabToEditorOnceCC()?this.getCreatePrefabToEditorOnceCC().preloadPrefab(t,!0,e):e()},a.setSpriteLoaderCCUrl=function(t,e){this.SpriteLoaderCC.setSpriteFrameUrl(t,!0,e)},a.getResoucesUrl=function(){return this.isLoadResouces?this.SpriteLoaderCC?t._resouces.getUuidByUrl(this.SpriteLoaderCC.spriteFrameByUuid):this.CreatePrefabToEditorCC?t._resouces.getUuidByUrl(this.CreatePrefabToEditorCC.prefabItemByUuid):this.getCreatePrefabToEditorOnceCC()?t._resouces.getUuidByUrl(this.getCreatePrefabToEditorOnceCC().prefabItemByUuid):"":null},a.getDelayVisibleNode=function(){return this.isLoadResouces?this.CreatePrefabToEditorCC?this.CreatePrefabToEditorCC.node:this.getCreatePrefabToEditorOnceCC()?this.getCreatePrefabToEditorOnceCC().node:null:null},a.getCreatePrefabToEditorOnceCC=function(){return this.CreatePrefabToEditorOnceCC},r}(t.BaseComponent);i=p([t.ccclass("BaseEntity"),t.menuEntity("main/entity/BaseEntity")],i),t.BaseEntity=i}(apeng||(apeng={})),function(t){var e=function(){function e(e){this.CLEAR_EXIT="CLEAR_EXIT",this.pool=new t.Pool(1e5,(function(e){return t.instantiate(t._resouces.get(e))}),(function(t){return t.removeFromParent()}),(function(t){return t.destroy()})),this.entites=new t.Maps,this.entitesUpdateState=[],this.entitesLateUpdateState=[],this.entitesType=new t.Maps,this.entityID=0,this.scene=null,this.queueResoucseLoad=null,this.scene=e}var i=e.prototype;return i.loadQueueResouces=function(e){var i=this;this.queueResoucseLoad=new t.Queue((function(){i.onLoadQueueResoucesComplete&&i.onLoadQueueResoucesComplete()}),t._platform.isNative?-1:0);var n=[],o=[];this.entites.forEach((function(t){t.isPreLoadResouces?o.push(t):n.push(t)}));for(var r=0,a=o;r<a.length;r++){var s=a[r];s.loadResouces(null),e&&e(s)}var l=this.getQueueResoucesPriority();t.Sets.sortMin(n,(function(t){return l.indexOf(t.entityType)}));for(var u=function(){var t=c[h];i.queueResoucseLoad.add((function(i){t.loadResouces(i),e&&e(t)}))},h=0,c=n;h<c.length;h++)u();this.queueResoucseLoad.run()},i.updateStateMachine=function(){for(var t,e=u(this.entitesUpdateState);!(t=e()).done;){t.value.entityStateMackine.onUpdate()}for(var i,n=u(this.entitesLateUpdateState);!(i=n()).done;){i.value.entityStateMackine.onUpdate()}},i.add=function(e){this.entityID++,e.entityMgr=this;var i=this.entitesType.get(e.entityType);i||(i=new t.Maps,this.entitesType.set(e.entityType,i)),i.set(this.entityID,e),this.entites.set(this.entityID,e),("boolean"==typeof e.isUpdateStateMackine?e.isUpdateStateMackine:e.isUpdateStateMackine())&&(e.updateStateMachineHead?this.entitesUpdateState.unshift(e):e.lateUpdateState?this.entitesLateUpdateState.push(e):this.entitesUpdateState.push(e)),e.entityID=this.entityID},i.remove=function(e){if(e.entityStateMackine.state!=t.EEntityState.None){e.entityStateMackine.change(t.EEntityState.Exit,[this.CLEAR_EXIT]),this.entites.delete(e.entityID),("boolean"==typeof e.isUpdateStateMackine?e.isUpdateStateMackine:e.isUpdateStateMackine())&&(e.lateUpdateState?t.Sets.delete(this.entitesLateUpdateState,e):t.Sets.delete(this.entitesUpdateState,e));var i=this.entitesType.get(e.entityType);if(i&&i.delete(e.entityID),e.entityStateMackine.change(t.EEntityState.None),e.entityID=0,!e.node)throw new Error("节点为空，检测子父节点是否嵌套");e._onDisable(),e.onDestroy(),e.url&&e.isPut?this.pool.put(e.node):e.isDestroy&&e.node.destroy()}else console.log("已被回收",e.entityType,e.entityID)},i.changeState=function(t){this.entites.forEach((function(e){return e.entityStateMackine.change(t)}))},i.clear=function(t){var e=this;this.entites.forEach((function(t){return e.remove(t)}),!0),this.entites.clear(),this.entitesUpdateState.length=0,this.entitesLateUpdateState.length=0,this.entitesType.forEach((function(t){return t.clear()})),this.entitesType.clear(),this.entityID=0,t&&this.pool.clear(),this.queueResoucseLoad&&this.queueResoucseLoad.clear()},i.create=function(t,e){void 0===e&&(e=!0);var i=null,n="";"string"==typeof t?(n=t,i=this.pool.get(t)):i=t;var o=i.getComponent("BaseEntity");return o?(o.url=n,e&&this.add(o),this.runLife(o),o):null},i.runLife=function(t){t.autoMember(),t.__preload(),t._onLoad(),t._onEnable()},e}();t.BaseEntityMgr=e}(apeng||(apeng={})),function(t){var e;(e=t.EEntityState||(t.EEntityState={}))[e.None=0]="None",e[e.Load=1]="Load",e[e.Reset=2]="Reset",e[e.Run=3]="Run",e[e.Over=4]="Over",e[e.Exit=5]="Exit"}(apeng||(apeng={})),function(t){var e=function(){function t(t,e){this.x=-1,this.y=-1,this.g=-1,this.h=-1,this.f=-1,this.parent=null,this.isOpen=!1,this.isClose=!1,this.isSlash=!1,this.isFind=!0,this.x=t,this.y=e}t.manhattan=function(t,e,i,n){return Math.abs(t-i)+Math.abs(e-n)};var e=t.prototype;return e.clear=function(){this.g=-1,this.h=-1,this.f=-1,this.parent=null,this.isOpen=!1,this.isClose=!1,this.isSlash=!1},e.disponse=function(){this.clear(),this.isFind=!0},t}();t.AStarCell=e;var i=new t.PoolOnce(1e4,(function(){return new e(0,0)}),(function(t){return t.disponse()})),n=function(){function n(){this.cells=[],this.xMax=0,this.yMax=0,this.isSlash=!1,this.startCell=null,this.endCell=null,this._finds=[],this.findRes=[]}var o=n.prototype;return o.init=function(e,n,o){this.xMax=e,this.yMax=n,this.isSlash=o;for(var r=0;r<this.xMax;r++){this.cells[r]=[];for(var a=0;a<this.yMax;a++)this.cells[r][a]=t.Vector2.set(i.get(),r,a)}},o.run=function(){if(this._finds.length=0,this.findRes.length=0,!this.startCell||!this.endCell)return this.findRes;for(var t,i=u(this.cells);!(t=i()).done;)for(var n,o=u(t.value);!(n=o()).done;){n.value.clear()}var r=this.endCell;for(this.endCell=this.startCell,this.startCell=r,this.startCell.g=0,this.startCell.h=e.manhattan(this.startCell.x,this.startCell.y,this.endCell.x,this.endCell.y),this.startCell.f=this.startCell.g+this.startCell.h,this._finds[this._finds.length]=this.startCell,this.startCell.isOpen=!0;this._finds.length>0;){var a=this._finds.shift();if(a.isClose=!0,a.x==this.endCell.x&&a.y==this.endCell.y){for(;a.parent;)(a=a.parent).parent&&(this.findRes[this.findRes.length]=a);break}this.findByCell(a,1,0),this.findByCell(a,-1,0),this.findByCell(a,0,-1),this.findByCell(a,0,1),this.isSlash&&(this.findByCell(a,1,-1),this.findByCell(a,1,1),this.findByCell(a,-1,1),this.findByCell(a,-1,-1)),this._finds.sort((function(t,e){return t.f>e.f?1:-1}))}return this.findRes},o.findByCell=function(t,i,n){var o=t.x+i;if(o<0||o>=this.xMax)return!1;var r=this.cells[o];if(r){var a=t.y+n;if(!(a<0||a>=this.yMax)){var s=r[a];s&&s.isFind&&(s.isClose||((!s.parent||t.g<s.g)&&(s.g=t.g+(s.isSlash?Math.SQRT2:1),-1==s.h&&(s.h=e.manhattan(s.x,s.y,this.endCell.x,this.endCell.y)),s.f=s.g+s.h,s.parent=t,s.isSlash=1!=Math.abs(i+n)),s.isOpen||(this._finds[this._finds.length]=s,s.isOpen=!0)))}}},o.dispose=function(){this.startCell=null,this.endCell=null,this._finds.length=0,this.findRes.length=0;for(var t,e=u(this.cells);!(t=e()).done;)for(var n,o=u(t.value);!(n=o()).done;){var r=n.value;i.put(r)}this.cells.length=0},o.getIndexByCell=function(t){var e=t%this.yMax,i=Math.floor(t/this.yMax);return this.cells[i][e]},o.getCellByIndex=function(t){return t.x*this.yMax+t.y},n}();t.AStarHelper=n}(apeng||(apeng={})),function(t){var e=function(){function e(){}return e.clearMember=function(t){},e.init=function(i,n){var o=[];for(var r in n){if(null==n[r])if(0==t.Strings.indexOf(r,e.memberByNodeNamePrefix)){var a=t.Strings.lastIndexOf(r,e.memberByNodeNamePrefix);o.push(r.slice(a))}}t.NodeHelper.walkAllChild(i,(function(i){if(o.length>0&&t.Sets.has(o,i.name)){t.Sets.delete(o,i.name);var r=null,a=t.Maps.filterKey(t.js._nameToClass,(function(e,n){if(0==t.Strings.indexOf(n,"cc.")){if(r=n.slice(t.Strings.lastIndexOf(n,"cc.")),0==t.Strings.indexOf(i.name,r))return!0;r=null}else if(0==t.Strings.indexOf(i.name,n))return!0}),!0);a&&r&&(r+="CC",0==t.Strings.indexOf(i.name,r)&&t.js._nameToClass[r]&&(a=r));var s=e.memberByNodeNamePrefix+i.name;a?(n[s]=i.getComponent(a),n[s]||console.log("no find component: ",a,i.name)):n[s]=i,n[s]&&(null==n[s].AutoMemberNodeAttribute&&(n[s].AutoMemberNodeAttribute=[]),t.Sets.add(n[s].AutoMemberNodeAttribute,n.uuid)),e.isLog&&console.log("auto_add_member>>:",i.name,";",s,"; success:",n[s]?n[s].name:null)}if(t.NodeHelper.getUITransform(i)){var l=i.name;0==t.Strings.indexOf(l,"ButtonCC")&&(l=l.slice(t.Strings.lastIndexOf(l,"ButtonCC")));var u=e.registClickEventPrefix+l,h=n[u];h&&"function"==typeof h&&(t.EventHandlerCC.onClick(i,n[u],n),e.isLog&&console.log("auto_regist_click_event>>:",i.name,"; ",u))}}))},e}();e.isLog=!1,e.registClickEventPrefix="onClick",e.memberByNodeNamePrefix="c",t.AutoMemberNodeAttribute=e}(apeng||(apeng={})),function(t){var e=function(){function t(t,e){this.arr={},this.obj={};var i=this.deParse(t);for(var n in e){var o=i[n];if(this.arr[n]=[],-1!=n.indexOf("language"))for(var r in o)this.arr[n].push(o[r]);else for(var a in o){o[a].id=Number(a),o[a].configName=n,this.arr[n].push(o[a]);var s=e[n];null!==s&&(o[a]=o[a][s])}this.obj[n]=o}}return t.prototype.deParse=function(t){var e={};for(var i in t){var n=null;if(-1!=i.indexOf("language"))for(var o in n=t[i][1])for(var r=0;r<n[o].length;r++){var a=n[o][r];n[o][r]=a&&"string"==typeof a?a.split("\\n").join("\n"):a+""}else{n={};for(var s,l=[],h=u(t[i][0]);!(s=h()).done;){var c=s.value;l.push(c)}var p=t[i][1];for(var d in p){n[d]={};for(var f=0;f<l.length;f++)n[d][l[f]]=p[d][f]}}e[i]=n}return e},t}();t.ConfigHelper=e}(apeng||(apeng={})),function(t){var e=function(e){function i(i,n){var o;return(o=e.call(this)||this).poolCreate=i,o.poolClear=n,o.EventType={REMOVE:"REMOVE",RESET:"RESET"},o.pool=new t.PoolOnce(1e5,(function(){return o.poolCreate()}),(function(t){return o.poolClear(t)})),o.datas=[],o}o(i,e);var n=i.prototype;return n.create=function(){var t=this.pool.get();return this.datas.push(t),t},n.count=function(){for(var t,e=0,i=u(this.datas);!(t=i()).done;){t.value&&e++}return e},n.hasZero=function(){for(var t,e=u(this.datas);!(t=e()).done;){if(t.value)return!1}return!0},n.reset=function(){for(var t,e=u(this.datas);!(t=e()).done;){var i=t.value;i&&this.pool.put(i)}this.datas.length=0,this.emit(this.EventType.RESET)},n.remove=function(t){var e=this.datas[t];e&&(this.datas[t]=null,this.pool.put(e),this.emit(this.EventType.REMOVE,t))},i}(t.EventDispatcher);t.DataLogicHelper=e}(apeng||(apeng={})),function(t){var e=function(){function e(){this.data="",this.info=""}var i=e.prototype;return i.set=function(e){this.data=JSON.stringify(e);var i=this.data.length;this.info="长度"+i+"; 大小"+t.Maths.toFixed(i/1024,2)+"kb"},i.get=function(){return JSON.parse(this.data)},e}();p([t.property({displayName:"数据源"})],e.prototype,"data",void 0),p([t.property({readonly:!0,displayName:"数据信息"})],e.prototype,"info",void 0),e=p([t.ccclass("EditorParseDataCC")],e),t.EditorParseDataCC=e}(apeng||(apeng={})),function(t){var e=function(){function e(t,e,i,n,o){this.storage=t,this.cachePrefix=e,this.interval=i,this.cacheTimeFn=n,this.onSub=o}e.instance=function(t,e){return this._instance.interval=t,this._instance.cacheTimeFn=function(){return e},this._instance};var i=e.prototype;return i.getMul=function(t,e){return void 0===e&&(e=this.interval),t/e},i.setCache=function(){this.storage.set(this.cachePrefix+"_a",t.Times.second())},i.getOfflineMul=function(e,i){void 0===e&&(e=0),void 0===i&&(i=this.interval);var n=t.Times.second()-this.cacheTime+e;return n<=0?-1:this.getMul(n,i)},i.disponse=function(){this.storage.delete(this.cachePrefix+"_a")},l(e,[{key:"cacheTime",get:function(){return this.cacheTimeFn?this.cacheTimeFn():this.storage.get(this.cachePrefix+"_a",t.Times.second())}},{key:"sub",get:function(){return Math.max(0,this.cacheTime+this.interval-t.Times.second()-(this.onSub?this.onSub():0))}},{key:"subMax",get:function(){return this.cacheTime+this.interval-t.Times.second()-(this.onSub?this.onSub():0)}},{key:"ratio",get:function(){return t.Maths.clamp01((this.interval-this.sub)/this.interval)}},{key:"ratioMax",get:function(){return(this.interval-this.subMax)/this.interval}}]),e}();e._instance=new e(t.StorageOnceMgr,"test",-1),t.IntervalTimeHelper=e}(apeng||(apeng={})),function(t){var e=function(e){function i(i,n,o,r,a,s,l,u){var h;return void 0===u&&(u=null),(h=e.call(this)||this).storage=i,h.test=n,h.cacheKey=o,h.max=r,h.toMax=a,h.exclude=s,h.defautCacheData=l,h._parseDataCb=u,h._parseData=new t.Maps,h}o(i,e);var n=i.prototype;return n.setCurCache=function(t){this.setCache(this.cur,t)},n.getData=function(t){if(!this._parseDataCb)return null;var e=this._parseData.get(t);return e||(e=this._parseDataCb(t),this._parseData.set(t,e)),e},n.setCache=function(t,e){this.storage.set(this.cacheKey+".curData"+t,e,!1),this.emit(i.EventType.CACHE_CHANGE,t,e)},n.getAllCache=function(t){for(var e=[],i=1;i<=this.max;i++)e.push(t(this.getCache(i)));return e},n.getCache=function(t){return this.storage.get(this.cacheKey+".curData"+t,this.defautCacheData)},n.add=function(){var t=this.cur;return!!(this.toMax||t<this.max)&&(this.set(t+1),this.emit(i.EventType.ADD,t+1),!0)},n.set=function(t){this.storage.set(this.cacheKey+".cur",t),this.emit(i.EventType.CHNAGE)},n.getConverLevel=function(e){var i=this.storage.get(this.cacheKey+".cacheUrl",null);if(i||(i={}),!i[e]){var n=1;if(e>this.max){if(this.max<=2)n=this.max;else for(var o=this.storage.get(this.cacheKey+".lastRandomCacheUrl",-1);;)if(o!=(n=t.Maths.minToMax(1,this.max))&&-1==this.exclude.indexOf(n)){this.storage.set(this.cacheKey+".lastRandomCacheUrl",n);break}i[e]=n,this.storage.set(this.cacheKey+".cacheUrl",i),console.log("超过配置最大关卡 随机已有关卡:",e)}}return i[e]&&(e=i[e]),e},l(i,[{key:"cur",get:function(){return this.test>0?this.test:this.storage.get(this.cacheKey+".cur",1)}},{key:"curConverLevel",get:function(){return this.getConverLevel(this.cur)}},{key:"curData",get:function(){return this.getData(this.cur)}},{key:"curCache",get:function(){return this.getCache(this.cur)}}]),i}(t.EventDispatcher);e.EventType={CACHE_CHANGE:"CACHE_CHANGE",ADD:"ADD",CHNAGE:"CHNAGE"},t.LevelHelper=e}(apeng||(apeng={})),function(t){var e=new t.Vec3(0,1,0),i=new t.Vec3,n=new t.Vec3,o=new t.Vec3,r=new t.Vec3,s=new t.Quat,l=new t.Quat,h=(new t.Mat4,new t.Color),p=new t.Rectangle,d=new t.Size,f=new t.Color(150,150,150,255),y=new t.Color(150,150,150,0),g=function(){function g(){}return g.setHideFlags=function(e){if(t.EDITOR){for(var i=0,n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];for(var a=0,s=o;a<s.length;a++){var l=s[a];i|=l}e.hideFlags=i}},g.getChildByCreate=function(e,i,n,o,r,a){void 0===o&&(o=-1),void 0===r&&(r=!1);var s=e.getChildByName(i);return s||((s=new t.Node(i)).layer=e.layer,r||this.setHideFlags(s,t.CCObject.Flags.HideInHierarchy,t.CCObject.Flags.DontSave),this.getUITransform(e)&&s.addComponent(t.UITransform),n&&n(s),e.insertChild(s,-1==o?e.children.length:o),a&&a(s)),s},g.insertChild=function(t,e){var i=e.toString(),n=t.getChildByName(i);if(n)return n;for(var o=0,r=t.children,a=r.length;o<a;o++){var s=r[o];if(Number(s.name)>e)return this.getChildByCreate(t,i,null,o)}return this.getChildByCreate(t,i)},g.setSize=function(e,i,n){void 0===i&&(i=null),void 0===n&&(n=null),null==i||null==n?i&&i instanceof t.Size?g.getUITransform(e).setContentSize(i):null!=i&&null!=n?(d.set(i,n),g.getUITransform(e).setContentSize(d)):(null!=i&&(g.getUITransform(e).width=i),null!=n&&(g.getUITransform(e).height=n)):g.getUITransform(e).setContentSize(i,n)},g.getUITransform=function(t){return t._uiProps.uiTransformComp},g.getUIRenderer=function(e){return e.getComponent(t.UIRenderer)},g.move=function(e,i,o,r){return t.Vector3.set(n,i),t.Vector3.mul(n,n,o*t._timer.dt),t.Vector3.add(n,n,g.getPosition(e,r)),g.setPosition(e,n,r),n},g.getNodeComponents=function(t,e){for(var i,n=[],o=u(e);!(i=o()).done;){var r=i.value,a=t.getComponents(r);a.length>0&&n.push.apply(n,a)}return n},g.getParentByComponent=function(t,e){for(;t;){var i=t.getComponent(e);if(i)return i;t=t.parent}return null},g.gray=function(e,i){if(e&&e.activeInHierarchy){var n=function(e){if(e.getComponent("ButtonByChildGrayExcludeCC"))return 1;if(e.active){var n=e.getComponent(t.Sprite);if(n)n.enabled&&(n.grayscale=i);else{var o=e.getComponent(t.Label);if(o&&o.enabled){var r=o.orginLabelColor;r||(r=o.orginLabelColor=o.color.clone()),i?(f.a=r.a,o.color=f):o.color=r;var a=o.outlineColor;if(a){var s=o.orginLabelOutlineColor;s||(s=o.orginLabelOutlineColor=a.clone()),o.outlineColor=i?y:s}}}}};n(e),e.children.length>0&&this.walkAllDeepChild(e,n)}},g.getParentByName=function(t,e){for(var i=t.parent;i;){if(i.name==e)return i;i=i.parent}return null},g.getParentByNameChild=function(t,e){for(var i=t.parent,n=t;i;){if(i.name==e)return n;n=i,i=i.parent}return null},g.getChildrenByComponent=function(t,e){for(var i,n=u(t.children);!(i=n()).done;){var o=i.value.getComponent(e);if(o)return o}return null},g.getAllByComponent=function(t,e){var i=t.getComponent(e);return i||(i=t.getComponentInChildren(e)),i||(i=null),i},g.getChildrenByComponents=function(t,e,i,n){for(var o,r=0,a=u(t.children);!(o=a()).done;){var s=o.value.getComponent(e);s&&(null!=n&&n.push(s),i&&i(s,r),r++)}return n},g.lookAt=function(i,o,r,a){void 0===r&&(r=null),void 0===a&&(a=90),g.getUITransform(i)?(t.Vector2.equals(i.worldPosition,o,.1)||(a=t.Vector2.angle360(i.worldPosition,o,r||0)),n.set(0,0,a),g.setRotate(i,n,!1)):(t.Vector3.set(n,o),i.lookAt(n,e),0!=r&&(s.set(),r=t.Maths.toRadian(r),t.Quat.rotateY(s,s,r),i.rotate(s,t.Node.NodeSpace.WORLD)))},g.zIndexSort=function(e,i){var n=e.map((function(t,e){return{node:t,zIndex:i(t,e)}}));t.Sets.sortMin(n,(function(t){return t.zIndex}));for(var o=0;o<n.length;o++)n[o].node.setSiblingIndex(o)},g.followTarget=function(e,i,a,s,l,u){void 0===s&&(s=null),void 0===l&&(l=!0);var h=!1;if(t.Vector3.set(n,i),t.Vector3.set(r,g.getPosition(e,l)),t.Vector3.equalsZero(n,r))return!0;t.Vector3.set(o,i),t.Vector3.sub(n,n,r);var c=t.Vector3.len(n);return c<.001||("number"==typeof a?(a*=t._timer.dtSecond)>c&&(h=!0,a=c):(t.Vector3.mul(a,a,60*t._timer.dt),t.Vector3.len(a)>c&&(h=!0,t.Vector3.normalize(a,a),t.Vector3.mul(a,a,c))),t.Vector3.normalize(n,n),t.Vector3.mul(n,n,a),t.Vector3.add(r,n,g.getPosition(e,l)),g.setPosition(e,r,l),null!=s&&g.lookAt(e,o,s,u),h)},g.lerpTarget=function(e,i,a,s,l,u,h){return void 0===s&&(s=null),void 0===l&&(l=!0),void 0===h&&(h=.001),t.Vector3.set(n,i),t.Vector3.set(o,g.getPosition(e,l)),!!t.Vector3.equalsZero(n,o)||(t.Vector3.set(r,i),t.Vector3.distance(n,o)<h?(g.setPosition(e,n,l),!0):(t.Vector3.lerp(o,o,n,a),g.setPosition(e,o,l),null!=s&&g.lookAt(e,r,s,u),!1))},g.converScreenToWorld=function(e,i,o){return t.Vector3.set(n,i),o?o.screenToWorld(n,n):t.view._convertToUISpace(n),t.Vector3.set(e,n),e},g.converSceneToUI=function(e,i,o){return t.Vector3.set(n,i),o.worldToScreen(n,n),g.converScreenToWorld(n,n,this.UICamera),t.Vector3.set(e,n),e},g.lerpScaleTarget=function(e,i,r,a){return void 0===a&&(a=!0),"number"==typeof i?t.Vector3.set(n,i,i,i):t.Vector3.set(n,i),t.Vector3.set(o,g.getScale(e,a)),!!t.Vector3.equalsZero(n,o)||((this.getUITransform(e)?t.Vector2.distance(n,o):t.Vector3.distance(n,o))<.001?(g.setScale(e,n,a),!0):(t.Vector3.lerp(o,o,n,r),g.setScale(e,o,a),!1))},g.lerpRotateTarget=function(e,i,r,a){return void 0===a&&(a=!0),"number"==typeof i?t.Vector3.set(n,i,i,i):t.Vector3.set(n,i),t.Vector3.set(o,g.getRotateV3(e,a)),!!t.Vector3.equalsZero(n,o)||((this.getUITransform(e)?n.z-o.z:t.Vector3.distance(n,o))<.001?(g.setRotate(e,n,a),!0):(t.Vector3.lerp(o,o,n,r),g.setRotate(e,o,a),!1))},g.lerpQuatTarget=function(e,i,r){return l.set(i),e.getRotation(s),!!t.Quat.strictEquals(s,l)||(l.getEulerAngles(n),s.getEulerAngles(o),t.Vector3.distance(n,o)<.001?(e.setRotation(l),!0):(t.Quat.lerp(s,s,l,r),g.getUITransform(e)?(s.getEulerAngles(n),g.setRotateZ(e,n.z,!1)):e.setRotation(s),!1))},g.walkAllChild=function(t,e,i){if(void 0===i&&(i=!1),i)for(var n,o=u(t.children);!(n=o()).done;){var r=n.value;if(e(r))break;g.walkAllChild(r,e,i)}else for(var a=[].concat(t.children),s=0;s<a.length&&!e(a[s]);s++)a.push.apply(a,a[s].children)},g.walkAllDeepChild=function(t,e){for(var i,n=u(t.children);!(i=n()).done;){var o=i.value,r=e(o);if(1!==r){if(2===r)break;g.walkAllDeepChild(o,e)}}},g.setRotate=function(e,i,o){t.Vector3.set(n,i),o?e.setWorldRotationFromEuler(n.x,n.y,n.z):e.setRotationFromEuler(n)},g.setRotateX=function(t,e,i){s.set(g.getRotate(t,i)),s.getEulerAngles(n),n.x=e,g.setRotate(t,n,i)},g.setRotateY=function(t,e,i){s.set(g.getRotate(t,i)),s.getEulerAngles(n),n.y=e,g.setRotate(t,n,i)},g.setRotateZ=function(t,e,i){t.angle=e},g.rotateX=function(e,i,n){s.set(),t.Quat.rotateX(s,s,t.Maths.toRadian(i)),e.rotate(s,n?t.Node.NodeSpace.WORLD:t.Node.NodeSpace.LOCAL)},g.rotateY=function(e,i,n){s.set(),t.Quat.rotateY(s,s,t.Maths.toRadian(i)),e.rotate(s,n?t.Node.NodeSpace.WORLD:t.Node.NodeSpace.LOCAL)},g.rotateZ=function(e,i,n){s.set(),t.Quat.rotateZ(s,s,t.Maths.toRadian(i)),e.rotate(s,n?t.Node.NodeSpace.WORLD:t.Node.NodeSpace.LOCAL)},g.setScale=function(e,i,o){t.Vector2.set(n,i),null!=i.z&&(n.z=i.z),this.getUITransform(e)&&(n.z=1),t.Vector3.equalsZero(n,g.getScale(e,o))||(o?e.setWorldScale(n):e.setScale(n))},g.setScaleNum=function(e,i,o){e.scale.x!==i&&(this.getUITransform(e)?t.Vector3.set(n,i,i,1):t.Vector3.set(n,i,i,i),g.setScale(e,n,o))},g.getRotate=function(t,e){return e?t.worldRotation:t.rotation},g.getRotateV3=function(t,e){return g.getRotate(t,e).getEulerAngles(this._getRotateV3)},g.getRotateZ=function(t){return t.angle},g.getScale=function(t,e){return e?t.worldScale:t.scale},g.setScaleX=function(e,i,o){t.Vector3.set(n,g.getScale(e,o)),n.x=i,g.setScale(e,n,o)},g.setScaleY=function(e,i,o){t.Vector3.set(n,g.getScale(e,o)),n.y=i,g.setScale(e,n,o)},g.setScaleZ=function(e,i,o){t.Vector3.set(n,g.getScale(e,o)),n.z=i,g.setScale(e,n,o)},g.setPositionX=function(e,i,o){t.Vector3.set(n,g.getPosition(e,o)),n.x=i,g.setPosition(e,n,o)},g.setPositionY=function(e,i,o){t.Vector3.set(n,g.getPosition(e,o)),n.y=i,g.setPosition(e,n,o)},g.setPositionZ=function(e,i,o){t.Vector3.set(n,g.getPosition(e,o)),n.z=i,g.setPosition(e,n,o)},g.setPositionXY=function(e,i,o){t.Vector3.set(n,g.getPosition(e,o)),t.Vector2.set(n,i),g.setPosition(e,n,o)},g.setPosition=function(e,i,o,r,a,s){t.Vector3.set(n,i),isNaN(n.z)&&(n.z=0),r&&(n.x+=r),a&&(n.y+=a),s&&(n.z+=s),o?t.Vector3.equalsZero(e.worldPosition,n)||e.setWorldPosition(n):t.Vector3.equalsZero(e.position,n)||e.setPosition(n)},g.setOpacity=function(e,i){var n=e.getComponent(t.UIRenderer);if(!n||n instanceof t.Graphics){var o=e.getComponent(t.UIOpacity);o||(o=e.addComponent(t.UIOpacity)),o.opacity!=255*i&&(o.opacity=255*i)}else h.set(n.color),h.a=255*i,n.color.a!=h.a&&(n.color=t.EDITOR?h.clone():h)},g.getOpacity=function(e){var i=e.getComponent(t.UIRenderer);if(i)return i.color.a/255;var n=e.getComponent(t.UIOpacity);return n||(n=e.addComponent(t.UIOpacity)),n.opacity/255},g.getPosition=function(e,n,o,r,a){return e?(n?t.Vector3.set(this._getPosition,e.worldPosition):t.Vector3.set(this._getPosition,e.position),o&&(this._getPosition.x+=o),r&&(this._getPosition.y+=r),a&&(this._getPosition.z+=a),this._getPosition):(this._getPosition.set(i),this._getPosition)},g.distance=function(e,i,n){switch(void 0===n&&(n="xyz"),n){case"xyz":return t.Vector3.distance(e.worldPosition,i.worldPosition);case"xy":return t.Vector2.distance(e.worldPosition,i.worldPosition);case"x":return Math.abs(e.worldPosition.x-i.worldPosition.x);case"y":return Math.abs(e.worldPosition.y-i.worldPosition.y);case"z":return Math.abs(e.worldPosition.z-i.worldPosition.z)}},g.convertToWorldSpaceAR=function(t,e,i){return g.getUITransform(e).convertToWorldSpaceAR(i,t)},g.convertToNodeSpaceAR=function(t,e,i){var o=g.getUITransform(e);return n.set(i.x,i.y),o.convertToNodeSpaceAR(n,t)},g.convertSelfToOtherNodeSpaceAR=function(e,i,n,o){return i==n?t.Vector3.set(e,o):(g.convertToWorldSpaceAR(e,i,o),g.convertToNodeSpaceAR(e,n,e),e)},g.isHit=function(t,e){return g.getRectangle(p,t,!0),p.contains(e)},g.getRectangle=function(e,i,r,a){return void 0===a&&(a=!1),n.set(g.getXMin(i,r,a),g.getYMin(i,r,a)),o.set(g.getXMax(i,r,a),g.getYMax(i,r,a)),t.Rectangle.fromMinMax(e,n,o)},g.getYMin=function(t,e,i){void 0===i&&(i=!1);var n=g.getUITransform(t);return(e?t.worldPosition.y:t.position.y)-n.height*(i?1:t.scale.y)*n.anchorY},g.getYMax=function(t,e,i){void 0===i&&(i=!1);var n=g.getUITransform(t);return(e?t.worldPosition.y:t.position.y)+n.height*(i?1:t.scale.y)*(1-n.anchorY)},g.getXMax=function(t,e,i){void 0===i&&(i=!1);var n=g.getUITransform(t);return(e?t.worldPosition.x:t.position.x)+n.width*(i?1:t.scale.x)*(1-n.anchorX)},g.getXMin=function(t,e,i){void 0===i&&(i=!1);var n=g.getUITransform(t);return(e?t.worldPosition.x:t.position.x)-n.width*(i?1:t.scale.x)*n.anchorX},g.findChildrenByNameOnce=function(t,e){var i=null;return g.walkAllChild(t,(function(t){if(t.name==e)return i=t,!0})),i},g.findChildrenByPrefixNameOnce=function(e,i){var n=null;return g.walkAllChild(e,(function(e){if(0==t.Strings.indexOf(e.name,i))return n=e,!0})),n},g.findChildrenByNamePrefixs=function(e,i,n){var o=[];return g.walkAllChild(e,(function(e){0==t.Strings.indexOf(e.name,i)&&(o.push(e),n&&n(e))})),o},g.coordinateTracker=function(e,i,n,r,a,s){var l=n.worldPosition;return r.convertToUINode(l,i,e.converPosition),s&&t.Vec3.transformMat4(o,l,r.camera.matView),e.scale=a/Math.abs(o.z),e},g.getSaveImageUrl=function(e){return c(this,void 0,void 0,a().mark((function i(){return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",new Promise((function(i){var n;if(!e)return i("");var o=null===(n=e.getComponent(t.UITransform))||void 0===n?void 0:n.contentSize;if(!o)return i("");if(!t._platform.isNative)return i("");var r=t._ui.UICamera;if(!r)return i("");var a=new t.RenderTexture;a.reset({width:t.view.getVisibleSize().width,height:t.view.getVisibleSize().height}),r.targetTexture=a;var s=t.native.fileUtils.getWritablePath()+"renderTexture.png";t.native.fileUtils.removeFile(s),t._timer.once(null,(function(){var n=e.getWorldPosition(),l=a.readPixels(Math.round(n.x),Math.round(n.y),o.width,o.height);t.native.saveImageData(l,o.width,o.height,s).then((function(){return r.targetTexture=null,a.decRef(),i(s)})).catch((function(){return r.targetTexture=null,a.decRef(),i("")}))}),1/60)})));case 1:case"end":return i.stop()}}),i)})))},g}();g.UICamera=null,g._getRotateV3=new t.Vec3,g._getPosition=new t.Vec3,t.NodeHelper=g}(apeng||(apeng={})),function(t){var e=function(e){function i(t,i,n,o,r,a,s){var l;return void 0===a&&(a=!1),void 0===s&&(s=""),(l=e.call(this)||this).storage=t,l.configName=i,l.id=n,l.defaultCount=o,l._maxCount=r,l.toMax=a,l.cachePrefix=s,l.intervalTime=null,l.autoResumeCount=-1,l.isAutoResumeOffline=!1,l.addCountConver=null,l.subCountConver=null,l.maxCountConver=null,l.defaultCount||(l.defaultCount=0),(!l._maxCount||l._maxCount<0)&&(l._maxCount=9999999),l}o(i,e);var n=i.prototype;return n.add=function(e,n){if(void 0===n&&(n=!1),!(e<=0)){this.addCountConver&&(e=this.addCountConver(e));var o=this.cur+e;this.toMax||o>this.maxCount&&(o=this.maxCount),this.set(o),this.cur>=this.maxCount&&t._timer.clear(this,this.onLoopAutoResume);var r=!1;this.isAdd||(r=!0,this.storage.set(this.getCacheKey("a"),"true"),this.emit(i.EventType.ADD_ONCE,e)),this.emit(i.EventType.ADD,e,n,r)}},n.sub=function(t){if(!(t<=0)){this.subCountConver&&(t=this.subCountConver(t));var e=this.cur,i=this.cur-t;i<0&&(i=0),this.set(i),this.intervalTime&&e>=this.maxCount&&this.intervalTime.setCache(),this.openAutoResume()}},n.set=function(t,e){if(void 0===e&&(e=!0),this.cur!=t){var n=this.cur;this.storage.set(this.getCacheKey("c"),t),e&&this.emit(i.EventType.CHANGE,t,n)}},n.has=function(t){return!(this.cur<t)},n.openAutoResume=function(){this.intervalTime&&this.cur<this.maxCount&&t._timer.loop(this,this.onLoopAutoResume,1,-1,1)},n.initAutoResume=function(e,i,n){this.intervalTime=new t.IntervalTimeHelper(this.storage,this.getCacheKey("i"),e),this.autoResumeCount=i,this.isAutoResumeOffline=n},n.onLoopAutoResume=function(){this.intervalTime&&this.intervalTime.sub<=0&&(this.intervalTime.setCache(),this.add(this.autoResumeCount,!0))},n.autoResumeByOffline=function(t,e){if(void 0===e&&(e=this.autoResumeCount),this.isAutoResumeOffline){var i=this.intervalTime.getOfflineMul(t)*e;if(!(i<1)){var n=this.toMax;this.toMax=!1,this.add(Math.floor(i),!0),this.toMax=n,this.intervalTime.setCache()}}},n.getCacheKey=function(t){return this.cachePrefix+this.configName+this.id+""+t},n.dispose=function(){this.storage.delete(this.getCacheKey("a")),this.storage.delete(this.getCacheKey("c")),this.intervalTime&&this.intervalTime.disponse(),this.intervalTime=null,this.clearEvent()},l(i,[{key:"isAdd",get:function(){return"true"==this.storage.get(this.getCacheKey("a"),"false")}},{key:"cur",get:function(){return this.storage.get(this.getCacheKey("c"),this.defaultCount)}},{key:"maxCount",get:function(){return this.maxCountConver?this.maxCountConver(this._maxCount):this._maxCount}}]),i}(t.EventDispatcher);e.EventType={CHANGE:"CHANGE",ADD_ONCE:"ADD_ONCE",ADD:"ADD"},t.PropHelper=e}(apeng||(apeng={})),function(t){var e=function(){function e(e,i,n,o,r,a,s,l,u,h,c,p,d,f,y){void 0===f&&(f=""),void 0===y&&(y=null),this.storage=e,this.configName=i,this.addOnce=n,this.configDatas=o,this.defaultCount=r,this.maxCount=a,this.toMax=s,this.isAutoResume=l,this.autoResumeIntervale=u,this.autoResumeCount=h,this.isAutoResumeOffline=c,this.addCount=p,this.changeCount=d,this.cachePrefix=f,this._updateCount=y,this.datas=new t.Maps}var i=e.prototype;return i.getAll=function(e){var i=this,n=[];return t.Maps.forEach(this.configDatas,(function(t,o){o=Number(o),e&&-1!=e.indexOf(o)||i.get(o).cur>0&&n.push(o)})),n},i.getAdds=function(){var e=this,i=[];return t.Maps.forEach(this.configDatas,(function(t,n){e.get(n).isAdd&&i.push(n)})),i},i.updateCount=function(){for(var t in this._updateCount&&this._updateCount(),this.configDatas){var e=this.get(Number(t));e._maxCount=this.maxCount(e.id),e.defaultCount=this.defaultCount(e.id),e.set(e.defaultCount,!1)}},i.get=function(e){var i=this,n=this.datas.get(e);return n||(n=new t.PropHelper(this.storage,this.configName,Number(e),this.defaultCount(e),this.maxCount(e),this.toMax(e),this.cachePrefix),this.isAutoResume&&this.autoResumeIntervale&&this.autoResumeCount&&this.isAutoResumeOffline&&this.isAutoResume(e)&&n.initAutoResume(this.autoResumeIntervale(e),this.autoResumeCount(e),this.isAutoResumeOffline(e)),this.addCount&&n.once(t.PropHelper.EventType.ADD_ONCE,(function(){i.addOnce(e)}),this),this.addCount&&n.on(t.PropHelper.EventType.ADD,(function(t,n,o){i.addCount(e,t,n,o)}),this),this.changeCount&&n.on(t.PropHelper.EventType.CHANGE,(function(t){i.changeCount(e,t)}),this),this._updateCount&&(n.toMax||n.cur>n.maxCount&&n.set(n.maxCount,!1)),this.datas.set(e,n)),n},e}();t.PropsHelper=e}(apeng||(apeng={})),function(t){var e=function(e){function i(i,n,o){var r;return(r=e.call(this)||this).storage=i,r.configName=n,r.defaultID=o,r.configDatas=null,r._defaultUnlocks=null,r.configDatas=t._config_.obj[r.configName],r}o(i,e);var n=i.prototype;return n.getCacheKey=function(t){return this.configName+"s"+t},n.has=function(e){return t.Sets.has(this.unlocks,e)},n.unlock=function(t){this.has(t)||(this.unlocks.push(t),this.storage.set(this.getCacheKey("u"),this.unlocks),this.emit(i.EventType.UNLOCK,t))},n.use=function(t){this.cur!=t&&this.has(t)&&(this.storage.set(this.getCacheKey("l"),this.cur),this.storage.set(this.getCacheKey("c"),t),this.emit(i.EventType.CHANGE_AFTER,t),this.emit(i.EventType.CHANGE,t))},n.getUnlockTypeByNoIDs=function(e){var i=this,n=[];return t.Maps.forEach(this.configDatas,(function(t,o){var r=Number(o);t.unlock_type==e&&(i.has(r)||n.push(r))})),n},n.hasIDUse=function(t){return 1==this.configDatas[t].is_use},n.getDefaultUnlocks=function(){var e=this;return null==this._defaultUnlocks&&(this._defaultUnlocks=[],t.Maps.forEach(this.configDatas,(function(t,i){var n=Number(i);1==t.is_unlock&&e._defaultUnlocks.push(n)}))),this._defaultUnlocks},l(i,[{key:"cur",get:function(){return this.storage.get(this.getCacheKey("c"),this.defaultID)}},{key:"lastCur",get:function(){return this.storage.get(this.getCacheKey("l"),this.defaultID)}},{key:"unlocks",get:function(){return this.storage.get(this.getCacheKey("u"),this.getDefaultUnlocks())}},{key:"noUnlocks",get:function(){var e=this,i=[];return t.Maps.forEach(this.configDatas,(function(t,n){var o=Number(n);e.has(o)||i.push(o)})),i}}]),i}(t.EventDispatcher);e.EventType={CHANGE_AFTER:"CHANGE_AFTER",CHANGE:"CHANGE",UNLOCK:"UNLOCK"},t.SkinHelper=e}(apeng||(apeng={})),function(t){var e=new t.Vector2,i=function(){function i(){this.clickShape=null,this.eventNode=null,this.delay=-1,this.fingerNode=null,this.itemParent=null,this.graphics=null,this.outlineGraphics=null,this.isFingerAnim=!1,this.isScaleAnim=!1,this.isDraw=!0,this.scaleMax=5,this.scaleDuration=.5,this.scaleEase=t.EEaseType.quintOut,this.fingerOffsetPoint=null,this.fingerAngle=0,this.dirty=!0,this._curScale=0}var n=i.prototype;return n.init=function(t,e,i){return this.itemParent=t,this.graphics=e,this.outlineGraphics=i,this.onCreate&&this.onCreate(),this.updateFingerPosition(),this.isScaleAnim?this._onScaleStart():(this.isFingerAnim&&this.updateFingerPosition(),this.outlineGraphics&&(this.outlineGraphics.node.active=!0)),this},n.setDelay=function(t){return this.delay=t,this},n.setIsDraw=function(t){return this.isDraw=t,this},n.setFinger=function(e,i){return void 0===i&&(i=0),this.isFingerAnim=!0,this.fingerAngle=i,this.fingerOffsetPoint=new t.Vector2(e),this},n.setAnim=function(t,e,i){return void 0===e&&(e=this.scaleMax),void 0===i&&(i=this.scaleEase),this.scaleDuration=t,this.scaleMax=e,this.scaleEase=i,this.isScaleAnim=!0,this},n.setClick=function(t,e){return this.clickShape=t,this.eventNode=e,this},n.onClick=function(e){if(this.clickShape&&this.clickShape(e),this.eventNode){var i="function"==typeof this.eventNode?this.eventNode():this.eventNode;t.EventHandlerCC.runClick(i,e)}},n.updateFingerPosition=function(){this.isFingerAnim&&(t.Vector2.add(e,this.getShapeCenter(),this.fingerOffsetPoint),t.NodeHelper.setPositionXY(this.fingerNode,e,!0))},n.onUpdate2=function(){if(this.isScaleAnim&&1!=this._curScale){this.dirty=!0,this._curScale=this._curScale+t._timer.dtDefault*(1/this.scaleDuration),this._curScale>1&&(this._curScale=1);var e=this.scaleMax*(1-t.easing(this.scaleEase,this._curScale))+1;this.onScaleing(e),1==this._curScale&&this._onScaleEnd()}},n._onScaleStart=function(){this.isFingerAnim&&(this.fingerNode.active=!1),this.outlineGraphics&&(this.outlineGraphics.node.active=!1),this.onScaleStart&&this.onScaleStart()},n._onScaleEnd=function(){this.isFingerAnim&&(this.fingerNode.active=!0),this.outlineGraphics&&(this.outlineGraphics.node.active=!0),this.onScaleEnd&&this.onScaleEnd()},i}();t.BaseHollow=i}(apeng||(apeng={})),function(t){var e=function(t){function e(e,i){var n;return void 0===i&&(i=null),(n=t.call(this)||this)._circle=e,n.circleHeight=i,n.circle=null,n.copyCircle=null,n}o(e,t);var i=e.prototype;return i.onCreate=function(){"function"==typeof this._circle?this.circle=this._circle():this.circle=this._circle,this.isScaleAnim&&(this.copyCircle=this.circle.clone())},i.onScaleing=function(t){this.copyCircle.mul(this.circle,t)},i.draw=function(){this.circleHeight?(this.graphics.ellipse(this.circle.x,this.circle.y,this.circle.radius,this.circleHeight),this.outlineGraphics&&this.outlineGraphics.ellipse(this.circle.x,this.circle.y,this.circle.radius,this.circleHeight)):(this.graphics.circle(this.circle.x,this.circle.y,this.circle.radius),this.outlineGraphics&&this.outlineGraphics.circle(this.circle.x,this.circle.y,this.circle.radius))},i.getShapeCenter=function(){return this.circle.position},i.intersection=function(t){return this.circle.contains(t)},e}(t.BaseHollow);t.CircleHollow=e}(apeng||(apeng={})),function(t){var e=function(e){function i(i,n,o){var r;return void 0===n&&(n=!1),(r=e.call(this)||this)._node=i,r.syncPosition=n,r.createCopyNode=o,r.node=null,r.copyNode=null,r.rect=new t.Rectangle,r}o(i,e);var n=i.prototype;return n.onCreate=function(){"function"==typeof this._node?this.node=this._node():this.node=this._node,t.NodeHelper.getRectangle(this.rect,this.node,!0),this.copyNode=t.instantiate(this.node),this.copyNode.active=!0,t.NodeHelper.setPositionX(this.copyNode,-1e4,!1),this.itemParent.addChild(this.copyNode),t.NodeHelper.setPosition(this.copyNode,this.node.worldPosition,!0),this.copyNode.pauseSystemEvents(!0),this.createCopyNode&&this.createCopyNode(this.copyNode)},n.onScaleing=function(t){},n.onUpdate=function(){this.syncPosition&&this.node&&this.copyNode&&(t.NodeHelper.setPosition(this.copyNode,this.node.worldPosition,!0),t.NodeHelper.getRectangle(this.rect,this.node,!0),this.updateFingerPosition())},n.getShapeCenter=function(){return this.rect.center},n.intersection=function(t){return this.rect.contains(t)},i}(t.BaseHollow);t.NodeHollow=e}(apeng||(apeng={})),function(t){var e=new t.Vector3,i=function(i){function n(t){var e;return(e=i.call(this)||this)._polygon=t,e.polygon=null,e.copyPolygon=null,e.centerPolygon=null,e}o(n,i);var r=n.prototype;return r.onCreate=function(){if("function"==typeof this._polygon?this.polygon=this._polygon():this.polygon=this._polygon,this.isScaleAnim){this.copyPolygon=[],this.centerPolygon=new t.Vector2(this.getShapeCenter());for(var e,i=u(this.polygon);!(e=i()).done;){var n=e.value;this.copyPolygon.push(new t.Vector2(n).subSelf(this.centerPolygon))}}},r.onScaleStart=function(){},r.onScaleEnd=function(){},r.onScaleing=function(i){for(var n,o=0,r=u(this.copyPolygon);!(n=r()).done;){var a=n.value;t.Vector2.mul(e,a,i),t.Vector2.add(this.polygon[o],e,this.centerPolygon),o++}},r.draw=function(){this.outlineGraphics&&this.outlineGraphics.moveTo(this.polygon[0].x,this.polygon[0].y),this.graphics.moveTo(this.polygon[0].x,this.polygon[0].y);for(var t=1;t<this.polygon.length;t++){var e=this.polygon[t];this.graphics.lineTo(e.x,e.y),this.outlineGraphics&&this.outlineGraphics.lineTo(e.x,e.y)}this.outlineGraphics&&this.outlineGraphics.lineTo(this.polygon[0].x,this.polygon[0].y),this.graphics.lineTo(this.polygon[0].x,this.polygon[0].y)},r.getShapeCenter=function(){return t.Vector2.polygonByCenterPoint(e,this.polygon)},r.intersection=function(e){return t.Polygon.pointInPolygon(e,this.polygon)},n}(t.BaseHollow);t.PolygonHollow=i}(apeng||(apeng={})),function(t){var e=function(t){function e(e,i){var n;return void 0===i&&(i=null),(n=t.call(this)||this)._rect=e,n.rectRadius=i,n.rect=null,n.copyRect=null,n}o(e,t);var i=e.prototype;return i.onCreate=function(){"function"==typeof this._rect?this.rect=this._rect():this.rect=this._rect,this.isScaleAnim&&(this.copyRect=this.rect.clone())},i.onScaleing=function(t){this.copyRect.mul(this.rect,t)},i.draw=function(){this.rectRadius?(this.outlineGraphics&&this.outlineGraphics.roundRect(this.rect.x,this.rect.y,this.rect.width,this.rect.height,this.rectRadius),this.graphics.roundRect(this.rect.x,this.rect.y,this.rect.width,this.rect.height,this.rectRadius)):(this.outlineGraphics&&this.outlineGraphics.rect(this.rect.x,this.rect.y,this.rect.width,this.rect.height),this.graphics.rect(this.rect.x,this.rect.y,this.rect.width,this.rect.height))},i.getShapeCenter=function(){return this.rect.center},i.intersection=function(t){return this.rect.contains(t)},e}(t.BaseHollow);t.RectHollow=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).datas=new Map,t.curMusicUrl="",t}o(i,e);var n=i.prototype;return n.onLogic=function(){var e=this;t._main.once(t._main.EventType.TOUCH_DOWN,(function(){t._timer.once(null,(function(){e.checkPlaying(e.curMusicUrl)&&e.playMusic(e.curMusicUrl)}),.5)}))},n.setVolume=function(t,e){var i=this;this.getVolume(t)!=e&&(this.storage.set("AudioMgr.allVolume"+t,e),this.datas.forEach((function(e,n){t?e.music&&e.source&&e.source.playing&&(e.source.volume=i.getCurVolume(n)):!e.music&&e.source&&e.source.playing&&(e.source.volume=i.getCurVolume(n))})))},n.getVolume=function(t){return this.storage.get("AudioMgr.allVolume"+t,1)},n.setDefalutVolume=function(t,e){t&&(this.getData(t).volume=e)},n.setStartTime=function(t,e){t&&(this.getData(t).startTime=e)},n.setScaleVolume=function(t,e){if(t){var i=this.getData(t);i.volumeScale=e,i.source&&(i.source.volume=this.getCurVolume(t))}},n.getCurVolume=function(t){var e=this.getData(t);return e.volume*this.getVolume(e.music)*e.volumeScale},n.play=function(e,i,n,o){var r=this;if(void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===o&&(o=!0),e){var a=this.getData(e);a.source?(a.music=n,(o||a.source.state!=t.AudioSource.AudioState.PLAYING)&&(a.source.loop=i,this._playSource(e,a.source))):this.load(e,-1,(function(t){t&&r.play(e,i,n)}))}},n.playMore=function(e){var i=this.getData(e);if(!i.source){var n=t._resouces.get(e,t.AudioClip);if(!n)return;i.source=this.addAudioSouce(n)}for(var o,r=null,a=u(i.sources);!(o=a()).done;){var s=o.value;if(s.state!=t.AudioSource.AudioState.PLAYING){r=s;break}}r||(r=this.addAudioSouce(i.source.clip),i.sources.push(r)),this._playSource(e,r)},n._playSource=function(t,e){var i=this.getData(t);e.volume=this.getCurVolume(t),e.play(),0!=i.startTime&&(e.currentTime=i.startTime)},n.playMusic=function(t){var e=this;t&&(this.curMusicUrl!=t?(this.datas.forEach((function(i){i.url!=t&&i.music&&e.stop(i.url)})),this.curMusicUrl=t,this.checkPlaying(t),this.play(t,!0,!0,!1)):this.checkPlaying(t)&&this.play(t,!0,!0,!1))},n.checkPlaying=function(e){var i=this.getData(e);return!(!i||!i.source||i.source.state!=t.AudioSource.AudioState.INIT)&&(i.source&&i.source.node.removeFromParent(),i.source=null,console.log("检测到背景声未播放 清除数据"),!0)},n.resumeAll=function(){var t=this;this.datas.forEach((function(e,i){t.resume(i)}))},n.pauseAll=function(){var t=this;this.datas.forEach((function(e,i){t.pause(i)}))},n.resume=function(e){if(e){var i=this.getData(e);i.source&&i.source.state==t.AudioSource.AudioState.PAUSED&&i.source.play()}},n.pause=function(e){if(e){var i=this.getData(e);i.source&&i.source.state==t.AudioSource.AudioState.PLAYING&&i.source.pause()}},n.stop=function(t){if(t){var e=this.getData(t);e.source&&e.source.stop()}},n.load=function(e,i,n){var o=this;if(void 0===i&&(i=-1),e){var r=this.getData(e);r.source?n&&n(!0):t._timer.once(this,(function(){t._resouces.load({url:e,type:t.AudioClip},(function(t){t&&(r.source=o.addAudioSouce(t)),n&&n(!!t)}),null,!0)}),i)}},n.addAudioSouce=function(e){var i=t.NodeHelper.getChildByCreate(t._ui.getLayerParent(t.EUILayer.Top),"_audio_").addComponent(t.AudioSource);return i.clip=e,i},n.getData=function(t){var e=this.datas.get(t);return e||(e={source:null,sources:[],url:t,volume:1,music:!1,volumeScale:1,startTime:0},this.datas.set(t,e)),e},i}(t.BaseModule);e=p([t.moduleMgr.add(t.EModuleType.audio)],e),t.AudioModule=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).datas=[],t}o(i,e);var n=i.prototype;return n.onLogic=function(){t.initData.openGm&&t._ui.open("gm/prefab/GMUI",null,null,null,!1)},n.addData=function(t){return this.datas[this.datas.length]=t,this},n.getDatas=function(){return this.datas},n.click=function(e,i){var n=t.Sets.filterValue(this.datas,(function(t){return t.dec===e}));n&&n.click(i)},i}(t.BaseModule);e=p([t.moduleMgr.add(t.EModuleType.gm)],e),t.GmModule=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).EventType={NEW_USER_COMPLETE:"NEW_USER_COMPLETE",NEW_USER_COMPLETE_QUEUE:"NEW_USER_COMPLETE_QUEUE",FINGER_CLICK:"FINGER_CLICK"},t.models={},t}o(i,e);var n=i.prototype;return n.onCreate=function(){t._ui.setPreLoadUrls("guide/prefab/GuideMaskUI",(function(){return[{url:t.CGuideDefine.fingerUrl,type:t.Prefab}]}))},n.trigger=function(){if(!this.newUserComplete){t._ui.blockTouchEvent(!0,t.EUILayer.ItemUp,t._ui.stageUp);var e=this.models[this.newUserCur];this.newUserIndex>=e.completeIndex||(this.storage.set("GuideModule.newUserCur",this.newUserCur-1),this.storage.set("GuideModule.newUserIndex",-1)),this.next(!0)}},n.getLastByIndex=function(t,e){return this.models[t].datas.length-e-1},n.add=function(t,e){return this.models[t]=e,-1==e.completeIndex&&(e.completeIndex=e.datas.length-1),this},n.addOnce=function(t){return this.add(0,t),this},n.getOnceLastByIndex=function(t){return this.getLastByIndex(0,t)},n.complete=function(){if(!this.newUserComplete){this.storage.set("GuideModule.newUserIndex",this.newUserIndex+1);var t=this.models[this.newUserCur];console.log("引导:",this.newUserCur,this.newUserIndex,t.completeIndex,this.newUserIndex>=t.completeIndex);var e=t.datas[this.newUserIndex];e?e():this.next()}},n.next=function(e){var i=this;void 0===e&&(e=!1);var n=this.models[this.newUserCur+1];n?(this.storage.set("GuideModule.newUserCur",this.newUserCur+1),this.storage.set("GuideModule.newUserIndex",-1),t._main.changeScene(n.sceneUrl,(function(){n.enter((function(){return i.complete()}))}),e?2:-1)):(console.log("引导完成"),t._ui.blockTouchEvent(!1,t.EUILayer.ItemUp,t._ui.stageUp),this.storage.set("isComplete","true"),this.emit(this.EventType.NEW_USER_COMPLETE),this.emitQueue(this.EventType.NEW_USER_COMPLETE_QUEUE,-1,(function(){console.log("引导队列完成")}),(function(t){return t+""})))},n.moveFinger=function(e,i){t._guide.mask({drag:{framWorldPosition:e,toWorldPosition:i}})},n.dialogue=function(e){t._ui.open("guide/prefab/GuideDialogueUI",e,null,null,!1)},n.mask=function(e){t._ui.open("guide/prefab/GuideMaskUI",e,null,null,!1)},n.finger=function(e){t._ui.open("guide/prefab/GuideFingerUI",e,null,null,!1)},n.closeDialogue=function(){t._ui.close("guide/prefab/GuideDialogueUI")},n.closeMask=function(){t._ui.close("guide/prefab/GuideMaskUI")},n.closeFinger=function(){t._ui.close("guide/prefab/GuideFingerUI")},n.ui=function(e,i,n,o){var r=this;void 0===o&&(o=0),t._ui.once(t._ui.EventType.OPEN,(function(a){if(a==e){if("false"==r.storage.get(i,"false")){var s=t._ui.getModule(e).ui;return t._ui.blockTouchEvent(!0,t.EUILayer.ItemUp,t._ui.stageUp),t._timer.once(r,(function(){n(s,(function(){r.storage.set(i,"true"),t._ui.blockTouchEvent(!1,t.EUILayer.ItemUp,t._ui.stageUp)}))}),o),!0}return!1}return!1}))},n.maskByPolygon=function(e,i,n){var o=new t.PolygonHollow((function(){var t=e.getShape(1,n||e.node.worldPosition);return i&&i(t),t.getPolygon()})).setFinger([0,0]).setAnim(.5);return t._timer.callLater(this,this.mask,[{clickShapeByCloseUI:!0,hollows:[o]}]),o},n.maskByCircle=function(e,i,n){void 0===n&&(n=!0);var o=e.worldPosition,r=new t.CircleHollow((function(){var n=new t.Circle(o.x,o.y,t.NodeHelper.getUITransform(e).width/2);return i&&i(n),n})).setFinger([0,0]).setAnim(.5);return t._timer.callLater(this,this.mask,[{clickShapeByCloseUI:n,hollows:[r]}]),r},n.maskByRect=function(e,i,n,o){void 0===o&&(o=!0);var r=new t.RectHollow((function(){var i=t.NodeHelper.getRectangle(new t.Rectangle,e,!0);return n&&n(i),i}),i).setFinger([0,0]).setAnim(.5);return t._timer.callLater(this,this.mask,[{clickShapeByCloseUI:o,hollows:[r]}]),r},l(i,[{key:"newUserComplete",get:function(){return"true"==this.storage.get("isComplete","false")}},{key:"newUserCur",get:function(){return this.storage.get("GuideModule.newUserCur",0)}},{key:"newUserIndex",get:function(){return this.storage.get("GuideModule.newUserIndex",-1)}}]),i}(t.BaseModuleEvent);e=p([t.moduleMgr.add(t.EModuleType.guide)],e),t.GuideModule=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).EventType={CHANGE:"CHANGE"},t.cur=null,t.curStr=null,t._datas={},t}o(i,e);var n=i.prototype;return n.onCreate=function(){for(var e in this.updateType(),t.initData.configDefine)if(-1!=e.indexOf("language")){var i=t._config_.obj[e];for(var n in i)this._datas[n]=i[n]}var o=t.initData.languageDefine;if(o&&o.chinese){for(var r in o.chinese)this._datas[r]=[o.chinese[r]];for(var a in o){var s=t.ELanguageType[a];if(s){var l=o[a];for(var u in l)this._datas[u][s]=l[u]}}this.updateType()}},n.onLogic=function(){var e=this;t._gm.addData({dec:"切换为中文",click:function(){e.change(t.ELanguageType.chinese)}}).addData({dec:"切换为繁体",click:function(){e.change(t.ELanguageType.traditional)}}).addData({dec:"切换为英文",click:function(){e.change(t.ELanguageType.english)}}).addData({dec:"切换为西班牙",click:function(){e.change(t.ELanguageType.spanish)}}).addData({dec:"切换为葡萄牙",click:function(){e.change(t.ELanguageType.portuguese)}}).addData({dec:"切换为越南",click:function(){e.change(t.ELanguageType.vietnamese)}}).addData({dec:"切换为印尼",click:function(){e.change(t.ELanguageType.indonesia)}})},n.change=function(e){var i=this;t.initData.getLanguageType(t.ELanguageType)!=t.ELanguageType[e]?(t._ui.Loading.wait(!0),this.setLanguageType(e),this.updateType(),console.log("切换语言"+this.curStr),t._ui.closeAll(t.EUILayer.Panel).closeAll(t.EUILayer.Notice).closeAll(t.EUILayer.Item),this.emitQueue(this.EventType.CHANGE,-1,(function(){console.log("切换成功"),t._timer.once(i,(function(){t._ui.Loading.wait(!1)}),.3)}))):t._ui.tip("是当前语言无需切换")},n.updateType=function(){this.curStr=t.initData.getLanguageType(t.ELanguageType),this.cur=t.ELanguageType[this.curStr]},n.setLanguageType=function(t){localStorage.setItem("language",t+"")},n.get=function(t){var e=this._datas[t];return e?e[this.cur]:""},n.replace=function(t,e){return this.get(t).replace("{0}",e)},n.getSpriteFrame=function(e){return this.cur==t.ELanguageType.chinese?e:"languageTexture/"+this.curStr+"/"+e},n.converSpriteFrameUrl=function(t){var e=t.indexOf("languageTexture/");return-1==e?t:(e=t.indexOf("/",e+17),t.substring(e+1))},i}(t.BaseModuleEvent);e=p([t.moduleMgr.add(t.EModuleType.language)],e),t.LanguageModule=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).isNewUser=!1,i._requests=new t.Maps,i}o(i,e);var n=i.prototype;return n.onInstance=function(){"false"==this.storage.get("isNewUser","false")?(this.storage.set("isNewUser","true"),this.storage.set("registTime",t.Times.second()),this.isNewUser=!0):this.isNewUser=!1},n.onLogic=function(){this.login()},n.updateInfo=function(e){var i=this.userData;i.name=e.name,i.img_url=e.avatarUrl,this.storage.set("userData",i,!1),this.request("user/updateInfo",new t.si.User.CSInfo(e.name,e.avatarUrl))},n.requestByLogin=function(t,e,i,n){var o=this;void 0===n&&(n=!1),this.login((function(){o.request(t,e,i,n)}))},n.login=function(e){var i=this;if(t.initData.server&&t.initData.server.gameId&&t.initData.server.requestIp)if(this.userData)e&&e();else{var n=new t.si.User.CSLogin("",t._platform.config.appid,"",t.si.EPlatformType[t._platform.type]),o=function(){i.request("user/login",n,(function(t){i.storage.set("userData",t),e&&e()}))};switch(t._platform.type){case t.EPlatformType.wx:t._platform.instance.login((function(t){n.openid="",n.jscode=t,o()}));break;default:t._platform.instance.getSystemId((function(t){n.openid=t,n.jscode="",o()}))}}},n.request=function(e,i,n,o){if(void 0===o&&(o=!1),t.initData.server&&t.initData.server.gameId&&t.initData.server.requestIp){i.game_id=t.initData.server.gameId,this.userData&&(i.user_id=this.userData.user_id);var r=this._requests.get(e);if(!r){if(r={http:new t.HttpRequest(t.initData.server.requestIp,e,"POST",!1),cb:new t.CompleteCallBack},this._requests.set(e,r),o){var a=function(){return t._ui.Loading.wait(!1)};r.http.on(t.HttpRequest.EventType.START,(function(){return t._ui.Loading.wait(!0)})),r.http.on(t.HttpRequest.EventType.COMPLETE,a),r.http.on(t.HttpRequest.EventType.NONE,a),r.http.on(t.HttpRequest.EventType.ERROR,a)}r.http.on(t.HttpRequest.EventType.COMPLETE,(function(t){t.errorCode||r.cb.run(t.data)}))}return r.cb.set(n),r.http.send(i),r.http}},l(i,[{key:"registTime",get:function(){return this.storage.get("registTime",-1)}},{key:"userData",get:function(){return this.storage.get("userData",null)}}]),i}(t.BaseModule);e=p([t.moduleMgr.add(t.EModuleType.login)],e),t.LoginModule=e}(apeng||(apeng={})),function(t){var e=new t.Vec2,i=new t.Vec2,n=new t.Vec2,r=function(r){function a(){var e;return(e=r.apply(this,arguments)||this).EventType={NEW_DAY:"NEW_DAY",TODAY_ONCE_ONLINE:"TODAY_ONCE_ONLINE",SHOW_QUERY:"SHOW_QUERY",HAS_PLAY_CLICK_EFFECT:"HAS_PLAY_CLICK_EFFECT",TOUCH_DOWN:"TOUCH_DOWN",TOUCH_UP:"TOUCH_UP",VIDEO_COMPLETE:"VIDEO_COMPLETE"},e.loopIntervalServer=30,e.startTime=-1,e.offlineTime=-1,e.preLoadQueue=null,e._isToDay=!0,e.lastOnlineTimeAdd=t.Times.second(),e.loadingCompleteColor=new t.Color,e.showVideoQuery="video",e}o(a,r);var s=a.prototype;return s.onCreate=function(){var e=this;this.loadingCompleteColor.fromHEX(t.initData.loadingCompleteColorAnim);var i=t.Times.day(t.Times.now);this._isToDay=this.storage.get("MainModel._isToDay",i)==i,this.storage.set("MainModel._isToDay",i),this.updateNewDay(),this.startTime=t.Times.second(),this.offlineTime=t._login.storage.get("main-offlineTime",t.Times.second()),this.updateLogicTime(),this.preLoadQueue=new t.Queue((function(){console.log("预加载资源完成"),t._resouces.setSfData(0,2)}),.5),this.preLoadQueue.add((function(e){return t._ui.load(t._ui.DefaultUrl.tip,e)})).add((function(e){return t._ui.load(t._ui.DefaultUrl.tipSystemFont,e)})).add((function(e){return t._ui.load(t._ui.DefaultUrl.tipClick,e)})).add((function(e){return t._ui.load(t._ui.DefaultUrl.tipClickSystemFont,e)})).add((function(e){return t._ui.load(t._ui.DefaultUrl.tipTitleClick,e)})).add((function(e){return t._ui.load(t._ui.DefaultUrl.tipTitleClickSystemFont,e)})).add((function(e){return t._audio.load(t.EventHandlerCC.clickSoundUrl,-1,e)})),t.initData.sceneChangeWaitUrl&&this.preLoadQueue.add((function(e){return t._resouces.loadPrefab(t.initData.sceneChangeWaitUrl,e)})),t._resouces.addRootBundle("main","guide","content"),this.on(this.EventType.NEW_DAY,(function(){e.storage.set("MainModel.allDayCount",e.allDayCount+1),t._ui.clearOpenDayCount()})),t._scene.once(t._scene.EventType.CHANG_SUCCESS,(function(){t._timer.once(e,(function(){var i=t.Times.day();e.storage.get("MainModel.lastDay",-1)!=i&&e.storage.set("MainModel.lastDay",i),e.preLoadQueue.run()}),1)})),t._platform.isIDE||t._platform._share_.onShareAppMessage((function(){return e.getShareData()}));var n=!1;t.input.on(t.Input.EventType.KEY_DOWN,(function(e){e.keyCode==t.KeyCode.KEY_S&&n&&t._ui.screenShot(),n=!1,e.keyCode==t.KeyCode.KEY_P&&(n=!0)}))},s.onLogic=function(){var e=this;this.registTouch(),t._guide.once(t._guide.EventType.NEW_USER_COMPLETE,(function(){e.storage.set("MainModel.lastDay",t.Times.day())})),t._gm.addData({dec:"清除本地缓存",click:function(){return e.changeOtherAccount()}}).addData({dec:"重启游戏",click:function(){t._platform.instance.reStart()}}),t._platform.instance.onShow((function(t){e.updateNewDay(),console.log("进入query",t),e.checkLaunch(t)}))},s.onComplete=function(){this._isToDay||(console.log("----------------是昨天 更新为新的一天"),this.emit(this.EventType.NEW_DAY)),this.checkLaunch()},s.changeScene=function(e,i,n){var o=this;if(void 0===n&&(n=-1),t._scene.curUrl!=e){t._ui.blockTouchEvent(!0);var r=function(){t._scene.change(e,(function(){t._timer.once(o,(function(){t._ui.blockTouchEvent(!1),t._ui.Loading.screen(!1,o.loadingCompleteColor),t._ui.Loading.wait(!1,void 0,void 0,t.initData.sceneChangeWaitUrl),i&&i()}),.4)}),null,{duration:.6,url:t.initData.sceneChangeWaitUrl})};n<=0?r():setTimeout(r,1e3*n)}else i&&i()},s.registTouch=function(){var o=this,r=!1,a=function(e,i){var o=t.NodeHelper.getChildByCreate(t._ui.getLayerParent(t.EUILayer.Top,t._ui.stageUp),"touchMove",(function(e){t.initData.touchMovePrefabUrl&&t._resouces.loadPrefab(t.initData.touchMovePrefabUrl,(function(){e.addChild(t._ui.pool.get(t.initData.touchMovePrefabUrl))}))}));n.set(e,i),t.NodeHelper.setPositionXY(o,n,!0)};t.EventHandlerCC.touchEvent.on(t.Input.EventType.TOUCH_START,(function(i){t.EventHandlerCC.touchIsMove=!1,r=!0,t.EventHandlerCC.touchIsMoveRun=!1,i.getUILocation(e),t.initData.touchClickPrefabUrl||a(e.x,e.y),o.emit(o.EventType.TOUCH_DOWN)})).on(t.Input.EventType.TOUCH_END,(function(n){if(t.EventHandlerCC.touchIsMove=!1,r=!1,t.EventHandlerCC.touchIsMoveRun=!1,a(-1e4,0),n.getUILocation(i),o.emit(o.EventType.TOUCH_UP,n),t.Vector2.equals(e,i)){for(var s,l=u(o.emit(o.EventType.HAS_PLAY_CLICK_EFFECT,i));!(s=l()).done;){if(!s.value)return}t.initData.touchClickPrefabUrl&&t._resouces.loadPrefab(t.initData.touchClickPrefabUrl,(function(){var e=t._ui.pool.get(t.initData.touchClickPrefabUrl);t._ui.getLayerParent(t.EUILayer.Top,t._ui.stageUp).addChild(e),t.NodeHelper.setPositionXY(e,i,!0);var n=function(){return t._ui.pool.put(e)},o=e.getComponent("DragonBonesCC");if(o)o.playDefault(1,n);else{var r=e.getComponent("SpineCC");if(r)r.playDefault(!1,n);else{var a=e.getComponent("AnimtorCC");if(a)a.playDefault(n);else{var s=e.getComponent("ParticleSystem2DCC");s&&s.play(n)}}}}))}})).on(t.Input.EventType.TOUCH_CANCEL,(function(e){t.EventHandlerCC.touchIsMove=!1,r=!1,t.EventHandlerCC.touchIsMoveRun=!1,a(-1e4,0)})).on(t.Input.EventType.TOUCH_MOVE,(function(i){t.EventHandlerCC.touchIsMove=!0,r&&(i.getUILocation(n),t.EventHandlerCC.touchIsMoveRun||t.Vector2.equals(e,n,3)||(t.EventHandlerCC.touchIsMoveRun=!0),a(n.x,n.y))}))},s.checkLaunch=function(e){e||(e=t._platform.instance.getLaunchOptionsSync()),console.log("启动参数:",e),e.query&&e.query.query&&this.emit(this.EventType.SHOW_QUERY,e.query.query)},s.showVideo=function(e,i,n,o){var r=this;void 0===n&&(n=!1),t.initData.rewardVideoUseShare||n?t._platform._share_.show(this.getShareData(),(function(e){e?(r.emit(r.EventType.VIDEO_COMPLETE,!0),i()):(t._platform.type!=t.EPlatformType.tt&&t._ui.tip(t._language.get(40005)),r.emit(r.EventType.VIDEO_COMPLETE,!1),o&&o())})):t._platform._rewardedVideo_.showByFinish(e,(function(){r.emit(r.EventType.VIDEO_COMPLETE,!0),i()}),(function(){r.emit(r.EventType.VIDEO_COMPLETE,!1)}))},s.getShareData=function(){var e=t._platform._share_.getData(),i=[this.showVideoQuery,e.imageUrl,t._platform.config.share.list.title.indexOf(e.title)];return e.query=JSON.stringify(i),t._platform.instance.reportEvent("share",{shareid:i[1],sharetextid:i[2],sharetype:1}),e},s.updateNewDay=function(){var e=t.Times.getToDayLeave()/1e3;console.log("距离第二天时间:"+t.Times.numHourCountDown(1e3*e)),t._timer.loop(this,this._updateNewDay,t.Times.dayOnce/1e3,-1,e)},s._updateNewDay=function(){this._isToDay=!1,this.storage.set("MainModel._isToDay",t.Times.day()),this.emit(this.EventType.NEW_DAY),this.storage.delete("MainModel.onlineTimeToDay"),console.log("新的一天----------------------")},s.changeOtherAccount=function(){t._ui.Loading.wait(!0),t.StorageMgr.clear(),t._timer.once(this,(function(){return t._platform.instance.reStart()}),.3)},s.updateLogicTime=function(){var e=t.Times.second(),i=e-this.lastOnlineTimeAdd;i<0||(t._login.storage.set("main-offlineTime",e,!1),this.storage.set("MainModel.onlineTime",this.storage.get("MainModel.onlineTime",0)+i,!1),this.storage.set("MainModel.onlineTimeToDay",this.storage.get("MainModel.onlineTimeToDay",0)+i,!1),this.lastOnlineTimeAdd=e,t._timer.once(this,this.updateLogicTime,this.loopIntervalServer))},s.getNewDay=function(e){var i=t.Times.Date.getDate();return this.storage.get("MainModel.newDay."+e,i)!=i&&(this.storage.set("MainModel.newDay."+e,i),!0)},s.converBillToGold=function(t){return Math.floor(100*t)},s.getAddId=function(t){var e=this.storage.get(t,0);return e++,this.storage.set(t,e),e},l(a,[{key:"onlineTime",get:function(){return this.updateLogicTime(),this.storage.get("MainModel.onlineTime",0)}},{key:"onlineTimeToDay",get:function(){return this.updateLogicTime(),this.storage.get("MainModel.onlineTimeToDay",0)}},{key:"offlineByMinute",get:function(){return t.StorageLogic.offlineByMinute(this.offlineTime)}},{key:"offlineByHour",get:function(){return t.StorageLogic.offlineByHour(this.offlineTime)}},{key:"offlineByDay",get:function(){return t.StorageLogic.offlineByDay(this.offlineTime)}},{key:"dayNewUser",get:function(){return t.StorageLogic.dayNewUser(t._login.registTime)}},{key:"allDayCount",get:function(){return this.storage.get("MainModel.allDayCount",1)}}]),a}(t.BaseModuleEvent);r=p([t.moduleMgr.add(t.EModuleType.main)],r),t.MainModule=r}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).EventType={INIT:"INIT",ON_SHOW:"ON_SHOW",ON_HIDE:"ON_HIDE"},i.openWebSimulationUI=!1,i.systemInfo=null,i.instance=null,i.config=null,i.type=null,i.initTime=-1,i.isInit=!1,i.OpenDataContext=null,i._banner_=null,i._blockOnce_=null,i._interstitial_=null,i._nativeTemp_=null,i._record_=null,i._rewardedVideo_=null,i._share_=null,i._vibrate_=null,i._dayAdCount={day:-1,count:0},i._bannerOrNativeTempType=t.EBottomAdType.None,i._blockOnceType=t.EBlockOnceAdType.None,i._settingData=null,i}o(i,e);var n=i.prototype;return n.onInstance=function(){var e=this;this.type=t.EPlatformType[t.initData.platformType],this.openWebSimulationUI=this.type==t.EPlatformType.web&&t.initData.openWebSimulationUI,this.isInit=!0,this.initTime=t.Times.second(),this.instance=t.platformMgr.instanceOnce(this.type),this.isNative&&(console.log("注册原生端接收消息接口"),window.__onNative_=function(t){console.log("接收到原生端消息:",t);var i=JSON.parse(t);e.emit(i.eventType,i.arg)})},n.init=function(e){var i=this,n=t.initData.configPlatform;n||(n="platform");var o,r=t._config_.obj[n][this.type];this.config={gameName:t.initData.gameName,appid:r.appid,startBlockAd:t.initData.startBlockAd,share:t.initData.share,blockOnce:{id:r.blockOnce,refreshInterval:120,idUpdate:r.blockOnce},banner:{id:r.banner,refreshInterval:60*(this.type==t.EPlatformType.qq?1:5),sizeRatio:1,active:!0},interstitial:{id:(o=r.interstitial,Array.isArray(o)||(o=[o]),o),coolingTime:0},nativeTemp:{id:r.nativeTemp,idRoot:r.nativeTempRoot,refreshInterval:300},rewardedVideo:{id:r.rewardedVideo,idOnce:r.rewardedVideoOnce,showMaxCount:999999,isSuccess:!1}},this.openWebSimulationUI&&(this.config.banner.id="webTest",this.config.banner.idUpdate="webTest",this.config.blockOnce.id="webTest",this.config.blockOnce.idUpdate="webTest",this.config.interstitial.id=["webTest"],this.config.nativeTemp.id="webTest",this.config.nativeTemp.idRoot="webTest",this.config.rewardedVideo.id="webTest",this.config.rewardedVideo.idOnce="webTest");var a=new t.LoadDir(3,e);t.platformMgr.run(a.subCount()),this.OpenDataContext=this.instance.IOpenDataContext(),this.instance.onShow((function(){console.log("后台进入前台"),i.emit(i.EventType.ON_SHOW)})),this.instance.onHide((function(){console.log("前台进入后台"),i.emit(i.EventType.ON_HIDE)})),this.systemInfo=this.instance.getSystemInfoSync(),this.getSetting(a.subCount()),t.platformLogicMgr.instance(!0),this._banner_=t.platformLogicMgr.get(t.EPlatformLogicType.banner),this._blockOnce_=t.platformLogicMgr.get(t.EPlatformLogicType.blockOnce),this._interstitial_=t.platformLogicMgr.get(t.EPlatformLogicType.interstitial),this._nativeTemp_=t.platformLogicMgr.get(t.EPlatformLogicType.nativeTemp),this._record_=t.platformLogicMgr.get(t.EPlatformLogicType.record),this._rewardedVideo_=t.platformLogicMgr.get(t.EPlatformLogicType.rewardedVideo),this._share_=t.platformLogicMgr.get(t.EPlatformLogicType.share),this._vibrate_=t.platformLogicMgr.get(t.EPlatformLogicType.vibrate),this._banner_.isSimulate=t.initData.useWebSimulationUI,this._interstitial_.isSimulate=t.initData.useWebSimulationUI,this._nativeTemp_.isSimulate=t.initData.useWebSimulationUI,this._record_.isSimulate=t.initData.useWebSimulationUI,this._rewardedVideo_.isSimulate=t.initData.useWebSimulationUI,this._share_.isSimulate=t.initData.useWebSimulationUI,t.platformLogicMgr.run(a.subCount(),t.EPlatformLogicType)},n.sendToNative=function(e,i){return void 0===i&&(i=""),t.sys.isNative?t.sys.platform==t.sys.Platform.ANDROID?t.native.reflection.callStaticMethod("com/cocos/game/Main","onScript","(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;",e,i):t.sys.platform==t.sys.Platform.IOS?t.native.reflection.callStaticMethod("UtilsHelper","onScript",e,i):"":""},n.getDayAd=function(e){e+="_count";var i=this.storage.get(e,this._dayAdCount),n=t.Times.Date.getDay();return i.day!=n&&(i.day=n,i.count=0,this.storage.set(e,i)),i},n.addDayAdCount=function(t){var e=this.getDayAd(t);e.count++,t+="_count",this.storage.set(t,e)},n.hasOpenAd=function(){return 0==this.config.startBlockAd||this.initTime+this.config.startBlockAd<t.Times.second()},n.setKeepScreenOn=function(){this.instance.root&&this.instance.root.setKeepScreenOn&&this.instance.root.setKeepScreenOn({keepScreenOn:!0})},n.setEnableDebug=function(t){this.instance.root&&this.instance.root.setEnableDebug&&this.instance.root.setEnableDebug({enableDebug:t})},n.bannerOrNativeTemp=function(e){var i=this;this._bannerOrNativeTempType=e,this.isInit&&(this.type==t.EPlatformType.qq&&this._banner_.errHide&&this._bannerOrNativeTempType==t.EBottomAdType.Banner&&(this._bannerOrNativeTempType=t.EBottomAdType.Native),this._bannerOrNativeTemp((function(){t._timer.once(i,i._bannerOrNativeTemp,.5)})))},n._bannerOrNativeTemp=function(e){switch(this._bannerOrNativeTempType){case t.EBottomAdType.None:this._nativeTemp_.hide(e),this._banner_.hide(e);break;case t.EBottomAdType.Banner:this._nativeTemp_.hide(e),this._banner_.show(e);break;case t.EBottomAdType.Native:this._nativeTemp_.show(e),this._banner_.hide(e)}},n.blockOnce=function(e){var i=this;this._blockOnceType=e,this.isInit&&this.__blockOnce((function(){t._timer.once(i,i.__blockOnce,.5)}))},n.__blockOnce=function(e){switch(this._blockOnceType){case t.EBlockOnceAdType.None:this._blockOnce_.hide(e);break;case t.EBlockOnceAdType.Show:this._blockOnce_.show(e)}},n.getSetting=function(t,e){var i=this;void 0===e&&(e=!0),e&&this._settingData?t(this._settingData):this.instance.getSetting((function(e){i._settingData=e,t(e)}))},l(i,[{key:"_web",get:function(){return this.instance}},{key:"_wx",get:function(){return this.instance}},{key:"_qq",get:function(){return this.instance}},{key:"_tt",get:function(){return this.instance}},{key:"_vivo",get:function(){return this.instance}},{key:"_oppo",get:function(){return this.instance}},{key:"_hbs",get:function(){return this.instance}},{key:"_xiaomi",get:function(){return this.instance}},{key:"_overseas_android_xgame",get:function(){return this.instance}},{key:"_a360",get:function(){return this.instance}},{key:"_overseas_kwai",get:function(){return this.instance}},{key:"_overseas_weiyou",get:function(){return this.instance}},{key:"_ks",get:function(){return this.instance}},{key:"_ios",get:function(){return this.instance}},{key:"isNetWork",get:function(){var e=navigator.onLine;return t.sys.isNative&&(e=t.sys.getNetworkType()!=t.sys.NetworkType.NONE),e}},{key:"isIOS",get:function(){return-1!=this.systemInfo.model.indexOf("hone")}},{key:"isIDE",get:function(){return-1!=this.systemInfo.brand.indexOf("devtools")}},{key:"isLongScreen",get:function(){var t=this.systemInfo;return t.screenHeight/t.screenWidth>1.94}},{key:"isNative",get:function(){return t.sys.isNative}},{key:"isOverseas",get:function(){return this.type==t.EPlatformType.overseas_weiyou||this.type==t.EPlatformType.ios||this.type==t.EPlatformType.web||this.type==t.EPlatformType.overseas_android_xgame}}]),i}(t.BaseModuleEvent);e=p([t.moduleMgr.add(t.EModuleType.platform)],e),t.PlatformModule=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){return e.apply(this,arguments)||this}o(i,e);var n=i.prototype;return n.show=function(e,i){"false"==t.StorageOnceMgr.get("PrivacyModule.success","false")?t._ui.open("main/prefab/privacy/PrivacyUI",(function(){t.StorageOnceMgr.set("PrivacyModule.success","true",!1),t._platform.instance.privacyConfirm(i)}),e,null,!1):(e(),t._platform.instance.privacyConfirm(i))},n.openDecUI=function(){t._ui.open("main/prefab/privacy/privacyText")},n.openUserUI=function(){t._ui.open("main/prefab/privacy/userText",{path:"ad/user/",count:9,gameName:t.initData.gameName+"用户协议"})},i}(t.BaseModule);e=p([t.moduleMgr.add(t.EModuleType.privacy)],e),t.PrivacyModule=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).numRollAnimParam="show",t.EventType={FLY_TIP_COMPLETE:"FLY_TIP_COMPLETE",CHANGE:"CHANGE",PROP_CHANGE:"PROP_CHANGE",PROP_SUB:"PROP_SUB"},t.propUseCount={},t.singles=null,t.plurals={},t.skins={},t.singlesByUIWorldPosition={},t.singlesOpenUIData={},t}o(i,e);var n=i.prototype;return n.onCreate=function(){this.singles=this.create(this.storage,"prop")},n.onLogic=function(){for(var e,i=this,n=u(t._config_.arr.prop);!(e=n()).done;){var o=e.value;this.singles.get(o.id).autoResumeByOffline()}for(var r,a=u(t._config_.arr.prop);!(r=a()).done;){var s=r.value;this.singles.get(s.id).openAutoResume()}t._main.on(t._main.EventType.NEW_DAY,(function(){i.storage.delete("PropModel.toDayVideoMaxCount"),t.Maps.forEach(t._config_.obj.prop,(function(t){if(1==t.is_refull){var e=i.singles.get(t.id);-1!=t.max_count&&e.cur<t.max_count&&e.add(t.max_count-e.cur,!0)}})),i.storage.delete("propShareToDay")}),this)},n.flyTipByProp=function(e,i,n){var o=this;t._ui.flyTip(i,t._prop.singlesByUIWorldPosition[e.id],e.icon_url,n,(function(){o.emit(o.EventType.FLY_TIP_COMPLETE,e.id)}))},n.create=function(e,i,n){var o=this,r=t._config_.obj[i],a=new t.PropsHelper(e,i,(function(t){}),r,(function(t){return r[t].default_count||0}),(function(t){return r[t].max_count}),(function(t){return!0}),(function(t){return r[t].auto_resume&&-1!=r[t].auto_resume[0]}),(function(t){return r[t].auto_resume&&60*r[t].auto_resume[0]}),(function(t){return r[t].auto_resume&&r[t].auto_resume[1]}),(function(t){return r[t].auto_resume&&0!=r[t].auto_resume[2]}),(function(e,i,n,a){n||1==r[e].is_fly&&o.flyTipByProp(r[e],t.winCenterPostion())}),(function(t,e){return o.emit(o.EventType.CHANGE,i,t,e)}));return this.plurals[i]=a,a},n.setSinglesOpenUI=function(t,e){return this.singlesOpenUIData[t]=e,this},n.openGetUI=function(e){var i=e.id;if(this.singlesOpenUIData[i])this.singlesOpenUIData[i]();else t._config_.obj.prop[i]},n.createSkin=function(e,i,n,o){var r=new t.SkinHelper(e,i,n);return o&&r.on(t.SkinHelper.EventType.UNLOCK,(function(t){})),r.on(t.SkinHelper.EventType.CHANGE,(function(){})),this.skins[i]=r,r},n.addPropBuyShare=function(t){var e=this.storage.get("propShareToDay",{});e[t]="true",this.storage.set("propShareToDay",e)},n.hasOpenUI=function(t){var e=t.id;return!!this.singlesOpenUIData[e]},n.addProp=function(e){this.addPropBuyShare(e);var i=t._config_.obj.prop[e];t._prop.singles.get(e).add(i.video_add_count),1===i.is_video_add_use?this.useProp(e):this.emit(this.EventType.PROP_CHANGE)},n.hasUseProp=function(t){return"false"!=this.storage.get("useProp"+t,"false")},n.resetProp=function(){for(var e,i=u(t._config_.arr.prop);!(e=i()).done;){var n=e.value;this.propUseCount[n.id]=0}},n.hasToDayMax=function(e){return this.propUseCount[e]>=t._config_.obj.prop[e].today_max},n.useProp=function(e){t._prop.singles.get(e).sub(1),this.storage.set("useProp"+e,"true"),this.propUseCount[e]++,this.emit(this.EventType.PROP_CHANGE),this.emit(this.EventType.PROP_SUB,e)},i}(t.BaseModuleEvent);e=p([t.moduleMgr.add(t.EModuleType.prop)],e),t.PropModule=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).EventType={CHANGE_PRIOVINCE:"CHANGE_PRIOVINCE",UPDATE_PROVINCE:"UPDATE_PROVINCE"},i.provinceConfigs=[],i.provinceAllData=[],i.randomSeed=new t.RandomSeed,i}o(i,e);var n=i.prototype;return n.onCreate=function(){this.curFakeData||this.updateFakeData();for(var e=this.curFakeData,i=0;i<t._config_.arr.province_item.length;i++){var n=t._config_.arr.province_item[i],o=e[i]||0;this.provinceAllData[i]={index:i,count:o},0!=i&&this.provinceConfigs.push(n)}t.Sets.sortMax(this.provinceAllData,(function(t){return 100*t.count-(0==t.index?50:t.index)}));var r=this.storage.get("rank.provinceAllData","");r&&this.parseProvinceAll(r),t._ui.on(t._ui.EventType.OPEN_BEFORE,(function(e){"rank/prefab/RankUI"==e||t.initData.uiUrl.index}))},n.onLogic=function(){var e=this;t._main.on(t._main.EventType.NEW_DAY,(function(){e.updateFakeData()}))},n.getProvineData=function(){for(var e,i=[],n=-1,o=-1,r=u(t._rank.provinceAllData);!(e=r()).done;){var a=e.value;o++,t._rank.curProvinceIndex==a.index&&(n=o),a.count>0&&i.push(a)}return{datas:i,selfRank:n}},n.updateFakeData=function(){for(var e=t.Times.day(),i={},n=0;n<t._config_.arr.province_item.length;n++){var o=t._config_.arr.province_item[n];this.randomSeed.init(e+o.id),i[n]=t.Maths.minToMax(o.fakemin||0,o.fakemax||0,!0,this.randomSeed.run())}this.storage.set("curFakeData",i)},n.parseProvinceAll=function(e){for(var i=this,n=JSON.parse(e),o=this.curFakeData,r=function(e){var r=n[e]||0,a=o[e]||0;t.Sets.filterValue(i.provinceAllData,(function(t){return t.index==e})).count=r+a},a=0;a<t._config_.arr.province_item.length;a++)r(a);t.Sets.sortMax(this.provinceAllData,(function(t){return 100*t.count-(0==t.index?50:t.index)}))},n.changePriovinceIndex=function(e){t._login.storage.set("priovinceIndex",e,!1),this.emit(this.EventType.CHANGE_PRIOVINCE)},l(i,[{key:"curProvinceIndex",get:function(){return this.storage.get("priovinceIndex",0)}},{key:"curFakeData",get:function(){return this.storage.get("curFakeData",null)}}]),i}(t.BaseModuleEvent);e=p([t.moduleMgr.add(t.EModuleType.rank)],e),t.RankModule=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).EventType={BUNDLE_LOAD_COMPLETE:"BUNDLE_LOAD_COMPLETE",RELEASE_ALL:"RELEASE_ALL",SPRITEFRAME_COMPLETE:"SPRITEFRAME_COMPLETE"},i.loadMap=new Map,i.loadDirUrls=[],i.bundles=new t.Maps,i._rootBundle=new t.Sets,i.sfQueue=new t.Queue((function(){i.sfQueue.clear()}),1),i.sfRunCount=1,i._loadPrefab={url:"",type:t.Prefab},i._loadSpriteFrame={url:"",type:t.SpriteFrame},i.defaultSpriteFrameUrl="main/texture/ui/preload/default_sprite_splash",i}o(i,e);var n=i.prototype;return n.onInstance=function(){this.setSfData(-1,100)},n.addRootBundle=function(){var t;(t=this._rootBundle).add.apply(t,arguments)},n.loadPrefab=function(t,e,i,n){void 0===n&&(n=!0),this._loadPrefab.url=t,this.load(this._loadPrefab,e,i,n)},n.loadSpriteFrame=function(t,e,i,n){void 0===n&&(n=!0),this._loadSpriteFrame.url=t,this.load(this._loadSpriteFrame,e,i,n)},n.load=function(e,i,n,o){var r=this;void 0===o&&(o=!0);var a="",s=t.Asset;if("string"==typeof e?a=e:(a=e.url,s=e.type),!a)return n&&n(1),void(i&&i(null));var l=this.get(a);if(l&&s&&l instanceof s)return n&&n(1),void(i&&i(l));var u=null;n&&(u=function(e,i){n(t.Maths.clamp01(e/i))});var h=function(t,e){if(t)return console.warn("error load resouces: "+a+", check url",t),n&&n(1),void(i&&i(null));o&&r.loadMap.set(a,e),n&&n(1),i&&i(e)};if(-1!=a.indexOf("http")){var c=a.lastIndexOf("."),p=a.substring(c);console.log("load network resouces: ",a,p),t.assetManager.loadRemote(a,{ext:".png"},h)}else this.loadBundle(a,(function(e,o){if(s==t.SpriteFrame){var r="/spriteFrame";-1==o.indexOf(r)&&(o+=r)}e?e.load(o,s,u,h):(n&&n(1),i&&i(null))}))},n.loadBundles=function(e,i){for(var n,o=new t.LoadDir(e.length,i),r=u(e);!(n=r()).done;){var a=n.value;this.loadBundle("",o.subCount(),a)}},n.loadBundle=function(e,i,n){var o=this,r="";n||(n=this.getUrlByBoundleName(e),r=this.getUrlByBoundlePath(e));var a=this.getBundle(n);a?i&&i(a.bundle,r):t.assetManager.loadBundle(n,(function(s,l){if(void 0!==(a=o.getBundle(n))){if(null===a){var u=t.assetManager.getBundle(n).deps,h=new t.Queue((function(){o.loadBundle(e,i)}));return t.Sets.forEach(u,(function(t){h.add((function(e){o.loadBundle(t,e)}))}),!0),void h.run()}i&&i(a.bundle,r),o.emit(o.EventType.BUNDLE_LOAD_COMPLETE,n)}else console.warn("load bundle error:"+n+", check bundle",s)}))},n.getBundle=function(e){e=this.getUrlByBoundleName(e);var i=this.bundles.get(e);if(!i){var n,o=t.assetManager.getBundle(e);if(!o)return;for(var r,a=u(o.deps);!(r=a()).done;){var s=r.value;if(!t.assetManager.getBundle(s))return null}i={bundle:o,parent:[],children:[]},this.bundles.set(e,i),(n=i.parent).push.apply(n,o.deps);for(var l,h=u(o.deps);!(l=h()).done;){var c=l.value;this.getBundle(c).children.push(e)}}return i},n.releaseAllBundle=function(){var e=this;if(0!=this.bundles.get("main2").children.length){var i=new t.Sets;this.bundles.forEach((function(t,n){i.add(e.getUrlByBoundleName(n)),i.add.apply(i,t.children)}));for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];for(var a=0,s=o;a<s.length;a++){var l=s[a],h=this.getBundle(l);if(h)for(var c,p=u(h.parent);!(c=p()).done;){var d=c.value;i.delete(d)}i.delete(this.getUrlByBoundleName(l))}this._rootBundle.forEach((function(t){i.delete(e.getUrlByBoundleName(t))})),i.forEach((function(t){e.getBundle(t)})),this.emit(this.EventType.RELEASE_ALL)}},n.get=function(e,i){void 0===i&&(i=null);var n="";if("string"==typeof e?n=e:(n=e.url,i=e.type),!n)return null;var o=this.loadMap.get(n);o&&!t.isValid(o,!0)&&(o=null,this.loadMap.delete(n));var r=!o;if(i&&o&&(o instanceof i||(-1!=n.indexOf("http")?i==t.SpriteFrame&&(o=t.SpriteFrame.createWithImage(o),this.loadMap.set(n,o)):r=!0)),r){var a=this.getBundle(this.getUrlByBoundleName(n));if(a){if(i&&i==t.SpriteFrame){var s=n,l="/spriteFrame";-1==s.indexOf(l)&&(s+=l),o=a.bundle.get(this.getUrlByBoundlePath(s),i)}else o=a.bundle.get(this.getUrlByBoundlePath(n),i);o&&this.loadMap.set(n,o)}}return o},n.release=function(t,e){this.getBundle(this.getUrlByBoundleName(t))},n.getUrlByBoundleName=function(t){var e=t.indexOf("/");return-1!=e&&(t=t.substring(0,e)),"main"==t&&(t="main2"),t},n.getUrlByBoundlePath=function(t){return t.substring(t.indexOf("/")+1)},n.loadDir=function(e,i,n,o){if(void 0===o&&(o=!0),0!=e.length){var r=new t.LoadDir(e.length,(function(){i&&i()}),(function(t){})),a=null;n&&(a=new t.ProgressDir(n));for(var s,l=u(e);!(s=l()).done;){var h=s.value,c=h;"object"==typeof h&&(c=h.url),this.load(h,r.subCount(c),a?a.progress(c):null,o)}}else i&&i()},n.setSfData=function(t,e){this.sfRunCount=e,this.sfQueue.interval=t},n.setSpriteFrame=function(e,i,n,o){var r=this,a=this.get(i,t.SpriteFrame);a||this.loadSpriteFrame(i,(function(o){e.enabledInHierarchy&&o?(e.spriteFrame=a=r.get(i,t.SpriteFrame),n&&n(a)):n&&(t.isValid(e)&&t.isValid(e.node)&&e?n(o):n(null)),r.emit(r.EventType.SPRITEFRAME_COMPLETE,i)})),e.spriteFrame=a,n&&n(a)},n.cancleSpriteFrame=function(t){t&&this.sfQueue.remove2(t)},n.getUuidByUrl=function(e){for(var i in t.assetManager.bundles._map){var n=t.assetManager.bundles.get(i).config.assetInfos.get(e);if(n&&n.path)return i+"/"+n.path}return""},n.getCacheAllUrls=function(){var e=this,i=[];return t.assetManager.assets.forEach((function(t,n){i.push(e.getUuidByUrl(n))})),i},n.getDefaultSpriteFrame=function(){return this.get(this.defaultSpriteFrameUrl,t.SpriteFrame)},n.loadDefaultSpriteFrame=function(t){this.loadSpriteFrame(this.defaultSpriteFrameUrl,t)},i}(t.BaseModuleEvent);e=p([t.moduleMgr.add(t.EModuleType.resouces)],e),t.ResoucesModule=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).EventType={CHANG_SUCCESS:"CHANG_SUCCESS",CHANG_START:"CHANG_START"},t.cur=null,t.lastUrl="",t.curUrl="",t.preLoadUrls={},t.preLoadBundles={},t.preLoads={},t.isChange=!1,t.isProChange=!1,t}o(i,e);var n=i.prototype;return n.onInstance=function(){var e=this;t._ui.on(t._ui.EventType.HAS_CLOSE_SCENE_ALL,(function(){return!e.isProChange})),this.on(this.EventType.CHANG_SUCCESS,(function(){return t._timer.once(t._ui,t._ui.checkSceneOpenUI,.2)}))},n.getEnterCount=function(t){return this.enterCount[t]||0},n.setEnterCount=function(t,e){var i=this.enterCount;null==i[t]&&(i[t]=0),i[t]+=e,this.storage.set("enterCount",i),this.storage.set("enterCountAll",this.enterCountAll+1)},n.setPreLoadUrls=function(t,e){return this.preLoadUrls[t]=e,this},n.setPreLoadBundles=function(t,e){return this.preLoadBundles[t]=e,this},n.setPreLoad=function(e,i){return this.preLoads[e]||(this.preLoads[e]=new t.Queue),this.preLoads[e].add(i),this},n.preLoad=function(e,i,n,o){var r=this;void 0===o&&(o=!0);var a=null;n&&(a=new t.ProgressDir(n));var s=null,l=null,u=new t.LoadDir(2,(function(){i&&i(l,s)})),h=function(){var i=r.preLoadUrls[e];i?t._resouces.loadDir(i(),u.subCount(),a?a.progress("preLoad"):null,!0):u.subCount()(),o?t._resouces.loadBundle(e,(function(e,i){l=e,s=i,t.director.preloadScene(s,a?a.progress("preloadScene"):null,u.subCount())})):u.subCount()()};this.preLoadBundles[e]?t._resouces.loadBundles(this.preLoadBundles[e](),h):h()},n.change=function(e,i,n,o,r){var a=this;void 0===o&&(o=null),void 0===r&&(r=null),this.curUrl=e,this.isProChange=!0;var s=function(){var s=new t.LoadDir(2,(function(){var n;a.isChange=!1,a.isProChange=!1,console.log("change scene complete:"+e),t._ui.closeAll(t.EUILayer.Window).closeAll(t.EUILayer.WindowUp).closeAll(t.EUILayer.Panel).closeAll(t.EUILayer.PanelUp);var s=[e],l=a.preLoadUrls[e];if(l)for(var h,c=u(l());!(h=c()).done;){var p=h.value;s.push("object"==typeof p?p.url:p)}(n=t._resouces).releaseAllBundle.apply(n,s),null!=o&&(o.url?t._ui.Loading.wait(!1,void 0,void 0,o?o.url:void 0):t._ui.Loading.screen(!1)),a.cur.loadUrl=e,a.cur._changeData=r,a.cur._onCreate(),i&&i(),a.emit(a.EventType.CHANG_SUCCESS,e)}));null!=o&&o.duration&&o.duration>0&&(s.count++,t._timer.once(null,s.subCount(),o.duration));var h=null;(l||n)&&(h=function(t){l&&l(t),n&&n(t)});var c=function(){return a.preLoad(e,(function(i,n){a.cur&&(a.lastUrl=a.cur.loadUrl);var r=function(i){a.cur=i.getComponentInChildren("BaseScene"),a.cur?a.cur.openUIUrl?t._ui.load(a.cur.openUIUrl,s.subCount()):s.subCount()():console.error("find BaseScene error: ",e)},l=function(){a.cur&&(a.cur._onDispose(),a.cur=null)};if(a.lastUrl==e)return l(),void r(t.director.getScene());var u=function(){l(),a.isChange=!0,t.director.once(t.Director.EVENT_BEFORE_SCENE_LAUNCH,r),t.director.loadScene(n,s.subCount())};o&&o.duration&&o.duration>0?o.url?t._ui.Loading.getWaitState()==t.ETipWaitState.Complete?u():t._ui.Loading.setWaitShow(u):t._ui.Loading.getScreenState()==t.ETipWhiteState.Show?u():t._ui.Loading.setScreenShow(u):u()}),h)},p=a.preLoads[e];p?(p.complete=c,p.run()):c()};this.emit(this.EventType.CHANG_START,e);var l=null;if(null!=o)if(o.url){var h=0;l=function(t){h=t},t._ui.Loading.wait(!0,!1,(function(){return h}),o.url,o.duration,s)}else t._ui.Loading.screen(!0),s();else s()},n.getCurrent=function(){return this.cur},l(i,[{key:"enterCount",get:function(){return this.storage.get("enterCount",{})}},{key:"enterCountAll",get:function(){return this.storage.get("enterCountAll",0)}}]),i}(t.BaseModuleEvent);e=p([t.moduleMgr.add(t.EModuleType.scene)],e),t.SceneModule=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).handerPool=new t.PoolOnce(100,(function(){return{callBack:null,caller:null,timerCallBack:null,args:null}}),(function(t){t.callBack=null,t.caller=null,t.timerCallBack=null,t.args=null})),i.handerMap=new Map,i._updateInterval={},i._updateAddTime={},i.handerComponent=null,i._dt=0,i.minDt=1/60,i._dirtyMark={},i._fps=60,i}o(i,e);var n=i.prototype;return n.onInstance=function(){var e=t.director.getScene().getComponentInChildren(t.Canvas);this.init(e)},n.init=function(e){this.handerComponent=e.addComponent(t.Component),this.handerComponent.lateUpdate=this.lateUpdate.bind(this)},n.lateUpdate=function(t){for(var e in this._dirtyMark)this._dirtyMark[e]=!0},n.once=function(t,e,i,n,o){void 0===i&&(i=0),void 0===n&&(n=null),void 0===o&&(o=!0),i<0?e.apply(t,n):this.loop(t,e,0,0,i,n,o)},n.callLater=function(t,e,i,n){void 0===i&&(i=null),void 0===n&&(n=!0),this.once(t,e,0,i,n)},n.loop=function(e,i,n,o,r,a,s){if(void 0===o&&(o=-1),void 0===r&&(r=0),void 0===a&&(a=null),void 0===s&&(s=!0),!t.EDITOR){-1==o&&(o=t.macro.REPEAT_FOREVER);var l=this.handerMap.get(e);l||(l=[],this.handerMap.set(e,l)),this.has(e,i)&&s&&this.clear(e,i);var u=this.handerPool.get();u.caller=e,u.callBack=i,u.args=a,u.timerCallBack=this.onCallBack.bind(this,u),l.push(u),this.handerComponent.schedule(u.timerCallBack,n,o,r),r<0&&u.timerCallBack()}},n.pauseAll=function(){this.scheduler.pauseTarget(this.handerComponent)},n.resumeAll=function(){this.scheduler.resumeTarget(this.handerComponent)},n.isPauseAll=function(){return this.scheduler.isTargetPaused(this.handerComponent)},n.clear=function(e,i){if(!t.EDITOR){var n=this.get(e,i);n&&(t.Sets.delete(this.handerMap.get(e),n),this.handerComponent.unschedule(n.timerCallBack),this.handerPool.put(n))}},n.clearAll=function(e){var i=this,n=this.handerMap.get(e);n&&t.Sets.forEach(n,(function(t){i.clear(t.caller,t.callBack)}),!0)},n.has=function(t,e){return!!this.get(t,e)},n.get=function(e,i){var n=this.handerMap.get(e);return n?t.Sets.filterValue(n,(function(t){return t.caller==e&&t.callBack==i})):null},n.onCallBack=function(t){t.callBack.apply(t.caller,t.args)},n.hasLowFps=function(){return this._fps<=31},n.setTimeScale=function(t){},n.dirtyMark=function(t){var e=this._dirtyMark[t];return this._dirtyMark[t]=!1,void 0===e||!0===e},n.deleteDirtyMark=function(t){delete this._dirtyMark[t]},n.clearUpdateInterval=function(t){this._updateInterval[t]=null},n.hasUpdateIntervale=function(t,e,i){return null==this._updateInterval[t]&&(this._updateInterval[t]=0),0==this._updateInterval[t]?(this._updateInterval[t]+=this.dt,i):(this._updateInterval[t]+=this.dt,this._updateInterval[t]>=e&&(this._updateInterval[t]=this._updateInterval[t]-e,!0))},n.updateAddTime=function(t){return null==this._updateAddTime[t]&&(this._updateAddTime[t]=0),this._updateAddTime[t]+=this.dt,this._updateAddTime[t]},n.clearUpdateAddTime=function(t){this._updateAddTime[t]=null},l(i,[{key:"scheduler",get:function(){return t.director.getScheduler()}},{key:"dt",get:function(){return this._dt=this.dtDefault,this._dt*=this.timeScale,this._dt}},{key:"dtSecond",get:function(){return this.dt*this._fps}},{key:"dtDefault",get:function(){return t.game.deltaTime}},{key:"fps",get:function(){return this._fps},set:function(e){this._fps!=e&&(this._fps=e,t.game.setFrameRate(this._fps))}},{key:"timeScale",get:function(){return 1}}]),i}(t.BaseModule);e=p([t.moduleMgr.add(t.EModuleType.timer)],e),t.TimerModule=e}(apeng||(apeng={})),function(t){var e=new t.Vec3,i=(new t.Vector2,new t.Vec3),n=function(){function e(){this._waitComponent=null,this._waitVisible=!1}var i=e.prototype;return i.screen=function(e,i){this.screenComponent.Sprite.color=i||t.Color.WHITE,this.screenComponent.init(e)},i.getScreenState=function(){return this.screenComponent?this.screenComponent.state:t.ETipWhiteState.Hide},i.setScreenShow=function(t){this.screenComponent&&(this.screenComponent.showCb=t)},i.wait=function(e,i,n,o,r,a){var s=this;if(void 0===i&&(i=!1),void 0===n&&(n=null),void 0===o&&(o=""),o||(o=t._ui.DefaultUrl.wait),this._waitVisible=e,this._waitComponent||(this._waitComponent={}),this._waitVisible){if(!this._waitComponent[o]){if(!t._resouces.get(o,t.Prefab))return t._ui.blockTouchEvent(!0,t.EUILayer.TopUp),console.log("resouces none, reload: ",o),void t._resouces.loadPrefab(o,(function(){t._ui.blockTouchEvent(!1,t.EUILayer.TopUp),s.wait(s._waitVisible,i,n,o,r,a)}));this._waitComponent[o]=t._ui.pool.get(o).getComponent("LoadingWait"),this._waitComponent[o].node.active=!1,t._ui.getLayerParent(t.EUILayer.ItemUp,t._ui.stageUp).addChild(this._waitComponent[o].node)}this._waitComponent[o].init(this._waitVisible,i,n,r),a&&a()}else for(var l in this._waitComponent)this._waitComponent[l].init(!1)},i.getWaitState=function(){if(!this._waitComponent)return t.ETipWaitState.Hide;for(var e in this._waitComponent)if(this._waitComponent[e].node.active)return this._waitComponent[e].state;return t.ETipWaitState.Hide},i.setWaitShow=function(t){if(this._waitComponent)for(var e in this._waitComponent)this._waitComponent[e].node.active&&(this._waitComponent[e].completeCb=t)},l(e,[{key:"screenComponent",get:function(){return t.NodeHelper.getChildByCreate(t._ui.getLayerParent(t.EUILayer.Item,t._ui.stageUp),"LoadingScreen",(function(e){e.addComponent(t.Sprite).spriteFrame=t._resouces.getDefaultSpriteFrame(),e.addComponent("LoadingScreen"),t.NodeHelper.setSize(e,t.winSize()),e.addComponent(t.BlockInputEvents),e.active=!1})).getComponent("LoadingScreen")}}]),e}(),r=function(r){function a(){var e;return(e=r.apply(this,arguments)||this).EventType={LOAD_COMPLETE:"LOAD_COMPLETE",OPEN_BEFORE:"OPEN_BEFORE",OPEN:"OPEN",CLOSE:"CLOSE",DISPOSE:"DISPOSE",CLOSE_SCENE_ALL:"CLOSE_SCENE_ALL",CLOSE_SCENE_ALL_DELAY:"CLOSE_SCENE_ALL_DELAY",HAS_CLOSE_SCENE_ALL:"HAS_CLOSE_SCENE_ALL"},e.DefaultUrl={tip:"main/prefab/systemUI/Tip",tipSystemFont:"main/prefab/systemUI/Tip",tipClick:"main/prefab/systemUI/TipClick",tipClickSystemFont:"main/prefab/systemUI/TipTitleClick",tipTitleClick:"main/prefab/systemUI/TipTitleClick",tipTitleClickSystemFont:"main/prefab/systemUI/TipTitleClick",wait:"main/prefab/systemUI/LoadingWait",moveUp:"main/prefab/systemUI/MoveUpItem",flyItem:"main/prefab/systemUI/FlyEffectItem",fly:"main/prefab/systemUI/FlyEffect"},e.delayProAudio=.6,e.Loading=new n,e.pool=new t.Pool(1e3,(function(e){return t.instantiate(t._resouces.get(e))}),(function(e){t.TweenHelper.stop(e),e.removeFromParent()}),(function(t){return t.destroy()})),e.modules=new t.Maps,e.UICamera=null,e.ScreenshotCamera=null,e.stage=null,e.stageUp=null,e.waits=[],e.openTotal=0,e.preLoadUrls={},e.preLoads={},e}o(a,r);var s=a.prototype;return s.onBeforeInstance=function(){var e=t.director.getScene().getComponentInChildren(t.Canvas);this.setStage(e.node)},s.screenShot=function(e){var i=this,n=t.winSize().width,o=t.winSize().height;this.ScreenshotCamera.node.active=!0,t._timer.once(this,(function(){var r=i.ScreenshotCamera.targetTexture.readPixels(0,0,n,o);i.ScreenshotCamera.node.active=!1,t._platform.instance.saveImg(n,o,r,(function(n){e&&t._timer.once(i,(function(){e(n)}))}),!0)}),5/60)},s.blockTouchEvent=function(e,i,n){void 0===i&&(i=t.EUILayer.Top),t.NodeHelper.getChildByCreate(this.getLayerParent(i,n),"blockTouchEvent",(function(e){e.addComponent(t.BlockInputEvents),t.NodeHelper.setSize(e,t.winSize())})).active=e},s.blockTouchEventVisible=function(e,i){return void 0===e&&(e=t.EUILayer.Top),t.NodeHelper.getChildByCreate(this.getLayerParent(e,i),"blockTouchEvent",(function(e){e.addComponent(t.BlockInputEvents),t.NodeHelper.setSize(e,t.winSize()),e.active=!1})).active},s.getModule=function(e){var i=this.modules.get(e);return i||(i={ui:null,state:t.EUIState.None,openCount:0,openTime:-1,closeCb:null,url:e,loaded:!1,disposeByRelease:!0,openTotal:0},this.modules.set(e,i)),i},s.tip=function(e,i,n,o){var r=this;if(void 0===i&&(i=!1),void 0===o&&(o=!1),i){var a=o?this.DefaultUrl.tipClickSystemFont:this.DefaultUrl.tipClick;t._resouces.loadPrefab(a,(function(){var i=r.pool.get(a).getComponent("TipClick");r.getLayerParent(t.EUILayer.Item,r.stageUp).addChild(i.node),i.init(e,n)}))}else{var s=o?this.DefaultUrl.tipSystemFont:this.DefaultUrl.tip;t._resouces.loadPrefab(s,(function(){var i=r.pool.get(s).getComponent("Tip");r.getLayerParent(t.EUILayer.Item,r.stageUp).addChild(i.node),i.init(e,n)}))}},s.flyTip=function(e,i,n,o,r){var a=this,s=this.DefaultUrl.fly,l=this.DefaultUrl.flyItem;if(e=t.Vector2.pool.get().set(e),t._resouces.get(l,t.Prefab)){var u=t._ui.pool.get(s).getComponent("FlyEffect");t._ui.getLayerParent(t.EUILayer.Item).addChild(u.node),u.init(e,i,n,l,o,r),t.Vector2.pool.put(e)}else t._resouces.loadDir([{url:s,type:t.Prefab},{url:l,type:t.Prefab}],(function(){a.flyTip(e,i,n,o,r)}))},s.moveUp=function(e,i,n,o,r){var a=this;void 0===r&&(r=1),t._resouces.loadPrefab(this.DefaultUrl.moveUp,(function(){var s=a.pool.get(a.DefaultUrl.moveUp).getComponent("MoveUpItem");a.getLayerParent(t.EUILayer.Item,a.stageUp).addChild(s.node),s.setScaleNum(r,!1),s.init(e,i,n,(function(){a.pool.put(s.node),o&&o()}))}))},s.tipTitle=function(e,i,n,o,r,a,s){var l=this;void 0===o&&(o=!0),void 0===r&&(r=!1),void 0===a&&(a=""),void 0===s&&(s=!1);var u=s?this.DefaultUrl.tipTitleClickSystemFont:this.DefaultUrl.tipTitleClick;t._resouces.loadPrefab(u,(function(){var s=l.pool.get(u).getComponent("TipTitleClick");l.getLayerParent(t.EUILayer.Item,l.stageUp).addChild(s.node),s.init(e,i,n,o,r,a)}))},s.clearTip=function(){var e=this,i=this.getLayerParent(t.EUILayer.Item,this.stageUp);t.Sets.forEach(i.children,(function(t){var i=t.getComponent("Tip");i||(i=t.getComponent("Tip")),i&&i.isVisible&&e.pool.put(t)}),!0)},s.dialogue=function(e,i,n){var o=this,r="main/prefab/systemUI/Dialogue";t._resouces.loadPrefab(r,(function(){var a=o.pool.get(r).getComponent("Dialogue");o.getLayerParent(t.EUILayer.Item,o.stageUp).addChild(a.node),a.init(e,i,n)}))},s.getZeroWorldPointNode=function(){return t.NodeHelper.getChildByCreate(this.stage.parent,"ZeroWorldPointNode",(function(e){var i=e.getComponent(t.UITransform);i.setContentSize(new t.Size(0,0)),i.setAnchorPoint(0,0)}),void 0,void 0,(function(e){t.NodeHelper.setPosition(e,i,!0)}))},s.showLine=function(e,i,n,o){void 0===n&&(n=t.Color.RED),void 0===o&&(o=10);var r=this._line;r.getComponent(t.Sprite).color=n,r.active=!0;var a=r.getComponent(t.UITransform);a.width=o,a.height=t.Vector2.distance(e,i),t.NodeHelper.setPositionXY(r,e,!0);var s=t.Vector2.angle360(e,i,-90);return t.NodeHelper.setRotateZ(r,s,!1),r},s.hideLine=function(){this._line.active=!1},s.createSpriteSplashItem=function(e,i,n){void 0===i&&(i=new t.Color(255,255,255,255)),void 0===n&&(n=new t.Size(10,10));var o=new t.Node("SpriteSplashItem");o.layer=e.layer;var r=o.addComponent(t.UITransform),a=o.addComponent(t.Sprite);return a.color=i,a.spriteFrame=t._resouces.getDefaultSpriteFrame(),r.setContentSize(n),r.setAnchorPoint(.5,.5),e.addChild(o),o},s.createByRectangle=function(e){this.createSpriteSplashItem(this.stageUp,new t.Color(255,255,255,100),new t.Size(e.width,e.height)).setWorldPosition(new t.Vec3(e.center.x,e.center.y))},s.preOpen=function(e,i){var n=this;this.open(e,i,(function(){t._timer.once(n,(function(){return n.close(e)}),.1)}),null,!1,!1)},s.open=function(e,i,n,o,r,a){var s=this;void 0===r&&(r=!0),void 0===a&&(a=!0);var l=this.getModule(e);if(l){l.closeCb=o;var u=function(){s.preLoads[e]?s.preLoads[e](i,(function(){return s.onOpened(e,i,n,a)})):s.onOpened(e,i,n,a)};if(l.ui&&t.isValid(l.ui,!0)&&t._resouces.get(l.url,t.Prefab))u();else if(l.state!=t.EUIState.Load){l.state=t.EUIState.Load;var h=null;if(r){var c=0;h=function(t){c=t},this.Loading.wait(!0,!1,(function(){return c}))}this.load(e,(function(){if(r&&s.Loading.wait(!1),l.state!=t.EUIState.None){s.emit(s.EventType.LOAD_COMPLETE,e);var i=s.pool.get(e).getComponent("BaseUI");i.url=e,l.ui=i,i.node.active=!1,s.getLayerParent(i.layerType,i.stageUp?s.stageUp:s.stage).addChild(i.node),l.state!=t.EUIState.LoadClose&&(l.state=t.EUIState.Close),u()}else console.log("ui none, destoryed: ",e)}),i,h)}else console.log("ui loading: ",e)}else console.error("module none: ",e)},s.close=function(e){var i=this.getModule(e);if(i)switch(i.state){case t.EUIState.None:console.log("ui close, find none: ",e);break;case t.EUIState.Open:i.state=t.EUIState.Close,this.setActive(e,!1,!0),this.emitOpenByCloseCb(e,i.closeCb),this.emit(this.EventType.CLOSE,e),this.openWaitUI(e),this.checkSceneOpenUI(),this.checkAd();break;case t.EUIState.Load:console.log("ui close, load no complete: ",e),i.state=t.EUIState.LoadClose;break;case t.EUIState.Wait:console.log("ui close, wait remove: ",e),i.state=t.EUIState.Close;break;case t.EUIState.Close:console.log("ui close, state close, no repeat: ",e)}else console.error("module none: ",e)},s.checkAd=function(){t._timer.once(this,this.onDelayCheckAd,.6)},s.playParticle=function(e,i,n){var o=this;void 0===n&&(n=t.EUILayer.Top),t._resouces.loadPrefab(e,(function(){var r=o.pool.get(e).getComponent("ParticleSystem2DCC");t.NodeHelper.setPositionXY(r.node,i,!1),o.getLayerParent(n).addChild(r.node),r.play((function(){o.pool.put(r.node)}))}))},s.onDelayCheckAd=function(){var e=this.getTop((function(e){return e.bottomAdType!=t.EBottomAdType.Jump}));e&&t._platform.bannerOrNativeTemp(this.getModule(e).ui.bottomAdType);var i=this.getTop((function(e){return e.blockOnceAdType!=t.EBlockOnceAdType.Jump}));i&&t._platform.blockOnce(this.getModule(i).ui.blockOnceAdType)},s.getTop=function(e){var i=this,n=[];return this.modules.forEach((function(i,o){i.ui&&(e&&!e(i.ui)||i.state==t.EUIState.Open&&n.push(o))})),t.Sets.sortMax(n,(function(t){var e=i.getModule(t).ui.node;return e.getSiblingIndex()+100*e.parent.getSiblingIndex()+1e3*e.parent.parent.getSiblingIndex()})),n[0]},s.checkSceneOpenUI=function(){this.hasSceneOpenUI()||this.emit(this.EventType.CLOSE_SCENE_ALL),this.hasEventName(this.EventType.CLOSE_SCENE_ALL_DELAY)&&t._timer.callLater(this,this.onDelayHasOpenUIEvent)},s.onDelayHasOpenUIEvent=function(){this.hasSceneOpenUI()||this.emit(this.EventType.CLOSE_SCENE_ALL_DELAY)},s.hasSceneOpenUI=function(){for(var e,i=u(this.emit(this.EventType.HAS_CLOSE_SCENE_ALL));!(e=i()).done;){if(!e.value)return!0}return this.modules.filterValue((function(e){return e.state==t.EUIState.Load||e.state==t.EUIState.Open&&e.ui.layerType!=t.EUILayer.Window&&e.ui.layerType!=t.EUILayer.WindowUp&&e.ui.layerType!=t.EUILayer.WindowUpAfter&&!e.ui.lockUIMgrAll}))},s.cameraConverToUINode=function(t,i){return this.UICamera.convertToUINode(t,i,e),e},s.openWaitUI=function(e){if(!this.hasUp(e)){var i=this.waits.shift();i&&(console.log("ui close, emit wait: ",i.url),i.state=t.EUIState.Open,this.setActive(i.url,!0,!0))}},s.setActive=function(t,e,i){var n=this.getModule(t),o=n.ui.node.active;e?(n.ui.node.setSiblingIndex(n.ui.node.parent.children.length-1),n.ui.node.active=!0,n.loaded||(n.loaded=!0,n.ui._onCreate()),!o&&i&&n.ui._onOpen()):(o&&i&&n.ui.onBeforeClose&&n.ui.onBeforeClose(),n.ui.node.active=!1,o&&i&&n.ui._onClose())},s.closeAll=function(e,i,n){var o=this;return void 0===n&&(n=!0),console.log("close all layer-"+t.EUILayer[e]),this.modules.forEach((function(r,a){if(r.ui&&e==r.ui.layerType&&!(n&&r.ui.lockUIMgrAll||i&&-1!=i.indexOf(a))){switch(r.state){case t.EUIState.Open:r.state=t.EUIState.Close;break;case t.EUIState.Load:return void(r.state=t.EUIState.LoadClose);case t.EUIState.Wait:r.state=t.EUIState.Close;break;case t.EUIState.None:return}o.setActive(a,!1,!0),o.emitOpenByCloseCb(a,r.closeCb)}})),this},s.dispose=function(e){var i=this.getModule(e);i?i.ui&&(this.setActive(e,!1,!0),i.ui._onDispose(),i.ui.node.destroy(),i.ui=null,i.state=t.EUIState.None,i.loaded=!1,i.disposeByRelease&&t._resouces.release(i.url,t.Prefab),this.emitOpenByCloseCb(e,i.closeCb),this.emit(this.EventType.DISPOSE,e),this.openWaitUI(e)):console.error("module none: ",e)},s.disposeAll=function(e){var i=this;return console.log("dispose all layer-"+t.EUILayer[e]),this.modules.forEach((function(n,o){if(n.ui&&e==n.ui.layerType&&!n.ui.lockUIMgrAll){switch(n.state){case t.EUIState.Open:n.state=t.EUIState.Close;break;case t.EUIState.Load:return void(n.state=t.EUIState.LoadClose);case t.EUIState.Wait:n.state=t.EUIState.Close;break;case t.EUIState.None:return}i.dispose(o)}})),this},s.emitOpenByCloseCb=function(t,e){var i=this.getModule(t);i.closeCb=null,e&&e(i.ui._closeData)},s.getLayerParent=function(e,i){return void 0===i&&(i=null),i||(i=this.stage),t.NodeHelper.insertChild(i,e)},s.setStage=function(e){t.director.addPersistRootNode(e),t.NodeHelper.UICamera=this.UICamera=e.getChildByName("UICamera").getComponent(t.Camera),this.ScreenshotCamera=e.getChildByName("ScreenshotCamera").getComponent(t.Camera),this.ScreenshotCamera.node.active=!1;var i=t.winSize(),n=new t.RenderTexture;n.initialize({width:i.width,height:i.height}),this.ScreenshotCamera.targetTexture=n,this.stage=t.NodeHelper.getChildByCreate(e,"stage",(function(e){t.NodeHelper.setSize(e,i)})),this.stageUp=t.NodeHelper.getChildByCreate(e,"stageUp",(function(e){t.NodeHelper.setSize(e,i)}))},s.load=function(e,i,n,o){if(t._resouces.get(e,t.Prefab))return o&&o(1),void(i&&i());var r=this.preLoadUrls[e]?this.preLoadUrls[e](n):[];r.length>1?(r.push({url:e,type:t.Prefab}),t._resouces.loadDir(r,i,o)):t._resouces.loadPrefab(e,i,o)},s.setDisposeByRelease=function(e,i){void 0===i&&(i=!0),this.getModule(e).disposeByRelease=i,t._resouces.addRootBundle(t._resouces.getUrlByBoundleName(e))},s.setPreLoadUrls=function(t,e){return this.preLoadUrls[t]=e,this},s.setPreLoad=function(t,e){return this.preLoads[t]=e,this},s.getOpenCount=function(t){var e=this.getModule(t);return e?e.openCount:0},s.clearOpenDayCount=function(){for(var t,e=u(this.storage.getPrefixKeys("open-day-"));!(t=e()).done;){var i=t.value;this.storage.delete(i)}},s.getToDayOpenCount=function(t){return this.storage.get("open-day-"+t,0)},s.getOpenByDuation=function(e){var i=this.getModule(e);return i?t.Times.second()-i.openTime:0},s.hasUp=function(t){var e=this.getModule(t);return!!e&&(!!e.ui&&this.hasLayerUp(e))},s.hasLayerUp=function(e){return-1!=t.EUILayer[e.ui.layerType].indexOf("Up")},s.onceOpen=function(e,i,n){var o=this;void 0===n&&(n=0);var r=function(r){return r==e&&(t._timer.once(o,(function(){i(o.getModule(e).ui)}),n),!0)};this.getModule(e).ui?r(e):this.once(this.EventType.OPEN,r)},s.onOpened=function(e,i,n,o){var r=this;void 0===o&&(o=!0),this.openTotal++;var a=this.getModule(e);switch(a.openCount++,a.openTime=t.Times.second(),this.storage.set("open-day-"+e,this.getToDayOpenCount(e)+1),a.openTotal=this.openTotal,a.state){case t.EUIState.Wait:console.log("ui open, waiting again open: ",e),a.state=t.EUIState.Close,this.onOpened(e,i,n,o);break;case t.EUIState.Open:console.log("ui open, state open, no repeat: ",e),a.ui._openData=i,a.ui.__openShow=o,a.ui.updateOpenShow(),a.ui.node.setSiblingIndex(a.ui.node.parent.children.length-1),a.ui._onOpen(),n&&n();break;case t.EUIState.Close:this.hasUp(e)||(this.waits.length=0,this.modules.values((function(i){return!(i.state==t.EUIState.Wait||i.state==t.EUIState.Open&&!i.ui.lockUIMgrAll&&a.ui.layerType<i.ui.layerType&&i.url!=e&&!r.hasLayerUp(i))||(console.log("ui open, add wait: ",i.url),i.state=t.EUIState.Wait,r.setActive(i.url,!1,!0),!1)}),this.waits),t.Sets.sortMax(this.waits,(function(t){return t.openTotal}))),console.log("ui open, open success:",e),a.state=t.EUIState.Open,a.ui._openData=i,a.ui.__openShow=o,a.ui.updateOpenShow(),this.emit(this.EventType.OPEN_BEFORE,e),this.setActive(e,!0,!0),n&&n(),this.emit(this.EventType.OPEN,e),this.checkAd();break;case t.EUIState.None:console.log("ui open, none:",e);break;case t.EUIState.Load:console.log("ui open, state loading, please wait load complete call: ",e);break;case t.EUIState.LoadClose:a.state=t.EUIState.Close,console.log("ui open, state loading close:",e)}},l(a,[{key:"_line",get:function(){return t.NodeHelper.getChildByCreate(this.stage.parent,"-line",(function(e){e.getComponent(t.UITransform).setAnchorPoint(.5,1),e.addComponent(t.Sprite).spriteFrame=t._resouces.getDefaultSpriteFrame()}))}}]),a}(t.BaseModuleEvent);r=p([t.moduleMgr.add(t.EModuleType.ui)],r),t.UIModule=r}(apeng||(apeng={})),function(t){t.CGuideDefine={fingerUrl:"guide/prefab/Finger"}}(apeng||(apeng={})),function(t){var e,i,n,o,r,a;(e=t.EBottomAdType||(t.EBottomAdType={}))[e.Jump=0]="Jump",e[e.None=1]="None",e[e.Banner=2]="Banner",e[e.Native=3]="Native",(i=t.EBlockOnceAdType||(t.EBlockOnceAdType={}))[i.Jump=0]="Jump",i[i.None=1]="None",i[i.Show=2]="Show",(n=t.EAdState||(t.EAdState={}))[n.None=0]="None",n[n.Show=1]="Show",n[n.Hide=2]="Hide",(t.TShare||(t.TShare={})).ParamDefault={title:"",imageUrl:"",query:"",desc:" "},(o=t.ERewardVideoState||(t.ERewardVideoState={}))[o.Finish=0]="Finish",o[o.Close=1]="Close",o[o.Error=2]="Error",(r=t.ENativeSend||(t.ENativeSend={})).rewardedVideoShow="rewardedVideoShow",r.interstitialShow="interstitialShow",r.BannerShow="BannerShow",r.BannerHide="BannerHide",r.rewardedVideoShow_taptap="rewardedVideoShow_taptap",r.interstitialShow_taptap="interstitialShow_taptap",r.BannerShow_taptap="BannerShow_taptap",r.BannerHide_taptap="BannerHide_taptap",r.NativeTempShow_taptap="NativeTempShow_taptap",r.NativeTempHide_taptap="NativeTempHide_taptap",r.openVibrator="openVibrator",r.hideVibrator="hideVibrator",r.privacyConfirm="privacyConfirm",r.downloadsaveimg="downloadsaveimg",(a=t.ENativeReceive||(t.ENativeReceive={})).rewardVideoError="rewardVideoError",a.rewardVideoLoaded="rewardVideoLoaded",a.rewardVideoShowed="rewardVideoShowed",a.rewardVideoClose="rewardVideoClose",a.interstitialError="interstitialError",a.interstitialLoaded="interstitialLoaded",a.interstitialShowed="interstitialShowed",a.interstitialClose="interstitialClose",a.bannerError="bannerError",a.bannerLoaded="bannerLoaded",a.bannerShowed="bannerShowed",a.bannerHideed="bannerHideed",a.rewardVideoError_taptap="rewardVideoError_taptap",a.rewardVideoLoaded_taptap="rewardVideoLoaded_taptap",a.rewardVideoShowed_taptap="rewardVideoShowed_taptap",a.rewardVideoClose_taptap="rewardVideoClose_taptap",a.interstitialError_taptap="interstitialError_taptap",a.interstitialLoaded_taptap="interstitialLoaded_taptap",a.interstitialShowed_taptap="interstitialShowed_taptap",a.interstitialClose_taptap="interstitialClose_taptap",a.bannerError_taptap="bannerError_taptap",a.bannerLoaded_taptap="bannerLoaded_taptap",a.bannerShowed_taptap="bannerShowed_taptap",a.bannerHideed_taptap="bannerHideed_taptap",a.NativeTempShowed_taptap="NativeTempShowed_taptap",a.NativeTempHideed_taptap="NativeTempHideed_taptap",a.NativeTempError_taptap="NativeTempError_taptap",a.NativeTempLoaded_taptap="NativeTempLoaded_taptap",a.downLoadSaveImgResult="downLoadSaveImgResult",a.privacyConfirmComplete="privacyConfirmComplete"}(apeng||(apeng={})),function(t){var e,i,n,o;(e=t.ETipWhiteState||(t.ETipWhiteState={}))[e.Hide=0]="Hide",e[e.Show=1]="Show",e[e.Showing=2]="Showing",e[e.Hideing=3]="Hideing",(i=t.ETipWaitState||(t.ETipWaitState={}))[i.Hide=0]="Hide",i[i.Complete=1]="Complete",i[i.Loading=2]="Loading",(n=t.EUIState||(t.EUIState={}))[n.None=0]="None",n[n.Load=1]="Load",n[n.Open=2]="Open",n[n.Close=3]="Close",n[n.Wait=4]="Wait",n[n.LoadClose=5]="LoadClose",function(t){t[t.Window=0]="Window",t[t.WindowUpAfter=1]="WindowUpAfter",t[t.WindowUp=2]="WindowUp",t[t.Panel=3]="Panel",t[t.PanelUp=4]="PanelUp",t[t.Notice=5]="Notice",t[t.NoticeUp=6]="NoticeUp",t[t.Item=7]="Item",t[t.ItemUp=8]="ItemUp",t[t.Guide=9]="Guide",t[t.GuideUp=10]="GuideUp",t[t.Top=11]="Top",t[t.TopUp=12]="TopUp"}(o=t.EUILayer||(t.EUILayer={})),t.ccenum(o)}(apeng||(apeng={})),function(t){t.StorageLogic=new(function(){function e(){}var i=e.prototype;return i.offlineByMinute=function(t){var e=this.offlineBySecond(t);return 0==e?0:Math.floor(e/60)},i.offlineByHour=function(t){var e=this.offlineBySecond(t);return 0==e?0:Math.floor(e/60/60)},i.onlineByDay=function(t){return t<=0?0:Math.ceil(t/60/60/24)},i.offlineBySecond=function(e){return e<=0?0:t.Times.second()-e},i.offlineByDay=function(t){var e=this.offlineByHour(t);return 0==e?0:Math.floor(e/24)},i.dayNewUser=function(e){return t.Times.getToNowDay(0)==t.Times.getToNowDay(e)},i.catMissBackTime=function(e,i,n,o){return i+e-n*o-t.Times.second()},i.getKeyByModuleType=function(t){var e=t.indexOf("-");return Number(t.substring(0,e))},e}())}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).size={width:0,height:0},t.isShow=!1,t.isSimulate=!1,t.ad=null,t.ad2=null,t.errHide=!1,t.curIndex=0,t}o(i,e);var n=i.prototype;return n.onCreate=function(){var e=this;if(this.resetSize(),t._platform.config.banner.idUpdate){var i=t._platform.config.banner.refreshInterval;t._timer.loop(this,(function(){if(!e.errHide&&e.isShow){if(!e.ad)return;console.log("自动刷新banner",e.curIndex);var i=null;0==e.curIndex?(e.curIndex=1,e.ad2&&e.ad2.destroy(),e.ad2=e.create(t._platform.config.banner.idUpdate),i=e.ad2,e.ad):(e.curIndex=0,e.ad.destroy(),e.ad=e.create(t._platform.config.banner.id),i=e.ad,e.ad2),i&&t._timer.once(e,(function(){e.isShow&&i.show().then((function(){e.isShow=!0,console.log("自动刷新banner成功")})).catch((function(t){console.log("自动刷新banner失败",t)}))}),.5)}}),i,-1,i)}},n.resetSize=function(){var e=t._platform.config.banner.sizeRatio;this.size.width=t._platform.systemInfo.screenWidth*e,t._platform.type==t.EPlatformType.qq?this.size.height=.24*this.size.width:this.size.height=.3*this.size.width},n.create=function(e){var i=this;t._platform.isIOS||this.resetSize();var n=null;return n=this.isSimulate?t.WebPlatform.IBannerCreate(e,null):e?t._platform.instance.IBannerCreate(e,{left:(t._platform.systemInfo.screenWidth-this.size.width)/2,top:t._platform.systemInfo.screenHeight-this.size.height,width:this.size.width,height:this.size.height}):t.BasePlatform.IBannerCreate(e,null),t._platform.type==t.EPlatformType.oppo&&(n.isLoading=!0),n.onLoad((function(){n.isLoading=!0,console.warn("banner ad load"),t._platform.type!=t.EPlatformType.oppo&&n.isLoadingByShow&&n.show()})),n.onError((function(e){console.log("banner load error: ","object"==typeof e&&JSON.stringify(e)),i.errHide||e&&e.errCode&&(1004!=e.errCode&&1008!=e.errCode||(i.errHide=!0,t._platform.bannerOrNativeTemp(t._platform._bannerOrNativeTempType)))})),n.onResize((function(e){i.size.width=e.width,i.size.height=e.height,n.style&&n.style.top&&(n.style.top=t._platform.systemInfo.screenHeight-i.size.height)})),console.log("create banner ad complete",e),n},n.hide=function(e){var i=this.getAd();if(i&&t._platform.hasOpenAd()&&t._platform.isNetWork&&this.isShow){this.isShow=!1,i.isLoadingByShow=!1;var n=i.hide();n&&n.then((function(){e&&e()})),console.log("banner ad hide")}},n.show=function(e){var i=this;if(t._platform.hasOpenAd()&&t._platform.isNetWork){var n=this.getAd();this.ad2||n||(n=this.preCreate()),n&&(this.isShow||(this.isShow=!0,n.isLoading?(n.show().then((function(){i.isShow=!0,e&&e()})).catch((function(){i.isShow=!1})),console.log("banner ad show")):(n.isLoadingByShow=!0,console.log("banner ad show loading wait"))))}},n.getAd=function(){return this.ad2?0==this.curIndex?this.ad:this.ad2:this.ad},n.preCreate=function(){return this.ad=this.create(t._platform.config.banner.id),this.ad},l(i,[{key:"worldTopY",get:function(){return this.size.height*(t.winSize().width/t._platform.systemInfo.screenWidth)}}]),i}(t.BaseModule);e=p([t.platformLogicMgr.add(t.EPlatformLogicType.banner)],e),t.BannerPlatformLogic=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).topSpace=10,t.isShow=!1,t.ad=null,t.ad2=null,t.curIndex=0,t}o(i,e);var n=i.prototype;return n.onCreate=function(){var e=this;t._timer.once(this,(function(){if(e.preCreate(),t._platform.config.blockOnce.idUpdate){var i=t._platform.config.blockOnce.refreshInterval;t._timer.loop(e,(function(){if(e.isShow){if(!e.ad)return;console.log("自动刷新积木广告",e.curIndex);var i=null,n=null;0==e.curIndex?(e.curIndex=1,e.ad2&&e.ad2.destroy(),e.ad2=e.create(t._platform.config.blockOnce.idUpdate),i=e.ad2,n=e.ad):(e.curIndex=0,e.ad.destroy(),e.ad=e.create(t._platform.config.blockOnce.id),i=e.ad,n=e.ad2),i&&t._timer.once(e,(function(){e.isShow&&i.show().then((function(){e.isShow=!0,console.log("自动刷新积木广告成功"),n.hide()})).catch((function(t){console.log("自动刷新积木广告失败",t)}))}),.5)}}),i,-1,i)}}),1.5)},n.create=function(e){var i=null;return(i=e?t._platform.instance.IBlockOnceCreate(e):t.BasePlatform.IBlockOnceCreate(e)).onLoad((function(){i.isLoading=!0,console.log("BlockOnce ad load"),i.isLoadingByShow&&i.show()})),i.onError((function(t){console.log("BlockOnce load error: ","object"==typeof t&&JSON.stringify(t))})),console.log("create BlockOnce ad complete",e),i},n.hide=function(e){var i=this.getAd();if(i&&t._platform.hasOpenAd()&&t._platform.isNetWork&&this.isShow){this.isShow=!1,i.isLoadingByShow=!1;var n=i.hide();n&&n.then((function(){e&&e()})),console.log("BlockOnce ad hide")}},n.show=function(e){var i=this;if(t._platform.hasOpenAd()&&t._platform.isNetWork){var n=this.getAd();this.ad2||n||(n=this.preCreate()),n&&(this.isShow||(this.isShow=!0,n.isLoading?(n.show().then((function(){i.isShow=!0,e&&e()})).catch((function(){i.isShow=!1})),console.log("BlockOnce ad show")):(n.isLoadingByShow=!0,console.log("BlockOnce ad show loading wait"))))}},n.getAd=function(){return this.ad2?0==this.curIndex?this.ad:this.ad2:this.ad},n.preCreate=function(){return this.ad||(this.ad=this.create(t._platform.config.blockOnce.id)),this.ad},i}(t.BaseModule);e=p([t.platformLogicMgr.add(t.EPlatformLogicType.blockOnce)],e),t.BlockOncePlatformLogic=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).isSimulate=!1,t.lastShowTime=null,t.callBack=null,t.idByIndex=0,t.ads=[],t}o(i,e);var n=i.prototype;return n.onCreate=function(){},n.create=function(e){var i=this,n=null;return n=this.isSimulate?t.WebPlatform.IInterstitialCreate(e):e?t._platform.instance.IInterstitialCreate(e):t.BasePlatform.IInterstitialCreate(e),console.log("create interstitial: "+e),n.onLoad&&n.onLoad((function(){console.log("interstitial load")})),n.onError&&n.onError((function(t){console.log("banner load error: ","object"==typeof t&&JSON.stringify(t)),i.callBack&&i.callBack(),i.callBack=null})),n.onClose&&n.onClose((function(t){console.log("interstitial close: ",t),i.callBack&&i.callBack(),i.callBack=null})),n},n.getAd=function(e){var i=t._platform.config.interstitial.id,n=this.idByIndex%i.length;e&&this.idByIndex++;var o=this.ads[n];return o||(o=this.create(i[n]),this.ads[n]=o),o},n.pre=function(){this.getAd(!1)},n.show=function(e){var i=this,n=t.Times.second();null==this.lastShowTime&&(this.lastShowTime=t._platform.initTime);var o=n-this.lastShowTime;if(o>=t._platform.config.interstitial.coolingTime){if(this.lastShowTime=n,this.callBack=e,!this.getAd(!1)||!t._platform.hasOpenAd()||!t._platform.isNetWork)return this.callBack&&this.callBack(),void(this.callBack=null);var r=this.getAd(!0);r.load?r.load().then((function(){r.show()})).catch((function(){t._timer.once(null,(function(){i.getAd(!0).show()}),1)})):r.show()}else console.log("interstitial cooling: ",t._platform.config.interstitial.coolingTime-o)},i}(t.BaseModule);e=p([t.platformLogicMgr.add(t.EPlatformLogicType.interstitial)],e),t.InterstitialPlatformLogic=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).ad=null,t.adRoot=null,t.adOffsetY=null,t.adRootOffsetY=-200,t.isSimulate=!1,t.isShow=!1,t.isShowRoot=!1,t}o(i,e);var n=i.prototype;return n.onCreate=function(){var e=this;t._platform.type==t.EPlatformType.oppo&&t._timer.once(this,(function(){e.pre()}),.2)},n.showRoot=function(){var e=this;t._platform.hasOpenAd()&&t._platform.isNetWork&&(this.adRoot||this.preRoot(),this.adRoot&&(this.isShowRoot||(this.isShowRoot=!0,this.adRoot.isLoading?(this.adRoot.show().then((function(){e.isShowRoot=!0})).catch((function(){e.isShowRoot=!1})),console.log("nativeTemp adRoot show")):(this.adRoot.isLoadingByShow=!0,console.log("nativeTemp adRoot show loading wait")))))},n.hideRoot=function(e){if(this.adRoot&&t._platform.hasOpenAd()&&this.isShowRoot){this.isShowRoot=!1,this.adRoot.isLoadingByShow=!1;var i=this.adRoot.hide();i&&i.then((function(){e&&e(),console.log("nativeTemp ad hide")}))}},n.create=function(e,i){t._platform.systemInfo;var n=null;return n=this.isSimulate?t.WebPlatform.INativeTempCreate("",1):e?t._platform.instance.INativeTempCreate(e,t._platform.config.nativeTemp.refreshInterval,i):t.BasePlatform.INativeTempCreate("",1),t._platform.type==t.EPlatformType.oppo&&(n.isLoading=!0),n.onLoad((function(){n.isLoading=!0,console.warn("nativeTemp ad load"),t._platform.type!=t.EPlatformType.oppo&&n.isLoadingByShow&&n.show()})),n.onError((function(t){console.warn("nativeTemp error: ",t)})),console.log("create nativeTemp complete: ",n,e),n},n.hide=function(e){if(this.ad&&t._platform.hasOpenAd()&&this.isShow){this.isShow=!1,this.ad.isLoadingByShow=!1;var i=this.ad.hide();i&&i.then((function(){e&&e(),console.log("nativeTemp ad hide")}))}},n.pre=function(){this.ad=this.create(t._platform.config.nativeTemp.id,this.adOffsetY)},n.preRoot=function(){this.adRoot=this.create(t._platform.config.nativeTemp.idRoot,this.adRootOffsetY)},n.show=function(e){var i=this;t._platform.hasOpenAd()&&t._platform.isNetWork&&(this.ad||this.pre(),this.ad&&(this.isShow||(this.isShow=!0,this.ad.isLoading?(this.ad.show().then((function(){i.isShow=!0,e&&e()})).catch((function(){i.isShow=!1})),console.log("nativeTemp ad show")):(this.ad.isLoadingByShow=!0,console.log("nativeTemp ad show loading wait")))))},i}(t.BaseModule);e=p([t.platformLogicMgr.add(t.EPlatformLogicType.nativeTemp)],e),t.NativeTempPlatformLogic=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).isSimulate=!1,t.viodeTime=-1,t.recordering=!1,t.active=!1,t.stoping=!1,t.videoPath="",t.getvideo=!1,t._isEvent=!1,t.record=null,t}o(i,e);var n=i.prototype;return n.onCreate=function(){this.record=this.isSimulate?t.WebPlatform.IRecordMgr():t._platform.instance.IRecordMgr()},n.stop=function(){console.log("stop",this.active),0!=this.recordering&&(console.log("结束录制"),this.recordering=!1,this.stoping=!0,this.record.stop())},n.getSharePath=function(){return this.videoPath},n.start=function(t){var e=this;void 0===t&&(t=280),this._isEvent||(this._isEvent=!0,this.record.onStart((function(t){console.log("onStart",t),e.videoPath=""})),this.record.onStop((function(t){var i=e;e.videoPath=t.videoPath,console.log(" this.videoPath",e.videoPath),e.getvideo=!1,console.log("onStop",e.viodeTime,t.videoPath),e.viodeTime>0?e.record.clipVideo({path:t.videoPath,timeRange:[3,0],success:function(t){i.videoPath=t.videoPath,console.log("videoPath",i.videoPath),1==i.getvideo&&console.log(t.videoPath)},complete:function(){i.stoping=!1,i.recordering&&(console.log("结束完成，刷新录制"),i.start())}}):e.record.clipVideo({path:t.videoPath,timeRange:[120,0],success:function(t){i.videoPath=t.videoPath,console.log("videoPath",i.videoPath),1==i.getvideo&&console.log(t.videoPath)},complete:function(){i.stoping=!1,i.recordering&&(console.log("结束完成，刷新录制"),i.start())},fail:function(t){console.error("recorder fail",t)}})})),this.record.onError((function(t){console.log("onError",t)}))),this.recordering=!0,this.stoping?console.log("录制开始被打断，正在剪切视频"):(console.log("录制开始"),this.viodeTime=0,this.record.start({duration:t}))},n.pause=function(){this.record.pause()},n.resume=function(){this.record.resume()},i}(t.BaseModule);e=p([t.platformLogicMgr.add(t.EPlatformLogicType.record)],e),t.RecordPlatformLogic=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).isSimulate=!1,t.ad=null,t.adOnce=null,t.callBack=null,t.reportName="",t.showTime=-1,t.pause=!1,t._lastShowByCloseTime=-1,t.reprotAddress="",t}o(i,e);var n=i.prototype;return n.onCreate=function(){var e=this;t._main.on(t._main.EventType.NEW_DAY,(function(){e.storage.delete("idOnceToDay")}))},n.create=function(e){var i=this,n=null;return n=this.isSimulate?t.WebPlatform.IRewardedVideoCreate(e):e?t._platform.instance.IRewardedVideoCreate(e):t.BasePlatform.IRewardedVideoCreate(e),console.log("create rewardedVideo componnt: "+e),n.onLoad((function(t){console.log("rewardedVideo load complete: ",t)})),n.onError((function(t){console.log("rewardedVideo load error: ",t,"object"==typeof t||JSON.stringify(t)),i.error(),i.report(3,"错误码"+(t&&t.errCode||-1))})),n.onClose((function(e){i._lastShowByCloseTime=t.Times.second(),i.callBack&&(t._platform.openWebSimulationUI||!n.isSimulate&&t.Times.second()-i.showTime<2.9&&(e.isEnded=!1),e.isEnded?(i.callBack(t.ERewardVideoState.Finish),i.report(1)):(i.callBack(t.ERewardVideoState.Close),i.report(2))),t._timer.once(i,i.clearShowData,.1)})),n},n.getLastShowByCloseTime=function(){return this._lastShowByCloseTime},n.isLoaded=function(){return!!this.callBack},n.showByFinish=function(e,i,n){this.show(e,(function(e){switch(e){case t.ERewardVideoState.Finish:i&&i();break;case t.ERewardVideoState.Close:t._ui.tip(t._language.get(30002)),n&&n();break;case t.ERewardVideoState.Error:t._ui.tip(t._language.get(30003)),n&&n()}}))},n.report=function(e,i){var n="",o="";if(this.reprotAddress)if(-1!=this.reprotAddress.indexOf(",")){var r=this.reprotAddress.split(",");n=r[0],o=r[1]}else n=this.reprotAddress;i&&(o+="-"+i),t._platform.instance.reportEvent("viode",{scene:n,type:e,value:o})},n.error=function(){this.callBack&&(this.callBack(t.ERewardVideoState.Error),this.clearShowData())},n.getAd=function(){var e=this.ad;return this.adOnce&&"false"==this.storage.get("idOnceToDay","false")&&(this.storage.set("idOnceToDay","true"),e=this.adOnce,console.log("每日第一次使用广告id",t._platform.config.rewardedVideo.idOnce)),e},n.preCreate=function(){if(this.ad)return this.ad;this.ad=this.create(t._platform.config.rewardedVideo.id);var e=t._platform.config.rewardedVideo.idOnce;return e&&(this.adOnce=this.create(e)),this.ad},n.show=function(e,i){var n=this;if(this.reprotAddress=e,this.report(0),t._platform.config.rewardedVideo.isSuccess)i&&i(t.ERewardVideoState.Finish);else if(t._platform.getDayAd("showRewardedVideo").count>=t._platform.config.rewardedVideo.showMaxCount||!t._platform.isNetWork)i&&i(t.ERewardVideoState.Error);else{t._platform.addDayAdCount("showRewardedVideo"),this.showTime=t.Times.second();var o=this.getAd();o||(o=this.preCreate()),this.callBack=i,this.reportName=e,this.pause=!1;var r=function(){n.pause||(t._audio.pauseAll(),t._platform._record_.pause(),n.pause=!0),o.show&&o.show()},a=o.load();a?a.then(r):r()}},n.clearShowData=function(){this.callBack=null,this.reportName="",this.pause&&(this.pause=!1,t._audio.resumeAll(),t._platform._record_.resume())},i}(t.BaseModule);e=p([t.platformLogicMgr.add(t.EPlatformLogicType.rewardedVideo)],e),t.RewardedVideoPlatformLogic=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).isSimulate=!1,t.share=null,t}o(i,e);var n=i.prototype;return n.onCreate=function(){this.share=this.isSimulate?t.WebPlatform.IShare():t._platform.instance.IShare()},n.getData=function(){if(!t._platform.config.share)return t.TShare.ParamDefault;var e=t._platform.config.share.list;return Array.isArray(e)?0==e.length?t.TShare.ParamDefault:t.Sets.random(e):{title:t.Sets.random(e.title),imageUrl:t.Sets.random(e.imgUrl)}},n.onShareAppMessage=function(e){var i="";if(t._platform.config.share){var n=t._platform.config.share.list;if(Array.isArray(n))for(var o,r=u(n);!(o=r()).done;){var a=o.value;if(i=this.getImgUrlByPath(a.imageUrl))break}else for(var s,l=u(n.imgUrl);!(s=l()).done;){var h=s.value;if(i=this.getImgUrlByPath(h))break}}this.share.onShareAppMessage(i,e)},n.getImgUrlByPath=function(t){var e="";if(!t)return e;if(-1==t.indexOf("subpackages"))return e;var i=t.indexOf("/");if(-1!=i){var n=t.indexOf("/",i+1);-1!=n&&(e=t.substring(i+1,n))}return e},n.show=function(t,e){t||(t=this.getData()),this.share.show(t,e)},n.circleFriends=function(t,e,i){t||(t=this.getData()),i&&(t.query="query="+i),this.share.circleFriends?this.share.circleFriends(t,e):e&&e(!1)},i}(t.BaseModule);e=p([t.platformLogicMgr.add(t.EPlatformLogicType.share)],e),t.SharePlatformLogic=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).vibrate=null,t}o(i,e);var n=i.prototype;return n.onCreate=function(){this.vibrate=t._platform.instance.IVibrate()},n.setOpen=function(t){this.storage.set("VibratePlatformLogic.setVibrate",t?"true":"false")},n.short=function(){this.isOpen&&this.vibrate.short()},n.long=function(){this.isOpen&&this.vibrate.long()},l(i,[{key:"isOpen",get:function(){return"true"==this.storage.get("VibratePlatformLogic.setVibrate","true")}}]),i}(t.BaseModule);e=p([t.platformLogicMgr.add(t.EPlatformLogicType.vibrate)],e),t.VibratePlatformLogic=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).root=null,t.shareAppMessageCallBack=null,t}o(i,e),i.IRecordMgr=function(){return{clipVideo:function(t){t&&(t.success&&t.success({videoPath:"test"}),t.complete&&t.complete({videoPath:"test"}))},start:function(t){},resume:function(){},pause:function(){},stop:function(){},onStart:function(t){},onPause:function(t){},onResume:function(t){},onStop:function(t){},onError:function(t){}}},i.IOpenDataContext=function(){return{set:function(t){},startRender:function(t){},updateRender:function(t){}}},i.IInterstitialCreate=function(t){return{onLoad:function(t){},onError:function(t){},onClose:function(t){},load:function(){return new Promise((function(t){return t(null)}))},show:function(){return new Promise((function(t){return t(null)}))},destroy:function(){}}},i.INativeTempCreate=function(t,e,i){return{isShow:function(){return!0},show:function(){return new Promise((function(t){return t(null)}))},hide:function(){return new Promise((function(t){return t(null)}))},onLoad:function(t){},onError:function(t){},onHide:function(t){},onClose:function(t){},destroy:function(){}}},i.IBannerCreate=function(t,e){return{destroy:function(){},show:function(){return new Promise((function(t){return t(null)}))},hide:function(){return new Promise((function(t){return t(null)}))},onLoad:function(t){},onError:function(t){},onHide:function(t){},onResize:function(t){},style:{left:0,top:0,width:0,height:0}}},i.IBlockOnceCreate=function(t){return{destroy:function(){},show:function(){return new Promise((function(t){return t(null)}))},hide:function(){return new Promise((function(t){return t(null)}))},onLoad:function(t){},onError:function(t){},onHide:function(t){},onResize:function(t){},style:{left:0,top:0}}};var n=i.prototype;return n.reportEvent=function(t,e){},i.login=function(e){t._timer.callLater(this,(function(){e&&e("success")}))},i.IRewardedVideoCreate=function(e){var i=new t.EventDispatcher;return{onLoad:function(t){i.on("onLoad",t)},onError:function(t){i.on("onError",t)},onClose:function(t){i.on("onClose",t)},load:function(){return new Promise((function(t){t(null),i.emit("onLoad")}))},show:function(){return new Promise((function(t){t(null),i.emit("onClose",{isEnded:!0})}))}}},i.IShare=function(){return{onShareAppMessage:function(){},show:function(t,e,i){e&&e(!0)},circleFriends:function(t,e,i){e&&e(!0)}}},i.getSystemInfoSync=function(){var e={};return e.brand=t.sys.platform,e.model=t.sys.os,e.screenWidth=t.winSize().width,e.screenHeight=t.winSize().height,e.version=t.sys.osVersion,e.SDKVersion=t.sys.osMainVersion+"",e.pixelRatio=screen.pixelDepth||screen,e},i.getLaunchOptionsSync=function(){return{}},i.IVibrate=function(){return{short:function(){},long:function(){}}},i.getUserInfo=function(e){t._timer.callLater(this,(function(){e({name:"",avatarUrl:"",age:-1,city:""})}))},n.login=function(t){i.login(t)},n.IRewardedVideoCreate=function(t){return i.IRewardedVideoCreate(t)},n.IRecordMgr=function(){return i.IRecordMgr()},n.INativeTempCreate=function(t,e,n){return void 0===n&&(n=0),i.INativeTempCreate(t,e,n)},n.IBannerCreate=function(t,e){return i.IBannerCreate(t,e)},n.IInterstitialCreate=function(t){return i.IInterstitialCreate(t)},n.IShare=function(){return i.IShare()},n.IVibrate=function(){return i.IVibrate()},n.IBlockOnceCreate=function(t){return i.IBlockOnceCreate(t)},n.reStart=function(){t.game.restart()},n.getSystemInfoSync=function(){return i.getSystemInfoSync()},n.getUserInfo=function(t){i.getUserInfo(t)},n.getLaunchOptionsSync=function(){return i.getLaunchOptionsSync()},n.payShow=function(t,e){e("success")},n.saveImg=function(t,e,i,n,o){n&&n("")},n.getSaveImgName=function(){return"app-"+t.Times.toLocaleString(void 0,!0,"-")},n.privacyConfirm=function(t){t()},n.IOpenDataContext=function(){return i.IOpenDataContext()},n.onShow=function(e){t.game.on(t.Game.EVENT_SHOW,e)},n.onHide=function(e){t.game.on(t.Game.EVENT_HIDE,e)},n.killGame=function(){t.game.end()},n.getSystemId=function(t){var e=localStorage.getItem("brower_systemid_test");return e||(e=(Math.random()+Date.now()).toString(32),localStorage.setItem("brower_systemid_test",e)),t&&t(e)},n.getSetting=function(t){t(null)},i}(t.BaseModule);t.BasePlatform=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).root=window.qq,t}o(i,e);var n=i.prototype;return n.IRecordMgr=function(){return t._platform.isIDE?t.BasePlatform.IRecordMgr():this.root.getGameRecorderManager?this.root.getGameRecorderManager():t.BasePlatform.IRecordMgr()},n.IRewardedVideoCreate=function(t){return this.root.createRewardedVideoAd({adUnitId:t})},n.IInterstitialCreate=function(e){return this.root.createInterstitialAd?this.root.createInterstitialAd({adUnitId:e}):t.BasePlatform.IInterstitialCreate(e)},n.IBannerCreate=function(e,i){return this.root.createBannerAd({adUnitId:e,style:i,adIntervals:t._platform.config.banner.refreshInterval})},n.IVibrate=function(){var t=this;return{short:function(){t.root.vibrateShort({type:"heavy"})},long:function(){}}},n.reportEvent=function(t,e){this.root.reportEvent&&this.root.reportEvent(t,e)},n.getLaunchOptionsSync=function(){return this.root.getLaunchOptionsSync()},n.loadShareImg=function(t,e,i){this.isLoadShareCache()?e():(this.storage.get("shareImgLoad","true"),this.root.loadSubpackage({name:t,complete:e}))},n.isLoadShareCache=function(){return"false"!=this.storage.get("shareImgLoad","false")},n.getSystemInfoSync=function(){var t=this.root.getSystemInfoSync(),e={};return e.brand=t.brand,e.model=t.model,e.screenWidth=t.screenWidth,e.screenHeight=t.screenHeight,e.version=t.COREVersion,e.SDKVersion=t.platformVersionCode,e.pixelRatio=t.pixelRatio,e.navbarPosition=t.navbarPosition,e},n.login=function(t){this.root.login({success:function(e){t&&t(e.code)},fail:function(){t&&t("")}})},n.onShow=function(t){this.root.onShow(t)},n.onHide=function(t){this.root.onHide(t)},n.reStart=function(){this.root.restartMiniProgram()},n.killGame=function(){this.root.exitMiniProgram()},i}(t.BasePlatform);t.BaseMingamePlatform=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).root=window.MINIGAMEAD,t.testId=!1,t}o(i,e);var n=i.prototype;return n.IRewardedVideoCreate=function(e){var i=window.REWARD_VIDEO_AD;return i&&i.createRewardedVideoAd?(this.testId&&(e="nIg2BB"),i.createRewardedVideoAd({adUnitId:e})):t.BasePlatform.IRewardedVideoCreate(e)},n.IBlockOnceCreate=function(e){var i=this;if(!this.root||!this.root.renderShopWindow)return t.BasePlatform.IBlockOnceCreate(e);this.testId&&(e="sL9Jkr");var n=new t.EventDispatcher,o=function(){return new Promise((function(t,o){i.root.renderShopWindow({showid:e,adDomId:"frontAdBoxOnce",width:"300",height:"300",onSuccess:t,onFail:function(t){o(t),n.emit("onError",t)}})}))};return t._timer.once(this,o,.2),{onLoad:function(t){n.on("onLoad",t)},onError:function(t){n.on("onError",t)},onHide:function(t){n.on("onHide",t)},onResize:function(t){n.on("onResize",t)},show:o,hide:function(){return null},destroy:function(){}}},n.IInterstitialCreate=function(e){var i=this;if(!this.root||!this.root.renderShopWindow)return t.BasePlatform.IInterstitialCreate(e);this.testId&&(e="sL9Jkr");var n=new t.EventDispatcher;return{onLoad:function(t){n.on("onLoad",t)},onError:function(t){n.on("onError",t)},onClose:function(t){n.on("onClose",t)},load:function(){return new Promise((function(e){t._timer.callLater(i,(function(){e(null),n.emit("onLoad")}))}))},show:function(){return new Promise((function(t,o){i.root.renderShopWindow({showid:e,adDomId:"frontAdBox",width:"380",height:"380",onSuccess:t,onFail:function(t){o(t),n.emit("onError",t)}})}))},destroy:function(){}}},n.IBannerCreate=function(e,i){var n=this;if(!this.root||!this.root.renderInfoFlow)return t.BasePlatform.IBannerCreate(e,i);this.testId&&(e="0GcxwV");var o=new t.EventDispatcher,r=300,a=window.document;a&&a.body&&(a.clientWidth&&(r=a.body.clientWidth),a.clientHeight&&a.body.clientHeight);var s=function(){return new Promise((function(t,i){n.root.renderInfoFlow({showid:e,adDomId:"feedAdBoxBottom",width:r+"",onSuccess:t,onFail:function(t){i(t),o.emit("onError",t)}}),console.log("显示banner广告------------")}))};return t._timer.once(this,s,.2),{destroy:function(){},show:s,hide:function(){return null},onLoad:function(t){o.on("onLoad",t)},onError:function(t){o.on("onError",t)},onHide:function(t){o.on("onHide",t)},onResize:function(t){o.on("onResize",t)}}},i}(t.BaseMingamePlatform);e=p([t.platformMgr.add(t.EPlatformType.a360)],e),t.A360Platform=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){return e.apply(this,arguments)||this}o(i,e),i.IVibrate=function(){return{short:function(){t._platform.sendToNative(t.ENativeSend.openVibrator),t._timer.once(null,(function(){t._platform.sendToNative(t.ENativeSend.hideVibrator)}),.015)},long:function(){t._platform.sendToNative(t.ENativeSend.openVibrator),t._timer.once(null,(function(){t._platform.sendToNative(t.ENativeSend.hideVibrator)}),.03)}}},i.privacyConfirm=function(e){t._platform.once(t.ENativeReceive.privacyConfirmComplete,e),t._platform.sendToNative(t.ENativeSend.privacyConfirm)},i.saveImg=function(e,i,n,o,r){var a=t.native.fileUtils.getWritablePath()+"renderTexture.png";t.native.fileUtils.removeFile(a),t.native.saveImageData(n,e,i,a).then((function(){if(!r)return o(a);t._platform.once(t.ENativeReceive.downLoadSaveImgResult,(function(t){o(a)}),null),t._platform.sendToNative(t.ENativeSend.downloadsaveimg,a)})).catch((function(){return o("")}))},i.IARewardedVideoCreate=function(e,i,n,o,r,a){var s=new t.EventDispatcher;t._platform.on(i,(function(t){s.emit("onError",t)})),t._platform.on(n,(function(t){s.emit("onLoad",t)}));var l=null;return t._platform.on(o,(function(t){l&&(l(null),l=null)}),null),t._platform.on(r,(function(t){s.emit("onClose",{isEnded:"true"==t})})),{onLoad:function(t){s.on("onLoad",t)},onError:function(t){s.on("onError",t)},onClose:function(t){s.on("onClose",t)},load:function(){return new Promise((function(t){t(null)}))},show:function(){return new Promise((function(i){l=i,t._platform.sendToNative(a,e)}))}}},i.IAInterstitialCreate=function(e,i,n,o,r,a){var s=new t.EventDispatcher;t._platform.on(i,(function(t){s.emit("onError",t)})),t._platform.on(n,(function(t){s.emit("onLoad",t)}));var l=null;return t._platform.on(o,(function(t){l&&(l(null),l=null)})),t._platform.on(r,(function(t){s.emit("onClose",t)})),{onLoad:function(t){s.on("onLoad",t)},onError:function(t){s.on("onError",t)},onClose:function(t){s.on("onClose",t)},load:function(){return new Promise((function(t){t(null)}))},show:function(){return new Promise((function(i){l=i,t._platform.sendToNative(a,e)}))},destroy:function(){}}},i.IABannerCreate=function(e,i,n,o,r,a,s){var l=new t.EventDispatcher;t._platform.on(i,(function(t){l.emit("onError",t)})),t._platform.on(n,(function(t){l.emit("onLoad",t)}));var u=null;t._platform.on(o,(function(t){u&&(u(null),u=null)}));var h=null;return t._platform.on(r,(function(t){h&&(h(null),h=null),l.emit("onHide",t)})),{isLoading:!0,onLoad:function(t){l.on("onLoad",t)},onError:function(t){l.on("onError",t)},onHide:function(t){l.on("onHide",t)},onResize:function(t){},hide:function(){return new Promise((function(i){h=i,t._platform.sendToNative(a,e)}))},show:function(){return new Promise((function(i){u=i,t._platform.sendToNative(s,e)}))},destroy:function(){}}};var n=i.prototype;return n.IVibrate=function(){return i.IVibrate()},n.privacyConfirm=function(t){i.privacyConfirm(t)},n.saveImg=function(t,e,n,o,r){i.saveImg(t,e,n,o,r)},n.IRewardedVideoCreate=function(e){return i.IARewardedVideoCreate(e,t.ENativeReceive.rewardVideoError,t.ENativeReceive.rewardVideoLoaded,t.ENativeReceive.rewardVideoShowed,t.ENativeReceive.rewardVideoClose,t.ENativeSend.rewardedVideoShow)},n.IInterstitialCreate=function(e){return i.IAInterstitialCreate(e,t.ENativeReceive.interstitialError,t.ENativeReceive.interstitialLoaded,t.ENativeReceive.interstitialShowed,t.ENativeReceive.interstitialClose,t.ENativeSend.interstitialShow)},n.IBannerCreate=function(e,n){return i.IABannerCreate(e,t.ENativeReceive.bannerError,t.ENativeReceive.bannerLoaded,t.ENativeReceive.bannerShowed,t.ENativeReceive.bannerHideed,t.ENativeSend.BannerHide,t.ENativeSend.BannerShow)},i}(t.BasePlatform);t.BaseAndroidPlatform=e}(apeng||(apeng={})),function(t){var e=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).root=window.wx,e}return o(e,t),e}(t.BaseMingamePlatform);e=p([t.platformMgr.add(t.EPlatformType.ks)],e),t.KsPlatform=e}(apeng||(apeng={})),function(t){var e=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).root=window.wx,e}return o(e,t),e}(t.BaseMingamePlatform);e=p([t.platformMgr.add(t.EPlatformType.overseas_kwai)],e),t.KsWaiPlatform=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).root=window.qg,t}o(i,e);var n=i.prototype;return n.INativeTempCreate=function(e,i,n){if(void 0===n&&(n=0),t._platform.systemInfo.SDKVersion<1094)return t.BasePlatform.INativeTempCreate(e,i);if(!this.root.createCustomAd)return t.BasePlatform.INativeTempCreate(e,i);var o={adUnitId:e};if(null!==n||void 0!==n){var r=t._platform.systemInfo.screenHeight,a=n*(r/t.winSize().height);o.style={top:r/2+a}}return this.root.createCustomAd(o)},n.IBannerCreate=function(t,e){return this.root.createBannerAd({adUnitId:t,style:{}})},n.IShare=function(){var t=this;return{onShareAppMessage:function(){},show:function(e,i,n){t.root.share({success:function(){i&&i(!0)},fail:function(){i&&i(!1)}})}}},i}(t.BaseMingamePlatform);e=p([t.platformMgr.add(t.EPlatformType.oppo)],e),t.OppoPlatform=e}(apeng||(apeng={})),function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e}(t.BaseAndroidPlatform);e=p([t.platformMgr.add(t.EPlatformType.overseas_android_xgame)],e),t.OverseasAndroidXgamePlatform=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).root=window.qq,t}o(i,e);var n=i.prototype;return n.IBlockOnceCreate=function(e){var i=t._platform.systemInfo,n=this.root.createBlockAd({adUnitId:e,style:{left:i.screenWidth-200,top:200},size:1,orientation:"landscape"});return n.onResize((function(e){if(e.width,e.height,n.style&&n.style.top){var o=i;if(o.navbarPosition){var r=o.pixelRatio||1;n.style.top=(o.navbarPosition.marginTop+o.navbarPosition.navbarHeight)/r+t._platform._blockOnce_.topSpace,n.style.left=i.screenWidth-(o.navbarPosition.marginRight+o.navbarPosition.navbarWidth)/r}else n.style.top=80,n.style.left=i.screenWidth-90}})),n},n.IShare=function(){var e=this,i=!1,n=new t.LoadDir(2,null),o=new t.CompleteCallBack,r=!0;return{onShareAppMessage:function(i,n){e.root.onShareAppMessage(n||function(){return t._platform._share_.getData()}),e.root.showShareMenu({showShareItems:["qq","qzone","wechatFriends","wechatMoment"],withShareTicket:!0,success:function(t){console.log("click topRight share: ",t)}}),i&&t._timer.once(e,(function(){e.loadShareImg(i,(function(){}))}),e.isLoadShareCache()?-1:3)},show:function(a,s,l){o.set(s),r=!0,n.count=2,n.onFinish=function(){o.run(r)};e.root.onShow((function t(){e.root.offShow(t),n.subCount()()})),i=!1;e.root.onHide((function t(){i=!0,e.root.offHide(t)}));var u={title:a.title,success:function(){i?(r=!0,t._timer.callLater(e,n.subCount()),console.log("分享成功--")):(r=!0,t._timer.once(e,n.subCount(),.2))},fail:function(){r=!1,console.log("分享失败--"),t._timer.callLater(e,n.subCount())}};a.query&&(u.query="query="+a.query);var h=function(){e.root.shareAppMessage(u)};if(a.imageUrl){u.imageUrl=a.imageUrl;var c=t._platform._share_.getImgUrlByPath(a.imageUrl);c?(u.path=c,e.loadShareImg(c,h)):h()}else h()}}},i}(t.BaseMingamePlatform);e=p([t.platformMgr.add(t.EPlatformType.qq)],e),t.QQPlatform=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).root=window.tt,i._loginSuccess=!1,i.sidebar={isEnable:!1,isReward:!1,EventType:{REWARD_CHANGE:"REWARD_CHANGE"},init:function(e){i.root.checkScene?i.root.checkScene({scene:"sidebar",success:function(e){console.log("check scene success: ",e.isExist),i.sidebar.isEnable=!0;var n=function(e){i.sidebar.isReward=!1,e&&"021036"==e.scene&&i.sidebar.checkReward()&&(i.sidebar.isReward=!0,t._platform.emit(i.sidebar.EventType.REWARD_CHANGE))};i.onShow(n),n(i.getLaunchOptionsSync())},fail:function(t){console.log("check scene fail:",t)},complete:e}):e()},checkReward:function(){var e=t.Times.day(),i=t._platform.storage.get("sidebarReward",-1);return-1==i||i!=e},reward:function(){var e=t.Times.day();t._platform.storage.set("sidebarReward",e),i.sidebar.isReward=!1},to:function(){tt.navigateToScene({scene:"sidebar",success:function(t){console.log("navigate to scene success")},fail:function(t){console.log("navigate to scene fail: ",t)}})}},i}o(i,e);var n=i.prototype;return n.onInstance=function(){var e=this;t.platformMgr.on(t.platformMgr.EventType.START_UP,(function(t){e.sidebar.init(t)}))},n.IShare=function(){var t=this;return{onShareAppMessage:function(){},show:function(e,i,n){t.shareAppMessage(["对子消消消","麻将消消","挪麻将","解压游戏"],i,{title:e.title})}}},n.shareAppMessage=function(e,i,n){void 0===e&&(e=["倒水冲冲冲","水排序","颜色排序","第二关怎么过","倒水排序"]);var o=t._platform._record_,r=n&&n.channel?n.channel:"video";if(1==o.recordering&&"video"==r)return t._ui.tip("分享出错了，再来一局吧！"),void(i&&i(!1));if(console.log("开始分享",o.videoPath),n&&""!=n.videoPath&&null!=n.videoPath&&null!=n.videoPath&&(o.videoPath=n.videoPath),""==o.videoPath)return i&&i(!1),void(o.getvideo=!0);var a={videoPath:o.videoPath,videoTopics:e,withVideoId:!0};console.log("extra",a);var s="";if(n&&n.query)for(var l in n.query)s+="&"+l+"="+n.query[l];console.log("分享参数 query",s),this.root.shareAppMessage({channel:r,extra:a,query:s,success:function(t){console.log("分享视频成功",t),i&&i(!0)},fail:function(e){"shareAppMessage:cancel"==e.errMsg||"shareAppMessage:fail cancel"==e.errMsg||"shareAppMessage:fail internal error Share error"==e.errMsg?(console.log("分享视频失败",e),n&&"invite"==n.channel||t._ui.tip("分享视频失败")):(console.log("分享视频失败",e),t._ui.tip("录屏时间少于 3 秒，无法分享")),i&&i(!1)}})},n.reportEvent=function(t,e){this.root.reportAnalytics&&this.root.reportAnalytics(t,e)},n.login=function(t){var e=this;this.root.login({force:!1,success:function(i){e._loginSuccess=!0,t&&t(i.code)},fail:function(){t&&t("")}})},n.setImRankData=function(t){var e=this;this.root.setImRankData&&this._rankLogin((function(i){i?e.root.setImRankData({dataType:0,value:t.toString(),priority:0,extra:"extra",success:function(t){console.log("setImRankData success res: "+JSON.stringify(t))},fail:function(t){console.log("setImRankData fail res: "+t.errMsg)}}):console.log("setImRankData fail ")}))},n._rankLogin=function(t){this._loginSuccess?t("true"):this.login(t)},n.getImRankList=function(e){var i=this;void 0===e&&(e="次"),this.root.getImRankList?this._rankLogin((function(n){n?i.root.getImRankList({relationType:"default",dataType:0,rankType:"day",suffix:e,rankTitle:"每日排行榜",success:function(t){console.log("getImRankData success res: "+t)},fail:function(t){console.log("getImRankData fail res: "+t.errMsg)}}):(t._ui.tip("登陆成功后才可以查看排行"),console.log("setImRankData fail "))})):(t._ui.tip("当前版本不支持"),console.log("当前版本不支持"))},i}(t.BaseMingamePlatform);e=p([t.platformMgr.add(t.EPlatformType.tt)],e),t.TTPlatform=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){return e.apply(this,arguments)||this}o(i,e);var n=i.prototype;return n.IRewardedVideoCreate=function(e){return t.BaseAndroidPlatform.IARewardedVideoCreate(e,t.ENativeReceive.rewardVideoError_taptap,t.ENativeReceive.rewardVideoLoaded_taptap,t.ENativeReceive.rewardVideoShowed_taptap,t.ENativeReceive.rewardVideoClose_taptap,t.ENativeSend.rewardedVideoShow_taptap)},n.IInterstitialCreate=function(e){return t.BaseAndroidPlatform.IAInterstitialCreate(e,t.ENativeReceive.interstitialError_taptap,t.ENativeReceive.interstitialLoaded_taptap,t.ENativeReceive.interstitialShowed_taptap,t.ENativeReceive.interstitialClose_taptap,t.ENativeSend.interstitialShow_taptap)},n.IBannerCreate=function(e,i){return t.BaseAndroidPlatform.IABannerCreate(e,t.ENativeReceive.bannerError_taptap,t.ENativeReceive.bannerLoaded_taptap,t.ENativeReceive.bannerShowed_taptap,t.ENativeReceive.bannerHideed_taptap,t.ENativeSend.BannerHide_taptap,t.ENativeSend.BannerShow_taptap)},n.INativeTempCreate=function(e,i,n){var o=new t.EventDispatcher;t._platform.on(t.ENativeReceive.NativeTempError_taptap,(function(t){o.emit("onError",t)})),t._platform.on(t.ENativeReceive.NativeTempLoaded_taptap,(function(t){o.emit("onLoad",t)}));var r=null;t._platform.on(t.ENativeReceive.NativeTempShowed_taptap,(function(t){r&&(r(null),r=null),o.emit("onShow",t)}));var a=null;return t._platform.on(t.ENativeReceive.NativeTempHideed_taptap,(function(t){a&&(a(null),a=null),o.emit("onHide",t)})),{isShow:function(){return!0},show:function(){return new Promise((function(i){r=i,t._platform.sendToNative(t.ENativeSend.NativeTempShow_taptap,e)}))},hide:function(){return new Promise((function(i){a=i,t._platform.sendToNative(t.ENativeSend.NativeTempHide_taptap,e)}))},onLoad:function(t){o.on("onLoad",t)},onError:function(t){o.on("onError",t)},onHide:function(t){o.on("onHide",t)},onClose:function(t){o.on("onClose",t)},destroy:function(){}}},i}(t.BaseAndroidPlatform);e=p([t.platformMgr.add(t.EPlatformType.taptap)],e),t.TaptapPlatform=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).root=window.qg,t}o(i,e);var n=i.prototype;return n.INativeTempCreate=function(e,i,n){if(void 0===n&&(n=0),t._platform.systemInfo.SDKVersion<=1095)return t.BasePlatform.INativeTempCreate(e,i);if(!this.root.createCustomAd)return t.BasePlatform.INativeTempCreate(e,i);var o={adUnitId:e};if(null!==n||void 0!==n){var r=t._platform.systemInfo.screenHeight,a=n*(r/t.winSize().height);o.style={top:r/2+a}}return this.root.createCustomAd(o)},n.IBannerCreate=function(t,e){return this.root.createBannerAd({posId:t,style:{}})},n.IShare=function(){var t=this;return{onShareAppMessage:function(){},show:function(e,i,n){t.root.share({success:function(){i&&i(!0)},fail:function(){i&&i(!1)}})}}},i}(t.BaseMingamePlatform);e=p([t.platformMgr.add(t.EPlatformType.vivo)],e),t.VivoPlatform=e}(apeng||(apeng={})),function(t){var e,i="platform/prefab/",n=e=function(n){function a(){return n.apply(this,arguments)||this}o(a,n),a.setSize=function(e,i,n){var o=t.NodeHelper.getUITransform(e);null==i||null==n?i&&"object"==typeof i?o.setContentSize(i):(null!=i&&(o.width=i),null!=n&&(o.height=n)):o.setContentSize(i,n)},a.getChildrenByComponent=function(t,e){for(var i,n=u(t.children);!(i=n()).done;){var o=i.value.getComponent(e);if(o)return o}return null},a.getNodeParent=function(){return t._ui.getLayerParent(t.EUILayer.Top,t._ui.stageUp)},a.getPrefabByNode=function(e){return t.instantiate(t._resouces.get(e,t.Prefab))},a.IRewardedVideoCreate=function(e){var n=this;if(!t._platform.openWebSimulationUI)return t.BasePlatform.IRewardedVideoCreate(e);var o=new t.EventDispatcher,r=null;return{isSimulate:!0,onLoad:function(t){o.on("onLoad",t,null)},onError:function(t){o.on("onError",t,null)},onClose:function(t){o.on("onClose",t,null)},load:function(){return new Promise((function(e){t._resouces.load(i+"RewardedVideoTemp",(function(){r||((r=n.getPrefabByNode(i+"RewardedVideoTemp").getComponent("RewardedVideoTemp")).node.active=!1,n.getNodeParent().addChild(r.node),r.onCloseCallBack=function(e){r.node.active=!1,o.emit("onClose",{isEnded:e}),t.game.emit(t.Game.EVENT_SHOW)}),t._timer.once(n,(function(){o.emit("onLoad"),e(null)}),.2)}))}))},show:function(){return new Promise((function(e){r.node.active=!0,t._timer.once(n,(function(){t.game.emit(t.Game.EVENT_HIDE),e(null)}),.2)}))}}},a.IRecordMgr=function(){return t._platform.openWebSimulationUI,t.BasePlatform.IRecordMgr()},a.IInterstitialCreate=function(e){var n=this;if(!t._platform.openWebSimulationUI)return t.BasePlatform.IInterstitialCreate(e);var o=new t.EventDispatcher,r=null;return{onLoad:function(t){o.on("onLoad",t,null)},onError:function(t){o.on("onError",t,null)},onClose:function(t){o.on("onClose",t,null)},load:function(){return new Promise((function(e){t._resouces.load(i+"InterstitialTemp",(function(){r||((r=n.getPrefabByNode(i+"InterstitialTemp")).active=!1,n.getNodeParent().addChild(r),n.setSize(r,t.winSize()),n.getChildrenByComponent(r,"ButtonCC").eventHandler.addEvent({callBack:function(){r.active=!1,o.emit("onClose")}})),t._timer.once(n,(function(){o.emit("onLoad"),e(null)}),.2)}))}))},show:function(){return new Promise((function(t){r.active=!0,t(null)}))},destroy:function(){}}},a.INativeTempCreate=function(e,n){var o=this;if(!t._platform.openWebSimulationUI)return t.BasePlatform.INativeTempCreate(e,n);var r=t.winSize(),a=new t.EventDispatcher,s=null;return{isShow:function(){return s&&s.active},hide:function(){return new Promise((function(e){t._timer.once(o,(function(){s&&(s.active=!1),a.emit("onHide"),e(null)}),.2)}))},show:function(){return new Promise((function(e){t._resouces.load(i+"CustomAdTemp",(function(){if(!s){(s=o.getPrefabByNode(i+"CustomAdTemp")).active=!1,o.getNodeParent().addChild(s);var n=r.width*t._platform.config.banner.sizeRatio;o.setSize(s,n,.3*n);var l=t.NodeHelper.getUITransform(s).height/2,u=s.worldPosition;s.setWorldPosition({x:u.x,y:l,z:u.z}),t._timer.once(o,(function(){a.emit("onLoad")}),.2)}t._timer.once(o,(function(){s.active=!0,e(null)}),.2)}))}))},onLoad:function(t){a.on("onLoad",t,null)},onError:function(t){a.on("onError",t,null)},onHide:function(t){a.on("onHide",t,null)},onClose:function(t){a.on("onClose",t,null)},destroy:function(){}}},a.IBannerCreate=function(e,n){var o=this;if(!t._platform.openWebSimulationUI)return t.BasePlatform.IBannerCreate(e,n);var r=t.winSize(),a=new t.EventDispatcher,s=null;return{destroy:function(){},show:function(){return new Promise((function(e){t._resouces.load(i+"BannerTemp",(function(){if(!s){(s=o.getPrefabByNode(i+"BannerTemp")).active=!1,o.getNodeParent().addChild(s);var n=r.width*t._platform.config.banner.sizeRatio;o.setSize(s,n,.4*n);var l=t.NodeHelper.getUITransform(s).height/2,u=s.worldPosition;s.setWorldPosition({x:u.x,y:l,z:u.z}),t._timer.once(o,(function(){a.emit("onLoad"),a.emit("onResize",{width:n,height:.4*n})}),.2)}t._timer.once(o,(function(){s.active=!0,e(null)}),.2)}))}))},hide:function(){return new Promise((function(e){t._timer.once(o,(function(){s&&(s.active=!1),a.emit("onHide"),e(null)}),.2)}))},onLoad:function(t){a.on("onLoad",t,null)},onError:function(t){a.on("onError",t,null)},onHide:function(t){a.on("onHide",t,null)},onResize:function(t){a.on("onResize",t,null)}}};var s=a.prototype;return s.IRewardedVideoCreate=function(t){return e.IRewardedVideoCreate(t)},s.IRecordMgr=function(){return e.IRecordMgr()},s.IInterstitialCreate=function(t){return e.IInterstitialCreate(t)},s.INativeTempCreate=function(t,i){return e.INativeTempCreate(t,i)},s.IBannerCreate=function(t,i){return e.IBannerCreate(t,i)},a.IShare=function(){var n=null,o=null;return{onShareAppMessage:function(){},show:function(r,a,s){t._platform.openWebSimulationUI?(n=a,t._resouces.load(i+"ShareTemp",(function(){o||((o=e.getPrefabByNode(i+"ShareTemp")).active=!1,e.getNodeParent().addChild(o),e.setSize(o,t.winSize()),o.getComponentInChildren("ButtonCC").eventHandler.addEvent({callBack:function(){o.active=!1,n&&n(!0)}})),o.active=!0}))):a&&a(!0)},circleFriends:function(t,e,i){e&&e(!0)}}},s.IShare=function(){return e.IShare()},s.reStart=function(){t.sys.isBrowser?location.reload():t.game.restart()},s.saveImg=function(t,e,i,n,o){var a=this.getSaveImgName();r.getInstance().saveAsPNG(r.updateCanvas(t,e,i),t,e,a),n(a)},a}(t.BasePlatform);n=e=p([t.platformMgr.add(t.EPlatformType.web)],n),t.WebPlatform=n;var r=function(){function t(){}return t.updateCanvas=function(t,e,i){this._canvas?this._canvas.getContext("2d").clearRect(0,0,this._canvas.width,this._canvas.height):(this._canvas=document.createElement("canvas"),this._canvas.width=t,this._canvas.height=e);for(var n=this._canvas.getContext("2d"),o=4*t,r=0;r<e;r++){for(var a=e-1-r,s=n.createImageData(t,1),l=a*t*4,u=0;u<o;u++)s.data[u]=i[l+u];n.putImageData(s,0,r)}return this._canvas},t.getInstance=function(){var t,e,i=(t=document.createElement("canvas"),{canvas:!!(e=t.getContext("2d")),imageData:!!e.getImageData,dataURL:!!t.toDataURL,btoa:!!window.btoa});function n(t,e,i){var n=t.width,o=t.height;null==e&&(e=n),null==i&&(i=o);var r=document.createElement("canvas"),a=r.getContext("2d");return r.width=e,r.height=i,a.drawImage(t,0,0,n,o,0,0,e,i),r}function o(t,e,i){d(t,e,i)}function r(t){var e=document.createElement("img");return e.src=t,e}function a(t){return"image/"+(t=t.toLowerCase().replace(/jpg/i,"jpeg")).match(/png|jpeg|bmp|gif/)[0]}function s(t){if(!window.btoa)throw"btoa undefined";var e="";if("string"==typeof t)e=t;else for(var i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function l(t){var e=t.width,i=t.height;return t.getContext("2d").getImageData(0,0,e,i)}function u(t,e){return"data:"+e+";base64,"+t}var h=function(t){var e=t.width,i=t.height,n=e*i*3,o=n+54,r=[66,77,255&o,o>>8&255,o>>16&255,o>>24&255,0,0,0,0,54,0,0,0],a=[40,0,0,0,255&e,e>>8&255,e>>16&255,e>>24&255,255&i,i>>8&255,i>>16&255,i>>24&255,1,0,24,0,0,0,0,0,255&n,n>>8&255,n>>16&255,n>>24&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=(4-3*e%4)%4,u=t.data,h="",c=e<<2,p=i,d=String.fromCharCode;do{for(var f=c*(p-1),y="",g=0;g<e;g++){var m=g<<2;y+=d(u[f+m+2])+d(u[f+m+1])+d(u[f+m])}for(var v=0;v<l;v++)y+=String.fromCharCode(0);h+=y}while(--p);return s(r.concat(a))+s(h)},c=function(t,e,r,s,c){if(i.canvas&&i.dataURL)if("string"==typeof t&&(t=document.getElementById(t)),null==s&&(s="png"),s=a(s),/bmp/.test(s)){var p=l(n(t,e,r));o(u(h(p),"image/octet-stream"),s.replace("image/",""),c)}else(t=n(t,e,r)).toBlob((function(t){o(URL.createObjectURL(t),s.replace("image/",""),c)}),s,1)},p=function(t,e,o,s){if(i.canvas&&i.dataURL){if("string"==typeof t&&(t=document.getElementById(t)),null==s&&(s="png"),s=a(s),/bmp/.test(s)){var c=l(n(t,e,o));return r(u(h(c),"image/bmp"))}return r(function(t,e,i,o){return(t=n(t,i,o)).toDataURL(e)}(t,s,e,o))}},d=function(t,e,i){var n=document.createElement("a");n.style.display="none",n.href=t,n.download=i+"."+e,document.body.appendChild(n),n.click(),document.body.removeChild(n)};return{saveAsImage:c,saveAsPNG:function(t,e,i,n){return c(t,e,i,"png",n)},saveAsJPEG:function(t,e,i){return c(t,e,i,"jpeg","defaultjpg")},saveAsGIF:function(t,e,i){return c(t,e,i,"gif","defaultgif")},saveAsBMP:function(t,e,i){return c(t,e,i,"bmp","defaultbmp")},convertToImage:p,convertToPNG:function(t,e,i){return p(t,e,i,"png")},convertToJPEG:function(t,e,i){return p(t,e,i,"jpeg")},convertToGIF:function(t,e,i){return p(t,e,i,"gif")},convertToBMP:function(t,e,i){return p(t,e,i,"bmp")}}},t}();r._canvas=null}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).root=window.wx,t._userInfoBtn=null,t.isBtnShow=!1,t}o(i,e);var n=i.prototype;return n.INativeTempCreate=function(e,i){if(!this.root.createCustomAd)return t.BasePlatform.INativeTempCreate(e,i);var n=t._platform.systemInfo;return this.root.createCustomAd({adUnitId:e,style:{left:Math.max(0,(n.screenWidth-375)/2),top:n.screenHeight-106},adIntervals:i})},n.IBlockOnceCreate=function(e){t._platform.systemInfo;var i=this.root.getMenuButtonBoundingClientRect();return this.root.createCustomAd({adUnitId:e,style:{left:i.left,top:i.top+i.height+t._platform._blockOnce_.topSpace},adIntervals:t._platform.config.blockOnce.refreshInterval})},n.IShare=function(){var e=this,i=null,n=!1;return{onShareAppMessage:function(i,n){e.root.onShareAppMessage(n||function(){return t._platform._share_.getData()}),e.root.showShareMenu({menus:["shareAppMessage","shareTimeline"],withShareTicket:!0,success:function(t){console.log("click topRight share: ",t)}}),i&&t._timer.once(e,(function(){e.loadShareImg(i,(function(){}))}),e.isLoadShareCache()?-1:3)},show:function(o,r,a){if(i=t.Times.second(),e.shareAppMessageCallBack=r,!n){n=!0;e.root.onShow((function o(){e.root.offShow(o),i&&e.shareAppMessageCallBack&&(t.Times.second()-i>t._platform.config.share.callTime?e.shareAppMessageCallBack(!0):e.shareAppMessageCallBack(!1),i=null,n=!1,e.shareAppMessageCallBack=null)}))}var s={title:o.title};o.query&&(s.query="query="+o.query);var l=function(){e.root.shareAppMessage(s)};if(o.imageUrl){s.imageUrl=o.imageUrl;var u=t._platform._share_.getImgUrlByPath(o.imageUrl);u?(s.path=u,e.loadShareImg(u,l)):l()}else l()},circleFriends:function(t,e,i){e&&e(!0)}}},n.IOpenDataContext=function(){var t=this,e=this.root.getOpenDataContext();return{set:function(e){t.root.setUserCloudStorage({KVDataList:[{key:"ranking",value:JSON.stringify(e)}]})},startRender:function(t){e.postMessage({event:"startRender",param:t})},updateRender:function(t){e.postMessage({event:"updateRender",index:t})}}},n.getSetting=function(t){this.root.getSetting({success:function(e){t(e)},fail:function(){t(null)}})},n.authorizeWxFriendInteraction=function(e){var i=this;t._platform.getSetting((function(t){t?t.authSetting["scope.WxFriendInteraction"]?e("none"):i.root.authorize({scope:"scope.WxFriendInteraction",success:function(i){t.authSetting["scope.WxFriendInteraction"]=!0,console.log("开放域授权成功",i),e("authSuccess")},fail:function(t){console.log("开放域授权失败",t),e("authFail")}}):e("none")}))},n.authorizeWxFriendInteractionSync=function(){var e=t._platform._settingData;return!e||!!e.authSetting["scope.WxFriendInteraction"]},n.getUserInfo=function(e){var i=this;t._platform.getSetting((function(t){t&&t.authSetting["scope.userInfo"]?i.root.getUserInfo({success:function(t){console.log(t.userInfo),e(i._getUserInfo(t.userInfo))},fail:function(){e(null)}}):e(null)}))},n.showUserInfoBtn=function(e,i){var n,o=this,r=null===(n=e.getComponent(t.UITransform))||void 0===n?void 0:n.getBoundingBoxToWorld(),a=t.winSize().width/t._platform.systemInfo.screenWidth;r.x/=a,r.y=(t.winSize().height-r.y-r.height)/a,r.width=r.width/a,r.height=r.height/a,this._userInfoBtn?this.isBtnShow||(this._userInfoBtn.show(),this._userInfoBtn.style.left=r.x,this._userInfoBtn.style.top=r.y,this._userInfoBtn.style.width=r.width,this._userInfoBtn.style.height=r.height):(this._userInfoBtn=this.root.createUserInfoButton({type:"image",style:{left:r.x,top:r.y,width:r.width,height:r.height}}),this._userInfoBtn.onTap((function(t){console.log(t);var e=o._getUserInfo(t.userInfo);e&&(o.hideUserInfoBtn(),i(e))}))),this.isBtnShow=!0},n.hideUserInfoBtn=function(){this._userInfoBtn&&(this.isBtnShow&&this._userInfoBtn.hide(),this.isBtnShow=!1)},n._getUserInfo=function(t){return t?{name:t.nickName,city:t.city,avatarUrl:t.avatarUrl,age:1}:null},i}(t.BaseMingamePlatform);e=p([t.platformMgr.add(t.EPlatformType.wx)],e),t.WxPlatform=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).root=window.qg,t}o(i,e);var n=i.prototype;return n.INativeTempCreate=function(e,i){return this.root.createCustomAd?this.root.createCustomAd({adUnitId:e}):t.BasePlatform.INativeTempCreate(e,i)},n.IBannerCreate=function(t,e){return this.root.createBannerAd({adUnitId:t,style:{}})},i}(t.BaseMingamePlatform);e=p([t.platformMgr.add(t.EPlatformType.xiaomi)],e),t.XiaoMiPlatform=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).CLOSE_ON_CC=!0,t.backupDescribe="场景基类(勿使用cocos生命周期)",t.openUIUrl="",t.loadUrl="",t._changeData=null,t._isOnCreate=!1,t._onCreateByUpdateCb=null,t.isUpdate=!1,t}o(i,e);var n=i.prototype;return n._onCreate=function(){t._scene.setEnterCount(this.loadUrl,1),this.onUpdate&&this.onUpdate!=this._onCreateByUpdate&&(this._onCreateByUpdateCb=this.onUpdate,this.onUpdate=this._onCreateByUpdate),this._onLoad(),this._onEnable(),this.openUIUrl&&t._ui.open(this.openUIUrl,null,null,null,!1),this.onCreate&&this.onCreate(),this._isOnCreate=!0,this.isUpdate=!0},n._onCreateByUpdate=function(){this._isOnCreate&&this._onCreateByUpdateCb()},n._onDispose=function(){this.isUpdate=!1,this._isOnCreate=!1,this.openUIUrl&&t._ui.dispose(this.openUIUrl),this._onDisable(),this.onDispose&&this.onDispose(),this.onDestroy()},n.pause=function(){this.isUpdate=!1,this.onPause&&this.onPause()},n.run=function(){this.onRun&&this.onRun.apply(this,arguments)},n.resume=function(){this.isUpdate=!0,this.onResume&&this.onResume()},n.preLoadScene=function(e){t._scene.preLoad(this.loadUrl,e,null,!1)},l(i,[{key:"enterCount",get:function(){return t._scene.getEnterCount(this.loadUrl)}},{key:"isPause",get:function(){return!this.isUpdate}}]),i}(t.BaseComponent);p([t.property({displayName:"显示ui 路径"})],e.prototype,"openUIUrl",void 0),e=p([t.ccclass("BaseScene"),t.menuScene("scene/BaseScene")],e),t.BaseScene=e}(apeng||(apeng={})),function(t){!function(t){function e(t){return function(e){return e[t]}}function i(){return Date.now()}var n;t._eGet=e,t.DateNow=i,t.ErrorCodeMap={2e3:"用户id解析错误",2001:"游戏id解析错误",2002:"携带参数错误",2003:"游戏对应appid或secret未配置",2004:"获取openid错误",2005:"服务器错误"},(n=t.EPlatformType||(t.EPlatformType={}))[n.web=99]="web",n[n.wx=1]="wx",n[n.qq=2]="qq",n[n.tt=3]="tt",n[n.vivo=4]="vivo",n[n.oppo=5]="oppo",n[n.hbs=7]="hbs",n[n.xiaomi=8]="xiaomi",n[n.overseas_android_xgame=10]="overseas_android_xgame",n[n.a360=11]="a360",n[n.overseas_kwai=12]="overseas_kwai",n[n.overseas_weiyou=13]="overseas_weiyou",n[n.ks=14]="ks",n[n.ios=15]="ios";var r=function(){};t.SCSendDataBase=r;var a=function(){function t(){this.timeTemp=i()}return t.error=function(e,i){var n=new t;return n.errorCode=e,void 0!==i&&(n.data=i),n},t.data=function(e){var i=new t;return i.data=e,i},t.serializeData=function(t,e){for(var i in t)e[i]&&(t[i]=e[i]);return this.data(t)},t}();t.ApiSCSendBase=a;var s=function(){};t.ParamBase=s;var l=function(t){function e(e){var i;return(i=t.call(this)||this).data=e,i}return o(e,t),e}(s);t.ParamData=l;var u=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e}(s);t.ParamGame=u;var h=function(t){function e(e,i){var n;return(n=t.call(this)||this).key=e,n.count=i,n}return o(e,t),e}(u);t.ParamKeyCount=h;var c=function(t){function e(e){var i;return(i=t.call(this)||this).data=e,i}return o(e,t),e}(u);t.ParamGameData=c,function(t){var e=function(t){function e(e,i,n,o){var r;return(r=t.call(this)||this).jscode=e,r.appid=i,r.openid=n,r.platform=o,r}return o(e,t),e}(u);t.CSLogin=e;var i=function(t){function e(e,i){var n;return(n=t.call(this)||this).name=e,n.img_url=i,n}return o(e,t),e}(u);t.CSInfo=i;var n=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).name="",e.img_url="",e.uid=-1,e.user_id="",e}return o(e,t),e}(r);t.SCLogin=n}(t.User||(t.User={})),function(t){var i;!function(t){t[t.count=0]="count",t[t.index=1]="index",t[t.name=2]="name",t[t.img_url=3]="img_url"}(i=t.ESCList||(t.ESCList={})),t.eGet={name:e(i.name),count:e(i.count),index:e(i.index),img_url:e(i.img_url)};var n,a=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e}(r);t.SCData=a,function(t){t[t.index=0]="index",t[t.count=1]="count"}(n=t.ESCProvince||(t.ESCProvince={})),t.eGetProvince={index:e(n.index),count:e(n.count)}}(t.Rank||(t.Rank={})),function(t){var i;!function(t){t[t.id=0]="id",t[t.id_num=1]="id_num",t[t.play_count=2]="play_count",t[t.play_success_count=3]="play_success_count",t[t.like_count=4]="like_count",t[t.data=5]="data",t[t.name=6]="name",t[t.img_url=7]="img_url",t[t.create_time=8]="create_time"}(i=t.ESCList||(t.ESCList={})),t.eGet={id:e(i.id),id_num:e(i.id_num),play_count:e(i.play_count),play_success_count:e(i.play_success_count),like_count:e(i.like_count),data:e(i.data),name:e(i.name),img_url:e(i.img_url),create_time:e(i.create_time)};var n=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e}(r);t.SCListAll=n}(t.Custom||(t.Custom={}))}(t.si||(t.si={}))}(apeng||(apeng={})),function(t){var e=new t.Color(0,0,0,255),i=function(i){function n(){var e;return(e=i.apply(this,arguments)||this).CLOSE_ON_CC=!0,e.backupDescribe="UI组件(勿使用cocos生命周期)",e.layerType=t.EUILayer.Window,e.bottomAdType=t.EBottomAdType.Jump,e.blockOnceAdType=t.EBlockOnceAdType.Jump,e.isEventBlock=!0,e.clickCloseUI=!1,e.lockUIMgrAll=!1,e.disposeByRelease=!0,e.stageUp=!1,e.delayNodes=[],e.autoPlayAnim=null,e._maskOpacityUI=0,e.openByAudioUrls=null,e.audioUrls=null,e.url="",e._openData=null,e._closeData=null,e.__openShow=null,e._isOnCreate=!1,e._onCreateByUpdateCb=null,e.onClickCloseUI2=e.onClickCloseUI,e}o(n,i);var r=n.prototype;return r.onLoad=function(){if(i.prototype.onLoad.call(this),t.EDITOR){var e=t.CCObject.Flags.IsPositionLocked|t.CCObject.Flags.IsRotationLocked|t.CCObject.Flags.IsScaleLocked|t.CCObject.Flags.IsSizeLocked|t.CCObject.Flags.IsAnchorLocked;this._objFlags=e,this.node.setPosition(0,0),this.setSize(t.winSize()),this.maskOpacityUI=this._maskOpacityUI,this.onEditorByOnLoad&&this.onEditorByOnLoad()}},r._onCreate=function(){(this.onUpdate&&this.onUpdate!=this._onCreateByUpdate&&(this._onCreateByUpdateCb=this.onUpdate,this.onUpdate=this._onCreateByUpdate),this._onLoad(),this.isEventBlock)&&(this.getComponent(t.BlockInputEvents)||this.addComponent(t.BlockInputEvents));this.setSize(t.winSize()),this.getMaskOpacityUI(),this.clickCloseUI&&t.EventHandlerCC.onClick(this.node,this.onClickCloseUI,this),this.onCreate&&this.onCreate()},r._onCreateByUpdate=function(){this._isOnCreate&&this._onCreateByUpdateCb()},r.updateOpenShow=function(){this.node.setPosition(this.__openShow?0:-1e4,0)},r._onOpen=function(){var e=this;this.updateOpenShow(),this._onEnable();var i=2;if(t._platform.type!=t.EPlatformType.vivo&&t._platform.type!=t.EPlatformType.oppo&&t._platform.type!=t.EPlatformType.tt||(i=0),0!=i){for(var n,o=u(this.delayNodes);!(n=o()).done;){var r=n.value;r&&(r.active=!1)}this.scheduleOnce((function(){for(var t,i=u(e.delayNodes);!(t=i()).done;){var n=t.value;n&&(n.active=!0)}}),i)}this.autoPlayAnim&&this.autoPlayAnim.playDefault(),this.openByAudioUrls&&(this.audioUrls="function"==typeof this.openByAudioUrls?this.openByAudioUrls():this.openByAudioUrls,this.audioUrls&&this.audioUrls.length>0&&this.scheduleOnceCover(this.onDelayLoadAudios,t._ui.delayProAudio)),this.onOpen&&this.onOpen(),this._isOnCreate=!0},r.onDelayLoadAudios=function(){for(var e,i=u(this.audioUrls);!(e=i()).done;){var n=e.value;t._audio.load(n)}},r._onClose=function(){this._isOnCreate=!1,this._onDisable(),this.onClose&&this.onClose()},r._onDispose=function(){this.onDispose&&this.onDispose(),this.onDestroy()},r.onClickCloseUI=function(t,e){void 0===e&&(e=""),this.onCloseUIClickBefore&&this.onCloseUIClickBefore(),this.closeUI("destroy"==e)},r.closeUI=function(e){void 0===e&&(e=!1),e?t._ui.dispose(this.url):t._ui.close(this.url)},r.getMaskOpacityUI=function(){var i=this;return this.getChildByCreate("MaskOpacityUI",(function(n){if(t.EDITOR)n.addComponent(t.Graphics);else{var o=n.addComponent(t.Sprite);o.spriteFrame=t._resouces.getDefaultSpriteFrame(),o.color=e.clone().set(0,0,0,255*i._maskOpacityUI),n.addComponent("SpriteEnableFadeInCC")}t.NodeHelper.getUITransform(n).setContentSize(t.winSize())}),0)},r.getOpenCount=function(){return t._ui.getModule(this.url).openCount},l(n,[{key:"maskOpacityUI",get:function(){return this._maskOpacityUI},set:function(i){this._maskOpacityUI=i;var n=this.getMaskOpacityUI();if(t.EDITOR){var o=n.getComponent(t.Graphics);o.fillColor=e.clone().set(0,0,0,255*this._maskOpacityUI),o.clear();var r=t.winSize();o.rect(-r.width/2,-r.height/2,r.width,r.height),o.fill()}}}]),n}(t.BaseComponent);p([t.property({displayName:"屏蔽下层事件"})],i.prototype,"isEventBlock",void 0),p([t.property({displayName:"点击关闭UI"})],i.prototype,"clickCloseUI",void 0),p([t.property({range:[0,1,.1],slide:!0,displayName:"透明蒙层"})],i.prototype,"maskOpacityUI",null),p([t.property({tooltip:"锁住当前ui 不让UImgr进行批量操作 屏蔽SceneMgr管理ui",displayName:"屏蔽批量操作"})],i.prototype,"lockUIMgrAll",void 0),p([t.property({tooltip:"销毁时，释放当前预制体资源",displayName:"释放资源"})],i.prototype,"disposeByRelease",void 0),p([t.property({tooltip:"默认在舞台层，添加到默认舞台的上层",displayName:"舞台上层"})],i.prototype,"stageUp",void 0),p([t.property({type:[t.Node],displayName:"延迟显示节点"})],i.prototype,"delayNodes",void 0),p([t.property({type:t.AnimtorCC,displayName:"显示时播放动画"})],i.prototype,"autoPlayAnim",void 0),p([t.property({serializable:!0})],i.prototype,"_maskOpacityUI",void 0),i=p([t.ccclass("BaseUI"),t.executeInEditMode,t.menuUI("BaseUI")],i),t.BaseUI=i}(apeng||(apeng={})),function(t){var e={red:new t.Color(243,52,52),black:new t.Color(0,0,0),darkBlue:new t.Color(96,109,142)},i=function(i){function n(){var t;return(t=i.apply(this,arguments)||this).cLabelContent=null,t.cLabelLeft=null,t.cLabelRight=null,t.cLabelCenter=null,t.btn=null,t.rightBtn=null,t.onClickLeft=t.onClickCenter,t}o(n,i);var r=n.prototype;return r.onLoad=function(){i.prototype.onLoad.call(this),this.setSize(t.winSize())},r.init=function(t,e,i){this.btn=e,this.rightBtn=i,this.rightBtn?this.ControllerCC.index=0:this.ControllerCC.index=1,this.cLabelContent.string=t,0==this.ControllerCC.index?(this.setBtnData(this.cLabelLeft,this.btn),this.setBtnData(this.cLabelRight,this.rightBtn)):this.setBtnData(this.cLabelCenter,this.btn)},r.setBtnData=function(t,i){t.string=i.text,i.color?t.color=e[i.color]:t.color=e.black},r.onClick=function(){t._ui.pool.put(this.node)},r.onClickRight=function(){t._ui.pool.put(this.node),this.rightBtn.onClick&&this.rightBtn.onClick()},r.onClickCenter=function(){t._ui.pool.put(this.node),this.btn.onClick&&this.btn.onClick()},n}(t.BaseComponent);i=p([t.ccclass("Dialogue"),t.menuUI("Dialogue")],i),t.Dialogue=i}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).cAItems=null,i.loadDir=new t.LoadDir(1,null),i}return o(i,e),i.prototype.init=function(e,i,n,o,r,a){var s=this;this.setPositionXY(e,!0);var l=0;l=r?"number"==typeof r?r:t.Maths.minToMax(r[0],r[1]):t.Maths.minToMax(10,15),this.loadDir.count=l,this.loadDir.onFinish=function(){a&&a(),t._ui.pool.put(s.node)};for(var u=0;u<l;u++){var h=t._ui.pool.get(o).getComponent("FlyEffectItem");this.cAItems.addChild(h.node),h.init(n,i,this.loadDir.subCount(),l)}},i}(t.BaseComponent);e=p([t.ccclass("FlyEffect"),t.menuUI("FlyEffect")],e),t.FlyEffect=e}(apeng||(apeng={})),function(t){var e=new t.Vec3(.6,.6,0),i=function(i){function n(){var e;return(e=i.apply(this,arguments)||this).cb=null,e.count=null,e.v3T2=new t.Vec3(.6,.6,0),e}return o(n,i),n.prototype.init=function(i,n,o,r){var a=this;t.Vector2.set(this.v3T2,n),this.SpriteLoaderCC.setSpriteFrameUrl(i,!0),this.setPosition(t.Vector3.ZERO,!1),this.setScaleNum(.1,!1),this.cb=o,this.count=r,t.TweenHelper.getTween(this.node,"FlyEffectItem",(function(i){var n=new t.Vec3,o=t.Maths.minToMax(5,7)/10,r=t.Maths.minToMax(5,7)/10;return i.call((function(){if(1!=a.count){o=t.Maths.minToMax(5,7)/10,r=t.Maths.minToMax(5,7)/10,t.TweenHelper.setDuration(i,1,o),t.TweenHelper.setDuration(i,2,r);var e=t.Maths.minToMax(-100,100),s=100-Math.abs(e),l=t.Maths.isRandom(.5)?0-s:s;t.Vector3.set(n,e,l)}else t.Vector3.set(n)})).by(o,{position:n,scale:e},{easing:"quadOut"}).to(r,{worldPosition:a.v3T2},{easing:"quadIn"}).call((function(){t._ui.pool.put(a.node),a.cb()})),{}})).start()},n}(t.BaseComponent);i=p([t.ccclass("FlyEffectItem"),t.menuUI("FlyEffectItem")],i),t.FlyEffectItem=i}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this)._isVisible=!1,i.state=t.ETipWhiteState.Hide,i.showCb=null,i}o(i,e);var n=i.prototype;return n.onLoad=function(){e.prototype.onLoad.call(this),this.setOpacity(0)},n.onUpdate=function(){var e=this.getOpacity();if(this._isVisible)1!=e?(e=t.Maths.clamp01(e+2*t._timer.dtDefault),this.setOpacity(e)):this.state==t.ETipWhiteState.Showing&&(this.state=t.ETipWhiteState.Show,this.showCb&&(this.showCb(),this.showCb=null));else{if((e=t.Maths.clamp01(e-t._timer.dtDefault))<.01)return e=0,this.node.active=!1,void(this.state==t.ETipWhiteState.Hideing&&(this.state=t.ETipWhiteState.Hide));this.setOpacity(e)}},n.init=function(e){this.showCb=null,this._isVisible=e,this.node.active=!0,this._isVisible?(this.setOpacity(0),this.state=t.ETipWhiteState.Showing):(this.setOpacity(1),this.state=t.ETipWhiteState.Hideing)},i}(t.BaseComponent);e=p([t.ccclass("LoadingScreen"),t.menuUI("LoadingScreen")],e),t.LoadingScreen=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).isScene=!1,i.clickClose=!1,i.cLabelTip=null,i.tipIndex=0,i.state=t.ETipWaitState.Hide,i.completeCb=null,i}o(i,e);var n=i.prototype;return n.onLoad=function(){e.prototype.onLoad.call(this),this.setSize(t.winSize())},n.onUpdate=function(){},n.init=function(e,i,n,o){void 0===i&&(i=!1),this.setNodeActive(e),e&&(e&&(this.clickClose=i),this.state=t.ETipWaitState.Loading,this.completeCb=null)},n.setNodeActive=function(t){this.node.active=t},n.onClick=function(){this.clickClose&&this.init(!1)},i}(t.BaseComponent);p([t.property({displayName:"切换场景时 显示文字"})],e.prototype,"isScene",void 0),e=p([t.ccclass("LoadingWait"),t.menuUI("LoadingWait")],e),t.LoadingWait=e}(apeng||(apeng={})),function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e.prototype.init=function(t,e,i,n){this.Label.string=e,i?(this.SpriteLoaderCC.node.active=!0,this.SpriteLoaderCC.setSpriteFrameUrl(i)):this.SpriteLoaderCC.node.active=!1,this.setPositionXY(t,!0),this.AnimtorCC.playDefault(n)},e}(t.BaseComponent);e=p([t.ccclass("MoveUpItem"),t.menuUI("MoveUpItem")],e),t.MoveUpItem=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).cb=new t.CompleteCallBack,i}o(i,e);var n=i.prototype;return n.onLoad=function(){var i=this;e.prototype.onLoad.call(this),this.Label.string="",this.addEvent(t.Node.EventType.SIZE_CHANGED,(function(){i.scheduleOnceCover(i.onLabelSize)}),this,this.Label.node)},n.init=function(t,e){this.Label.string=t,this.scheduleOnceCover(this.onLabelSize),this.cb.set(e),this.AnimtorCC?(this.AnimtorCC.stop(),this.AnimtorCC.playDefault(this.put.bind(this))):this.AnimtorByTweenCC&&this.AnimtorByTweenCC.play(this.put.bind(this))},n.put=function(){this.cb.run(),this.isVisible&&t._ui.pool.put(this.node)},n.onLabelSize=function(){},i}(t.BaseComponent);e=p([t.ccclass("Tip"),t.menuUI("Tip")],e),t.Tip=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).cb=new t.CompleteCallBack,i}o(i,e);var n=i.prototype;return n.onLoad=function(){e.prototype.onLoad.call(this),this.node.setPosition(0,0),this.setSize(t.winSize()),t.EDITOR||(this.Label.string="")},n.init=function(t,e){this.Label.string=t,this.cb.set(e)},n.onClick=function(){t._ui.pool.put(this.node),this.cb.run()},i}(t.BaseComponent);e=p([t.ccclass("TipClick"),t.menuUI("TipClick")],e),t.TipClick=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).cLabel_downTip=null,i.cb=new t.CompleteCallBack,i}o(i,e);var n=i.prototype;return n.onLoad=function(){e.prototype.onLoad.call(this),this.node.setPosition(0,0),this.setSize(t.winSize())},n.init=function(e,i,n,o,r,a){void 0===o&&(o=!0),void 0===r&&(r=!1),void 0===a&&(a=""),a?(this.cLabel_downTip.node.active=!0,this.cLabel_downTip.string=a):this.cLabel_downTip.node.active=!1,i?(this.Label.node.parent.active=!0,this.Label.string=i):this.Label.node.parent.active=!1,this.CreatePrefabToEditorCC.render(e,t.TipTitleClickItem,(function(t,i){t.init(i,o,e.length<=1)})),this.cb.set(n),r?(this.scheduleOnceCover(this.onClick,2.5),this.spriteEnableFadeInCC.node.active=!1):this.spriteEnableFadeInCC.node.active=!0},n.onClick=function(){t._ui.pool.put(this.node),this.cb.run()},l(i,[{key:"spriteEnableFadeInCC",get:function(){return this.getCacheComponent("SpriteEnableFadeInCC")}}]),i}(t.BaseComponent);e=p([t.ccclass("TipTitleClick"),t.executeInEditMode,t.menuUI("TipTitleClick")],e),t.TipTitleClick=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).cLabel_right=null,t}return o(i,e),i.prototype.init=function(e,i,n){this.autoMember(),this.Sprite.node.active=i;var o=e;"string"!=typeof e?(o=e.curStr,e.rightStr?(this.cLabel_right.node.active=!0,this.cLabel_right.string=e.rightStr,e.rightColor?this.cLabel_right.color=e.rightColor:this.cLabel_right.color=this.Label.color):this.cLabel_right.node.active=!1):this.cLabel_right.node.active=!1,this.Label.string=o,this.Label.horizontalAlign=n?t.Label.HorizontalAlign.CENTER:t.Label.HorizontalAlign.LEFT,this.Sprite.node.active=!n},i}(t.BaseComponent);e=p([t.ccclass("TipTitleClickItem"),t.menuUI("TipTitleClickItem")],e),t.TipTitleClickItem=e}(apeng||(apeng={})),function(t){var e,i,n=new t.Size;new t.Vec3;!function(t){t[t.None=0]="None",t[t.Circle=1]="Circle",t[t.Point=2]="Point",t[t.Polygon=3]="Polygon",t[t.Box=4]="Box",t[t.Plane=5]="Plane",t[t.Line=6]="Line",t[t.Heightfield=7]="Heightfield"}(i||(i={})),t.ccenum(i);var r=new t.Vector2,a=e=function(a){function s(){var e;return(e=a.apply(this,arguments)||this).EventType={LERP_POS_COMPLETE:"LERP_POS_COMPLETE"},e.backupDescribe="物理形状",e.mass=0,e.trigger=!1,e.velocity=new t.Vec2,e.velocityScale=0,e.damping=0,e.fixedX=!1,e.fixedY=!1,e.fixedRotation=!1,e.angularVelocity=0,e.angularDamping=0,e.editorColor=new t.Color(0,255,0),e.editorLineWidth=6,e.runEditorShow=!0,e.tag="",e.shapePanle="x无限长,大于y可移动(小于等于y物理块)",e.bodyNodeOffset=null,e.syncNodePosition=null,e.syncNodePositionLerp=.1,e.syncNodeAngle=null,e.receiveMaterial=!1,e.openMaterial=!1,e.materialFriction=.5,e.materialFrictionRelaxation=4,e.materialFrictionStiffness=1e6,e.materialRelaxation=4,e.materialRestitution=0,e.materialStiffness=1e6,e.materialSurfaceVelocity=0,e.materialContactSkinSize=.005,e._shapeType=i.None,e._useNodeSize=!0,e._circleRadius=0,e._lineLength=1,e._heightfieldLength=100,e._circleLength=0,e._boxSize=new t.Size,e._shapeOffset=new t.Vec2,e._poygonPoints=[],e._heightfields=[],e.onEditorUpdateData=e.updateCCGraphics,e.shape=null,e.body=null,e._lerpBodyPos=new t.Vector2,e.areaWidth=0,e.lerpBodyPosLowRatio=.01,e.lerpBodyPosLow=new t.Vector2,e.isCreateBody=!1,e.lastBodyAngle=null,e.openMaterials=[],e}o(s,a);var h=s.prototype;return h.onLoad=function(){a.prototype.onLoad.call(this),this.updateNodeSize(),t.EDITOR||this.updateCCGraphics()},h.updateNodeSize=function(){switch(n.set(this.UITransform.contentSize),this._shapeType){case i.Circle:(this._useNodeSize||0==this._circleRadius)&&(n.width==n.height?(this._circleLength=0,this.circleRadius=this.UITransform.width/2):n.width>n.height&&(this._circleLength=n.width-n.height,this.circleRadius=n.height/2));break;case i.Box:(this._useNodeSize||0==this._boxSize.width&&0==this._boxSize.height)&&(this.boxSize=n);break;case i.Polygon:if(this._useNodeSize||0==this._poygonPoints.length){for(var e=[],o=0;o<4;o++)0==o?e[o]=new t.Vec2(-n.width/2,-n.height/2):1==o?e[o]=new t.Vec2(n.width/2,-n.height/2):2==o?e[o]=new t.Vec2(n.width/2,n.height/2):3==o&&(e[o]=new t.Vec2(-n.width/2,n.height/2));this._poygonPoints=e}break;case i.Line:this._useNodeSize&&(this._lineLength=n.width)}},h.onFocusInEditor=function(){this.updateCCGraphics()},h.onLostFocusInEditor=function(){this._shapeType!=i.None&&this.getGraphics().clear()},h.onEnable=function(){a.prototype.onEnable.call(this),this.lastBodyAngle=null},h.onUpdate=function(){this.body&&(this.syncNodePosition&&(this.syncNodePositionLerp>0?r.set(this.lerpBodyPos(this.syncNodePositionLerp)):r.set(this.body.position),this.bodyNodeOffset!=this.syncNodePosition&&this.bodyNodeOffset&&r.subSelf(this.bodyNodeOffset.position),t.NodeHelper.setPositionXY(this.syncNodePosition,r,!1)),this.syncNodeAngle&&(this.lastBodyAngle!=this.body.angle&&t.NodeHelper.setRotateZ(this.syncNodeAngle,t.Maths.toDegree(this.body.angle,!1),!1),this.lastBodyAngle=this.body.angle))},h.updateCCGraphics=function(){if(e.debug&&(t.EDITOR||this.runEditorShow)&&this._shapeType!=i.None){var n=this.getGraphics();n.strokeColor=this.editorColor,n.lineWidth=this.editorLineWidth,n.fillColor=this.editorColor,n.clear();var o=this._shapeOffset.x,r=this._shapeOffset.y;switch(this._shapeType){case i.Circle:if(this._circleLength>0){var a=this._circleLength/2,s=this._circleRadius;n.arc(-a+o,r,s,Math.PI/2,1.5*Math.PI,!0),n.arc(a+o,r,s,Math.PI/2,1.5*Math.PI,!1),n.moveTo(-a+o,s+r),n.lineTo(a+o,s+r),n.moveTo(-a+o,-s+r),n.lineTo(a+o,-s+r)}else n.circle(o,r,this._circleRadius);n.stroke();break;case i.Box:n.rect(o-this._boxSize.width/2,r-this._boxSize.height/2,this._boxSize.width,this._boxSize.height),n.stroke();break;case i.Polygon:if(this._poygonPoints.length>2){n.moveTo(this._poygonPoints[0].x+o,this._poygonPoints[0].y+r);for(var l=1,u=this._poygonPoints.length+1;l<u;l++){var h=l==u-1?0:l,c=this._poygonPoints[h];n.lineTo(c.x+o,c.y+r)}n.stroke()}break;case i.Point:n.circle(o,r,5),n.fill();break;case i.Plane:n.rect(-2e3,-2e3+r,4e3,2e3),n.fill();break;case i.Line:n.moveTo(-this._lineLength/2+o,r),n.lineTo(this._lineLength/2+o,r),n.stroke();break;case i.Heightfield:if(this._heightfields.length>1){n.moveTo(o,-1e3+r);for(var p=0;p<this._heightfields.length;p++){var d=p*this._heightfieldLength,f=this._heightfields[p];n.lineTo(d+o,f+r)}n.lineTo((this._heightfields.length-1)*this._heightfieldLength+o,-1e3+r),n.fill()}}}},h.getGraphics=function(){return this.getChildByCreate(this.uuid+"graphics",(function(e){e.addComponent(t.Graphics)})).getComponent(t.Graphics)},h.createBody=function(e,n){if(this.isCreateBody=!1,this.body)return this.body;if(this._shapeType==i.None)return this.body;this.isCreateBody=!0;var o=this.getCurPos(),r=[o.x,o.y];this._shapeType==i.Plane&&(r[0]=0),this.body=new p2.Body({type:0==this.mass?p2.Body.STATIC:this.trigger?p2.Body.KINEMATIC:p2.Body.DYNAMIC,mass:this.mass,position:r,gravityScale:this.velocityScale,velocity:[this.velocity.x,this.velocity.y],angle:t.Maths.toRadian(this.node.angle),angularVelocity:this.angularVelocity,fixedRotation:this.fixedRotation,allowSleep:!1,collisionResponse:!this.trigger,angularDamping:this.angularDamping,damping:this.damping,fixedX:this.fixedX,fixedY:this.fixedY}),this.body.comp=this;var a=this.node.scale.x;switch(this._shapeType){case i.Circle:this._circleLength>0?this.shape=new p2.Capsule(this.groupParam(e,n,{length:this._circleLength*a,radius:this._circleRadius*a})):this.shape=new p2.Circle(this.groupParam(e,n,{radius:this._circleRadius*a}));break;case i.Point:this.shape=new p2.Particle(this.groupParam(e,n,{}));break;case i.Box:this.shape=new p2.Box(this.groupParam(e,n,{width:this._boxSize.width*a,height:this._boxSize.height*a}));break;case i.Polygon:if(this._poygonPoints.length>2){for(var s,l=[],h=u(this._poygonPoints);!(s=h()).done;){var c=s.value;l.push([c.x*a,c.y*a])}this.shape=new p2.Convex(this.groupParam(e,n,{vertices:l}))}break;case i.Plane:this.shape=new p2.Plane(this.groupParam(e,n,{}));break;case i.Line:this.shape=new p2.Line(this.groupParam(e,n,{length:this._lineLength}));break;case i.Heightfield:this.shape=new p2.Heightfield(this.groupParam(e,n,{heights:this._heightfields,elementWidth:this._heightfieldLength}))}return this.body.addShape(this.shape),this.areaWidth=Math.sqrt(this.shape.area),this.body},h.groupParam=function(t,e,i){var n=i;return n.collisionMask=t.getMask(e),n.collisionGroup=t.getGroup(e),n.position=[this._shapeOffset.x,this._shapeOffset.y],n.sensor=this.trigger,(this.receiveMaterial||this.openMaterial)&&(n.material=new p2.Material),n},h.updateOffset=function(t,e){this._shapeOffset.set(t,e),this.shape.position[0]=this._shapeOffset.x,this.shape.position[1]=this._shapeOffset.y,this.shape.updateBoundingRadius(),this.body.updateBoundingRadius()},h.updateTransform=function(e,n,o,r){if(void 0===r&&(r=1),e){var a=this.getCurPos();this._shapeType!=i.Plane&&(this.body.position[0]=a.x),this.body.position[1]=a.y}if(o){var s=t.Maths.toRadian(this.node.angle);this.body.angle=s}if(n){var l=Math.abs(this.node.scale.x)*r;switch(this._shapeType){case i.Circle:this._circleLength>0?(this.shape.length=this._circleLength*l,this.shape.radius=this._circleRadius*l):this.shape.radius=this._circleRadius*l;break;case i.Point:break;case i.Box:this.shape.width=this._boxSize.width*l,this.shape.height=this._boxSize.height*l;break;case i.Polygon:for(var u=0;u<this._poygonPoints.length;u++){var h=this.shape.vertices,c=this._poygonPoints[u];h[u][0]=c.x*l,h[u][1]=c.y*l}}}(e||o||n)&&(this.shape.updateBoundingRadius(),this.body.updateBoundingRadius()),n&&(this.areaWidth=Math.sqrt(this.shape.area))},h.getCurPos=function(){return this.bodyNodeOffset?t.Vector2.add(r,this.bodyNodeOffset.position,this.node.position):this.node.position},h.lerpBodyPos=function(e){var i=this.body.position;return r.set(i),t.Vector2.lerp(this.lerpBodyPosLow,this.lerpBodyPosLow,r,this.lerpBodyPosLowRatio),t.Vector2.equalsZero(r,this._lerpBodyPos)||(t.Vector2.lerp(this._lerpBodyPos,this._lerpBodyPos,r,e*t._timer.dtSecond),t.Vector2.distance(r,this._lerpBodyPos)<.1&&(this.node.emit(this.EventType.LERP_POS_COMPLETE),this._lerpBodyPos.set(r))),this._lerpBodyPos},h.setBodyVelocity=function(t,e){this.body.velocity[0]=t,this.body.velocity[1]=e},h.setBodyPos=function(t,e){this.body.position[0]=t,this.body.position[1]=e,this._lerpBodyPos.x=t,this._lerpBodyPos.y=e,this.lerpBodyPosLow.x=t,this.lerpBodyPosLow.y=e},h.setBodyAngle=function(e){e=t.Maths.toRadian(e),this.body.angle=e},h.createContackMaterial=function(t){if(this.openMaterial){var e=new p2.ContactMaterial(t.shape.material,this.shape.material,{friction:this.materialFriction,frictionRelaxation:this.materialFrictionRelaxation,frictionStiffness:this.materialFrictionStiffness,relaxation:this.materialRelaxation,restitution:this.materialRestitution,stiffness:this.materialStiffness,surfaceVelocity:this.materialSurfaceVelocity});return e.contactSkinSize=this.materialContactSkinSize,e.comp=this,e}},l(s,[{key:"shapeType",get:function(){return this._shapeType},set:function(t){this._shapeType!=t&&(this._shapeType=t,this.updateNodeSize(),this.updateCCGraphics())}},{key:"heightfieldLength",get:function(){return this._heightfieldLength},set:function(t){this._heightfieldLength!=t&&(this._heightfieldLength=t,this.updateCCGraphics())}},{key:"heightfields",get:function(){return this._heightfields},set:function(t){this._heightfields=t,this.updateCCGraphics()}},{key:"lineLength",get:function(){return this._lineLength},set:function(t){this._lineLength!=t&&(this._lineLength=t,this.updateCCGraphics())}},{key:"circleRadius",get:function(){return this._circleRadius},set:function(t){this._circleRadius!=t&&(this._circleRadius=t,this.updateCCGraphics())}},{key:"circleLength",get:function(){return this._circleLength},set:function(t){this._circleLength!=t&&(this._circleLength=t,this.updateCCGraphics())}},{key:"boxSize",get:function(){return this._boxSize},set:function(t){this._boxSize.equals(t)||(this._boxSize.set(t),this.updateCCGraphics())}},{key:"poygonPoints",get:function(){return this._poygonPoints},set:function(t){this._poygonPoints=t,this.updateCCGraphics()}},{key:"shapeOffset",get:function(){return this._shapeOffset},set:function(t){this._shapeOffset.equals(t)||(this._shapeOffset.set(t),this.updateCCGraphics())}},{key:"useNodeSize",get:function(){return this._useNodeSize},set:function(t){this._useNodeSize!=t&&(this._useNodeSize=t,this.updateNodeSize(),this.updateCCGraphics())}}]),s}(t.BaseComponent);a.debug=!0,p([t.property({displayName:"质量(0静态)",min:0})],a.prototype,"mass",void 0),p([t.property({displayName:"触发器(无物理)"})],a.prototype,"trigger",void 0),p([t.property({displayName:"线性速度",visible:function(){return 0!=this.mass}})],a.prototype,"velocity",void 0),p([t.property({displayName:"世界重力倍数",visible:function(){return 0!=this.mass},min:0})],a.prototype,"velocityScale",void 0),p([t.property({displayName:"线性速度衰减系数(摩擦力)",range:[0,1,.001],slide:!0})],a.prototype,"damping",void 0),p([t.property({displayName:"固定x轴",visible:function(){return 0!=this.mass}})],a.prototype,"fixedX",void 0),p([t.property({displayName:"固定y轴",visible:function(){return 0!=this.mass}})],a.prototype,"fixedY",void 0),p([t.property({displayName:"固定角度",visible:function(){return 0!=this.mass}})],a.prototype,"fixedRotation",void 0),p([t.property({displayName:"角速度(旋转)",visible:function(){return 0!=this.mass&&!this.fixedRotation}})],a.prototype,"angularVelocity",void 0),p([t.property({displayName:"角速度衰减系数(摩擦力)",range:[0,1,.001],slide:!0})],a.prototype,"angularDamping",void 0),p([t.property({displayName:"编辑框颜色"})],a.prototype,"editorColor",void 0),p([t.property({displayName:"编辑框线宽"})],a.prototype,"editorLineWidth",void 0),p([t.property({displayName:"运行时显示线框"})],a.prototype,"runEditorShow",void 0),p([t.property({tooltip:"当有多个组件挂在相同节点时 方便区分"})],a.prototype,"tag",void 0),p([t.property({type:i,displayName:"碰撞器类型"})],a.prototype,"shapeType",null),p([t.property({displayName:"点间距",visible:function(){return this._shapeType==i.Heightfield}})],a.prototype,"heightfieldLength",null),p([t.property({type:t.CCFloat,displayName:"高度点",visible:function(){return this._shapeType==i.Heightfield}})],a.prototype,"heightfields",null),p([t.property({readonly:!0,displayName:"平面",visible:function(){return this._shapeType==i.Plane}})],a.prototype,"shapePanle",void 0),p([t.property({displayName:"X长度",visible:function(){return this._shapeType==i.Line}})],a.prototype,"lineLength",null),p([t.property({displayName:"半径",visible:function(){return this._shapeType==i.Circle}})],a.prototype,"circleRadius",null),p([t.property({displayName:"胶囊(x轴长度 宽>高)",visible:function(){return this._shapeType==i.Circle}})],a.prototype,"circleLength",null),p([t.property({displayName:"宽高",visible:function(){return this._shapeType==i.Box}})],a.prototype,"boxSize",null),p([t.property({type:[t.Vec2],displayName:"范围点",visible:function(){return this._shapeType==i.Polygon}})],a.prototype,"poygonPoints",null),p([t.property({displayName:"形状偏移",visible:function(){return this._shapeType!=i.None}})],a.prototype,"shapeOffset",null),p([t.property({displayName:"使用节点大小",visible:function(){return this._shapeType!=i.None&&this._shapeType!=i.Point&&this._shapeType!=i.Plane&&this._shapeType!=i.Heightfield}})],a.prototype,"useNodeSize",null),p([t.property({type:t.Node,displayName:"刚体位置偏移",visible:function(){return this._shapeType!=i.None}})],a.prototype,"bodyNodeOffset",void 0),p([t.property({type:t.Node,displayName:"同步节点位置",visible:function(){return this._shapeType!=i.None}})],a.prototype,"syncNodePosition",void 0),p([t.property({displayName:"同步节点位置插值",slide:!0,range:[0,1,.001],visible:function(){return this._shapeType!=i.None&&!!this.syncNodePosition}})],a.prototype,"syncNodePositionLerp",void 0),p([t.property({type:t.Node,displayName:"同步节点旋转",visible:function(){return this._shapeType!=i.None}})],a.prototype,"syncNodeAngle",void 0),p([t.property({tooltip:"接收其他材质属性",displayName:"接收材质",visible:function(){return this._shapeType!=i.None}})],a.prototype,"receiveMaterial",void 0),p([t.property({tooltip:"开启材质属性，接受材质(与当前绑定)",displayName:"开启材质",visible:function(){return this._shapeType!=i.None}})],a.prototype,"openMaterial",void 0),p([t.property({tooltip:"摩擦系数用于这两种材料的接触。\n \t\t摩擦力=1会使相关物体变得超级滑，摩擦力=0会使其变得不那么滑。\n \t\t大于1的摩擦系数将允许非常大的摩擦力，这可以方便地防止汽车轮胎在地面上打滑",displayName:"摩擦力",visible:function(){return this._shapeType!=i.None&&this.openMaterial}})],a.prototype,"materialFriction",void 0),p([t.property({tooltip:"由此产生的摩擦力的松弛。默认值应适用于大多数模拟",displayName:"摩擦松弛",visible:function(){return this._shapeType!=i.None&&this.openMaterial}})],a.prototype,"materialFrictionRelaxation",void 0),p([t.property({tooltip:"在大多数情况下，此属性的值应该是一个大数字。",displayName:"摩擦刚度",visible:function(){return this._shapeType!=i.None&&this.openMaterial}})],a.prototype,"materialFrictionStiffness",void 0),p([t.property({tooltip:"此ContactMaterial生成的所得ContactEquation的松弛",displayName:"松弛",visible:function(){return this._shapeType!=i.None&&this.openMaterial}})],a.prototype,"materialRelaxation",void 0),p([t.property({tooltip:"恢复，或“弹性”用于这两种材料的接触。\n \t\t恢复为0将不会反弹，而恢复为1将大致以与对象相同的速度反弹",displayName:"弹性",visible:function(){return this._shapeType!=i.None&&this.openMaterial}})],a.prototype,"materialRestitution",void 0),p([t.property({tooltip:"刚度越小，物体的穿透力越大，接触的作用更像弹簧，而不是接触力",displayName:"触点硬度",visible:function(){return this._shapeType!=i.None&&this.openMaterial}})],a.prototype,"materialStiffness",void 0),p([t.property({tooltip:"将为该材质添加曲面速度。\n \t\t如果身体A位于身体B的顶部，并且表面速度为正，身体A将向右滑动。",displayName:"曲面速度",visible:function(){return this._shapeType!=i.None&&this.openMaterial}})],a.prototype,"materialSurfaceVelocity",void 0),p([t.property({tooltip:"正值将使实体更多地相互渗透。在需要更持久的场景中非常有用，例如在堆叠时",displayName:"接触偏移大小",visible:function(){return this._shapeType!=i.None&&this.openMaterial}})],a.prototype,"materialContactSkinSize",void 0),p([t.property({serializable:!0})],a.prototype,"_shapeType",void 0),p([t.property({serializable:!0})],a.prototype,"_useNodeSize",void 0),p([t.property({serializable:!0})],a.prototype,"_circleRadius",void 0),p([t.property({serializable:!0})],a.prototype,"_lineLength",void 0),p([t.property({serializable:!0})],a.prototype,"_heightfieldLength",void 0),p([t.property({serializable:!0})],a.prototype,"_circleLength",void 0),p([t.property({serializable:!0})],a.prototype,"_boxSize",void 0),p([t.property({serializable:!0})],a.prototype,"_shapeOffset",void 0),p([t.property({serializable:!0})],a.prototype,"_poygonPoints",void 0),p([t.property({serializable:!0})],a.prototype,"_heightfields",void 0),a=e=p([t.ccclass("P2ShapeEditorCC"),t.executeInEditMode,t.menuP2("P2ShapeEditorCC")],a),t.P2ShapeEditorCC=a}(apeng||(apeng={})),function(t){var e;!function(t){t[t.None=0]="None",t[t.Revolute=1]="Revolute",t[t.Distance=2]="Distance",t[t.Gear=3]="Gear",t[t.Lock=4]="Lock",t[t.Prismatic=5]="Prismatic",t[t.SpringLinear=6]="SpringLinear",t[t.SpringRotate=7]="SpringRotate"}(e=t.EP2ConstraintType||(t.EP2ConstraintType={})),t.ccenum(e);var i=new t.Vector2,n=function(n){function r(){var i;return(i=n.apply(this,arguments)||this).backupDescribe="物理约束",i.shapeA=null,i.shapeB=null,i.collideConnected=!1,i.revolutePivot=null,i.distanceLength=0,i.gearAgnle=-1,i.gearBMul=1,i.lockOffsetAngle=0,i.lockOffsetPosition=new t.Vec2,i.prismaticBRotate=!1,i.prismaticMax=0,i.prismaticMin=0,i.springLength=0,i.springRotate=0,i.springStiffness=100,i.springDamping=.5,i._type=e.None,i.body=null,i}o(r,n);var a=r.prototype;return a.createBodyAfter=function(){},a.createBody=function(){if(this.body||!this.shapeA||!this.shapeB||this._type==e.None)return this.body;switch(this._type){case e.Revolute:if(this.revolutePivot){var n=t.Vector2.add(i,this.node.position,this.revolutePivot.position);this.body=new p2.RevoluteConstraint(this.shapeA.body,this.shapeB.body,this.constraintParam({worldPivot:[n.x,n.y]}))}break;case e.Distance:this.body=new p2.DistanceConstraint(this.shapeA.body,this.shapeB.body,this.constraintParam({distance:0!=this.distanceLength?this.distanceLength:void 0}));break;case e.Gear:this.body=new p2.GearConstraint(this.shapeA.body,this.shapeB.body,this.constraintParam({angle:-1!=this.gearAgnle?t.Maths.toRadian(this.gearAgnle):void 0,ratio:this.gearBMul}));break;case e.Lock:var o=void 0;0!=this.lockOffsetPosition.x&&0!=this.lockOffsetPosition.y&&(o=[this.lockOffsetPosition.x,this.lockOffsetPosition.y]),this.body=new p2.LockConstraint(this.shapeA.body,this.shapeB.body,this.constraintParam({localAngleB:0!=this.lockOffsetAngle?t.Maths.toRadian(this.lockOffsetAngle):void 0,localOffsetB:o}));break;case e.Prismatic:this.body=new p2.PrismaticConstraint(this.shapeA.body,this.shapeB.body,this.constraintParam({disableRotationalLock:this.prismaticBRotate,lowerLimit:this.prismaticMin,upperLimit:this.prismaticMax}));break;case e.SpringLinear:this.body=new p2.LinearSpring(this.shapeA.body,this.shapeB.body,this.springParam({restLength:0!=this.springLength?this.springLength:void 0}));break;case e.SpringRotate:this.body=new p2.RotationalSpring(this.shapeA.body,this.shapeB.body,this.springParam({restAngle:0!=this.springRotate?t.Maths.toRadian(this.springRotate):void 0}))}return this.body},a.constraintParam=function(t){var e=t;return e.collideConnected=this.collideConnected,e.wakeUpBodies=!0,e},a.springParam=function(t){var e=t;return e.stiffness=this.springStiffness,e.damping=this.springDamping,e.localAnchorA=[0,0],e.localAnchorB=[0,0],e},l(r,[{key:"type",get:function(){return this._type},set:function(t){this._type!=t&&(this._type=t)}},{key:"spring",get:function(){return this.body}},{key:"constraint",get:function(){return this.body}}]),r}(t.BaseComponent);p([t.property({tooltip:"需为子节点 shapeA.node.parent = this.node",type:t.P2ShapeEditorCC,displayName:"刚体A"})],n.prototype,"shapeA",void 0),p([t.property({tooltip:"需为子节点 shapeB.node.parent = this.node",type:t.P2ShapeEditorCC,displayName:"刚体B"})],n.prototype,"shapeB",void 0),p([t.property({type:e,displayName:"关节类型",visible:function(){return!!this.shapeA&&!!this.shapeB}})],n.prototype,"type",null),p([t.property({displayName:"相互产生物理",visible:function(){return!(this._type==e.SpringLinear||this._type==e.SpringRotate||this._type==e.None)}})],n.prototype,"collideConnected",void 0),p([t.property({type:t.Node,displayName:"瞄点",visible:function(){return!!this.shapeA&&!!this.shapeB&&this._type==e.Revolute}})],n.prototype,"revolutePivot",void 0),p([t.property({tooltip:"0自动计算距离",displayName:"距离(中心点)",visible:function(){return!!this.shapeA&&!!this.shapeB&&this._type==e.Distance}})],n.prototype,"distanceLength",void 0),p([t.property({tooltip:"-1使用当前，>0当前平均撑开或缩小",displayName:"夹角度数",visible:function(){return!!this.shapeA&&!!this.shapeB&&this._type==e.Gear}})],n.prototype,"gearAgnle",void 0),p([t.property({displayName:"B旋转倍数",visible:function(){return!!this.shapeA&&!!this.shapeB&&this._type==e.Gear}})],n.prototype,"gearBMul",void 0),p([t.property({displayName:"B角度偏移",visible:function(){return!!this.shapeA&&!!this.shapeB&&this._type==e.Lock}})],n.prototype,"lockOffsetAngle",void 0),p([t.property({displayName:"B位置偏移",visible:function(){return!!this.shapeA&&!!this.shapeB&&this._type==e.Lock}})],n.prototype,"lockOffsetPosition",void 0),p([t.property({displayName:"B可旋转",visible:function(){return!!this.shapeA&&!!this.shapeB&&this._type==e.Prismatic}})],n.prototype,"prismaticBRotate",void 0),p([t.property({displayName:"最大距离",visible:function(){return!!this.shapeA&&!!this.shapeB&&this._type==e.Prismatic}})],n.prototype,"prismaticMax",void 0),p([t.property({displayName:"最小距离",visible:function(){return!!this.shapeA&&!!this.shapeB&&this._type==e.Prismatic}})],n.prototype,"prismaticMin",void 0),p([t.property({tooltip:"弹簧的静止长度, 0使用AB的距离",displayName:"长度",visible:function(){return!!this.shapeA&&!!this.shapeB&&this._type==e.SpringLinear}})],n.prototype,"springLength",void 0),p([t.property({tooltip:"弹簧的静止长度, 0使用AB的旋转角度",displayName:"相对夹角",visible:function(){return!!this.shapeA&&!!this.shapeB&&this._type==e.SpringRotate}})],n.prototype,"springRotate",void 0),p([t.property({displayName:"硬度",visible:function(){return!(!this.shapeA||!this.shapeB||this._type!=e.SpringLinear&&this._type!=e.SpringRotate)}})],n.prototype,"springStiffness",void 0),p([t.property({displayName:"衰减速度",range:[0,1,.001],slide:!0,visible:function(){return!(!this.shapeA||!this.shapeB||this._type!=e.SpringLinear&&this._type!=e.SpringRotate)}})],n.prototype,"springDamping",void 0),p([t.property({serializable:!0})],n.prototype,"_type",void 0),n=p([t.ccclass("P2ConstraintEditorCC"),t.menuP2("P2ConstraintEditorCC")],n),t.P2ConstraintEditorCC=n}(apeng||(apeng={})),function(t){var e=function(){function e(t,e){this._enum=t,this.config=e,this.collider={types:{},masks:{}},this.parseCollider()}var i=e.prototype;return i.getGroup=function(t){return this.collider.types[t]},i.getMask=function(t){return this.collider.masks[t]||0},i.getShapeParam=function(t,e){var i=e;return i.collisionMask=this.getMask(t),i.collisionGroup=this.getGroup(t),e},i.parseCollider=function(){var e=this.collider.types,i=this.collider.masks;for(var n in t.JS.getEnumValue(this._enum,(function(t){e[t]=Math.pow(2,t)})),this.config){var o=Number(n),r=this.config[o];i[o]=0;for(var a,s=u(r);!(a=s()).done;){var l=a.value;i[o]|=e[l]}}},e}();t.P2Group=e}(apeng||(apeng={})),function(t){var e=function(){function e(t){var i=this;this.data=t,this.id=0,this._root=null,this.receiveMaterials=[],this.openMaterials=[],this.updateKey="",this.updateFps=1/30,e._idCounter++,this.id=e._idCounter,this.updateKey="P2World"+this.id,this.setFps(t.fps),this._root=new p2.World({gravity:t.gravity}),t.frictionGravity&&(this._root.frictionGravity=t.frictionGravity),this._root.useWorldGravityAsFrictionGravity=!1,this._root.useFrictionGravityOnZeroGravity=!1,this._root.emitImpactEvent=!1,this._root.sleepMode=p2.World.BODY_SLEEPING,void 0!==t.friction&&(this._root.defaultContactMaterial.friction=t.friction),void 0!==t.restitution&&(this._root.defaultContactMaterial.restitution=t.restitution),void 0!==t.relaxation&&(this._root.defaultContactMaterial.relaxation=t.relaxation),void 0!==t.stiffness&&(this._root.defaultContactMaterial.stiffness=t.stiffness),void 0!==t.frictionStuffness&&(this._root.defaultContactMaterial.frictionStuffness=t.frictionStuffness),void 0!==t.frictionRelaxation&&(this._root.defaultContactMaterial.frictionRelaxation=t.frictionRelaxation),void 0!==t.contactSkinSize&&(this._root.defaultContactMaterial.contactSkinSize=t.contactSkinSize),this._root.applySpringForces=t.isSpringForces,this._root.applyDamping=t.isDamping,this._root.applyGravity=t.isGravity,this._root.solveConstraints=t.isSolveConstraints,this._root.on(this._root.beginContactEvent.type,(function(t){var e=t.bodyA,n=t.bodyB;i.colliderCall(e,n),i.colliderCall(n,e)}))}var i=e.prototype;return i.onUpdate=function(){t._timer.hasUpdateIntervale(this.updateKey,this.updateFps,!0)&&this._root.step(t._timer.dt)},i.colliderCall=function(t,e){t.enterCollider&&t.enterCollider(e),t.enterOnceCollider&&(t.enterOnceCollider(e),t.enterOnceCollider=null),t.endCollider&&t.endCollider(e),t.endOnceCollider&&(t.endOnceCollider(e),t.endOnceCollider=null)},i.setFps=function(t){this.data.fps=t,this.updateFps=1/this.data.fps},i.aabbQuery=function(t,e,i){var n=this._root.broadphase.axisList;t.length=0;for(var o=0;o<n.length;o++){var r=n[o];i&&i(r)||r.aabb.overlaps(e)&&t.push(r)}return t},i.circleQuery=function(e,i,n){var o=this._root.broadphase.axisList;e.length=0;for(var r=0;r<o.length;r++){var a=o[r];if(!n||!n(a)){var s=a.aabb,l=s.lowerBound,u=s.upperBound;t.Circle.intersectAABB(i,l[0],l[1],u[0],u[1])&&e.push(a)}}return e},i.createBody=function(e,i){if(!e)return null;if(e.createBody(this.data.group,i),e.isCreateBody&&(e.receiveMaterial&&t.Sets.add(this.receiveMaterials,e),e.openMaterial&&t.Sets.add(this.openMaterials,e),e.receiveMaterial||e.openMaterial))for(var n,o=u(this.receiveMaterials);!(n=o()).done;)for(var r,a=n.value,s=a.openMaterials,l=function(){var e=r.value;t.Sets.filterValue(s,(function(t){return t.comp!=e}))||s.push(e.createContackMaterial(a))},h=u(this.openMaterials);!(r=h()).done;)l();return e.body},i.addBody=function(t){if(t&&t.body&&(this._root.addBody(t.body),t.isUpdate=!0,t.receiveMaterial))for(var e,i=u(t.openMaterials);!(e=i()).done;){var n=e.value;-1==this._root.contactMaterials.indexOf(n)&&this._root.addContactMaterial(n)}},i.removeBody=function(t){if(t&&t.body&&(t.body.endCollider=null,t.body.endOnceCollider=null,t.body.enterCollider=null,t.body.enterOnceCollider=null,this._root.removeBody(t.body),t.isUpdate=!1,t.receiveMaterial))for(var e,i=u(this.receiveMaterials);!(e=i()).done;){var n=e.value;this._root.removeContactMaterial(n)}},i.createConstraint=function(t,e,i){return t?(t.createBodyAfter(),this.createBody(t.shapeA,e),this.createBody(t.shapeB,i),t.createBody()):null},i.addConstraint=function(e){e&&e.body&&(this.addBody(e.shapeA),this.addBody(e.shapeB),e.type==t.EP2ConstraintType.SpringLinear||e.type==t.EP2ConstraintType.SpringRotate?this._root.addSpring(e.spring):this._root.addConstraint(e.constraint))},i.removeConstraint=function(e){e&&e.body&&(this.removeBody(e.shapeA),this.removeBody(e.shapeB),e.type==t.EP2ConstraintType.SpringLinear||e.type==t.EP2ConstraintType.SpringRotate?this._root.removeSpring(e.spring):this._root.removeConstraint(e.constraint))},i.createEditor=function(e,i){var n=e.getCacheComponent(t.P2ConstraintEditorCC),o=null;if(n)o=this.createConstraint(n,i,i);else{var r=e.getCacheComponent(t.P2ShapeEditorCC);r&&(o=this.createBody(r,i))}o&&(o._data_=e)},i.addEditor=function(e){var i=e.getCacheComponent(t.P2ConstraintEditorCC);if(i)this.addConstraint(i);else{var n=e.getCacheComponent(t.P2ShapeEditorCC);n&&this.addBody(n)}},i.removeEditor=function(e){var i=e.getCacheComponent(t.P2ConstraintEditorCC);if(i)this.removeConstraint(i);else{var n=e.getCacheComponent(t.P2ShapeEditorCC);n&&this.removeBody(n)}},e}();e._idCounter=0,t.P2World=e}(apeng||(apeng={})),function(t){var e=function(){function e(e,i,n){this.x=0,this.y=0,this.radius=0,this._position=new t.Vector2,this.set(e,i,n)}e.set=function(t,e,i,n){return e&&"object"==typeof e?(t.x=e.x,t.y=e.y,t.radius=e.radius||0):(t.x=e||0,t.y=i||0,t.radius=n||0),t},e.create=function(t,i,n){return new e(t,i,n)},e.clone=function(t){return new e(t)},e.contains=function(e,i){return t.Vector2.distance(e,i)<e.radius},e.intersectRect=function(t,i){e.intersectAABB(t,i.xMin,i.yMin,i.xMax,i.yMax)},e.intersectAABB=function(t,e,i,n,o){var r=t.radius,a=t.x,s=t.y,l=Math.abs,u=Math.min,h=u(l(e-a),l(n-a)),c=u(l(i-s),l(o-s));if(h*h+c*c<r*r)return!0;var p=(e+n)/2,d=(i+o)/2;return l(p-a)<l(n-e)/2+r&&l(s-d)<l(o-i)/2||l(d-s)<l(o-i)/2+r&&l(a-p)<l(n-e)/2},e.intersects=function(e,i){return t.Vector2.distance(e,i)<e.radius},e.mul=function(t,e,i){return t.set(e),t.radius*=i,t};var i=e.prototype;return i.set=function(t,i,n){return e.set(this,t,i,n),this},i.intersects=function(t){return e.intersects(this,t)},i.contains=function(t){return e.contains(this,t)},i.clone=function(){return e.clone(this)},i.mul=function(t,i){return e.mul(t,this,i)},i.mulSelf=function(t){return e.mul(this,this,t)},l(e,[{key:"position",get:function(){return this._position.set(this.x,this.y),this._position},set:function(t){this.x=t.x,this.y=t.y}}]),e}();e.TEMP=new e,t.Circle=e}(apeng||(apeng={})),function(t){var e=0,i=function(){};i.Bezier=new(function(){return function(){this.vec1=new(function(){function t(){}var i=t.prototype;return i.gets=function(t,i){var n=t.length;e=1-i;for(var o=0,r=0;r<n;r++){var a=n-r-1;o+=t[r]*Math.pow(e,a)*Math.pow(i,r)*this.erxiangshi(n-1,r)}return o},i.erxiangshi=function(t,e){for(var i=1,n=1;e>0;)i*=t,n*=e,t--,e--;return i/n},i.getControlByCurve=function(t,i,n,o){return(e=1-o)*e*t+2*o*e*n+o*o*i},i.getCurveByControl=function(t,i,n,o){return(n-(e=1-o)*e*t-o*o*i)/(2*o*e)},i.getControlByCurve3=function(t,i,n,o,r){return 0==t&&0==i?0:(e=1-r,Math.pow(e,3)*t+3*n*r*e*e+3*o*r*r*e+i*Math.pow(r,3))},i.getCurveByControl3=function(t,i,n,o,r){return e=1-r,(n-Math.pow(e,3)*t-3*e*r*r*o-i*Math.pow(r,3))/(3*e*e)},i.get3CurveByControl2=function(t,i,n,o,r){return e=1-r,(n-Math.pow(e,3)*t-3*e*e*o*r-i*Math.pow(r,3))/(3*Math.pow(e,3)*r*r)},t}()),this.vec2=new(function(){function t(){}var n=t.prototype;return n.gets=function(t,n,o){var r=n.length;e=1-o;for(var a=0;a<r;a++){var s=r-a-1,l=Math.pow(e,s)*Math.pow(o,a)*i.Bezier.vec1.erxiangshi(r-1,a);t.x+=n[a].x*l,t.y+=n[a].y*l}return t},n.getControlByCurve=function(t,e,n,o,r){return r.x=i.Bezier.vec1.getControlByCurve(t.x,e.x,n.x,o),r.y=i.Bezier.vec1.getControlByCurve(t.y,e.y,n.y,o),r},n.getCurveByControl=function(t,e,n,o,r){return r.x=i.Bezier.vec1.getCurveByControl(t.x,e.x,n.x,o),r.y=i.Bezier.vec1.getCurveByControl(t.y,e.y,n.y,o),r},n.getControlByCurve3=function(t,e,n,o,r,a){return a.x=i.Bezier.vec1.getControlByCurve3(t.x,e.x,n.x,o.x,r),a.y=i.Bezier.vec1.getControlByCurve3(t.y,e.y,n.y,o.y,r),a},n.getCurveByControl3=function(t,e,n,o,r,a){return a.x=i.Bezier.vec1.getCurveByControl3(t.x,e.x,n.x,o.x,r),a.y=i.Bezier.vec1.getCurveByControl3(t.y,e.y,n.y,o.y,r),a},t}()),this.vec3=new(function(){function t(){}var n=t.prototype;return n.gets=function(t,n,o){var r=n.length;e=1-o;for(var a=0;a<r;a++){var s=r-a-1,l=Math.pow(e,s)*Math.pow(o,a)*i.Bezier.vec1.erxiangshi(r-1,a);t.x+=n[a].x*l,t.y+=n[a].y*l,t.z+=n[a].z*l}return t},n.getControlByCurve=function(t,e,n,o,r){return r.x=i.Bezier.vec1.getControlByCurve(t.x,e.x,n.x,o),r.y=i.Bezier.vec1.getControlByCurve(t.y,e.y,n.y,o),r.z=i.Bezier.vec1.getControlByCurve(t.z,e.z,n.z,o),r},n.getCurveByControl=function(t,e,n,o,r){return r.x=i.Bezier.vec1.getCurveByControl(t.x,e.x,n.x,o),r.y=i.Bezier.vec1.getCurveByControl(t.y,e.y,n.y,o),r.z=i.Bezier.vec1.getCurveByControl(t.z,e.z,n.z,o),r},n.getControlByCurve3=function(t,e,n,o,r,a){return a.x=i.Bezier.vec1.getControlByCurve3(t.x,e.x,n.x,o.x,r),a.y=i.Bezier.vec1.getControlByCurve3(t.y,e.y,n.y,o.y,r),a.z=i.Bezier.vec1.getControlByCurve3(t.z,e.z,n.z,o.z,r),a},n.getCurveByControl3=function(t,e,n,o,r,a){return a.x=i.Bezier.vec1.getCurveByControl3(t.x,e.x,n.x,o.x,r),a.y=i.Bezier.vec1.getCurveByControl3(t.y,e.y,n.y,o.y,r),a.z=i.Bezier.vec1.getCurveByControl3(t.z,e.z,n.z,o.z,r),a},t}())}}()),i.Spline=new(function(){return function(){this.vec1=new(function(){function e(){}return e.prototype.get=function(e,i,n,o,r,a){var s=-1;if(1==a)s=3;else{var l=1/3;a=(a-l*(s=Math.floor(a/l)))/l}var u=[e,i,n,o],h=a*a,c=h*a,p=(1-r)/2;return(e=t.Sets.getAt(u,s-1))*(p*(2*h-c-a))+(i=t.Sets.getAt(u,s-0))*(p*(-c+h)+(2*c-3*h+1))+(n=t.Sets.getAt(u,s+1))*(p*(c-2*h+a)+(-2*c+3*h))+(o=t.Sets.getAt(u,s+2))*(p*(c-h))},e}()),this.vec2=new(function(){function t(){}return t.prototype.get=function(t,e,n,o,r,a,s){return s.x=i.Spline.vec1.get(t.x,e.x,n.x,o.x,r,a),s.y=i.Spline.vec1.get(t.y,e.y,n.y,o.y,r,a),s},t}()),this.vec3=new(function(){function t(){}return t.prototype.get=function(t,e,n,o,r,a,s){return s.x=i.Spline.vec1.get(t.x,e.x,n.x,o.x,r,a),s.y=i.Spline.vec1.get(t.y,e.y,n.y,o.y,r,a),s.z=i.Spline.vec1.get(t.z,e.z,n.z,o.z,r,a),s},t}())}}()),t.Curve=i}(apeng||(apeng={})),function(t){var e=function(e){function i(t,i,n,o,r,a){var s;return void 0===o&&(o=!1),(s=e.call(this)||this).ip=t,s.path=i,s.type=n,s.sendCreateHttp=o,s.encodeData=r,s.decodeData=a,s.http=null,s.isComplete=!0,s.data=null,s.header=null,s.sendTime=-1,s.version="",s}o(i,e);var n=i.prototype;return n.send=function(e,n){this.data=e,this.header=n,this.isComplete=!1,this.sendTime=t.Times.now,this.sendCreateHttp&&(this.http&&this.clearHttp(),this.http=null);var o=!1;this.http||(o=!0,this.http=new XMLHttpRequest),this.initHttp();var r=this.ip+"/"+this.path;if("GET"==this.type&&this.data){if(Array.isArray(this.data))throw new Error("网络请求参数不能为数组");if("GET"==this.type)if(r+="?","object"==typeof this.data){var a="";for(var s in e)a+=encodeURIComponent(s)+"="+encodeURIComponent(e[s])+"&";a.length>0&&(r+=a.substring(0,a.length-1))}else r+=this.data}if(this.http.open(this.type,r),o&&(this.http.setRequestHeader("Access-Control-Allow-Origin","*"),this.http.setRequestHeader("Content-Type","application/json")),this.version&&(this.http.setRequestHeader("start-Time",this.sendTime+""),this.http.setRequestHeader("version",this.version)),this.header)for(var l in this.header)this.http.setRequestHeader(l,this.header[l]);if(this.data&&"POST"==this.type){if("object"!=typeof this.data)throw new Error("POST网络请求参数必须为对象");var u=this.encodeData?this.encodeData(this.data):JSON.stringify(this.data);this.http.send(u),console.log("request start: "+r)}else this.http.send(),console.log("request start: "+r);this.emit(i.EventType.START)},n.reSend=function(){this.send(this.data,this.header)},n.error=function(t){if(this.clearHttp(),console.log("request error: "+this.ip+"/"+this.path+", data:"+t),0!==this.status){for(var e,n=u(this.emit(i.EventType.HAS_ERROR,t));!(e=n()).done;){if(!e.value)return}this.emit(i.EventType.ERROR,t)}else this.emit(i.EventType.NONE,t)},n.complete=function(){if(!this.isComplete){this.isComplete=!0,this.clearHttp();var t=null;if(this.http.responseText){try{t=this.decodeData?this.decodeData(this.http.responseText):JSON.parse(this.http.responseText)}catch(e){console.log("数据解析失败:",e),t=null,this.error("json error [responseText]")}if(t){for(var e,n=u(this.emit(i.EventType.HAS_COMPLETE,t));!(e=n()).done;){if(!e.value)return}console.log("request complete: ",this.ip+"/"+this.path),this.emit(i.EventType.COMPLETE,t),this.emit(i.EventType.COMPLETE2,t)}}else this.error("json error [responseText none]")}},n.dispose=function(){this.clearEvent(),this.clearHttp(),this.isComplete=!0,this.data=null,this.http=null},n.clearHttp=function(){this.http.onerror=null,this.http.onabort=null,this.http.onprogress=null,this.http.ontimeout=null,this.http.onload=null,this.http.onreadystatechange=null},n.initHttp=function(){var t=this;this.http.timeout=5e3,this.http.onerror=function(e){t.error("error status["+t.status+"]")},this.http.onabort=function(e){t.error("abort status["+t.status+"]")},this.http.onprogress=function(e){e&&e.lengthComputable&&t.emit(i.EventType.PROGRESS,e.loaded/e.total)},this.http.onload=function(e){200===t.status||204===t.status||0===t.status||void 0===t.status?t.complete():t.error("load status["+t.status+"]")},this.http.ontimeout=function(e){t.error("timeout status["+t.status+"]")},this.http.onreadystatechange=function(){4===t.http.readyState&&t.status>=200&&t.status<300&&t.complete()}},l(i,[{key:"status",get:function(){return this.http.status}}]),i}(t.EventDispatcher);e.EventType={PROGRESS:"PROGRESS",ERROR:"ERROR",COMPLETE:"COMPLETE",COMPLETE2:"COMPLETE2",HAS_COMPLETE:"HAS_COMPLETE",HAS_ERROR:"HAS_ERROR",START:"START",NONE:"NONE"},t.HttpRequest=e}(apeng||(apeng={})),function(t){var e=function(){function t(){this.datas=null,this.isAnim=!1,this.cb=null,this.loopCb=null,this.loop=0,this.loopCur=0,this.curIndex=0,this._dt=0}var e=t.prototype;return e.init=function(t,e,i){this.datas=t,this.cb=e,this.loopCb=i},e.run=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.isAnim=!0,this.loop=t,this.curIndex=e,this._dt=0,this.loopCur=0,this.cb(this.curIndex,this.loopCur)},e.stop=function(){this.isAnim=!1},e.onUpdate=function(t){if(this.isAnim){this._dt+=t;var e=this.datas[this.curIndex];this._dt>=e&&(this._dt=0,this.curIndex=(this.curIndex+1)%this.datas.length,this.cb(this.curIndex,this.loopCur),this.loop>0&&0==this.curIndex&&(this.loopCur++,this.loopCur>=this.loop&&(this.isAnim=!1,this.loopCb())))}},t}();t.IntervalAnim=e}(apeng||(apeng={})),function(t){var e=function(){function e(){this.node=null,this.start=new t.Vector2,this.position=new t.Vector2,this.duration=0,this.height=0,this.jumps=0,this.easeType=t.EEaseType.linear,this.isAnim=!1,this._dt=0}var i=e.prototype;return i.init=function(t){this.node=t},i.run=function(e,i,n,o,r){void 0===r&&(r=t.EEaseType.linear),this.position.x=e.x,this.position.y=e.y,this.duration=i,this.height=n,this.jumps=o,this.easeType=r,this.isAnim=!0,this._dt=0,this.start.set(this.node.position)},i.onUpdate=function(e){if(this.isAnim){this._dt+=e;var i=this._dt/this.duration;(i=t.easing(this.easeType,i))>=1&&(this.isAnim=!1,i=1);var n=i*this.jumps%1,o=4*this.height*n*(1-n);o+=this.position.y*i;var r=this.position.x*i;this.node.setPosition(r+this.start.x,o+this.start.y)}},e}();t.JumpBy=e}(apeng||(apeng={})),function(t){var e=new t.Vector2,i=function(){function i(){}return i.getDot=function(e,i,n,o){for(var r=t.Vector2.polygonByCenterPoint(new t.Vector2,e),a=new t.Vector2,s=i.normalize(new t.Vector2),l=s.mul(new t.Vector2,o).addSelf(r),u=0,h=e.length;u<h;++u){var c=e[u],p=e[(u+1)%h];if(this.lineLine(c,p,r,l)){var d=this.pointLineDistance(r,c,p,!0);a.set(s).mulSelf(d*n).addSelf(r);break}}return a},i.elliptic=function(e,i){var n=Math.min(e.width,e.height),o=e.center;if(t.Rectangle.TEMP.width=n,t.Rectangle.TEMP.height=n,t.Rectangle.TEMP.center=o,this.rectCircle(t.Rectangle.TEMP,i))return!0;var r=n/2;if(t.Circle.TEMP.radius=r,e.width>e.height){if(t.Circle.TEMP.x=e.xMin+r,t.Circle.TEMP.y=o.y,t.Circle.TEMP.intersects(i))return!0;if(t.Circle.TEMP.x=e.xMax-r,t.Circle.TEMP.intersects(i))return!0}else{if(t.Circle.TEMP.x=o.x,t.Circle.TEMP.y=e.yMin+r,t.Circle.TEMP.intersects(i))return!0;if(t.Circle.TEMP.y=e.yMax-r,t.Circle.TEMP.intersects(i))return!0}return!1},i.rectCircle=function(t,e){return this.polygonCircle(t.polygon(),e)},i.oneLineLine=function(t,e,i,n){return!(e<i||t>n)},i.lineLine=function(t,e,i,n){if(!(t&&e&&i&&n))return!1;var o=(n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x),r=(e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x),a=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);if(0!==a){var s=o/a,l=r/a;return 0<=s&&s<=1&&0<=l&&l<=1}return!1},i.lineRect=function(t,e,i){if(!t||!e||!i)return!1;var n=i.polygon(),o=n[0],r=n[1],a=n[2],s=n[3];return!!this.lineLine(t,e,o,r)||(!!this.lineLine(t,e,r,a)||(!!this.lineLine(t,e,a,s)||!!this.lineLine(t,e,s,o)))},i.linePolygon=function(t,e,i){if(!t||!e||!i)return!1;for(var n=0,o=i.length;n<o;++n){var r=i[n],a=i[(n+1)%o];if(this.lineLine(t,e,r,a))return!0}return!1},i.rectPolygon=function(t,e){if(!t||!e)return!1;var i,n,o=t.polygon(),r=o[0],a=o[1],s=o[2],l=o[3];if(this.linePolygon(r,a,e))return!0;if(this.linePolygon(a,s,e))return!0;if(this.linePolygon(s,l,e))return!0;if(this.linePolygon(l,r,e))return!0;for(i=0,n=e.length;i<n;++i)if(t.contains(e[i]))return!0;return!!this.pointInPolygon(r,e)||(!!this.pointInPolygon(a,e)||(!!this.pointInPolygon(s,e)||!!this.pointInPolygon(l,e)))},i.polygonPolygon=function(t,e){if(!t||!e)return!1;var i,n;for(i=0,n=t.length;i<n;++i){var o=t[i],r=t[(i+1)%n];if(this.linePolygon(o,r,e))return!0}for(i=0,n=e.length;i<n;++i)if(this.pointInPolygon(e[i],t))return!0;for(i=0,n=t.length;i<n;++i)if(this.pointInPolygon(t[i],e))return!0;return!1},i.polygonCircle=function(t,e){if(!t||!e)return!1;var i=e.position;if(this.pointInPolygon(i,t))return!0;for(var n=0,o=t.length;n<o;n++){var r=0===n?t[t.length-1]:t[n-1],a=t[n];if(this.pointLineDistance(i,r,a,!0)<e.radius)return!0}return!1},i.lineCircle=function(t,e,i){return!!i.contains(t)||(!!i.contains(e)||this.pointLineDistance(i.position,t,e,!0)<i.radius)},i.pointInPolygon=function(t,e){if(!t||!e)return!1;for(var i=!1,n=t.x,o=t.y,r=e.length,a=0,s=r-1;a<r;s=a++){var l=e[a].x,u=e[a].y,h=e[s].x,c=e[s].y;u>o!=c>o&&n<(h-l)*(o-u)/(c-u)+l&&(i=!i)}return i},i.pointLineDistance=function(t,i,n,o){if(!t||!i||!n)return 0;var r=n.x-i.x,a=n.y-i.y,s=r*r+a*a,l=((t.x-i.x)*r+(t.y-i.y)*a)/s;return o?s?l<0?e.set(i):l>1?e.set(n):e.set(i.x+l*r,i.y+l*a):e.set(i):e.set(i.x+l*r,i.y+l*a),r=t.x-e.x,a=t.y-e.y,Math.sqrt(r*r+a*a)},i.rectByAngle=function(t,e){return this.polygonPolygon(t.angleCenter(),e.angleCenter())},i}();t.Polygon=i}(apeng||(apeng={})),function(t){var e=function(){function t(t){this.ratio=0,this.ratioAll={},this.progressLength=0,this.onProgress=null,this.onProgress=t,this.onProgress&&this.onProgress(0)}var e=t.prototype;return e.progress=function(t){var e=this;null==this.ratioAll[t]&&this.progressLength++;var i=function(i,n){null!=n&&(i/=n),e.ratioAll[t]=i;var o=0;for(var r in e.ratioAll)o+=e.ratioAll[r];e.ratio=o/e.progressLength,e.onProgress&&e.onProgress(e.ratio)};return i(0),i},e.getCurRatio=function(){return this.ratio},t}();t.ProgressDir=e}(apeng||(apeng={})),function(t){var e=function(){function t(){this._data=-1,this.id=-1}var e=t.prototype;return e.init=function(t){return this._data=t,this.id=t,this},e.clear=function(){return this._data=this.id,this},e.run=function(){return this._data=(9301*this._data+49297)%233280,this._data/233280},t}();e.pool=new t.PoolOnce(1e5,(function(){return new e}),(function(t){return t.clear()})),t.RandomSeed=e}(apeng||(apeng={})),function(t){var e=function(e){function i(t,i){var n;return(n=e.call(this)||this).setAngle=t,n.getAngle=i,n._start=0,n._move=0,n._moveCur=0,n.isAnim=!1,n.lerpRatio=-1,n}o(i,e);var n=i.prototype;return n.lerpRun=function(e,i,n){var o=this.getAngle();if(e!=o){this._move=0,this._moveCur=0,this.isAnim=!0,this.lerpRatio=i,void 0!==n&&this.setAngle(n),this._start=t.Maths.normalizeAngle(o),e=t.Maths.normalizeAngle(e);var r=this._start-e,a=Math.abs(r);a>180?(this._move=360-a,r<0&&(this._move*=-1)):this._move=-r,this.emit(t.ScaleAnim.EventType.START)}},n.stop=function(t){this.isAnim=!1,void 0!==t&&this.setAngle(t)},n.onUpdate=function(){this.isAnim&&(this._moveCur=t.Maths.lerp(this._moveCur,this._move,this.lerpRatio),Math.abs(this._moveCur-this._move)<.01&&(this._moveCur=this._move),this.setAngle(this._start+this._moveCur),this._moveCur==this._move&&(this.isAnim=!1,this.emit(t.ScaleAnim.EventType.COMPLETE)))},i}(t.EventDispatcher);e.EventType={START:"START",COMPLETE:"COMPLETE"},t.Rotate360Anim=e}(apeng||(apeng={})),function(t){var e=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).node=null,i._to=new t.Vector3,i.isAnim=!1,i.lerpRatio=-1,i}o(i,e);var n=i.prototype;return n.init=function(t){this.node=t},n.lerpRun=function(e,n,o){this._to.set(e),this.isAnim=!0,this.lerpRatio=n,o&&t.NodeHelper.setScale(this.node,o,!1),this.emit(i.EventType.START)},n.stop=function(e){this.isAnim=!1,e&&t.NodeHelper.setScale(this.node,e,!1)},n.onUpdate=function(){this.isAnim&&t.NodeHelper.lerpScaleTarget(this.node,this._to,this.lerpRatio,!1)&&(t.NodeHelper.setScale(this.node,this._to,!1),this.isAnim=!1,this.emit(i.EventType.COMPLETE))},i}(t.EventDispatcher);e.EventType={START:"START",COMPLETE:"COMPLETE"},t.ScaleAnim=e}(apeng||(apeng={})),function(t){var e=[],i=function(t){function i(e){var i;if((i=t.call(this)||this).data=null,i.state=null,i.lastState=null,i._saveState=null,i._saveLastState=null,i.states={},i.logPrefix="",i.caller=null,i.enum=null,i.update=null,i.isUpdate=!0,!e)return n(i);if(null!=e._enum&&(i.enum=e._enum),null!=e.caller&&(i.caller=e.caller),null!=e.logPrefix&&(i.logPrefix=e.logPrefix),null!=e.update&&(i.update=e.update),null!=e.states)for(var o,r=u(e.states);!(o=r()).done;){var a=o.value;i.addState(a)}return null!=e.state&&(i.state=e.state),i}o(i,t);var r=i.prototype;return r.addState=function(t){var e=t.type;return this.states[e]?console.error("stateMackine add: "+e):this.states[e]=t,this},r.getState=function(t){return this.states[t]},r.getCurState=function(){return this.getState(this.state)},r.clear=function(){this.logPrefix&&console.log("stateMackine clear: ",this.converEnumK()),this.state=null,this.states={},this.caller=null,this.logPrefix="",this.enum=null,this.update=null,this.isUpdate=!0,this.emit(i.EventType.CLEAR)},r.change=function(t,e,i,n){void 0===i&&(i=!0),void 0===n&&(n=!0),n&&this.state===t||(i&&this.onExit(e),this.lastState=this.state,this.state=t,i&&this.onEnter(e))},r.onUpdate=function(){if(this.isUpdate&&this.isValid(this.state)){var t=this.getCurState();t&&(t.onUpdate&&t.onUpdate.call(this.caller),this.update&&this.update())}},r.converEnumK=function(){return this.logPrefix+(this.enum?this.enum[this.state]:this.state)},r.isValid=function(t){return null!=t&&null!=t&&!1!==t},r.onEnter=function(t){if(this.isValid(this.state)){this.logPrefix&&console.log("stateMackine enter: ",this.converEnumK());var n=this.getCurState();n&&(n.isLog&&console.log("stateMackine enter by isLog: ",this.converEnumK()),t||(t=e),this.emit.apply(this,[i.EventType.ENTER_BEFORE].concat(t)),n.onEnter&&n.onEnter.apply(this.caller,t),this.emit.apply(this,[i.EventType.ENTER_AFTER].concat(t)),this.emit.apply(this,[i.EventType.ENTER_AFTER2].concat(t)))}},r.onExit=function(t){if(null!=this.state&&this.isValid(this.state)){var n=this.getCurState();n&&(t||(t=e),this.emit.apply(this,[i.EventType.EXIT_BEFORE].concat(t)),n.onExit&&n.onExit.apply(this.caller,t),this.emit.apply(this,[i.EventType.EXIT_AFTER].concat(t)))}},i}(t.EventDispatcher);i.EventType={ENTER_BEFORE:"ENTER_BEFORE",ENTER_AFTER:"ENTER_AFTER",ENTER_AFTER2:"ENTER_AFTER2",EXIT_BEFORE:"EXIT_BEFORE",EXIT_AFTER:"EXIT_AFTER",CLEAR:"CLEAR"},t.StateMackine=i}(apeng||(apeng={})),function(t){var e=["，","。","；","！","：","【","】","…","？","“","”","—","·","、","《","》","（","）","￥","＠"],i=function(){function t(){}return t.indexOf=function(t,e,i){return void 0===i&&(i=0),t.indexOf(e,i)},t.lastIndexOf=function(t,e){var i=this.indexOf(t,e);return-1==i?-1:i+e.length},t.after=function(t,e){return t.substring(0,this.indexOf(t,e))},t.last=function(t,e){return t.substring(this.lastIndexOf(t,e))},t.converText=function(e){return{after:t.after(e,"{"),last:t.last(e,"}")}},t.chinaLength=function(t){for(var i=[],n=0;n<e.length;n++)i.push(e[n].charCodeAt(0));for(var o=0,r=0;r<t.length;r++){var a=t.charCodeAt(r);a>=1&&a<=126||65376<=a&&a<=65439?o++:(i.indexOf(a),o+=2)}return o},t.chinaSub=function(t,i){for(var n=[],o=0;o<e.length;o++)n.push(e[o].charCodeAt(0));for(var r="",a=0;a<t.length;a++){var s=t.charCodeAt(a);r+=t[a];if((i-=s>=1&&s<=126||65376<=s&&s<=65439?1:(n.indexOf(s),2))<=0)break}return r},t.blur=function(t,e){for(var i="",n=0;n<e;n++)i+="*";return t.substr(0,t.length-e)+i},t.replace=function(t,e,i,n){},t.createCodeByKey=function(t){for(var e,i=[],n=u((t+"").split(""));!(e=n()).done;){var o=e.value,r=Number(o);-1==i.indexOf(r)&&i.push(r)}for(var a=0;a<10;a++)-1==i.indexOf(a)&&i.push(a);return"AECDHFIJKLQMNOBPRXSTUVZWYG"+i.join("")},t.encode=function(t,e){if(!e)return t;for(var i,n,o,r=(e=this.createCodeByKey(e)).length,a=e.split(""),s="",l=0,u=t.length;l<u;l++)s+=a[(i=((i=((i=t.charCodeAt(l))-(n=i%r))/r)-(o=i%r))/r)%r]+a[o]+a[n];return s},t.decode=function(t,e){if(!e)return t;var i,n,o,r,a,s=(e=this.createCodeByKey(e)).length,l=0;i=Math.floor(t.length/3),a=new Array(i);for(var u=0;u<i;u++)n=e.indexOf(t.charAt(l)),l++,o=e.indexOf(t.charAt(l)),l++,r=e.indexOf(t.charAt(l)),l++,a[u]=n*s*s+o*s+r;return i=String.fromCharCode.apply(String,a)},t.compress=function(t){for(var e="",i=new Array,n=0;n<128;n++)i[n]=n;for(var o=128,r=0,a=0,s=0,l=0,u=0,h=0;h<t.length;h++)null!=i[u=s<<8|(l=t.charCodeAt(h))]?s=i[u]:(a<<=12,a|=s,s=l,(r+=12)>=16&&(e+=String.fromCharCode(a>>r-16),a&=Math.pow(2,r-16)-1,r-=16),o<4096&&(o++,i[u]=o-1));return 0!=s&&(r+=12,a<<=12,a|=s),r>=16&&(e+=String.fromCharCode(a>>r-16),a&=Math.pow(2,r-16)-1,r-=16),r>0&&(a<<=16-r,e+=String.fromCharCode(a)),e},t.decompress=function(t){for(var e="",i=new Array,n=0;n<128;n++)i[n]=String.fromCharCode(n);for(var o=128,r=0,a=0,s=0,l=0,u=0,h=0;h<t.length;h++)for(r+=16,a<<=16,a|=t.charCodeAt(h);r>=12;)void 0!==(u=i[s=a>>r-12])?(e+=u,o>128&&(i[i.length]=i[l]+u.substr(0,1)),l=s):(e+=u=i[l]+i[l].substr(0,1),i[i.length]=i[l]+u.substr(0,1),l=i.length-1),o++,r-=12,a&=Math.pow(2,r)-1;return e},t}();t.Strings=i}(apeng||(apeng={})),function(t){var e=new Date,i=function(){function i(t){this.time=0,this.time=t||i.now}i.getDayOfYear=function(t){e.setTime(t);var i=e.getFullYear().toString(),n=t-new Date(i).getTime();return Math.ceil(n/864e5)+1},i.toLocaleString=function(t,n,o){return void 0===n&&(n=!0),void 0===o&&(o=" "),t||(t=i.now),e.setTime(t),e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+(n?o+this.numHour(t,!0):"")},i.toLocaleStringChina=function(t){return t||(t=i.now),e.setTime(t),e.getFullYear()+i.texts[10001]+(e.getMonth()+1)+i.texts[10002]+e.getDate()+i.texts[10003]+" "+this.numHour(t,!0)},i.getMonthOfYear=function(t){return t||(t=i.now),e.setTime(t),e.getMonth()+1},i.getDayOfMonth=function(t){return t||(t=i.now),e.setTime(t),e.getDate()},i.console=function(t){i._console[t]=i.now},i.consoleEnd=function(t){for(var e,n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];(e=console).log.apply(e,[t,(i.now-(i._console[t]||i.now))/1e3].concat(o))},i.getMontyByDay=function(){var t=i.Date,e=t.getFullYear(),n=t.getMonth()+1;return new Date(e,n,0).getDate()},i.day=function(t){return Math.floor((i.hour(t)+8)/24)},i.hour=function(t){return Math.floor(i.minute(t)/60)},i.minute=function(t){return Math.floor(i.second(t)/60)},i.second=function(e){return null!=e&&null!=e?Math.floor(e/1e3):t._timer?(t._timer.dirtyMark("Times.second")&&(e=i.now,i._secondCache=Math.floor(e/1e3)),i._secondCache):Math.floor(i.now/1e3)},i.numHour=function(t,e){void 0===e&&(e=!1);var n=i.converMinTen(i.second(t)%60)+"";return n=i.second(t)>=60?i.converMinTen(i.minute(t)%60)+":"+n:"00:"+n,i.minute(t)>=60?n=i.converMinTen((i.hour(t)+8)%24)+":"+n:e&&(n="00:"+n),n},i.dayByHour=function(t){return(i.hour(t)+8)%24},i.numHourCountDown=function(t,e){if(void 0===e&&(e=!1),t&&t<=0)return e?"00:00:00":"00:00";var n=i.converMinTen(i.second(t)%60)+"";return n=i.second(t)>=60?i.converMinTen(i.minute(t)%60)+":"+n:"00:"+n,i.minute(t)>=60?n=i.converMinTen(i.hour(t))+":"+n:e&&(n="00:"+n),n},i.chinaHourCountDown=function(t,e){if(void 0===e&&(e=!1),t&&t<=0)return e?"0"+i.texts[10004]+"0"+i.texts[10006]+"0"+i.texts[10007]:"0"+i.texts[10006]+"0"+i.texts[10007];var n=i.converMinTen(i.second(t)%60)+i.texts[10007];return n=i.second(t)>=60?i.converMinTen(i.minute(t)%60)+i.texts[10006]+n:"0分"+n,i.minute(t)>=60?n=i.converMinTen(i.hour(t))+i.texts[10004]+n:e&&(n="0"+i.texts[10004]+n),n},i.numMinute=function(t){var e=i.converMinTen(i.second(t)%60)+"";return e=i.second(t)>=60?i.converMinTen(i.minute(t))+":"+e:"00:"+e},i.numSecond=function(t){return i.converMinTen(i.second(t))},i.chinaHour=function(t){var e;return e=i.converMinTen(i.second(t)%60)+i.texts[10007],i.second(t)>=60&&(e=i.converMinTen(i.minute(t)%60)+i.texts[10006]+e),i.minute(t)>=60&&(e=i.converMinTen(i.hour(t)%24)+i.texts[10005]+e),e},i.numHourAndMinute=function(t){var e=i.converMinTen(i.minute(t)%60)+":00";return i.minute(t)>=60&&(e=i.converMinTen(i.hour(t)%24)+":"+e),e},i.chinaHourAndMinute=function(t){var e;return e=i.converMinTen(i.minute(t)%60)+i.texts[10006],i.minute(t)>=60&&(e=i.converMinTen(i.hour(t)%24)+i.texts[10005]+e),e},i.chinaMinute=function(t){var e;return e=i.converMinTen(i.second(t)%60)+i.texts[10007],i.second(t)>=60&&(e=i.converMinTen(i.minute(t)%60)+i.texts[10006]+e),e},i.chinaSecond=function(t){return i.converMinTen(i.second(t))+i.texts[10007]},i.converMinTen=function(t){return t<10?"0"+t:t.toString()},i.getToDayNow=function(){var t=i.now,e=i.second(t)%60*1e3;return i.second(t)>=60&&(e+=i.minute(t)%60*60*1e3),i.minute(t)>=60&&(e+=(i.hour(t)+8)%24*60*60*1e3),e},i.getToDayLeave=function(){return i.dayOnce-i.getToDayNow()},i.getToNowDay=function(t){return i.day(i.now-t)},i.getOneDayLeftTime=function(){var t=i.numHour(i.now).split(":");return 60*(23-Number(t[0]))*60+60*(59-Number(t[1]))+(59-Number(t[2]))},i.getWeekOfTheYear=function(){e.setTime(i.now);var t=e,n=new Date(t.getFullYear(),0,1),o=n.getDay(),r=1;0!=o&&(r=7-o+1),n=new Date(t.getFullYear(),0,1+r);var a=Math.ceil((t.valueOf()-n.valueOf())/864e5);return Math.ceil(a/7)+1},i.getDayOfTheYear=function(t){e.setTime(t);var i=e,n=new Date(i.getFullYear(),0,1);return Math.ceil((i.valueOf()-n.valueOf())/864e5)};var n=i.prototype;return n.add=function(t){return this.time+=t,this},n.sub=function(t){return this.time-=t,this},n.converMinTen=function(){return i.converMinTen(this.time)},l(i,[{key:"now",get:function(){return this.time}},{key:"day",get:function(){return Math.floor(this.hour/24)}},{key:"hour",get:function(){return Math.floor(this.minute/60)}},{key:"minute",get:function(){return Math.floor(this.second/60)}},{key:"second",get:function(){return Math.floor(this.time/1e3)}},{key:"numHour",get:function(){return i.numHour(this.time)}},{key:"numMinute",get:function(){return i.numMinute(this.time)}},{key:"numSecond",get:function(){return i.numSecond(this.time)}},{key:"chinaHour",get:function(){return i.chinaHour(this.time)}},{key:"chinaMinute",get:function(){return i.chinaMinute(this.time)}},{key:"chinaSecond",get:function(){return i.chinaSecond(this.time)}}],[{key:"now",get:function(){return Date.now()}},{key:"Date",get:function(){var t=new Date;return t.setTime(i.now),t}}]),i}();i.texts={10001:"年",10002:"月",10003:"日",10004:"小时",10005:"时",10006:"分",10007:"秒"},i.dayOnce=864e5,i._console={},i._secondCache=i.now,t.Times=i}(apeng||(apeng={})),t("default",r.exports)}),{})}}}));

System.register("chunks:///_virtual/apeng.mjs_cjs=&original=.js",["./apeng.js","./cjs-loader.mjs"],(function(e,t){var a,r;return{setters:[function(t){a=t.__cjsMetaURL;var r={};r.__cjsMetaURL=t.__cjsMetaURL,r.default=t.default,e(r)},function(e){r=e.default}],execute:function(){a||r.throwInvalidWrapper("./apeng.js",t.meta.url),r.require(a)}}}));

System.register("chunks:///_virtual/GameTypeDefine.ts",["cc","./Main.ts"],(function(e){var n,t;return{setters:[function(e){n=e.cclegacy},function(e){t=e.ModuleMgr}],execute:function(){n._RF.push({},"bfa203YCe5NMKDoUYvwCYRQ","GameTypeDefine",void 0);e("EGameType",function(e){return e[e.none=0]="none",e[e.index=1]="index",e[e.level=2]="level",e[e.today=3]="today",e[e.shape=4]="shape",e[e.customEditor=5]="customEditor",e[e.custom=6]="custom",e}({})),e("gameTypeModule",new t),e("gameTypeLogicModule",new t);n._RF.pop()}}}));

System.register("chunks:///_virtual/GameTypeModule.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Main.ts","./GameTypeDefine.ts","./LogicDefine.ts"],(function(e){var t,n,i,o,r,s,u,c,a,p,l,h,f,C,y,m,R,_,d,g,v,E,T;return{setters:[function(e){t=e.inheritsLoose,n=e.createClass,i=e.createForOfIteratorHelperLoose},function(e){o=e.cclegacy,r=e.Prefab},function(e){s=e.moduleMgr,u=e.EModuleType,c=e._prop,a=e.Maths,p=e._platform,l=e._timer,h=e._resouces,f=e._ui,C=e.EUILayer,y=e._main,m=e.RandomSeed,R=e.CompleteCallBack,_=e._config_,d=e._scene,g=e.BaseModuleEvent},function(e){v=e.gameTypeModule,E=e.EGameType},function(e){T=e.CSceneData}],execute:function(){var L;o._RF.push({},"f3cb8+2THBLvILo3RYEEJZ5","GameTypeModule",void 0);e("GameTypeModule",s.add(u.gameType)(L=function(e){function o(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).EventType={PLAY_ANIM:"PLAY_ANIM",RESET:"RESET",EXIT:"EXIT",NEXT:"NEXT"},t.curRandom=new m,t.type=E.none,t.isRun=!1,t._runComplete=new R,t.testSuccess=!1,t.propCount={},t}t(o,e);var s=o.prototype;return s.onCreate=function(){v.instance(!0)},s.onLogic=function(){var e=this;c.on(c.EventType.PROP_SUB,(function(t){e.propCount[t]>0&&(e.propCount[t]--,c.emit(c.EventType.PROP_CHANGE))}))},s.setPropCount=function(e,t){this.propCount[e]=t,c.emit(c.EventType.PROP_CHANGE)},s.logicRun=function(e,t,n){var i=this;(void 0===e||e<0)&&(e=a.zeroToMax(1e6)),this.curRandom.init(e),p._record_.start(),this.isRun=!1,t(),this._runComplete.set((function(e){p._record_.stop(),i.isRun=!1,l.clear(i,i._runCheckComplete2),l.clear(i,i._runCheckComplete),n(e)})),this.scene.create(),l.loop(this,this._runCheckComplete2,1,-1,-1),this.isRun=!0},s._runCheckComplete=function(e){if(void 0===e&&(e=!0),(!e||this.isRun)&&this.scene.isLoadComplete){var t=v.get(this.type);t&&t.checkComplete&&t.checkComplete()}},s._runCheckComplete2=function(){this._runCheckComplete()},s.callLaterCheckComplete=function(){l.callLater(this,this._runCheckComplete)},s.runComplete=function(e){this._runComplete.run(e)},s.clearRunData=function(){this._runComplete.clear(),this.testSuccess=!1,this.isRun=!1,l.clear(this,this._runCheckComplete2),l.clear(this,this._runCheckComplete)},s.getEnterRunCount=function(e){return this.storage.get("enterRunCount"+e,0)},s.run=function(e){for(var t=this,n=arguments.length,o=new Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];this.type=e,this.storage.set("enterRunCount"+this.type,this.getEnterRunCount(this.type)+1);var u=v.get(e);if(u){u.beforeRun&&u.beforeRun();var a=function(){c.resetProp();for(var e,n=i(_.arr.prop);!(e=n()).done;){var r=e.value;t.propCount[r.id]=0}u.run.apply(u,o)},p=[];u.preLoadRes&&u.preLoadRes(p),h.get(T.uiUrl.RunUI,r)||p.push({type:r,url:T.uiUrl.RunUI}),p.length>0?this.isRun?(f.Loading.wait(!0),h.loadDir(p,(function(){f.Loading.wait(!1),a()}))):h.loadDir(p,a):a()}},s.reset=function(){this.emit(this.EventType.RESET);var e=v.get(this.type);e.reset?e.reset():this.run(this.type)},s.exit=function(){this.emit(this.EventType.EXIT),f.closeAll(C.Item).closeAll(C.Panel).closeAll(C.Notice).closeAll(C.WindowUp).closeAll(C.Window),this.run(E.index)},s.settingExit=function(){var e=v.get(this.type);e.settingExit?e.settingExit():this.exit()},s.next=function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];this.emit(this.EventType.NEXT);var o=v.get(this.type);this.type==E.shape?y.showVideo("",(function(){o&&(o.next&&o.next(),e.run.apply(e,[e.type].concat(n)))}),!1,(function(){})):o&&(o.next&&o.next(),this.run.apply(this,[this.type].concat(n)))},s.hasRun=function(e){void 0===e&&(e=this.type);var t=v.get(e);return!t||(!t.hasRun||!!t.hasRun())},n(o,[{key:"scene",get:function(){return d.getCurrent()}}]),o}(g))||L);o._RF.pop()}}}));

System.register("chunks:///_virtual/IndexBgUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Main.ts"],(function(n){var e,t,c,r,s;return{setters:[function(n){e=n.inheritsLoose},function(n){t=n.cclegacy},function(n){c=n.ccclass,r=n.EUILayer,s=n.BaseUI}],execute:function(){var i;t._RF.push({},"920a5/ssThGH4RQZgpXJcYL","IndexBgUI",void 0);n("IndexBgUI",c("IndexBgUI")(i=function(n){function t(){for(var e,t=arguments.length,c=new Array(t),s=0;s<t;s++)c[s]=arguments[s];return(e=n.call.apply(n,[this].concat(c))||this).layerType=r.Window,e}return e(t,n),t}(s))||i);t._RF.pop()}}}));

System.register("chunks:///_virtual/IndexGameType.ts",["cc","./Main.ts","./GameTypeDefine.ts","./LogicDefine.ts","./GameDefine.ts"],(function(e){var n,t,i,a,o,u,c,r,p,f;return{setters:[function(e){n=e.cclegacy},function(e){t=e.Vector3,i=e._logic,a=e._gameType,o=e.Maths,u=e._ui},function(e){c=e.gameTypeModule,r=e.EGameType},function(e){p=e.EBattleSizeType},function(e){f=e.initData}],execute:function(){var s;n._RF.push({},"60fe1layq1CSIxQJ26HBT61","IndexGameType",void 0);var y=new t(2,2,2);e("IndexGameType",c.add(r.index)(s=function(){function e(){}var n=e.prototype;return n.preLoadRes=function(e){e.push.apply(e,i.preLoadRes)},n.run=function(){a.logicRun(o.minToMax(0,1e5),(function(){var e;i.create(y,((e={})[p["1*1"]]=100,e[p["1*2"]]=0,e[p["2*2"]]=0,e),!1)}),(function(e){})),a.isRun=!1,u.open(f.uiUrl.index)},e}())||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/IndexUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Main.ts","./AnimBaseUI.ts","./GameTypeDefine.ts","./GameDefine.ts","./LogicDefine.ts"],(function(n){var e,t,i,o,c,a,s,l,r,u,f,d,p,y,h;return{setters:[function(n){e=n.inheritsLoose},function(n){t=n.cclegacy},function(n){i=n.ccclass,o=n._platform,c=n.EBottomAdType,a=n.EPlatformType,s=n._ui,l=n._main,r=n._gameType,u=n.EUILayer,f=n.EBlockOnceAdType},function(n){d=n.AnimBaseUI},function(n){p=n.EGameType},function(n){y=n.initData},function(n){h=n.CSceneData}],execute:function(){var k;t._RF.push({},"c12a3j8heVOyogqA4QywMBi","IndexUI",void 0);n("IndexUI",i("IndexUI")(k=function(n){function t(){for(var e,t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return(e=n.call.apply(n,[this].concat(i))||this).layerType=u.WindowUp,e.blockOnceAdType=f.Show,e.bottomAdType=c.None,e.cASidebar=null,e}e(t,n);var i=t.prototype;return i.onCreate=function(){switch(n.prototype.onCreate.call(this),o.type){case a.wx:case a.web:this.bottomAdType=c.Native;break;default:this.bottomAdType=c.Banner}this.updateSidebar()},i.updateSidebar=function(){o.type==a.tt&&o._tt.sidebar.isEnable?this.cASidebar.active=!0:this.cASidebar.active=!1},i.onClickASidebar=function(){s.open(y.uiUrl.sidebar)},i.onClickASkin=function(){s.open(h.uiUrl.SkinUI)},i.onClickSetting=function(){s.open(h.uiUrl.SettingUI)},i.onClickRank=function(){o.type==a.tt&&window.tt.login({force:!0,success:function(n){console.log("login 调用成功"+n.code+" "+n.anonymousCode),window.tt.getImRankList({relationType:"all",dataType:1,rankType:"day",suffix:"秒",rankTitle:"挑战模式排行榜",zoneId:"default",success:function(n){console.log("getImRankData success res: "+n)},fail:function(n){console.log("getImRankData fail res: "+n.errMsg)}})},fail:function(n){console.log("login 调用失败")}})},i.onClickToday=function(){this.clickRun(p.today)},i.onClickLevel=function(){this.clickRun(p.level)},i.onClickCustom=function(){this.clickRun(p.custom)},i.onClickShape=function(){var n=this;l.showVideo("",(function(){(n.clickRun(p.shape),o.type==a.tt)&&window.tt.reportAnalytics("adFinished",{origin:"模式  彩虹"})}),!1,(function(){}))},i.clickRun=function(n){var e=this;r.hasRun(n)&&this.playAnim(!1,(function(){if(r){if(!e.scene)return r.type=n,void s.Loading.wait(!0);if(r.run(n),o.type==a.tt){var t=window.tt,i="首页";switch(n){case p.level:i="关卡";break;case p.today:i="挑战";break;case p.shape:i="彩虹";break;case p.custom:i="自定义"}t.reportAnalytics("enterMode",{mode:i})}}}))},t}(d))||k);t._RF.pop()}}}));

System.register("chunks:///_virtual/LevelGameType.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameDefine.ts","./Main.ts","./GameTypeDefine.ts","./LogicDefine.ts"],(function(e){var t,l,n,i,r,o,u,s,c,a,p,v,f,h;return{setters:[function(e){t=e.createClass},function(e){l=e.cclegacy},function(e){n=e.initData},function(e){i=e._logic,r=e._ui,o=e._config_,u=e._gameType,s=e._platform,c=e.EPlatformType,a=e.LevelHelper,p=e.PropHelper},function(e){v=e.gameTypeModule,f=e.EGameType},function(e){h=e.CSceneData}],execute:function(){var m;l._RF.push({},"e727177/LhKDK84NnB1T6GV","LevelGameType",void 0);e("LevelGameType",v.add(f.level)(m=function(){function e(){this.level=null,this.curLevel=-1,this.step=null;for(var e=[],t=Math.floor(o.arr.level_item.length/2),l=0;l<t;l++)e.push(o.arr.level_item[l].id);this.level=new a(u.storage,-1,"level",o.arr.level_item.length,!0,e,null),this.step=new p(u.storage,"",-1,0,-1,!0,"step"),this.step.on(p.EventType.CHANGE,u.callLaterCheckComplete,u)}var l=e.prototype;return l.preLoadRes=function(e){e.push.apply(e,i.preLoadRes)},l.settingExit=function(){r.open(h.uiUrl.LevelSelectUI,{level:this.level,configLength:o.arr.level_item.length,add:!0})},l.run=function(e){var t=this;void 0===e&&(e=this.level.cur),this.curLevel=e;var l=this.curConfig;r.close(h.uiUrl.LevelSelectUI),r.close(n.uiUrl.index),u.logicRun(this.curLevel,(function(){for(var e={},t=0;t<l.widget.length;t++)e[t]=l.widget[t];i.create(l.size,e,!0)}),(function(e){if(e){if(s.type==c.tt)window.tt.reportAnalytics("passMode",{mode:"关卡",level:t.curLevel});t.level.cur==t.curLevel&&t.level.add(),r.open(h.uiUrl.SuccessUI)}else r.open(h.uiUrl.FailUI)}));var o=Math.floor(i.data.count())+l.step;this.step.set(o),r.open(h.uiUrl.RunUI,null,(function(){1===l.anim&&u.emit(u.EventType.PLAY_ANIM)}))},l.checkComplete=function(){0!=i.data.count()?this.step.cur<=0&&u.runComplete(!1):u.runComplete(!0)},l.reset=function(){u.run(u.type,this.curLevel)},l.subStep=function(){i.data.count()<=2&&this.step.cur<=1&&(u.isRun=!1),this.step.sub(1),u.callLaterCheckComplete()},l.revive=function(){u.isRun=!0,u._runComplete.set(u._runComplete._cb),this.step.add(100)},t(e,[{key:"curConfig",get:function(){return o.obj.level_item[this.level.getConverLevel(this.curLevel)]}}]),e}())||m);l._RF.pop()}}}));

System.register("chunks:///_virtual/LogicCustomModule.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Main.ts","./LogicDefine.ts","./GameTypeDefine.ts"],(function(t){var e,a,n,i,s,r,o,u,d,c,p,h,l,C,f,g,y,v,m,M,_,x,b,E,A,T,B,D,S,P,L;return{setters:[function(t){e=t.inheritsLoose,a=t.createClass},function(t){n=t.cclegacy,i=t.Prefab},function(t){s=t.Vector3,r=t.moduleMgr,o=t.EModuleType,u=t._main,d=t._platform,c=t._scene,p=t._ui,h=t._logic,l=t._resouces,C=t.Times,f=t._timer,g=t.EPlatformType,y=t.Sets,v=t._gameType,m=t.RandomSeed,M=t.Vector2,_=t.BaseModuleEvent},function(t){x=t.CBattleCustomSize,b=t.CCubeSize,E=t.CBattleCustomDownEntityUrl,A=t.CBattleCustomCube1x1EntityUrl,T=t.CBattleCustomDefaultCubeCount,B=t.CBattleCustomVidoCubeCount,D=t.CBattleDirV3,S=t.CBattleCustomOpenByLevel,P=t.CSceneData},function(t){L=t.EGameType}],execute:function(){var I;n._RF.push({},"f3751FZVI1KvLHQeh0KwrIL","LogicCustomModule",void 0);var U=new s;t("LogicCustomModule",r.add(o.logicCustom)(I=function(t){function n(){for(var e,a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))||this).EventType={MAP_DATA_CHANGE:"MAP_DATA_CHANGE",MAP_COUNT_CHANGE:"MAP_COUNT_CHANGE"},e.data={datas:[],downs:[],all:[],dataByPos:[],state:!0},e.random=new m,e.runData=null,e.runFrinend=!1,e.offset=new s,e.camera={position:new s(15,10,15),dis:new M(4,40),rotate:new s},e.isCustomLoad=!1,e.shareMapQuery="shareMap",e}e(n,t);var r=n.prototype;return r.onCreate=function(){this.offset.x=x.x/2+b.x,this.offset.y=x.y/2+b.y,this.offset.z=x.z/2+b.z},r.onLogic=function(){var t=this;u.on(u.EventType.SHOW_QUERY,(function(e){var a=JSON.parse(e);if(a[0]===t.shareMapQuery){d.instance.reportEvent("share",{shareid:a[1],sharetextid:a[2],sharetype:4});var n=function(){f.once(t,(function(){p.open(P.uiUrl.CustomFriendUI,a[3])}),1)};t.scene?n():c.once(c.EventType.CHANG_SUCCESS,n)}}))},r.remove=function(t){p.tip("删除成功");var e=this.data.datas[t];this.scene.entityMgr.remove(e.customCube1x1Entity),this.data.all[this.data.all.indexOf(e)]=null,this.data.datas[t]=null,h.data.pool.put(e);var a=this.getPosIndex(e.indexCenter);this.data.dataByPos[a]=void 0,this.setMap(this.editorIndex)},r.load=function(t,e){var a=this;this.isCustomLoad?t():(e&&p.Loading.wait(!0),l.loadDir([{url:"scene/prefab/ui/CustomEditorUI",type:i},{url:E,type:i},{url:A,type:i}],(function(){a.isCustomLoad=!0,t()})))},r.getStepSub=function(t){var e=this.getMap(t),a=this.deDataByCreateCount(e.data.p);return e.data.t-a},r.getMap=function(t){return this.storage.get("map"+t,null)},r.addMap=function(){var t=this.getMapCount();return this.storage.set("mapCount",t+1),this.storage.set("map"+t,{createTime:C.second(),updateTime:C.second(),data:{t:T,p:[],s:1}}),this.emit(this.EventType.MAP_COUNT_CHANGE),t},r.addMapCubeCount=function(t,e){void 0===e&&(e=1);var a=this.getMap(t);a.data.t+=B*e,this.updateMap(t,a)},r.getMapCount=function(){return this.storage.get("mapCount",0)},r.setMap=function(t){f.callLater(this,this._setMap,[t])},r._setMap=function(t){var e=this.getMap(t);this.enData(e.data.p),e.updateTime=C.second(),this.updateMap(t,e)},r.updateMap=function(t,e){this.storage.set("map"+t,e),this.emit(this.EventType.MAP_DATA_CHANGE,t)},r.shareMap=function(t){var e=this.getMap(t);if(0!=this.deDataByCreateCount(e.data.p)){e.data.s=h.arrowSkin.cur;var a={title:"快来挑战我自定义的关卡吧！",imageUrl:"subpackages/shareImg/custom.jpg"};d.type==g.qq&&(a.imageUrl="custom.jpg");var n=[this.shareMapQuery,a.imageUrl,d.config.share.list.title.length,e.data];a.query=JSON.stringify(n),d.instance.reportEvent("share",{shareid:n[1],sharetextid:n[2],sharetype:3}),d._share_.show(a,(function(t){p.tip("分享成功")}))}else p.tip("地图暂无数据")},r.deDataByCreateCount=function(t){for(var e=0,a=0;a<t.length;a++){var n=t[a];a%2==0&&(e+=n)}return e},r.deData=function(t){for(var e=[],a=0;a<t.length;a++)for(var n=t[a],i=a%2==0,s=0;s<n;s++)i?e.push(1):e.push(0);return e},r.enData=function(t){t.length=0;for(var e=x.x*x.y*x.z,a=0,n=!0,i=0;i<e;i++){var s=void 0!==this.data.dataByPos[i];n?s?a++:(t.push(a),n=!1,a=1):s?(t.push(a),n=!0,a=1):a++}},r.createCube=function(t,e){if(this.getStepSub(this.editorIndex)<=0)return p.tip("步数不足"),void d._vibrate_.short();var a=D[e];s.add(U,a,t.indexCenter),U.x<0||U.y<0||U.z<0||U.x>=x.x||U.y>=x.y||U.z>=x.z?p.tip("超出最大边界"):y.filterValue(this.data.all,(function(t){return t&&t.indexCenter.equals(U)}))?p.tip("已有方块"):(this._createCube(U,!0),this.setMap(this.editorIndex))},r._createCube=function(t,e){var a=h.create1x1(t,void 0,t);s.sub(a.aabb.center,a.aabb.center,this.offset);var n=this.data.datas.length;this.data.datas.push(a),this.data.all.push(a),e&&(a.customCube1x1Entity=this.scene.entityMgr.createCustomCube1x1(n));var i=this.getPosIndex(t);this.data.dataByPos[i]=n},r.getPosIndex=function(t){return t.x*x.x*x.y+t.y*x.y+t.z},r.enter=function(){h._level.level.cur>S?p.open("scene/prefab/ui/CustomMapUI"):p.dialogue("通过第"+S+"关解锁自定义",{text:"关闭",onClick:function(){}},{text:"前往挑战",color:"darkBlue",onClick:function(){v.run(L.level)}})},a(n,[{key:"scene",get:function(){return c.getCurrent()}},{key:"editorIndex",get:function(){return this.storage.get("editorIndexCur",0)}}]),n}(_))||I);n._RF.pop()}}}));

System.register("chunks:///_virtual/LogicDefine.ts",["cc","./Main.ts"],(function(e){var t,n,r,i,o,a;return{setters:[function(e){t=e.cclegacy,n=e.ccenum,r=e.JsonAsset,i=e.Material,o=e.Vec3},function(e){a=e.Vector3}],execute:function(){var u,c,s,l,p,f,C,b;t._RF.push({},"3cd5cJhLn1DMb5AyvDTjw2D","LogicDefine",void 0);e("EEntityType",function(e){return e[e.None=0]="None",e[e.Cube=1]="Cube",e[e.CustomDown=2]="CustomDown",e[e.CustomCube1x1=3]="CustomCube1x1",e}({}));var y=e("EPropId",function(e){return e[e.tip=1]="tip",e[e.remove=2]="remove",e[e.back=3]="back",e[e.reset=4]="reset",e[e.time=7]="time",e[e.power=8]="power",e}({}));n(y);e("CResoucesLoadPriority",[]);var m=e("EBattleDirType",function(e){return e[e.up=0]="up",e[e.down=1]="down",e[e.front=2]="front",e[e.left=3]="left",e[e.back=4]="back",e[e.right=5]="right",e}({})),h=(e("CBattleDirBack",((u={})[m.up]=m.down,u[m.down]=m.up,u[m.front]=m.back,u[m.left]=m.right,u[m.back]=m.front,u[m.right]=m.left,u)),e("CBattleDirAngle",((c={})[m.up]=new a,c[m.down]=new a(180),c[m.front]=new a(90),c[m.left]=new a(0,0,90),c[m.back]=new a(-90),c[m.right]=new a(0,0,-90),c)),e("CBattleDirAngleFn",((s={})[m.up]=function(e){return e},s[m.down]=function(e){return a.rotateX(e,e,a.ZERO,180)},s[m.front]=function(e){return a.rotateX(e,e,a.ZERO,90)},s[m.left]=function(e){return a.rotateZ(e,e,a.ZERO,90)},s[m.back]=function(e){return a.rotateX(e,e,a.ZERO,-90)},s[m.right]=function(e){return a.rotateZ(e,e,a.ZERO,-90)},s)),e("CBattleDirV3",((l={})[m.up]=new a(0,1,0),l[m.down]=new a(0,-1,0),l[m.front]=new a(0,0,1),l[m.left]=new a(-1,0,0),l[m.back]=new a(0,0,-1),l[m.right]=new a(1,0,0),l)),e("CBattleDirXYZ",((p={})[m.up]={cur:"y",other:["x","z"]},p[m.down]={cur:"y",other:["x","z"]},p[m.front]={cur:"z",other:["x","y"]},p[m.left]={cur:"x",other:["z","y"]},p[m.back]={cur:"z",other:["x","y"]},p[m.right]={cur:"x",other:["z","y"]},p)),e("CBattleDirs",{x:[m.left,m.right],y:[m.up,m.down],z:[m.front,m.back]}),e("CBattle2x2Dir2",[m.left,m.up,m.front]),e("EBattleSizeType",function(e){return e[e["1*1"]=0]="1*1",e[e["1*2"]=1]="1*2",e[e["2*2"]=2]="2*2",e}({}))),w=(e("CBattleSizeEntityUrl",((f={})[h["1*1"]]="scene/prefab/entity/Cube1x1Entity",f[h["1*2"]]="scene/prefab/entity/Cube1x2Entity",f[h["2*2"]]="scene/prefab/entity/Cube2x2Entity",f)),e("CBattleShapeConfigColor",{url:"scene/config/pixelcolor",type:r}),e("CBattleShapeConfigLevel",{url:"scene/config/pixellevel",type:r}),e("CBattleSizeEntityUrl1x1Shape","scene/prefab/entity/Cube1x1ShapeEntity"),e("CBattleSizeEntityUrl1x1ShapeMatBlackImg",{url:"scene/material/cube/1x1_shape/imgBlack",type:i}),e("CBattleSizeEntityUrl1x1ShapeMatWhiteImg",{url:"scene/material/cube/1x1_shape/imgWhite",type:i}),e("CBattleSizeEntityUrl1x1ShapeMatColor",{url:"scene/material/cube/1x1_shape/color",type:i}),e("CBattleCustomDownEntityUrl","scene/prefab/entity/CustomDownEntity"),e("CBattleCustomCube1x1EntityUrl","scene/prefab/entity/CustomCube1x1Entity"),e("CBattleSizeTypeImgNames",((C={})[h["1*1"]]=["1X1/up","1X1/down","1X1/front","1X1/left","1X1/back","1X1/right"],C[h["1*2"]]=["1X1/up","1X1/down","1X2/front","1X2/left","1X2/back","1X2/right"],C[h["2*2"]]=["2X2/up","2X2/down","2X2/front","2X2/left","2X2/back","2X2/right"],C))),U=(e("CBattleImgNames",[].concat(w[h["1*1"]],w[h["1*2"]],w[h["2*2"]])),e("CXyzTemp",["x","y","z"]),e("CCubeSize",new a(.5,.5,.5)),e("CCubeSizeAddV3",new o(.1,.1,.1)),e("CCubeColliderDis",.5),e("CBattleCustomSize",new o(10,10,10)),e("CBattleCustomDefaultMapCount",5),e("CBattleCustomDefaultCubeCount",30),e("CBattleCustomVidoCubeCount",50),e("CBattleCustomOpenByLevel",5),e("CBattleToDayOnceSphere",[new a(0,1,0),new a(-1,0,0),new a(0,0,0),new a(1,0,0),new a(0,0,1),new a(0,0,-1),new a(0,-1,0)]),e("EShareDayType",function(e){return e[e.runTip=0]="runTip",e[e.customTip=1]="customTip",e}({})));e("CSceneData",{shareDay:(b={},b[U.runTip]=2,b[U.customTip]=1,b),dotPrefabUrl:"scene/prefab/entity/DotEntity",tipPrefabUrl:"scene/prefab/entity/TipEntity",moveFishPrefabUrl:"scene/prefab/entity/MoveFishEntity",fishDownPrefabUrl:"scene/prefab/entity/FishDownEntity",customFishPrefabUrl:"scene/prefab/entity/CustomFishEntity",CustomListUIItemFish:"scene/prefab/ui/CustomListUIItemFish",audio:{bgm:"sceneRes/audio/bgm",success:"sceneRes/audio/success",fail:"sceneRes/audio/fail",magic:"sceneRes/audio/magic",remove:"sceneRes/audio/remove"},uiUrl:{SettingUI:"setting/prefab/SettingUI",SkinUI:"skin/prefab/SkinUI",PropGetUI:"scene/prefab/ui/PropGetUI",FailUI:"scene/prefab/ui/FailUI",LevelSelectUI:"scene/prefab/ui/LevelSelectUI",SuccessUI:"scene/prefab/ui/SuccessUI",RunUI:"scene/prefab/ui/RunUI",SuccessToDayUI:"scene/prefab/ui/SuccessToDayUI",ToDayPropUI:"scene/prefab/ui/ToDayPropUI",CustomFriendUI:"scene/prefab/ui/CustomFriendUI",CustomEditorSuccessUI:"scene/prefab/ui/CustomEditorSuccessUI"}});t._RF.pop()}}}));

System.register("chunks:///_virtual/LogicModule.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameDefine.ts","./Main.ts","./LogicDefine.ts","./GameTypeDefine.ts"],(function(e){var t,a,r,i,n,o,s,u,d,c,l,h,f,v,p,g,m,y,_,S,b,C,E,D,P,R,z,x,U,A,k,M,T,w,B,I,L,O,N,G,H,F,Y,K,W;return{setters:[function(e){t=e.inheritsLoose,a=e.createForOfIteratorHelperLoose,r=e.createClass},function(e){i=e.cclegacy,n=e.geometry,o=e.Prefab,s=e.AudioClip,u=e.Texture2D},function(e){d=e.initData},function(e){c=e.Vector2,l=e.Vector3,h=e.moduleMgr,f=e.EModuleType,v=e.DataLogicHelper,p=e._prop,g=e._ui,m=e._scene,y=e._audio,_=e._timer,S=e._gameType,b=e._login,C=e._config_,E=e._main,D=e._resouces,P=e.SkinHelper,R=e.Sets,z=e._logicCustom,x=e.Maths,U=e.JS,A=e.BaseModuleEvent},function(e){k=e.EBattleSizeType,M=e.EBattleDirType,T=e.CSceneData,w=e.CBattleSizeEntityUrl,B=e.EPropId,I=e.CBattleDirBack,L=e.CBattleDirV3,O=e.CBattleSizeEntityUrl1x1Shape,N=e.CCubeSizeAddV3,G=e.CCubeSize,H=e.CBattleDirs,F=e.CXyzTemp,Y=e.CBattleImgNames},function(e){K=e.EGameType,W=e.gameTypeModule}],execute:function(){var V;i._RF.push({},"2312ak9hy9Jxacwbz/c3bt1","LogicModule",void 0);var j=new n.Ray,J=(new c,new l),Z=new l,Q=[[0,1,2,3],[0,1,4,5],[2,3,4,5],[4,5,6,7]];e("LogicModule",h.add(f.logic)(V=function(e){function i(){for(var t,a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).EventType={USE_DIRBACK:"USE_DIRBACK",USE_DIRBACK_COMPLETE:"USE_DIRBACK_COMPLETE",DURATION_CHANGE:"DURATION_CHANGE",CHANGE_SKIN_COMPLETE:"CHANGE_SKIN_COMPLETE",PROP_CHANGE:"PROP_CHANGE",PLAY_ANIM:"PLAY_ANIM",TODAY_PROP_REWARD:"TODAY_PROP_REWARD",TODAY_SUCCESS:"TODAY_SUCCESS"},t.data=null,t.orginSize=new l,t.orginSizeSub=new l,t.size=new l,t.widget=null,t.cubeSize=0,t.offsetY=new c,t.scaleRatio=0,t.offset=new c,t.animIndex=-1,t.sizeLen=-1,t.preLoadRes=[],t._remove=!1,t._createData=null,t.arrowSkin=null,t.cameraPosition=new l(16,13,16),t.cameraDis=new c(4),t.cameraRotate=new l(0),t}t(i,e);var h=i.prototype;return h.onCreate=function(){var e;for(var t in this.data=new v((function(){return{type:k["1*1"],positions:[],center:new l,indexCenter:new l,dir:M.back,entity:null,customDownEntity:null,customCube1x1Entity:null,aabb:new n.AABB}}),(function(e){for(var t,r=a(e.positions);!(t=r()).done;){var i=t.value;l.pool.put(i)}e.positions.length=0,e.entity=null,e.customCube1x1Entity=null,e.customDownEntity=null})),this.arrowSkin=p.createSkin(this.storage,"skin_item",1),(e=this.preLoadRes).push.apply(e,[{type:o,url:g.DefaultUrl.moveUp},{type:s,url:T.audio.remove},{type:s,url:T.audio.magic}].concat(this.getSkinUrls())),w)this.preLoadRes.push({type:o,url:w[t]})},h.onLogic=function(){var e=this,t=!1;m.once(m.EventType.CHANG_SUCCESS,(function(){y.playMusic(T.audio.bgm),_.once(e,(function(){S.type==K.none&&(b.isNewUser&&d.newUseEnterGame?S.type=K.today:S.type=K.index),t=!0,S.run(S.type)}),2/60)})),g.on(g.EventType.OPEN,(function(e){e==d.uiUrl.index&&t&&S.run(K.index)}));for(var r,i=function(){var e=r.value;p.setSinglesOpenUI(e.id,(function(){g.open(T.uiUrl.PropGetUI,p.singles.get(e.id))}))},n=a(C.arr.prop);!(r=n()).done;)i();p.on(p.EventType.PROP_SUB,(function(t){switch(t){case B.remove:e.randomRemoveCount();break;case B.back:e.back();break;case B.reset:e.resets();break;case B.time:e._today.addTime(120)}})),E.preLoadQueue.add((function(e){return D.loadPrefab(g.DefaultUrl.fly,e)})).add((function(e){return D.loadPrefab(g.DefaultUrl.flyItem,e)})).add((function(e){return D.loadPrefab(T.uiUrl.SettingUI,e)})).add((function(e){return D.loadPrefab(T.uiUrl.FailUI,e)})).add((function(e){return D.loadPrefab(T.uiUrl.SuccessUI,e)})).add((function(e){return D.loadPrefab(T.uiUrl.PropGetUI,e)})).add((function(e){return D.loadPrefab(T.uiUrl.LevelSelectUI,e)})),this.arrowSkin.on(P.EventType.CHANGE,this.loadSkinTexture,this)},h.resets=function(){for(var e=[],t=0;t<this.data.datas.length;t++)this.data.datas[t]||e.push(t);this.create(this.orginSize,this.widget,this._remove,this._createData,{position:this.cameraPosition,dis:this.cameraDis,rotate:this.cameraRotate});for(var a=0,r=e;a<r.length;a++){var i=r[a];this.data.remove(i)}this.scene.create(!0)},h.loadSkinTexture=function(){var e=this;D.loadDir(this.getSkinUrls(),(function(){console.log("皮肤图片加载完成"),e.emit(e.EventType.CHANGE_SKIN_COMPLETE)}))},h.getFronts=function(e,t,r,i){for(var o,s=[],u=this.data.datas.indexOf(t),d=i+1,c=a(t.positions);!(o=c()).done;){var h=o.value;l.add(J,h,t.center);var f=this.getFront(u,e.dir,J);f&&(f.frontIndex=d,(e==t||n.intersect.aabbWithAABB(t.aabb,f.aabb))&&s.push(f))}if(0!=s.length)for(var v=0,p=s;v<p.length;v++){var g=p[v];R.has(r,g)||(r.push(g),this.getFronts(e,g,r,d))}},h.getFront=function(e,t,a){var r=this.data.datas[e];return void 0===t&&(t=r.dir),void 0===a&&(a=r.aabb.center),this.getDirMul(j.d,t,1),l.set(j.o,a),this.scene.rayByData(j,this.data.datas,e)},h.toDayPropReward=function(){this.storage.set("toDayProp","true"),p.addProp(B.back),p.addProp(B.remove),p.addProp(B.reset),this.emit(this.EventType.TODAY_PROP_REWARD)},h.getDirMul=function(e,t,a,r){void 0===r&&(r=!1),r&&(t=I[t]),l.set(e,L[t]),l.mul(e,e,a)},h.randomRemoveCount=function(e){void 0===e&&(e=5);for(var t,r=[],i=a(this.data.datas);!(t=i()).done;){var n=t.value;null!==n&&r.push(n)}R.shuffle(r),r.length<e&&(S.isRun=!1);for(var o=Math.min(e,r.length),s=0;s<o;s++)r[s].entity.randomRemove()},h.getCubeUrl=function(e){if(S.type==K.shape)return O;var t=this.data.datas[e];return w[t.type]},h.updateRankingStorage=function(){},h.dirBack=function(e){var t=this.data.datas[e];t.dir=I[t.dir],t.entity.dirBack()},h.back=function(){for(var e,t=-1,r=a(this.data.datas);!(e=r()).done;){t++,e.value&&this.dirBack(t)}},h.getSkinUrls=function(e){void 0===e&&(e=Y);for(var t,r=[],i=C.obj.skin_item[this.arrowSkin.cur].scene_url,n=a(e);!(t=n()).done;){var o=t.value;r.push({type:u,url:this.converSkinUrl(i,o)})}return r},h.converSkinUrl=function(e,t){return e+"/"+t+"/texture"},h.create=function(e,t,a,r,i){if(this._createClearDatas(),this._remove=a,this.widget=t,this.orginSize.set(e),this._createData=r,i)this.cameraPosition.set(i.position),this.cameraDis.set(i.dis),this.cameraRotate.set(i.rotate);else{var n=this.orginSize.y;this.cameraPosition.y=7+3*(n/2-1),this.cameraPosition.x=1.2*this.cameraPosition.y,this.cameraPosition.z=1.2*this.cameraPosition.y,this.cameraDis.x=4,this.cameraDis.y=2*this.cameraPosition.y,this.cameraRotate.set()}r?r():this._createBy2x2(),this.addAabbRange(this.data.datas)},h._createClearDatas=function(){for(var e,t=a(z.data.all);!(e=t()).done;){var r=e.value;r&&this.data.pool.put(r)}z.data.all.length=0,z.data.datas.length=0,z.data.downs.length=0,this.data.reset()},h.addAabbRange=function(e){for(var t,r=a(e);!(t=r()).done;){var i=t.value;i&&i.aabb.halfExtents.add(N)}},h._createBy2x2=function(){this.size.set(Math.ceil(this.orginSize.x/2),Math.ceil(this.orginSize.y/2),Math.ceil(this.orginSize.z/2)),l.mul(this.orginSizeSub,this.orginSize,.5);for(var e,t=[],r=a(F);!(e=r()).done;){var i=e.value;this.orginSize[i]%2==1?(t.push(i),this.orginSizeSub[i]=(this.orginSize[i]+2)/2):this.orginSizeSub[i]=this.orginSize[i]/2}var n=this.size.x*this.size.y*this.size.z,o=this._createWidget(this.widget,8*n),s=this._createSizeDots(n,o);R.shuffle(s,!0,(function(){return S.curRandom.run()}));var u=this._createLogic2x2(s);if(this._createDatas(u),this._remove)for(var d,c=a(t);!(d=c()).done;){var h=d.value;this._createRemove(h)}},h._createRemove=function(e){for(var t,r=[],i=-1,n=a(this.data.datas);!(t=n()).done;){var o=t.value;if(i++,o)for(var s,u=a(o.positions);!(s=u()).done;){var d=s.value,c=o.indexCenter[e]+d[e];r[c]||(r[c]=[]),R.add(r[c],i)}}if(r[1])for(var h,f=a(r[1]);!(h=f()).done;){var v=h.value,p=this.data.datas[v];if(p&&p.type!=k["1*1"]){for(var g,m=!1,y=a(p.positions);!(g=y()).done;){var _=g.value;0!=l.add(J,p.indexCenter,_)[e]&&(this.data.datas.push(this.create1x1(_,p.center,p.indexCenter)),m=!0)}m&&this.data.remove(v)}}if(r[0])for(var S,b=a(r[0]);!(S=b()).done;){var C=S.value;this.data.remove(C)}},h.create1x1=function(e,t,a,r){t||(t=l.ZERO),a||(a=l.ZERO);var i=this.data.pool.get();return i.type=k["1*1"],i.positions.push(l.pool.get().set(e)),void 0===r&&(r=this._createDir(i)),i.dir=r,l.add(i.aabb.center,t,e),i.center.set(t),i.indexCenter.set(a),l.set(i.aabb.halfExtents,G),i},h._createDatas=function(e){for(var t=-1,r=0;r<this.size.x;r++)for(var i=0;i<this.size.y;i++)for(var n=0;n<this.size.z;n++){t++;for(var o,s=J.set(2*r,2*i,2*n),u=Z.set(s).addSelf(G).subSelf(this.orginSizeSub),d=a(e[t]);!(o=d()).done;){var c=o.value;this.data.datas.push(c),c.center.set(u),c.indexCenter.set(s),l.add(c.aabb.center,c.aabb.center,c.center),c.dir=this._createDir(c)}}},h._createDir=function(e){if(e.type==k["1*1"])return x.minToMax(M.up,M.right,!0,S.curRandom.run());for(var t,r=[],i=a(F);!(t=i()).done;){var n=t.value;1==e.aabb.halfExtents[n]&&r.push.apply(r,H[n])}return R.random(r,void 0,(function(){return S.curRandom.run()}))},h._createLogic2x2=function(e){for(var t,r=[],i=a(e);!(t=i()).done;){for(var n=t.value,o=[],s=[],u=0,d=[k["2*2"],k["1*2"],k["1*1"]];u<d.length;u++)for(var c=d[u],h=n[c],f=0;f<h;f++){var v=o.length,p=this.data.pool.get();p.type=c,o.push(p);for(var g=c==k["2*2"]?4:c==k["1*2"]?2:1,m=0;m<g;m++)s.push(v)}if(1==n[k["2*2"]]){var y=x.zeroToMax(4,S.curRandom.run());if(0!=y)for(var _=Q[y],b=U.deep(s),C=0;C<4;C++){var E=s[C];s[C]=b[_[C]],s[_[C]]=E}}for(var D=-1,P=0;P<2;P++)for(var z=0;z<2;z++)for(var A=0;A<2;A++){o[s[++D]].positions.push(l.pool.get().set(P,z,A))}for(var M=0,T=o;M<T.length;M++){for(var w,B=T[M],I=[],L=[],O=[],N=a(B.positions);!(w=N()).done;){var G=w.value;R.add(I,G.x),R.add(L,G.y),R.add(O,G.z)}B.aabb.halfExtents.set(I.length/2,L.length/2,O.length/2),l.polygonByCenterPoint(B.aabb.center,B.positions)}r.push(o)}return r},h._createSizeDots=function(e,t){for(var a=[],r=0;r<e;r++){var i={};a.push(i);for(var n=0;n<=k["2*2"];n++)i[n]=0}for(var o=t[k["2*2"]],s=0;s<o;s++)a[s%e][k["2*2"]]++;for(var u=t[k["1*2"]],d=0,c=a;d<c.length;d++){var l=c[d],h=8-4*l[k["2*2"]],f=Math.min(u,h/2),v=0==t[k["1*1"]]?u:0==f?f:x.minToMax(1,f,!0,S.curRandom.run());t[k["1*2"]]-=v;for(var p=0;p<v;p++)l[k["1*2"]]++;for(var g=h-2*v,m=0;m<g;m++)l[k["1*1"]]++}return a},h._createWidget=function(e,t){var a=0;for(var r in e)a+=e[r];var i={};for(var n in e)i[n]=e[n]/a;var o={};return o[k["2*2"]]=Math.min(Math.floor(t/4),Math.floor(t*(i[k["2*2"]]/4))),t-=4*o[k["2*2"]],o[k["1*2"]]=Math.min(Math.floor(t/2),Math.floor(t*(i[k["1*2"]]/2))),t-=2*o[k["1*2"]],o[k["1*1"]]=t,o},r(i,[{key:"_level",get:function(){return W.get(K.level)}},{key:"_today",get:function(){return W.get(K.today)}},{key:"_shape",get:function(){return W.get(K.shape)}},{key:"scene",get:function(){return m.getCurrent()}}]),i}(A))||V);i._RF.pop()}}}));

System.register("chunks:///_virtual/Main.ts",["cc","./apeng.mjs_cjs=&original=.js","./GameDefine.ts"],(function(e){var o,l;return{setters:[function(e){o=e.cclegacy},null,function(e){l=e.initData}],execute:function(){o._RF.push({},"8b69drJM0ZLG5HIijaWb6Tg","Main",void 0);e("_config_",null),e("_scene",null),e("_ui",null),e("_audio",null),e("_gm",null),e("_guide",null),e("_language",null),e("_login",null),e("_main",null),e("_platform",null),e("_privacy",null),e("_resouces",null),e("_timer",null),e("_prop",null),e("_rank",null),e("_gameType",null),e("_logic",null),e("_logicCustom",null);setTimeout((function(){var o=apeng,t=o.initCore,r=o.EInitCoreState;t(l,(function(o){switch(o){case r.init:e("_scene",apeng._scene),e("_ui",apeng._ui),e("_audio",apeng._audio),e("_gm",apeng._gm),e("_guide",apeng._guide),e("_language",apeng._language),e("_login",apeng._login),e("_main",apeng._main),e("_platform",apeng._platform),e("_privacy",apeng._privacy),e("_resouces",apeng._resouces),e("_timer",apeng._timer),e("_prop",apeng._prop),e("_rank",apeng._rank),e("_gameType",i.get(n.gameType)),e("_logic",i.get(n.logic)),e("_logicCustom",i.get(n.logicCustom));break;case r.config:e("_config_",apeng._config_)}}))}));var n=e("EModuleType",function(e){return e[e.gameType=40]="gameType",e[e.logic=41]="logic",e[e.logicGuide=42]="logicGuide",e[e.custom=43]="custom",e[e.logicCustom=44]="logicCustom",e}({})),t=apeng,i=(e("AABB",t.AABB),e("CameraOrbitControlCC",t.CameraOrbitControlCC),e("si",t.si),e("SkinHelper",t.SkinHelper),e("PoolArray",t.PoolArray),e("TShare",t.TShare),e("FontCC",t.FontCC),e("SpineCC",t.SpineCC),e("IntervalAnim",t.IntervalAnim),e("ModuleMgr",t.ModuleMgr),e("Rotate360Anim",t.Rotate360Anim),e("Collider2DPoint",t.Collider2DPoint),e("Collider2DBox",t.Collider2DBox),e("Collider2DCircle",t.Collider2DCircle),e("Collider2DPolygon",t.Collider2DPolygon),e("Collider2DRoot",t.Collider2DRoot),e("Collider2DEditorCC",t.Collider2DEditorCC),e("P2ShapeEditorCC",t.P2ShapeEditorCC),e("P2ConstraintEditorCC",t.P2ConstraintEditorCC),e("P2Group",t.P2Group),e("P2World",t.P2World),e("SpriteFrameAnimCC",t.SpriteFrameAnimCC),e("requireComponent",t.requireComponent),e("Circle",t.Circle),e("EditorParseDataCC",t.EditorParseDataCC),e("executeInEditMode",t.executeInEditMode),e("LayoutCircleCC",t.LayoutCircleCC),e("LayoutCC",t.LayoutCC),e("JS",t.JS),e("ColliderGroup",t.ColliderGroup),e("ScaleAnim",t.ScaleAnim),e("PoolOnce",t.PoolOnce),e("NodeHollow",t.NodeHollow),e("RectHollow",t.RectHollow),e("CircleHollow",t.CircleHollow),e("PolygonHollow",t.PolygonHollow),e("EventHandlerCC",t.EventHandlerCC),e("ccclass",t.ccclass),e("property",t.property),e("BaseUI",t.BaseUI),e("MoveCC",t.MoveCC),e("LoadDir",t.LoadDir),e("EUILayer",t.EUILayer),e("moduleMgr",t.moduleMgr));e("BaseModule",t.BaseModule),e("BaseModuleEvent",t.BaseModuleEvent),e("EBlockOnceAdType",t.EBlockOnceAdType),e("EPlatformType",t.EPlatformType),e("EBottomAdType",t.EBottomAdType),e("BaseScene",t.BaseScene),e("Vector2",t.Vector2),e("Vector3",t.Vector3),e("Rectangle",t.Rectangle),e("Polygon",t.Polygon),e("BaseEntityMgr",t.BaseEntityMgr),e("EEntityState",t.EEntityState),e("Move",t.Move),e("Maths",t.Maths),e("NodeHelper",t.NodeHelper),e("PropHelper",t.PropHelper),e("PropsHelper",t.PropsHelper),e("RandomSeed",t.RandomSeed),e("StateMackine",t.StateMackine),e("CompleteCallBack",t.CompleteCallBack),e("IntervalTimeHelper",t.IntervalTimeHelper),e("LevelHelper",t.LevelHelper),e("EUIState",t.EUIState),e("Times",t.Times),e("DataLogicHelper",t.DataLogicHelper),e("BaseEntity",t.BaseEntity),e("SwitchSpriteCC",t.SwitchSpriteCC),e("SpriteLoaderCC",t.SpriteLoaderCC),e("BaseComponent",t.BaseComponent),e("ButtonCC",t.ButtonCC),e("ELanguageType",t.ELanguageType),e("SwitchChildrenCC",t.SwitchChildrenCC),e("ListCCByBaseItemCC",t.ListCCByBaseItemCC),e("winSize",t.winSize),e("winCenterPostion",t.winCenterPostion),e("Sets",t.Sets),e("Maps",t.Maps),e("EEaseType",t.EEaseType),e("TweenHelper",t.TweenHelper),e("ETweenType",t.ETweenType),e("CreatePrefabToEditorCC",t.CreatePrefabToEditorCC),e("CreatePrefabToEditorOnceCC",t.CreatePrefabToEditorOnceCC),e("AnimtorByTweenCC",t.AnimtorByTweenCC),e("MaxBoxCC",t.MaxBoxCC),e("menu",t.menu),e("BaseHollow",t.BaseHollow),e("CGuideDefine",t.CGuideDefine);o._RF.pop()}}}));

System.register("chunks:///_virtual/main2",["./Main.ts","./apeng.mjs_cjs=&original=.js","./GameTypeModule.ts","./LogicCustomModule.ts","./LogicModule.ts","./GameTypeDefine.ts","./LogicDefine.ts","./IndexGameType.ts","./LevelGameType.ts","./ShapeGameType.ts","./TodayGameType.ts","./AnimBaseUI.ts","./IndexBgUI.ts","./IndexUI.ts","./PrivacyDescUI.ts","./PrivacyUI.ts","./ToDayMaxRecode.ts","./PropEventChangeItem.ts","./PropUI.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/PrivacyDescUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Main.ts"],(function(c){var e,r,t,n,o;return{setters:[function(c){e=c.inheritsLoose},function(c){r=c.cclegacy,t=c._decorator},function(c){n=c.EUILayer,o=c.BaseUI}],execute:function(){var a;r._RF.push({},"64c2c0aThVOKrLayaFXoXkf","PrivacyDescUI",void 0);var i=t.ccclass;t.property,c("PrivacyDescUI",i("PrivacyDescUI")(a=function(c){function r(){for(var e,r=arguments.length,t=new Array(r),o=0;o<r;o++)t[o]=arguments[o];return(e=c.call.apply(c,[this].concat(t))||this).layerType=n.NoticeUp,e}return e(r,c),r.prototype.onClickReturn=function(){this.closeUI()},r}(o))||a);r._RF.pop()}}}));

System.register("chunks:///_virtual/PrivacyUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Main.ts"],(function(e){var i,r,t,a,n,o,c,l,u,s,f,p,b,y,v;return{setters:[function(e){i=e.applyDecoratedDescriptor,r=e.inheritsLoose,t=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){n=e.cclegacy,o=e._decorator,c=e.Prefab,l=e.Node,u=e.sys,s=e.instantiate},function(e){f=e.EUILayer,p=e._ui,b=e._platform,y=e._privacy,v=e.BaseUI}],execute:function(){var h,P,w,d,m,I,V,_,C,U,g,k,A;n._RF.push({},"e8271LoZ41Fv7FwgPbwG3XC","PrivacyUI",void 0);var x=o.ccclass,M=o.property;e("PrivacyUI",(h=x("PrivacyUI"),P=M({type:c}),w=M({type:c}),d=M({type:c}),m=M({type:c}),I=M(l),h((C=i((_=function(e){function i(){for(var i,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return i=e.call.apply(e,[this].concat(n))||this,t(i,"privacyWebViewPrefab",C,a(i)),t(i,"privacyTextPrefab",U,a(i)),t(i,"userWebViewPrefab",g,a(i)),t(i,"userTextPrefab",k,a(i)),t(i,"returnNode",A,a(i)),i.privacyView=void 0,i.userView=void 0,i.layerType=f.Notice,i.cLabel_dec=null,i._openData=null,i}r(i,e);var n=i.prototype;return n.onCreate=function(){this.cLabel_dec.string="欢迎您使用本游戏，我们将严格遵守相关法律法规和隐私政策以保护您的个人信息。"},n.onEnable=function(){},n.init=function(){u.platform===u.Platform.ANDROID?(this.privacyView=s(this.privacyWebViewPrefab),this.userView=s(this.userWebViewPrefab)):(u.platform===u.Platform.VIVO_MINI_GAME||u.platform===u.Platform.HUAWEI_QUICK_GAME||u.platform===u.Platform.XIAOMI_QUICK_GAME||u.platform===u.Platform.OPPO_MINI_GAME||u.Platform.COCOSPLAY)&&(this.privacyView=s(this.privacyTextPrefab),this.userView=s(this.userTextPrefab)),this.userView.active=!1,this.privacyView.active=!1,this.node.addChild(this.userView),this.node.addChild(this.privacyView)},n.onClickConfirm=function(){this.closeUI(),this._openData()},n.onClickCancel=function(){var e=this;p.dialogue("不同意协议将无法进入游戏，请确定操作",{text:"退出",onClick:function(){b.instance.killGame()}},{text:"同意",color:"darkBlue",onClick:function(){e.onClickConfirm()}})},n.onClickAUser=function(){y.openUserUI()},n.onClickAPrivacy=function(){y.openDecUI()},n.back=function(){this.privacyView.active=!1,this.userView.active=!1,this.returnNode.active=!1},i}(v)).prototype,"privacyWebViewPrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=i(_.prototype,"privacyTextPrefab",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=i(_.prototype,"userWebViewPrefab",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=i(_.prototype,"userTextPrefab",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=i(_.prototype,"returnNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=_))||V));n._RF.pop()}}}));

System.register("chunks:///_virtual/PropEventChangeItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Main.ts","./LogicDefine.ts"],(function(t){var e,i,o,n,r,s,l,a,p,u,c,h,f,m,d,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){r=t.cclegacy,s=t.Sprite,l=t.Node},function(t){a=t.ccclass,p=t.property,u=t._prop,c=t._config_,h=t.PropHelper,f=t._language,m=t.Vector3,d=t.BaseComponent},function(t){y=t.EPropId}],execute:function(){var g,C,b,v,E,R,I,N,D,L,A,P,w;r._RF.push({},"80773c9mlRNYqRCsmDQVDvv","PropEventChangeItem",void 0);t("PropEventChangeItem",(g=a("PropEventChangeItem"),C=p({type:y,displayName:"prop表ID"}),b=p({displayName:"显示最大数量"}),v=p({type:s,displayName:"自动恢复进度条"}),E=p({type:l,displayName:"不需要恢复时关闭"}),R=p({type:l,displayName:"飞行道具位置"}),g((D=e((N=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))||this).backupDescribe="道具数量刷新",o(e,"configID",D,n(e)),o(e,"isShowMaxCount",L,n(e)),o(e,"spriteAutoResumeRatio",A,n(e)),o(e,"nodeAutoResumeNoClose",P,n(e)),o(e,"flyItemPos",w,n(e)),e.prop=null,e.config=null,e}i(e,t);var r=e.prototype;return r.onLoad=function(){var e=this;this.prop=u.singles.get(this.configID),this.config=c.obj.prop[this.configID],u.hasOpenUI(this.prop)&&(this.onClick=function(){u.openGetUI(this.prop)}),t.prototype.onLoad.call(this),this.addEvent(h.EventType.CHANGE,this.onEventChange,this,this.prop),this.addEvent(h.EventType.ADD,this.onEventAdd,this,this.prop),this.addEvent(u.EventType.FLY_TIP_COMPLETE,this.onEventFlyTipComplete,this,u),this.isShowMaxCount&&(this.LabelNumRollCC.lastStr="/"+this.prop.maxCount),this.addEvent(f.EventType.CHANGE,(function(t){e.LabelNumRollCC.updateString(e.LabelNumRollCC.cur),t()}),this,f)},r.onEnable=function(){var e=this;t.prototype.onEnable.call(this),this.updateLabel(this.prop.cur,!1),this.scheduleOnce((function(){var t=u.singlesByUIWorldPosition[e.configID];t||(t=u.singlesByUIWorldPosition[e.configID]=new m),t.set(e.flyItemPos.worldPosition)}))},r.onUpdate=function(){this.prop.intervalTime&&(this.spriteAutoResumeRatio&&(this.spriteAutoResumeRatio.fillRange=this.prop.intervalTime.ratio),this.nodeAutoResumeNoClose&&(this.nodeAutoResumeNoClose.active=this.prop.cur<this.prop.maxCount))},r.onEventChange=function(t,e){e>=t&&(this.LabelNumRollCC.isAnim=!1,this.updateLabel(this.prop.cur,!1))},r.onEventAdd=function(t,e){e!=u.numRollAnimParam&&(1!=this.config.is_fly||e)&&this.updateLabel(this.prop.cur,!1)},r.onEventFlyTipComplete=function(t){this.configID==t&&(this.AnimtorCC.playDefault(),this.updateLabel(this.prop.cur,!0))},r.updateLabel=function(t,e){t=Math.ceil(t),e?this.LabelNumRollCC.toByString(t):this.LabelNumRollCC.setString(t)},e}(d)).prototype,"configID",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return y.power}}),L=e(N.prototype,"isShowMaxCount",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),A=e(N.prototype,"spriteAutoResumeRatio",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(N.prototype,"nodeAutoResumeNoClose",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(N.prototype,"flyItemPos",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=N))||I));r._RF.pop()}}}));

System.register("chunks:///_virtual/PropUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Main.ts"],(function(e){var r,t,n,c,o;return{setters:[function(e){r=e.inheritsLoose},function(e){t=e.cclegacy},function(e){n=e.ccclass,c=e.EUILayer,o=e.BaseUI}],execute:function(){var i;t._RF.push({},"b176be6WoZE652Ya3jLJWct","PropUI",void 0);e("PropUI",n("PropUI")(i=function(e){function t(){for(var r,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(r=e.call.apply(e,[this].concat(n))||this).layerType=c.NoticeUp,r}return r(t,e),t}(o))||i);t._RF.pop()}}}));

System.register("chunks:///_virtual/ShapeGameType.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameDefine.ts","./Main.ts","./GameTypeDefine.ts","./LogicDefine.ts"],(function(e){var t,a,l,i,r,n,o,u,c,s,p,v,f,h,g,d,y,m,C,S,x,U,T,L,M,E,_,I;return{setters:[function(e){t=e.createClass},function(e){a=e.cclegacy,l=e.Color,i=e.Prefab,r=e.Texture2D,n=e.Material},function(e){o=e.initData},function(e){u=e.Vector3,c=e.Vector2,s=e._logic,p=e._resouces,v=e._ui,f=e._gameType,h=e._platform,g=e.EPlatformType,d=e.LevelHelper,y=e._config_},function(e){m=e.gameTypeModule,C=e.EGameType},function(e){S=e.CBattleSizeEntityUrl1x1Shape,x=e.CSceneData,U=e.CBattleShapeConfigColor,T=e.CBattleShapeConfigLevel,L=e.CBattleSizeEntityUrl1x1ShapeMatColor,M=e.CBattleSizeEntityUrl1x1ShapeMatBlackImg,E=e.CBattleSizeEntityUrl1x1ShapeMatWhiteImg,_=e.CCubeSize,I=e.EBattleSizeType}],execute:function(){var w;a._RF.push({},"2348bU/vOhGV5vVHkI83oTZ","ShapeGameType",void 0);var B=new l,b=new u,k=new u(0,0,70),z=new u,A=new c;e("ShapeGameType",m.add(C.shape)(w=function(){function e(){this.level=null,this.curLevel=-1,this.data=null,this.level=new d(f.storage,-1,"shapeLevel",30,!1,[],null)}var a=e.prototype;return a.preLoadRes=function(e){e.push.apply(e,s.preLoadRes),this.data||e.push({url:S,type:i},{url:x.uiUrl.RunUI,type:i},U,T,L,M,E)},a.run=function(e){var t=this;void 0===e&&(e=this.level.cur),this.curLevel=e,this.data||(this.data={level:p.get(T).json,color:p.get(U).json,matMap:{},curColors:[],colorMat:p.get(L),imgBlackMat:p.get(M),imgWhiteMat:p.get(E),blackTexture:p.get({url:"scene/texture/black/texture",type:r}),whiteTexture:p.get({url:"scene/texture/white/texture",type:r})});var a=this.curConfig;v.close(x.uiUrl.LevelSelectUI),v.close(o.uiUrl.index),f.logicRun(this.curLevel,(function(){var a;t.data.curColors.length=0;for(var l=t.data.level[e-1],i=0,r=0,o=0;o<l.x.length;o++){var c=l.x[o],p=l.y[o];c>i&&(i=c),p>r&&(r=p);var v=l.c[o];if(t.data.curColors.push(v),!t.data.matMap[v]){var f=127.5,h=null,g=null,d=t.data.color;B.set(d.r[v],d.g[v],d.b[v],255),B.r>f||B.g>f||B.b>f?(g=t.data.blackTexture,h=t.data.imgBlackMat):(g=t.data.whiteTexture,h=t.data.imgWhiteMat);var y=new n;y.initialize({effectAsset:t.data.colorMat.effectAsset,defines:{USE_INSTANCING:!0,USE_TEXTURE:!1}}),y.setProperty("mainColor",B);var m=new n;m.initialize({effectAsset:h.effectAsset,defines:{USE_INSTANCING:!0,USE_TEXTURE:!0}}),m.setProperty("mainColor",B),m.setProperty("mainTexture",g),t.data.matMap[v]={color:y,img:m}}}var C=u.pool.get().set(-(i/2+_.x),-(r/2+_.y),-_.z);s.create(b.set(i,r,1),((a={})[I["1*1"]]=100,a[I["1*2"]]=0,a[I["2*2"]]=0,a),!1,(function(){for(var e=0;e<l.x.length;e++){var t=l.x[e],a=l.y[e];s.data.datas.push(s.create1x1(b.set(t,a,0),C))}u.pool.put(C)}),{position:k,dis:A.set(4,100),rotate:z})}),(function(e){if(e){if(h.type==g.tt)window.tt.reportAnalytics("passMode",{mode:"彩虹",level:t.curLevel});t.level.cur==t.curLevel&&t.level.add(),v.open(x.uiUrl.SuccessUI)}else v.open(x.uiUrl.FailUI)})),v.open(x.uiUrl.RunUI,null,(function(){1===a.anim&&f.emit(f.EventType.PLAY_ANIM)}))},a.checkComplete=function(){0!=s.data.count()||f.runComplete(!0)},a.reset=function(){f.run(f.type,this.curLevel)},a.settingExit=function(){v.open(x.uiUrl.LevelSelectUI,{level:this.level,configLength:this.level.max})},t(e,[{key:"curConfig",get:function(){return y.obj.level_item[this.level.getConverLevel(this.curLevel)]}}]),e}())||w);a._RF.pop()}}}));

System.register("chunks:///_virtual/TodayGameType.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameDefine.ts","./Main.ts","./GameTypeDefine.ts","./LogicDefine.ts"],(function(e){var n,t,i,o,a,r,u,s,c,l,p,m,f,d,T,y,v,g,C,_,I,h,D,U,E,w;return{setters:[function(e){n=e.createForOfIteratorHelperLoose,t=e.createClass},function(e){i=e.cclegacy},function(e){o=e.initData},function(e){a=e.Vector2,r=e.Vector3,u=e.Times,s=e._gameType,c=e._logic,l=e._ui,p=e._config_,m=e._timer,f=e._login,d=e.EUIState,T=e._prop,y=e.IntervalTimeHelper,v=e._main,g=e._platform,C=e.EPlatformType,_=e._scene},function(e){I=e.gameTypeModule,h=e.EGameType},function(e){D=e.CSceneData,U=e.CBattleSizeEntityUrl,E=e.EBattleSizeType,w=e.EPropId}],execute:function(){var L;i._RF.push({},"7541eckInFNY6q1am2JKcKn","TodayGameType",void 0);var R=new a,O=new r;e("TodayGameType",I.add(h.today)(L=function(){function e(){var e=this;this.configIndex=0,this.intervalTimeCountDown=null,this.uiOpenTime=0,this.intervalTimeCountDown=new y(c.storage,"countDown",-1);var n=!1;v.on(v.EventType.VIDEO_COMPLETE,(function(e){n=e})),l.on(l.EventType.OPEN,(function(t){n=!1,s.type==h.today&&t!==o.uiUrl.prop&&(t==D.uiUrl.SettingUI||t==D.uiUrl.PropGetUI?e.pause():e.uiOpenTime=0)})),l.on(l.EventType.CLOSE_SCENE_ALL_DELAY,(function(){if(s.type==h.today&&e.uiOpenTime>0&&l.getTop()==D.uiUrl.RunUI){var t=!1;e.intervalTimeCountDown.sub<=0?n?t=!0:s.runComplete(!1):t=!0,t&&e.resume()}}))}var i=e.prototype;return i.pause=function(){this.uiOpenTime=u.second(),s.isRun=!1},i.resume=function(){this.addTime(u.second()-this.uiOpenTime),s.isRun=!0},i.preLoadRes=function(e){e.push.apply(e,c.preLoadRes)},i.run=function(){var e=this;l.close(D.uiUrl.LevelSelectUI),l.close(o.uiUrl.index);for(var t,i=0,a=n(p.arr.today_item);!(t=a()).done;){i+=t.value.time}this.intervalTimeCountDown.interval=60*i,this.intervalTimeCountDown.setCache(),this.configIndex=0,this.uiOpenTime=0,m.once(this,(function(){e.scene.preCube(U[E["1*1"]],200,.1),m.once(e,(function(){e.scene.preCube(U[E["1*2"]],200,.1),m.once(e,(function(){e.scene.preCube(U[E["1*2"]],200,.1)}),20)}),20)}),3);!function n(){e._run((function(){if(e.configIndex>=p.arr.today_item.length-1){var t=e.intervalTimeCountDown.interval-e.intervalTimeCountDown.sub;if((-1==e.todayTime||e.todayTime>t)&&c.storage.set("toDayTime",t),c.storage.set("toDayRunComplete","true"),l.open(D.uiUrl.SuccessToDayUI,t),g.type==C.tt){var i=window.tt;i.reportAnalytics("passMode",{mode:"挑战",level:0}),i.login({force:!0,success:function(e){console.log("login 调用成功"+e.code+" "+e.anonymousCode),window.tt.setImRankData({dataType:1,value:t+"",priority:1e4-t,extra:"extra",zoneId:"default",success:function(e){console.log("setImRankData success res: "+e)},fail:function(e){console.log("setImRankData fail res: "+e.errMsg)}})},fail:function(e){console.log("login 调用失败")}})}}else e.configIndex++,m.callLater(e,n)}))}()},i.addTime=function(e){this.intervalTimeCountDown.interval+=e,c.emit(c.EventType.DURATION_CHANGE)},i._run=function(e){var n=this.curConfig,t=-1;f.isNewUser&&o.newUseEnterGame&&(t=9987675),s.logicRun(t,(function(){var e,t;1==n.id?c.create(n.size,((e={})[E["1*1"]]=100,e[E["1*2"]]=0,e[E["2*2"]]=0,e),!1):c.create(n.size,((t={})[E["1*1"]]=100,t[E["1*2"]]=100,t[E["2*2"]]=100,t),!0,void 0,{position:O.set(24,20,24).mulSelf(1.2),dis:R.set(4,40).mulSelf(1)})}),(function(n){n?e():l.open(D.uiUrl.FailUI)})),l.open(D.uiUrl.RunUI,null,(function(){1===n.anim&&s.emit(s.EventType.PLAY_ANIM)}))},i.checkComplete=function(){if(0!=c.data.count()){var e=l.getModule(D.uiUrl.PropGetUI).state;if(e!=d.Open&&e!=d.Load&&this.intervalTimeCountDown.sub<=0){var n=l.getModule(D.uiUrl.PropGetUI).state;if(n==d.Open||n==d.Load)return;T.hasToDayMax(w.time)?s.runComplete(!1):T.openGetUI(T.singles.get(w.time))}}else s.runComplete(!0)},i.revive=function(e){s.isRun=!0,s._runComplete.set(s._runComplete._cb),this.addTime(300+e)},t(e,[{key:"curConfig",get:function(){return p.arr.today_item[this.configIndex]}},{key:"todayTime",get:function(){return c.storage.get("toDayTime",-1)}},{key:"scene",get:function(){return _.getCurrent()}}]),e}())||L);i._RF.pop()}}}));

System.register("chunks:///_virtual/ToDayMaxRecode.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Main.ts"],(function(e){var n,t,o,i,a,c;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy},function(e){o=e.ccclass,i=e._logic,a=e.Times,c=e.BaseComponent}],execute:function(){var r;t._RF.push({},"7a7968WD69Naqnxxn/uKrYp","ToDayMaxRecode",void 0);e("ToDayMaxRecode",o("ToDayMaxRecode")(r=function(e){function t(){for(var n,t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return(n=e.call.apply(e,[this].concat(o))||this).cLabel_time=null,n}return n(t,e),t.prototype.onEnable=function(){e.prototype.onEnable.call(this);var n=i._today.todayTime;-1==n?this.SwitchChildrenCC.index=0:(this.SwitchChildrenCC.index=1,this.cLabel_time.string=a.numHourCountDown(1e3*n))},t}(c))||r);t._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main2', 'chunks:///_virtual/main2'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});